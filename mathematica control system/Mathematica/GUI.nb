(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    255922,       5637]
NotebookOptionsPosition[    250986,       5538]
NotebookOutlinePosition[    251343,       5554]
CellTagsIndexPosition[    251300,       5551]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Widgets", "Subsection",
 CellChangeTimes->{{3.810435460848139*^9, 
  3.810435462066349*^9}},ExpressionUUID->"aae5bb65-3c71-483a-ac6d-\
46b917b7c43c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "SpinBox", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpinBox", "[", 
   RowBox[{"func_", ",", "s0_", ",", "stepRange_", ",", "imageSize_"}], "]"}],
   ":=", 
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"step", "=", 
       RowBox[{"stepRange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "digits", ",", 
      RowBox[{"s", "=", "s0"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"digits", "=", 
      RowBox[{"Length", "@", 
       RowBox[{"IntegerDigits", "[", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"1", "/", 
          RowBox[{"stepRange", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Panel", "[", 
         RowBox[{
          RowBox[{"EventHandler", "[", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
                RowBox[{"SetAccuracy", "[", 
                 RowBox[{"s", ",", "digits"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "=", "#"}], ")"}], "&"}]}], "]"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", 
              RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s", "+=", "step"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"func", "[", "s", "]"}]}], ")"}]}], ",", 
              RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s", "-=", "step"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"func", "[", "s", "]"}]}], ")"}]}], ",", 
              RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"step", "<", 
                   RowBox[{"stepRange", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{"step", "=", 
                   RowBox[{"step", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
              RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"step", ">", 
                   RowBox[{"stepRange", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{"step", "=", 
                   RowBox[{"step", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
        RowBox[{"Panel", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", 
           RowBox[{"SetAccuracy", "[", 
            RowBox[{"step", ",", "digits"}], "]"}], "]"}], ",", 
          RowBox[{"FrameMargins", "\[Rule]", "Small"}]}], "]"}]}], "}"}], 
      "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8104653565548964`*^9, 3.810465379991267*^9}, {
   3.8104657644262733`*^9, 3.8104658706273785`*^9}, {3.8104659019082317`*^9, 
   3.810466053106718*^9}, {3.8104661164606752`*^9, 3.8104661852645645`*^9}, 
   3.8104662272651806`*^9, {3.810466260788371*^9, 3.8104662886505394`*^9}, {
   3.8104663190994635`*^9, 3.8104663211146107`*^9}, {3.8104664853154697`*^9, 
   3.810466515463168*^9}, {3.810466672209451*^9, 3.810466678707916*^9}, {
   3.8104668881134977`*^9, 3.8104669148201213`*^9}, {3.810468706460162*^9, 
   3.810468708022318*^9}, {3.8105048121768146`*^9, 3.8105048324504275`*^9}, {
   3.810504905578348*^9, 3.8105049351541123`*^9}, {3.810505051670339*^9, 
   3.810505111888052*^9}, {3.810505480202462*^9, 3.8105054834985332`*^9}, {
   3.8105069995287666`*^9, 3.8105070035748415`*^9}, {3.81050964334801*^9, 
   3.8105096481872206`*^9}, {3.810510354025773*^9, 3.8105103696468306`*^9}, {
   3.8105104689851694`*^9, 3.8105104840028257`*^9}, {3.8105105141034975`*^9, 
   3.810510519477236*^9}, {3.8105105739769716`*^9, 3.810510619587886*^9}, {
   3.810543142576417*^9, 3.8105431512152624`*^9}, {3.8105432354334555`*^9, 
   3.810543265650006*^9}, {3.8105433575776873`*^9, 3.810543358608692*^9}, {
   3.8105436976698008`*^9, 3.810543732959035*^9}, {3.8105440683942394`*^9, 
   3.810544078626337*^9}, {3.8105441479660454`*^9, 3.8105441489345384`*^9}, 
   3.8105442645821733`*^9, {3.810544680540372*^9, 3.810544712699377*^9}, {
   3.810544949792116*^9, 3.8105449515276666`*^9}, {3.8105451040827074`*^9, 
   3.8105451263477716`*^9}, {3.81054517385903*^9, 3.810545205505635*^9}, {
   3.810545245646345*^9, 3.8105452638864574`*^9}, {3.8105453941284323`*^9, 
   3.810545399805899*^9}, {3.810545592550088*^9, 3.8105456659490213`*^9}, {
   3.813186424633994*^9, 3.8131864303856335`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"122e15d1-cef4-4749-8891-6a5c45e18846"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinBox", "[", 
  RowBox[{"f", ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0.01", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"60", ",", "20"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8104667619823627`*^9, 3.810466824286169*^9}, {
   3.810467437241124*^9, 3.810467438818843*^9}, {3.8104676493350897`*^9, 
   3.810467649475462*^9}, {3.810468653029924*^9, 3.8104686694125786`*^9}, {
   3.8104687128492575`*^9, 3.8104687375679393`*^9}, {3.8105044938762627`*^9, 
   3.8105045112264843`*^9}, 3.8105046915017776`*^9, 3.8105071184524484`*^9, {
   3.8105099708676004`*^9, 3.810509975342807*^9}, {3.810510298399228*^9, 
   3.8105104011132464`*^9}, {3.8105104872052*^9, 3.8105104899980793`*^9}, {
   3.8105105236816225`*^9, 3.810510538612392*^9}, 3.8105106002619295`*^9, 
   3.8105108949987955`*^9, {3.8105431060307693`*^9, 3.810543114794088*^9}, 
   3.8105432771982985`*^9, {3.810543737505233*^9, 3.8105437647188015`*^9}, {
   3.8105443792514777`*^9, 3.810544426637993*^9}, {3.810544756529276*^9, 
   3.8105447586847987`*^9}, {3.8105448137375765`*^9, 3.8105448138783855`*^9}, 
   3.81054496837693*^9, {3.8105450328526373`*^9, 3.8105450341492076`*^9}, {
   3.810545270052905*^9, 3.8105452748642893`*^9}, {3.8105456707759867`*^9, 
   3.8105456736817684`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"ccd8f17b-a5d0-4b93-9433-71edab63da82"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`step$$ = 0.01, $CellContext`digits$$ = 
  3, $CellContext`s$$ = 2}, 
  TemplateBox[{PanelBox[
     TagBox[
      InputFieldBox[
       Dynamic[
        SetAccuracy[$CellContext`s$$, $CellContext`digits$$], \
($CellContext`s$$ = #)& ], FrameMargins -> Tiny, ImageSize -> {60, 20}], 
      EventHandlerTag[{
       "UpArrowKeyDown" :> (
         AddTo[$CellContext`s$$, $CellContext`step$$]; \
$CellContext`f[$CellContext`s$$]), 
        "DownArrowKeyDown" :> (
         SubtractFrom[$CellContext`s$$, $CellContext`step$$]; \
$CellContext`f[$CellContext`s$$]), "LeftArrowKeyDown" :> 
        If[$CellContext`step$$ < 
          Part[{0.01, 10}, 2], $CellContext`step$$ = $CellContext`step$$ 10], 
        "RightArrowKeyDown" :> 
        If[$CellContext`step$$ > 
          Part[{0.01, 10}, 1], $CellContext`step$$ = $CellContext`step$$ 0.1],
         Method -> "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
        True}]], FrameMargins -> Tiny],PanelBox[
     DynamicBox[
      ToBoxes[
       SetAccuracy[$CellContext`step$$, $CellContext`digits$$], 
       StandardForm]], FrameMargins -> Small]},
   "RowDefault"],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.8105096501222515`*^9, {3.810509976561002*^9, 3.810509999477517*^9}, {
   3.8105102900845075`*^9, 3.8105103388380003`*^9}, {3.81051037667665*^9, 
   3.8105104017847805`*^9}, {3.810510495498496*^9, 3.8105105514230013`*^9}, {
   3.8105105937778687`*^9, 3.8105106223996973`*^9}, {3.810510891030979*^9, 
   3.81051089527998*^9}, {3.8105431026094522`*^9, 3.810543115903186*^9}, 
   3.8105431528240047`*^9, {3.8105432479195485`*^9, 3.8105432961177883`*^9}, 
   3.8105433330441895`*^9, 3.8105433670598054`*^9, 3.810543659587517*^9, {
   3.810543742194992*^9, 3.810543765078062*^9}, 3.8105438272646275`*^9, 
   3.8105440822034936`*^9, {3.810544155308069*^9, 3.8105441605009804`*^9}, {
   3.8105442154874153`*^9, 3.8105442287591195`*^9}, {3.810544261797724*^9, 
   3.8105442677530155`*^9}, {3.810544297980414*^9, 3.8105443046825066`*^9}, {
   3.8105443611059375`*^9, 3.810544427294113*^9}, {3.8105446862992935`*^9, 
   3.8105446894391804`*^9}, {3.8105447537484403`*^9, 
   3.8105447635273943`*^9}, {3.8105448149693656`*^9, 3.810544818140526*^9}, 
   3.8105448807913294`*^9, {3.8105449551830835`*^9, 3.810544972195876*^9}, {
   3.810545034586339*^9, 3.810545038072095*^9}, 3.810545111864634*^9, 
   3.8105452785506744`*^9, 3.810545674181431*^9, 3.813186434129999*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"8d560ddb-7ba1-43f5-8789-af3d034f6aed"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["CCD", "Subsection",
 CellChangeTimes->{{3.8102689238576937`*^9, 
  3.8102689241937943`*^9}},ExpressionUUID->"96f05939-356d-4a31-b1df-\
158ea193db9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "emccdGUI", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"emccdGUI", "[", "]"}], ":=", 
  RowBox[{"Column", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Button", "[", 
         RowBox[{"\"\<LoadOn\>\"", ",", 
          RowBox[{"LoadIon", "[", 
           RowBox[{"4", ",", "2.2"}], "]"}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<LoadOff\>\"", ",", 
          RowBox[{"LoadingOff", "[", "]"}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"Spacer", "[", "5", "]"}], ",", 
        RowBox[{"EventHandler", "[", 
         RowBox[{
          RowBox[{"Panel", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "csStatus", "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"35", ",", "25"}], "}"}]}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"csStatus", "=", 
              RowBox[{"StringDelete", "[", 
               RowBox[{
                RowBox[{"GetCurrentSourceStatus", "@", "CurrentSource"}], 
                ",", "\"\<\\n\>\""}], "]"}]}], ")"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Spacer", "[", "10", "]"}], ",", 
        RowBox[{"TextCell", "[", 
         RowBox[{"\"\<OvenCurrent (A):\>\"", ",", "\"\<Text\>\""}], "]"}], 
        ",", 
        RowBox[{"Spacer", "[", "5", "]"}], ",", 
        RowBox[{"Panel", "[", 
         RowBox[{
          RowBox[{"EventHandler", "[", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
                RowBox[{"SetAccuracy", "[", 
                 RowBox[{"csCurrent", ",", "3"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"csCurrent", "=", "#"}], ")"}], "&"}]}], "]"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"40", ",", "20"}], "}"}]}], ",", 
              RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"csCurrent", "=", 
                  RowBox[{"csCurrent", "+", "cstep"}]}], ";", 
                 RowBox[{"SetVoltageCurrent", "[", 
                  RowBox[{"CurrentSource", ",", "4", ",", "csCurrent"}], 
                  "]"}]}], ")"}]}], ",", 
              RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"csCurrent", "=", 
                  RowBox[{"csCurrent", "-", "cstep"}]}], ";", 
                 RowBox[{"SetVoltageCurrent", "[", 
                  RowBox[{"CurrentSource", ",", "4", ",", "csCurrent"}], 
                  "]"}]}], ")"}]}], ",", 
              RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"cstep", "<", "1"}], ",", 
                  RowBox[{"cstep", "=", 
                   RowBox[{"cstep", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
              RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"cstep", ">", "0.01"}], ",", 
                  RowBox[{"cstep", "=", 
                   RowBox[{"cstep", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"Spacer", "[", "10", "]"}], ","}], "*)"}], "}"}], "]"}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DynamicModule", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"indicator", "=", "\"\<VideoOff\>\""}], ",", 
            RowBox[{"v", "=", "None"}]}], "}"}], ",", 
          RowBox[{"EventHandler", "[", 
           RowBox[{
            RowBox[{"Button", "[", 
             RowBox[{
              RowBox[{"Dynamic", "@", "indicator"}], ",", "Null", ",", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}], 
                "}"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"indicator", "=", 
                 RowBox[{"indicator", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "\"\<VideoOff\>\"", "\[Rule]", "\"\<VideoOn\>\""}], ",", 
                    RowBox[{
                    "\"\<VideoOn\>\"", "\[Rule]", "\"\<VideoOff\>\""}]}], 
                   "}"}]}]}], ";", 
                RowBox[{"v", "=", 
                 RowBox[{"v", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"None", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"UpdateInterval", "\[Rule]", 
                    RowBox[{"1.5", "*", "CCDExpo"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"UpdateInterval", "\[Rule]", 
                    RowBox[{"1.5", "*", "CCDExpo"}]}], ")"}], "\[Rule]", 
                    "None"}]}], "}"}]}]}], ";", 
                RowBox[{"videoSymbol", "=", "v"}]}], ")"}]}], "}"}]}], 
           "]"}]}], "]"}], ",", 
        RowBox[{"Spacer", "[", "20", "]"}], ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Trace\>\"", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"posx", ",", "posy"}], "}"}], "=", 
              RowBox[{"MaxCountPoint", "[", 
               RowBox[{"NETObjectToExpression", "@", "buf"}], "]"}]}]}], 
            "]"}], ",", 
           RowBox[{"Spacer", "[", "5", "]"}], ",", 
           RowBox[{"TextCell", "[", 
            RowBox[{"\"\<x:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
           RowBox[{"Panel", "[", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "posx", "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"30", ",", "20"}], "}"}]}], ",", 
               RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
             RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
           RowBox[{"Spacer", "[", "5", "]"}], ",", 
           RowBox[{"TextCell", "[", 
            RowBox[{"\"\<y:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
           RowBox[{"Panel", "[", 
            RowBox[{
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "posy", "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"30", ",", "20"}], "}"}]}], ",", 
               RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
             RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"Spacer", "[", "10", "]"}], ",", 
        RowBox[{"PopupMenu", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "$CCDSetting", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Gain\>\"", ",", "\"\<Temp\>\"", ",", "\"\<Expo\>\""}],
            "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"65", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Dynamic", "@", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"$CCDSetting", "\[Equal]", "\"\<Gain\>\""}], ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"SetEMCCDGain", "[", "CCDGain", "]"}], ";", 
                "CCDGain"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"CCDGain", "=", "#"}], ")"}], "&"}]}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"40", ",", "20"}], "}"}]}], ",", 
             RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
           RowBox[{"$CCDSetting", "\[Equal]", "\"\<Temp\>\""}], ",", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"EventHandler", "[", 
               RowBox[{
                RowBox[{"Panel", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", "CCDtemp", "]"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"35", ",", "Automatic"}], "}"}]}], ",", 
                  RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
                  RowBox[{"GetTemperature", "[", "CCDtemp", "]"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"SetTemperature", "[", "CCDTemp", "]"}], ";", 
                   "CCDTemp"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"CCDTemp", "=", "#"}], ")"}], "&"}]}], "]"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"35", ",", "20"}], "}"}]}], ",", 
                RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}],
             "]"}], ",", 
           RowBox[{"$CCDSetting", "\[Equal]", "\"\<Expo\>\""}], ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"SetExposureTime", "[", "CCDExpo", "]"}], ";", 
                "\[IndentingNewLine]", "CCDExpo"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"CCDExpo", "=", "#"}], ")"}], "&"}]}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"40", ",", "20"}], "}"}]}], ",", 
             RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
          "]"}]}]}], "}"}], "]"}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FileNameSetter", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "CCDFile", "]"}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Browse\>\""}]}], "]"}], 
              ",", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "CCDFile", "]"}], ",", "String", ",", 
                RowBox[{"FieldSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"25", ",", "1"}], "}"}]}]}], "]"}]}], "}"}], "]"}], 
           ",", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"TextCell", "[", 
               RowBox[{"\"\<CCD Image:\>\"", ",", "\"\<Subsection\>\""}], 
               "]"}], ",", 
              RowBox[{"Spacer", "[", "100", "]"}], ",", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Auto\>\"", ",", 
                RowBox[{
                 RowBox[{"imageMin", "=", "400"}], ";", 
                 RowBox[{"imageMax", "=", "1200"}]}]}], "]"}], ",", 
              RowBox[{"Panel", "[", 
               RowBox[{
                RowBox[{"InputField", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", "imageMin", "]"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"40", ",", "20"}], "}"}]}], ",", 
                  RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
              RowBox[{"Panel", "[", 
               RowBox[{
                RowBox[{"InputField", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", "imageMax", "]"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"40", ",", "20"}], "}"}]}], ",", 
                  RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}],
             "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"Spacer", "[", "5", "]"}], ",", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Load\>\"", ",", 
                RowBox[{"CCDimage", "=", 
                 RowBox[{"Image", "[", 
                  RowBox[{
                   RowBox[{"Rescale", "[", 
                    RowBox[{
                    RowBox[{"Import", "@", "CCDFile"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"imageMin", ",", "imageMax"}], "}"}]}], "]"}], 
                   ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"450", ",", "450"}], "}"}]}]}], "]"}]}]}], "]"}], 
              ",", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Save\>\"", ",", 
                RowBox[{"ImageSave", "[", "]"}]}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Capture\>\"", ",", 
             RowBox[{"CCDimage", "=", 
              RowBox[{"Video", "[", 
               RowBox[{"imageMin", ",", "imageMax"}], "]"}]}]}], "]"}]}], 
          "}"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"Panel", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"videoSymbol", "===", "None"}], ",", "CCDimage", ",", 
           RowBox[{"Refresh", "[", 
            RowBox[{
             RowBox[{"CCDimage", "=", 
              RowBox[{"Video", "[", 
               RowBox[{"imageMin", ",", "imageMax"}], "]"}]}], ",", 
             "videoSymbol"}], "]"}]}], "]"}], ",", 
         RowBox[{"Initialization", "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"videoSymbol", "=", "None"}], ";", 
            RowBox[{"InitializeCCDPar", "[", "]"}]}], ")"}]}]}], "]"}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
       RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], "}"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.812421556305815*^9, 3.8124215803694425`*^9}, {
   3.8124230633858514`*^9, 3.8124230652339077`*^9}, {3.8124250651186323`*^9, 
   3.812425077526439*^9}, {3.812425162804307*^9, 3.812425165293648*^9}, {
   3.8124253288045053`*^9, 3.8124253380737095`*^9}, 3.81242614799072*^9, {
   3.812426415622484*^9, 3.8124264273910017`*^9}, {3.812431088823145*^9, 
   3.812431094765249*^9}, {3.812431127720673*^9, 3.8124311434800215`*^9}, {
   3.8124313727283525`*^9, 3.8124313746881104`*^9}, {3.8126696763919525`*^9, 
   3.8126696772725945`*^9}, {3.8127719826220193`*^9, 
   3.8127719855023136`*^9}, {3.813100104483518*^9, 3.813100116985075*^9}, {
   3.813100167669486*^9, 3.813100171433417*^9}, {3.813102270624737*^9, 
   3.813102274003697*^9}, {3.814606102605656*^9, 3.8146061096039352`*^9}, {
   3.819942561970383*^9, 3.8199425743702364`*^9}, 3.8199426061901755`*^9, {
   3.819942745028037*^9, 3.819942847647716*^9}, {3.819943003544975*^9, 
   3.819943004251088*^9}, {3.8199430445812774`*^9, 3.8199430815125527`*^9}, {
   3.819943212575199*^9, 3.8199433770156198`*^9}, {3.819943411498441*^9, 
   3.819943497756857*^9}, {3.819943534525567*^9, 3.81994355932627*^9}, {
   3.819943726482432*^9, 3.8199437613302774`*^9}, 3.8199438214525614`*^9, {
   3.8199439258853917`*^9, 3.819943982900978*^9}, {3.8199442756244287`*^9, 
   3.8199443321583033`*^9}, {3.819944672637142*^9, 3.8199446912753186`*^9}, {
   3.8199447439544983`*^9, 3.8199447735055027`*^9}, {3.8199448513254757`*^9, 
   3.8199448844339705`*^9}, 3.819944933300342*^9, {3.819944974466298*^9, 
   3.819945030235217*^9}, {3.81994506155649*^9, 3.819945066619954*^9}, {
   3.8199452783758936`*^9, 3.819945294079913*^9}, {3.8199454927009635`*^9, 
   3.819945512786271*^9}, {3.8199455428957834`*^9, 3.819945549693611*^9}, 
   3.819945692965619*^9, {3.8199459983407*^9, 3.8199460181557317`*^9}, {
   3.819946172564967*^9, 3.8199461901300135`*^9}, {3.8199464272521424`*^9, 
   3.8199464566126566`*^9}, {3.81994652597424*^9, 3.8199465289582634`*^9}, {
   3.8199465849585643`*^9, 3.819946600350419*^9}, {3.8199466413807383`*^9, 
   3.819946660553486*^9}, {3.8199467596844907`*^9, 3.8199467667934866`*^9}, {
   3.819946878126872*^9, 3.819946882013482*^9}, {3.8199469885506897`*^9, 
   3.819947011436511*^9}, {3.8199470572370787`*^9, 3.819947071019236*^9}, {
   3.819947524348405*^9, 3.819947527910882*^9}, {3.8201332058490458`*^9, 
   3.82013322530005*^9}, {3.8201334207259684`*^9, 3.820133423768834*^9}, {
   3.820133616425827*^9, 3.820133638653409*^9}, {3.820211138946727*^9, 
   3.8202111390594254`*^9}, {3.8204852371696806`*^9, 3.820485244380397*^9}, {
   3.8204853134596663`*^9, 3.820485383217122*^9}, 3.8204854249874206`*^9, {
   3.8204854740661755`*^9, 3.820485494963292*^9}, {3.820485538670411*^9, 
   3.8204855388190145`*^9}, {3.820485605648301*^9, 3.820485617776867*^9}, 
   3.822385135333911*^9},ExpressionUUID->"75edf22a-d5d0-4a75-baf1-\
6ed2522dcb5d"]
}, Closed]],

Cell[CellGroupData[{

Cell["LaserCtrl", "Subsection",
 CellChangeTimes->{
  3.8102687695076056`*^9, {3.810268907810622*^9, 
   3.810268910377754*^9}},ExpressionUUID->"2353b441-99d1-4e4e-9cd7-\
42b5ecdadd73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "laserGUI", ",", "laserSignalDispGUI", ",", "laserSignalDispModule"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"laserGUI", "[", "]"}], ":=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"(*", 
         RowBox[{"370", " ", "laser", " ", "block"}], "*)"}], 
        RowBox[{
         RowBox[{"Column", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TextCell", "[", 
                 RowBox[{"\"\<370 laser set\>\"", ",", "\"\<Subsection\>\""}],
                  "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Connect\>\"", ",", 
                  RowBox[{"Laser370Connect", "[", "]"}]}], "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<On\>\"", ",", 
                  RowBox[{"EmissionEnable", "[", 
                   RowBox[{"laser370", ",", "\"\<#t\>\""}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Off\>\"", ",", 
                  RowBox[{"EmissionEnable", "[", 
                   RowBox[{"laser370", ",", "\"\<#f\>\""}], "]"}]}], "]"}]}], 
               "}"}], ",", "\"\<    \>\""}], "]"}], ",", 
            RowBox[{"Spacer", "[", "1", "]"}], ",", 
            RowBox[{"Grid", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<PC/CC reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"step9", "=", "0.01"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s7", "=", 
                    RowBox[{"LaserPCSet", "[", 
                    RowBox[{"laser370", ",", "\"\<?\>\""}], "]"}]}], ";", 
                    RowBox[{"step10", "=", "0.01"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s8", "=", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser370", ",", "\"\<?\>\""}], "]"}]}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<PC set\>\"", ",", "\"\<Subsubsection\>\""}], 
                    "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s7", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s7", "=", 
                    RowBox[{"s7", "+", "step9"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserPCSet", "[", 
                    RowBox[{"laser370", ",", "s7"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s8", "=", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser370", ",", "\"\<?\>\""}], "]"}]}]}], 
                    ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s7", "=", 
                    RowBox[{"s7", "-", "step9"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserPCSet", "[", 
                    RowBox[{"laser370", ",", "s7"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s8", "=", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser370", ",", "\"\<?\>\""}], "]"}]}]}], 
                    ")"}]}], ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step9", "<", "1"}], ",", 
                    RowBox[{"step9", "=", 
                    RowBox[{"step9", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step9", ">", "0.001"}], ",", 
                    RowBox[{"step9", "=", 
                    RowBox[{"step9", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step9", ",", "4"}], "]"}], "]"}], "<>", 
                    "\"\< V\>\""}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<CC set\>\"", ",", "\"\<Subsubsection\>\""}], 
                    "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s8", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s8", "=", 
                    RowBox[{"s8", "+", "step10"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser370", ",", "s8"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s8", "=", 
                    RowBox[{"s8", "-", "step10"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser370", ",", "s8"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step10", "<", "1"}], ",", 
                    RowBox[{"step10", "=", 
                    RowBox[{"step10", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step10", ">", "0.001"}], ",", 
                    RowBox[{"step10", "=", 
                    RowBox[{"step10", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step10", ",", "4"}], "]"}], "]"}], "<>", 
                    "\"\< mA\>\""}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                    "}"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<PID Offset:\>\"", ",", "\"\<Text\>\""}], 
                    "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"k0", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k0", "=", 
                    RowBox[{"k0", "+", "step0"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1045", ",", "2", ",", "0", ",", 
                    RowBox[{"1000", "*", "k0"}]}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k0", "=", 
                    RowBox[{"k0", "-", "step0"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1045", ",", "2", ",", "0", ",", 
                    RowBox[{"1000", "*", "k0"}]}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step0", "<", "1"}], ",", 
                    RowBox[{"step0", "=", 
                    RowBox[{"step0", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step0", ">", "0.001"}], ",", 
                    RowBox[{"step0", "=", 
                    RowBox[{"step0", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step0", ",", "4"}], "]"}], "]"}], "<>", 
                    "\"\< V\>\""}], ",", 
                    RowBox[{"Initialization", "\[RuleDelayed]", 
                    RowBox[{"InitializeLaser370Par", "[", "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Toggler", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "scan", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"False", "\[Rule]", "\"\<Scan\>\""}], ",", 
                    RowBox[{"True", "\[Rule]", "\"\<Scan\>\""}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"Lighter", "[", 
                    RowBox[{"Gray", ",", ".7"}], "]"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Gray", ",", "Thin"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{"scan", ",", 
                    RowBox[{
                    RowBox[{"ScanEnable", "[", 
                    RowBox[{"laser370", ",", "\"\<#t\>\""}], "]"}], ";", 
                    "\"\<Enable\>\""}], ",", 
                    RowBox[{
                    RowBox[{"ScanEnable", "[", 
                    RowBox[{"laser370", ",", "\"\<#f\>\""}], "]"}], ";", 
                    "\"\<Disable\>\""}]}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "25"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Toggler", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "LockC", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"False", "\[Rule]", "\"\<Lock\>\""}], ",", 
                    RowBox[{"True", "\[Rule]", "\"\<Lock\>\""}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"Lighter", "[", 
                    RowBox[{"Gray", ",", ".7"}], "]"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Gray", ",", "Thin"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{"LockC", ",", 
                    RowBox[{
                    RowBox[{"LockEnable", "[", 
                    RowBox[{"laser370", ",", "\"\<#t\>\""}], "]"}], ";", 
                    "\"\<Enable\>\""}], ",", 
                    RowBox[{
                    RowBox[{"LockEnable", "[", 
                    RowBox[{"laser370", ",", "\"\<#f\>\""}], "]"}], ";", 
                    "\"\<Disable\>\""}]}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "25"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                    "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<+\>\"", ",", 
                    RowBox[{
                    RowBox[{"reference1", "=", 
                    RowBox[{"reference1", "+", "1*^-6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference1", ",", "7"}], "]"}]}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<WLM reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"reference1", "=", 
                    RowBox[{"GetWavelengthNum", "[", "2", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference1", ",", "7"}], "]"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<-\>\"", ",", 
                    RowBox[{
                    RowBox[{"reference1", "=", 
                    RowBox[{"reference1", "-", "1*^-6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference1", ",", "7"}], "]"}]}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference1", ",", "7"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"reference1", "=", "#"}], ")"}], "&"}]}], "]"}], 
                    ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"75", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"reference1", "=", 
                    RowBox[{"reference1", "+", "1*^-6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference1", ",", "7"}], "]"}]}]}], "]"}]}], 
                    ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"reference1", "=", 
                    RowBox[{"reference1", "-", "1*^-6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference1", ",", "7"}], "]"}]}]}], "]"}]}], 
                    ")"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                    "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"Refresh", "[", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"GetWavelengthNum", "[", "2", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"9", ",", "6"}], "}"}]}], "]"}], ",", 
                    RowBox[{"UpdateInterval", "\[Rule]", ".1"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "[", 
                    RowBox[{"Dynamic", "[", "LockW", "]"}], "]"}], ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"SetDeviationMode", "[", "LockW", "]"}], ";", 
                    "\"\<RegSig\>\""}], "]"}], ",", 
                    RowBox[{"Checkbox", "[", 
                    RowBox[{"Dynamic", "[", "Lock370", "]"}], "]"}], ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"Lock370", ",", 
                    RowBox[{
                    RowBox[{"WLMPIDSetting", "[", 
                    RowBox[{"2", ",", "0.08", ",", "0.13", ",", "0.03"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"prop1", "=", "0.08"}], ";", 
                    RowBox[{"int1", "=", "0.13"}], ";", 
                    RowBox[{"dif1", "=", "0.03"}]}], ",", 
                    RowBox[{
                    RowBox[{"WLMPIDSetting", "[", 
                    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ";", 
                    RowBox[{"prop1", "=", "0."}], ";", 
                    RowBox[{"int1", "=", "0."}], ";", "\[IndentingNewLine]", 
                    RowBox[{"dif1", "=", "0."}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\"\<Lock\>\""}], "]"}]}], "}"}], 
                    ",", "\"\<  \>\""}], "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<clear\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ClearPIDHistory", "[", "2", "]"}], ";"}]}], 
                    "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<P:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"prop1", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"40", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"prop1", "=", 
                    RowBox[{"prop1", "+", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1034", ",", "2", ",", "0", ",", "prop1"}], 
                    "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"prop1", "=", 
                    RowBox[{"prop1", "-", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1034", ",", "2", ",", "0", ",", "prop1"}], 
                    "]"}]}], ")"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                    "}"}], ",", "\"\<  \>\""}], "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<I:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"int1", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"40", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"int1", "=", 
                    RowBox[{"int1", "+", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1035", ",", "2", ",", "0", ",", "int1"}], 
                    "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"int1", "=", 
                    RowBox[{"int1", "-", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1035", ",", "2", ",", "0", ",", "int1"}], 
                    "]"}]}], ")"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<D:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"dif1", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"40", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dif1", "=", 
                    RowBox[{"dif1", "+", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1036", ",", "2", ",", "0", ",", "dif1"}], 
                    "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dif1", "=", 
                    RowBox[{"dif1", "-", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1036", ",", "2", ",", "0", ",", "dif1"}], 
                    "]"}]}], ")"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                    "}"}], ",", "\"\<  \>\""}], "]"}]}], "}"}], "]"}]}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"Alignment", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Left", ",", "Left"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Top", ",", "Top"}], "}"}]}], "}"}]}]}], "]"}]}], 
           "}"}], "]"}], ",", 
         RowBox[{"laserSignalDispModule", "[", "laser370", "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"(*", 
         RowBox[{"935", " ", "laser", " ", "block"}], "*)"}], 
        RowBox[{
         RowBox[{"Column", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TextCell", "[", 
                 RowBox[{"\"\<935 laser set\>\"", ",", "\"\<Subsection\>\""}],
                  "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Connect\>\"", ",", 
                  RowBox[{"Laser935Connect", "[", "]"}]}], "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<On\>\"", ",", 
                  RowBox[{"EmissionEnable", "[", 
                   RowBox[{"laser935", ",", "\"\<#t\>\""}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Off\>\"", ",", 
                  RowBox[{"EmissionEnable", "[", 
                   RowBox[{"laser935", ",", "\"\<#f\>\""}], "]"}]}], "]"}]}], 
               "}"}], ",", "\"\<    \>\""}], "]"}], ",", 
            RowBox[{"Spacer", "[", "1", "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Button", "[", 
                    RowBox[{"\"\<PC/CC reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"step5", "=", "0.01"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s3", "=", 
                    RowBox[{"LaserPCSet", "[", 
                    RowBox[{"laser935", ",", "\"\<?\>\""}], "]"}]}], ";", 
                    RowBox[{"step6", "=", "0.01"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s4", "=", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser935", ",", "\"\<?\>\""}], "]"}]}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<PC set\>\"", ",", "\"\<Subsubsection\>\""}], 
                    "]"}], ",", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s3", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s3", "=", 
                    RowBox[{"s3", "+", "step5"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserPCSet", "[", 
                    RowBox[{"laser935", ",", "s3"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s4", "=", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser935", ",", "\"\<?\>\""}], "]"}]}]}], 
                    ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s3", "=", 
                    RowBox[{"s3", "-", "step5"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserPCSet", "[", 
                    RowBox[{"laser935", ",", "s3"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s4", "=", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser935", ",", "\"\<?\>\""}], "]"}]}]}], 
                    ")"}]}], ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step5", "<", "1"}], ",", 
                    RowBox[{"step5", "=", 
                    RowBox[{"step5", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step5", ">", "0.001"}], ",", 
                    RowBox[{"step5", "=", 
                    RowBox[{"step5", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step5", ",", "4"}], "]"}], "]"}], "<>", 
                    "\"\< V\>\""}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                   RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<CC set\>\"", ",", "\"\<Subsubsection\>\""}], 
                    "]"}], ",", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s4", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"55", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s4", "=", 
                    RowBox[{"s4", "+", "step6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser935", ",", "s4"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s4", "=", 
                    RowBox[{"s4", "-", "step6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser935", ",", "s4"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step6", "<", "1"}], ",", 
                    RowBox[{"step6", "=", 
                    RowBox[{"step6", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step6", ">", "0.001"}], ",", 
                    RowBox[{"step6", "=", 
                    RowBox[{"step6", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step6", ",", "4"}], "]"}], "]"}], "<>", 
                    "\"\< mA\>\""}], ",", 
                    RowBox[{"Initialization", "\[RuleDelayed]", 
                    RowBox[{"InitializeLaser935Par", "[", "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                    "}"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Grid", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<+\>\"", ",", 
                    RowBox[{
                    RowBox[{"reference2", "=", 
                    RowBox[{"reference2", "+", "1*^-6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"3", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference2", ",", "7"}], "]"}]}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<WLM reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"reference2", "=", 
                    RowBox[{"GetWavelengthNum", "[", "3", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"3", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference2", ",", "7"}], "]"}]}]}], "]"}]}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<-\>\"", ",", 
                    RowBox[{
                    RowBox[{"reference2", "=", 
                    RowBox[{"reference2", "-", "1*^-6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"3", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference2", ",", "7"}], "]"}]}]}], "]"}]}]}], 
                    "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference2", ",", "7"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"reference2", "=", "#"}], ")"}], "&"}]}], "]"}], 
                    ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"75", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"reference2", "=", 
                    RowBox[{"reference2", "+", "1*^-6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"3", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference2", ",", "7"}], "]"}]}]}], "]"}]}], 
                    ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"reference2", "=", 
                    RowBox[{"reference2", "-", "1*^-6"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDCourseNum", "[", 
                    RowBox[{"3", ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"reference2", ",", "7"}], "]"}]}]}], "]"}]}], 
                    ")"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                    "}"}]}], "}"}], "]"}], ",", 
                   RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"Refresh", "[", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"GetWavelengthNum", "[", "3", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"9", ",", "6"}], "}"}]}], "]"}], ",", 
                    RowBox[{"UpdateInterval", "\[Rule]", ".1"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "[", 
                    RowBox[{"Dynamic", "[", "LockW", "]"}], "]"}], ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"SetDeviationMode", "[", "LockW", "]"}], ";", 
                    "\"\<RegSig\>\""}], "]"}], ",", 
                    RowBox[{"Checkbox", "[", 
                    RowBox[{"Dynamic", "[", "Lock935", "]"}], "]"}], ",", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"Lock935", ",", 
                    RowBox[{
                    RowBox[{"WLMPIDSetting", "[", 
                    RowBox[{"3", ",", "0.02", ",", "0.05", ",", "0"}], "]"}], 
                    ";", 
                    RowBox[{"prop2", "=", "0.02"}], ";", 
                    RowBox[{"int2", "=", "0.05"}], ";", 
                    RowBox[{"dif2", "=", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"WLMPIDSetting", "[", 
                    RowBox[{"3", ",", "0", ",", "0", ",", "0"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"prop2", "=", "0."}], ";", 
                    RowBox[{"int2", "=", "0."}], ";", 
                    RowBox[{"dif2", "=", "0."}]}]}], "]"}], ";", 
                    "\"\<Lock\>\""}], "]"}]}], "}"}], ",", "\"\<  \>\""}], 
                    "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<clear\>\"", ",", 
                    RowBox[{
                    RowBox[{"ClearPIDHistory", "[", "3", "]"}], ";"}]}], 
                    "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<P:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"prop2", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"40", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"prop2", "=", 
                    RowBox[{"prop2", "+", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1034", ",", "3", ",", "0", ",", "prop2"}], 
                    "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"prop2", "=", 
                    RowBox[{"prop2", "-", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1034", ",", "3", ",", "0", ",", "prop2"}], 
                    "]"}]}], ")"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                    "}"}], ",", "\"\<  \>\""}], "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<I:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"int2", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"40", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"int2", "=", 
                    RowBox[{"int2", "+", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1035", ",", "3", ",", "0", ",", "int2"}], 
                    "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"int2", "=", 
                    RowBox[{"int2", "-", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1035", ",", "3", ",", "0", ",", "int2"}], 
                    "]"}]}], ")"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<D:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"dif2", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"40", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dif2", "=", 
                    RowBox[{"dif2", "+", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1036", ",", "3", ",", "0", ",", "dif2"}], 
                    "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dif2", "=", 
                    RowBox[{"dif2", "-", "0.01"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SetPIDSetting", "[", 
                    RowBox[{"1036", ",", "3", ",", "0", ",", "dif2"}], 
                    "]"}]}], ")"}]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                    "}"}], ",", "\"\<  \>\""}], "]"}]}], "}"}], "]"}]}], 
                  "}"}], "]"}]}], "}"}], ",", 
              RowBox[{"Spacer", "[", "5", "]"}]}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"(*", 
          RowBox[{"399", " ", "laser", " ", "block"}], "*)"}], 
         RowBox[{"Column", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TextCell", "[", 
                 RowBox[{"\"\<399 laser set\>\"", ",", "\"\<Subsection\>\""}],
                  "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Connect\>\"", ",", 
                  RowBox[{"Laser399Connect", "[", "]"}]}], "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<On\>\"", ",", 
                  RowBox[{"EmissionEnable", "[", 
                   RowBox[{"laser399", ",", "\"\<#t\>\""}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Off\>\"", ",", 
                  RowBox[{"EmissionEnable", "[", 
                   RowBox[{"laser399", ",", "\"\<#f\>\""}], "]"}]}], "]"}]}], 
               "}"}], ",", "\"\<    \>\""}], "]"}], ",", 
            RowBox[{"Spacer", "[", "1", "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Button", "[", 
                    RowBox[{"\"\<PC/CC reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"step7", "=", "0.01"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s5", "=", 
                    RowBox[{"LaserPCSet", "[", 
                    RowBox[{"laser399", ",", "\"\<?\>\""}], "]"}]}], ";", 
                    RowBox[{"step8", "=", "0.01"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s6", "=", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser399", ",", "\"\<?\>\""}], "]"}]}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<PC set\>\"", ",", "\"\<Subsubsection\>\""}], 
                    "]"}], ",", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s5", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s5", "=", 
                    RowBox[{"s5", "+", "step7"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserPCSet", "[", 
                    RowBox[{"laser399", ",", "s5"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s6", "=", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser399", ",", "\"\<?\>\""}], "]"}]}]}], 
                    ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s5", "=", 
                    RowBox[{"s5", "-", "step7"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserPCSet", "[", 
                    RowBox[{"laser399", ",", "s5"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"s6", "=", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser399", ",", "\"\<?\>\""}], "]"}]}]}], 
                    ")"}]}], ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step7", "<", "1"}], ",", 
                    RowBox[{"step7", "=", 
                    RowBox[{"step7", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step7", ">", "0.001"}], ",", 
                    RowBox[{"step7", "=", 
                    RowBox[{"step7", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step7", ",", "4"}], "]"}], "]"}], "<>", 
                    "\"\< V\>\""}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                    "}"}], "]"}], ",", 
                   RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<CC set\>\"", ",", "\"\<Subsubsection\>\""}], 
                    "]"}], ",", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s6", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"55", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s6", "=", 
                    RowBox[{"s6", "+", "step8"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser399", ",", "s6"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s6", "=", 
                    RowBox[{"s6", "-", "step8"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LaserCCSet", "[", 
                    RowBox[{"laser399", ",", "s6"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step8", "<", "1"}], ",", 
                    RowBox[{"step8", "=", 
                    RowBox[{"step8", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step8", ">", "0.001"}], ",", 
                    RowBox[{"step8", "=", 
                    RowBox[{"step8", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step8", ",", "4"}], "]"}], "]"}], "<>", 
                    "\"\< mA\>\""}], ",", 
                    RowBox[{"Initialization", "\[RuleDelayed]", 
                    RowBox[{"InitializeLaser399Par", "[", "]"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                    "}"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "wavelen", "]"}], ",", "Number", 
                    ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"75", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<WL confirm\>\"", ",", 
                    RowBox[{"LaserWavelengthSet", "[", 
                    RowBox[{"wavelen", ",", "True"}], "]"}], ",", 
                    RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], 
                    ","}], "*)"}], 
                  RowBox[{
                   RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"Refresh", "[", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"GetWavelengthNum", "[", "4", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"9", ",", "6"}], "}"}]}], "]"}], ",", 
                    RowBox[{"UpdateInterval", "\[Rule]", ".1"}]}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], 
                   RowBox[{"(*", 
                    RowBox[{",", 
                    RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Checkbox", "[", 
                    RowBox[{"Dynamic", "[", "lock399", "]"}], "]"}], ",", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{"lock399", ",", 
                    RowBox[{
                    RowBox[{"CtrlSignalValue", "[", 
                    RowBox[{
                    RowBox[{"LaserPanel", "@", "\"\<Laser\>\""}], ",", "2"}], 
                    "]"}], ";", 
                    RowBox[{"CtrlSignalValue", "[", 
                    RowBox[{
                    RowBox[{"LaserPanel", "@", "\"\<Lock\>\""}], ",", 
                    "True"}], "]"}], ";", "\"\<Lock\>\""}], ",", 
                    RowBox[{
                    RowBox[{"CtrlSignalValue", "[", 
                    RowBox[{
                    RowBox[{"LaserPanel", "@", "\"\<Laser\>\""}], ",", "2"}], 
                    "]"}], ";", 
                    RowBox[{"CtrlSignalValue", "[", 
                    RowBox[{
                    RowBox[{"LaserPanel", "@", "\"\<Lock\>\""}], ",", 
                    "False"}], "]"}], ";", "\[IndentingNewLine]", 
                    "\"\<Unlock\>\""}]}], "]"}]}]}], "}"}], ",", 
                    "\"\<  \>\""}], "]"}]}], "*)"}], ",", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Toggler", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "scan1", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"False", "\[Rule]", "\"\<Scan\>\""}], ",", 
                    RowBox[{"True", "\[Rule]", "\"\<Scan\>\""}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"Lighter", "[", 
                    RowBox[{"Gray", ",", ".7"}], "]"}]}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Gray", ",", "Thin"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{"scan1", ",", 
                    RowBox[{
                    RowBox[{"ScanEnable", "[", 
                    RowBox[{"laser399", ",", "\"\<#t\>\""}], "]"}], ";", 
                    "\"\<Enable\>\""}], ",", 
                    RowBox[{
                    RowBox[{"ScanEnable", "[", 
                    RowBox[{"laser399", ",", "\"\<#f\>\""}], "]"}], ";", 
                    "\"\<Disable\>\""}]}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "25"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                    "}"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
              RowBox[{"Spacer", "[", "5", "]"}]}], "]"}]}], "}"}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Left", ",", "Left"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Top", ",", "Top"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", "All"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"laserSignalDispGUI", "[", 
    RowBox[{"laser_", ",", 
     RowBox[{"WindowPosition_", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"600", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "60"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"CreateDialog", "[", 
    RowBox[{
     RowBox[{"laserSignalDispModule", "[", "laser", "]"}], ",", 
     RowBox[{"WindowMargins", "\[Rule]", "WindowPosition"}], ",", 
     RowBox[{"WindowTitle", "\[Rule]", "\"\<Signal display\>\""}], ",", 
     RowBox[{"WindowFrameElements", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<CloseBox\>\"", ",", "\"\<ZoomBox\>\"", ",", 
        "\"\<MinimizeBox\>\""}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"laserSignalDispModule", "[", "laser_", "]"}], ":=", 
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TextCell", "[", 
             RowBox[{"\"\<Display\>\"", ",", "\"\<Subsection\>\""}], "]"}], 
            ",", 
            RowBox[{"Spacer", "[", "10", "]"}], ",", 
            RowBox[{"DynamicModule", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"indicator", "=", "\"\<Off\>\""}], ",", 
                RowBox[{"v", "=", "None"}]}], "}"}], ",", 
              RowBox[{"EventHandler", "[", 
               RowBox[{
                RowBox[{"Button", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "@", "indicator"}], ",", "Null", ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"30", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"indicator", "=", 
                    RowBox[{"indicator", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<Off\>\"", "\[Rule]", "\"\<On\>\""}], ",", 
                    RowBox[{"\"\<On\>\"", "\[Rule]", "\"\<Off\>\""}]}], 
                    "}"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"v", "=", 
                    RowBox[{"v", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"None", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"UpdateInterval", "\[Rule]", ".2"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"UpdateInterval", "\[Rule]", ".2"}], ")"}], 
                    "\[Rule]", "None"}]}], "}"}]}]}], ";", 
                    RowBox[{"signalSymbol", "=", "v"}]}], ")"}]}], "}"}]}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"Spacer", "[", "5", "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<reset\>\"", ",", 
              RowBox[{
               RowBox[{"LImin", "=", 
                RowBox[{"-", "0.06"}]}], ";", 
               RowBox[{"LImax", "=", "0.06"}], ";"}]}], "]"}], ",", 
            RowBox[{"Spacer", "[", "5", "]"}], ",", 
            RowBox[{"TextCell", "[", "\"\<ymin:\>\"", "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "LImin", "]"}], ",", "Number", ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"45", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Spacer", "[", "5", "]"}], ",", 
            RowBox[{"TextCell", "[", "\"\<ymax:\>\"", "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "LImax", "]"}], ",", "Number", ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"45", ",", "Automatic"}], "}"}]}]}], "]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Spacer", "[", "1", "]"}], ",", 
         RowBox[{"Panel", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{
             RowBox[{"Refresh", "[", 
              RowBox[{
               RowBox[{"LaserSignalDisp", "[", 
                RowBox[{"laser", ",", 
                 RowBox[{"{", 
                  RowBox[{"LImin", ",", "LImax"}], "}"}]}], "]"}], ",", 
               "signalSymbol"}], "]"}], ",", 
             RowBox[{"Initialization", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"NumberQ", "@", "LImax"}]}], ",", 
                  RowBox[{
                   RowBox[{"LImax", "=", "0.06"}], ";", 
                   RowBox[{"LImin", "=", 
                    RowBox[{"-", "0.06"}]}]}]}], "]"}], ";", 
                RowBox[{"signalSymbol", "=", "None"}]}], ")"}]}]}], "]"}], 
           ",", 
           RowBox[{"Background", "\[Rule]", "White"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"380", ",", "250"}], "}"}]}], ",", 
           RowBox[{"FrameMargins", "\[Rule]", "None"}], ",", 
           RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], "}"}], 
       "]"}], "}"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Left", ",", "Left"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Top", ",", "Top"}], "}"}]}], "}"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8124217050313396`*^9, 3.8124217193380666`*^9}, {
   3.812423313599489*^9, 3.812423451024853*^9}, {3.813100203956413*^9, 
   3.813100210849971*^9}, {3.8131016167968345`*^9, 3.813101691545867*^9}, {
   3.8131034764669113`*^9, 3.813103485090845*^9}, {3.813358257979379*^9, 
   3.8133583315695133`*^9}, {3.815802314118972*^9, 3.8158023144231577`*^9}, {
   3.815802367765459*^9, 3.8158023687667804`*^9}, {3.815810254019373*^9, 
   3.8158102636336546`*^9}, {3.8158103135790415`*^9, 
   3.8158103150062227`*^9}, {3.815810494170929*^9, 3.8158105529825974`*^9}, {
   3.8158118015364866`*^9, 3.815811844107603*^9}, {3.81581188279012*^9, 
   3.8158119429820967`*^9}, {3.815811989856699*^9, 3.8158119901399417`*^9}, {
   3.8158120856903286`*^9, 3.815812085979555*^9}, {3.815812183117694*^9, 
   3.815812196657473*^9}, {3.8158122784616337`*^9, 3.815812289017395*^9}, 
   3.8158123192106233`*^9, {3.8158128312354856`*^9, 3.815812831438942*^9}, {
   3.815875909472126*^9, 3.8158759898600755`*^9}, {3.815876083240268*^9, 
   3.8158761183463535`*^9}, {3.8159503271172605`*^9, 3.815950454922361*^9}, {
   3.8159505204640255`*^9, 3.8159505301491165`*^9}, {3.8159506014511385`*^9, 
   3.815950631022032*^9}, {3.815950696894189*^9, 3.815950697028844*^9}, {
   3.815950729017256*^9, 3.815950731856659*^9}, {3.8159507890327034`*^9, 
   3.8159507896454897`*^9}, {3.8175156415640955`*^9, 3.817515678236024*^9}, {
   3.817515732367262*^9, 3.8175157417930546`*^9}, {3.817515785696644*^9, 
   3.817515819181097*^9}, {3.819925781709009*^9, 3.8199257918379326`*^9}, {
   3.82013372903979*^9, 3.8201337426015368`*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"b71b5c36-5fb3-4f6e-9bee-159cce4f8826"]
}, Closed]],

Cell[CellGroupData[{

Cell["AD5372", "Subsection",
 CellChangeTimes->{{3.8214314549557695`*^9, 
  3.821431456316134*^9}},ExpressionUUID->"6c7cddd7-9c01-4d2b-8c0f-\
74c23f4e89ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "AD5372GUI", ",", "SingleChanSpinBox", ",", "WiredChanSpinBox", ",", 
    "DACWidgets"}], "]"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SingleChanSpinBox", "[", 
     RowBox[{"row_Integer", ",", "column_Integer", ",", "imageSize_List"}], 
     "]"}], ":=", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"channel", "=", 
        RowBox[{
         RowBox[{"8", "*", 
          RowBox[{"(", 
           RowBox[{"row", "-", "1"}], ")"}]}], "+", "column", "-", "1"}]}], 
       "}"}], ",", 
      RowBox[{"Panel", "[", 
       RowBox[{
        RowBox[{"EventHandler", "[", 
         RowBox[{
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{
              RowBox[{"SetAccuracy", "[", 
               RowBox[{
                RowBox[{"$VList", "[", 
                 RowBox[{"[", 
                  RowBox[{"row", ",", "column"}], "]"}], "]"}], ",", "4"}], 
               "]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$VList", "[", 
                  RowBox[{"[", 
                   RowBox[{"row", ",", "column"}], "]"}], "]"}], "=", "#"}], 
                ")"}], "&"}]}], "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"$VList", "[", 
                 RowBox[{"[", 
                  RowBox[{"row", ",", "column"}], "]"}], "]"}], "+=", 
                "$DACStep"}], ";", "\[IndentingNewLine]", 
               RowBox[{"SetDACVoltage", "[", 
                RowBox[{"channel", ",", 
                 RowBox[{"$VList", "[", 
                  RowBox[{"[", 
                   RowBox[{"row", ",", "column"}], "]"}], "]"}]}], "]"}], 
               ";"}], ")"}]}], ",", 
            RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"$VList", "[", 
                 RowBox[{"[", 
                  RowBox[{"row", ",", "column"}], "]"}], "]"}], "-=", 
                "$DACStep"}], ";", "\[IndentingNewLine]", 
               RowBox[{"SetDACVoltage", "[", 
                RowBox[{"channel", ",", 
                 RowBox[{"$VList", "[", 
                  RowBox[{"[", 
                   RowBox[{"row", ",", "column"}], "]"}], "]"}]}], "]"}], 
               ";"}], ")"}]}], ",", 
            RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"$DACStep", "<", "1"}], ",", 
                RowBox[{"$DACStep", "=", 
                 RowBox[{"$DACStep", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
            RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"$DACStep", ">", "0.001"}], ",", 
                RowBox[{"$DACStep", "=", 
                 RowBox[{"$DACStep", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WiredChanSpinBox", "[", 
     RowBox[{"row_Integer", ",", "column_Integer", ",", "imageSize_List"}], 
     "]"}], ":=", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"$ChanWiredList", ",", "True"}], "]"}]}], "}"}], ",", 
      RowBox[{"Panel", "[", 
       RowBox[{
        RowBox[{"EventHandler", "[", 
         RowBox[{
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{
              RowBox[{"SetAccuracy", "[", 
               RowBox[{
                RowBox[{"$VList", "[", 
                 RowBox[{"[", 
                  RowBox[{"row", ",", "column"}], "]"}], "]"}], ",", "4"}], 
               "]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$VList", "[", 
                  RowBox[{"[", 
                   RowBox[{"row", ",", "column"}], "]"}], "]"}], "=", "#"}], 
                ")"}], "&"}]}], "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$VList", "[", 
                    RowBox[{"[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "+=", 
                    "$DACStep"}], ")"}], "&"}], ",", 
                 RowBox[{"pos", "\[Transpose]"}]}], "]"}], ";", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"SetDACVoltage", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"8", "*", 
                    RowBox[{"(", 
                    RowBox[{"#1", "-", "1"}], ")"}]}], "+", "#2", "-", "1"}], 
                    ",", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "]"}]}], "]"}], "&"}], 
                 ",", 
                 RowBox[{"pos", "\[Transpose]"}]}], "]"}], ";"}], ")"}]}], 
            ",", 
            RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"$VList", "[", 
                    RowBox[{"[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "-=", 
                    "$DACStep"}], ")"}], "&"}], ",", 
                 RowBox[{"pos", "\[Transpose]"}]}], "]"}], ";", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"SetDACVoltage", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"8", "*", 
                    RowBox[{"(", 
                    RowBox[{"#1", "-", "1"}], ")"}]}], "+", "#2", "-", "1"}], 
                    ",", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "]"}]}], "]"}], "&"}], 
                 ",", 
                 RowBox[{"pos", "\[Transpose]"}]}], "]"}], ";"}], ")"}]}], 
            ",", 
            RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"$DACStep", "<", "1"}], ",", 
                RowBox[{"$DACStep", "=", 
                 RowBox[{"$DACStep", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
            RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"$DACStep", ">", "0.001"}], ",", 
                RowBox[{"$DACStep", "=", 
                 RowBox[{"$DACStep", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DACWidgets", "[", 
    RowBox[{"row_", ",", "column_"}], "]"}], ":=", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Checkbox", "[", 
       RowBox[{"Dynamic", "[", 
        RowBox[{"$ChanWiredList", "[", 
         RowBox[{"[", 
          RowBox[{"row", ",", "column"}], "]"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"Spacer", "[", "1", "]"}], ",", 
      RowBox[{"Dynamic", "@", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"$ChanWiredList", "[", 
          RowBox[{"[", 
           RowBox[{"row", ",", "column"}], "]"}], "]"}], ",", 
         RowBox[{"WiredChanSpinBox", "[", 
          RowBox[{"row", ",", "column", ",", 
           RowBox[{"{", 
            RowBox[{"55", ",", "20"}], "}"}]}], "]"}], ",", 
         RowBox[{"SingleChanSpinBox", "[", 
          RowBox[{"row", ",", "column", ",", 
           RowBox[{"{", 
            RowBox[{"55", ",", "20"}], "}"}]}], "]"}]}], "]"}]}]}], "}"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AD5372GUI", "[", "]"}], ":=", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FileNameSetter", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "$DACFile", "]"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Browse\>\""}]}], "]"}], ",", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"$DACFile", ",", 
              RowBox[{"Initialization", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{
                "$DACFile", "=", "\"\<DACVoltage/DACVoltageList.csv\>\""}], 
                ")"}]}]}], "]"}], ",", "String", ",", 
            RowBox[{"FieldSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"30", ",", "1"}], "}"}]}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Load\>\"", ",", 
            RowBox[{
             RowBox[{"$VList", "=", 
              RowBox[{"Import", "[", 
               RowBox[{"DataPath", "[", "$DACFile", "]"}], "]"}]}], ";", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"SetDACVoltage", "[", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "$VList", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", "31"}], "}"}]}], "]"}], ";"}]}], 
           "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Save\>\"", ",", 
            RowBox[{
             RowBox[{"Export", "[", 
              RowBox[{"$DACFile", ",", "$VList"}], "]"}], ";"}]}], "]"}], ",", 
          RowBox[{"Spacer", "[", "10", "]"}], ",", 
          RowBox[{"Panel", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"$DACStep", ",", 
              RowBox[{"Initialization", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"$DACStep", "=", "0.001"}], ")"}]}]}], "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"45", ",", "25"}], "}"}]}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}]}], "}"}], 
        "]"}], ",", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"DACWidgets", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"\"\<C\>\"", "<>", 
               RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<:\>\""}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"Spacings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.5"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Reset\>\"", ",", 
         RowBox[{
          RowBox[{"$VList", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{".0", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "8"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"SetDACVoltage", "[", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"Flatten", "[", "$VList", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "31"}], "}"}]}], "]"}], ";"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}], 
           "}"}]}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ChanWiredList", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"False", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$VList", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8214317228875823`*^9, 3.821431731758856*^9}, {
   3.8214322709572816`*^9, 3.8214322726803455`*^9}, 3.821481190556263*^9, {
   3.821484737009468*^9, 3.8214847477796707`*^9}, {3.821486352648595*^9, 
   3.8214863595581617`*^9}, {3.8214865285244007`*^9, 
   3.8214865335218115`*^9}, {3.821486643476353*^9, 3.8214867346160483`*^9}, {
   3.8214868047016115`*^9, 3.82148680765685*^9}, {3.821487070473923*^9, 
   3.821487071890137*^9}, {3.821498431918851*^9, 3.821498470914584*^9}, {
   3.82149879731843*^9, 3.821498800539851*^9}, {3.8214988334677706`*^9, 
   3.8214988789810734`*^9}, {3.8214989611403885`*^9, 
   3.8214990036587033`*^9}, {3.821499067908939*^9, 3.821499142436592*^9}, {
   3.821499666538502*^9, 3.8214997392670794`*^9}, {3.821499821692642*^9, 
   3.8214998343717394`*^9}, {3.8215003342178173`*^9, 
   3.8215003877541857`*^9}, {3.8215004743376923`*^9, 
   3.8215004828130302`*^9}, {3.821500534454985*^9, 3.8215006536287217`*^9}, {
   3.821500836684266*^9, 3.821500862347682*^9}, {3.821500932651763*^9, 
   3.8215009415604825`*^9}, {3.821500976593773*^9, 3.82150100697598*^9}, {
   3.8215010386149006`*^9, 3.821501070935527*^9}, {3.8215011074408674`*^9, 
   3.8215011112766495`*^9}, {3.821501156521196*^9, 3.8215011659329944`*^9}, {
   3.821518531763364*^9, 3.821518538544199*^9}, {3.8223870406387787`*^9, 
   3.8223870429695463`*^9}, 3.82238714187306*^9, {3.822389491023877*^9, 
   3.8223895078668365`*^9}, 3.8223898290898275`*^9, {3.8239154654383917`*^9, 
   3.823915467745223*^9}, {3.823915501314452*^9, 
   3.8239155720921793`*^9}},ExpressionUUID->"2f6f2c05-bb6c-4917-877f-\
e20bb2237196"]
}, Open  ]],

Cell[CellGroupData[{

Cell["NI PCIe-6738", "Subsection",
 CellChangeTimes->{{3.8214314549557695`*^9, 3.821431456316134*^9}, {
  3.8223856050837145`*^9, 3.8223856085654044`*^9}, {3.822385651052785*^9, 
  3.822385657318031*^9}},ExpressionUUID->"6c6590b5-b4f9-4bc9-8a1e-\
c30139646fb8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "NIPCIe6738GUI", ",", "SingleChanSpinBox", ",", "WiredChanSpinBox", ",", 
     "DACWidgets"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SingleChanSpinBox", "[", 
     RowBox[{"row_Integer", ",", "column_Integer", ",", "imageSize_List"}], 
     "]"}], ":=", 
    RowBox[{"Panel", "[", 
     RowBox[{
      RowBox[{"EventHandler", "[", 
       RowBox[{
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", 
           RowBox[{
            RowBox[{"SetAccuracy", "[", 
             RowBox[{
              RowBox[{"$VList", "[", 
               RowBox[{"[", 
                RowBox[{"row", ",", "column"}], "]"}], "]"}], ",", "4"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"$VList", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", "column"}], "]"}], "]"}], "=", "#"}], 
              ")"}], "&"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", 
          RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"$VList", "[", 
               RowBox[{"[", 
                RowBox[{"row", ",", "column"}], "]"}], "]"}], "+=", 
              "$DACStep"}], ";", 
             RowBox[{"VoltageWriter", "@", 
              RowBox[{"WriteSingleSample", "[", 
               RowBox[{"True", ",", 
                RowBox[{"Flatten", "@", "$VList"}]}], "]"}]}], ";"}], ")"}]}],
           ",", 
          RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"$VList", "[", 
               RowBox[{"[", 
                RowBox[{"row", ",", "column"}], "]"}], "]"}], "-=", 
              "$DACStep"}], ";", 
             RowBox[{"VoltageWriter", "@", 
              RowBox[{"WriteSingleSample", "[", 
               RowBox[{"True", ",", 
                RowBox[{"Flatten", "@", "$VList"}]}], "]"}]}], ";"}], ")"}]}],
           ",", 
          RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"$DACStep", "<", "1"}], ",", 
              RowBox[{"$DACStep", "=", 
               RowBox[{"$DACStep", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
          RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"$DACStep", ">", "0.001"}], ",", 
              RowBox[{"$DACStep", "=", 
               RowBox[{"$DACStep", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
         "}"}]}], "]"}], ",", 
      RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WiredChanSpinBox", "[", 
    RowBox[{"row_Integer", ",", "column_Integer", ",", "imageSize_List"}], 
    "]"}], ":=", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"$ChanWiredList", ",", "True"}], "]"}]}], "}"}], ",", 
     RowBox[{"Panel", "[", 
      RowBox[{
       RowBox[{"EventHandler", "[", 
        RowBox[{
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{
             RowBox[{"SetAccuracy", "[", 
              RowBox[{
               RowBox[{"$VList", "[", 
                RowBox[{"[", 
                 RowBox[{"row", ",", "column"}], "]"}], "]"}], ",", "4"}], 
              "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"$VList", "[", 
                 RowBox[{"[", 
                  RowBox[{"row", ",", "column"}], "]"}], "]"}], "=", "#"}], 
               ")"}], "&"}]}], "]"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", 
           RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$VList", "[", 
                    RowBox[{"[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "+=", 
                   "$DACStep"}], ")"}], "&"}], ",", 
                RowBox[{"pos", "\[Transpose]"}]}], "]"}], ";", 
              RowBox[{"VoltageWriter", "@", 
               RowBox[{"WriteSingleSample", "[", 
                RowBox[{"True", ",", 
                 RowBox[{"Flatten", "@", "$VList"}]}], "]"}]}], ";"}], 
             ")"}]}], ",", 
           RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"$VList", "[", 
                    RowBox[{"[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "-=", 
                   "$DACStep"}], ")"}], "&"}], ",", 
                RowBox[{"pos", "\[Transpose]"}]}], "]"}], ";", 
              RowBox[{"VoltageWriter", "@", 
               RowBox[{"WriteSingleSample", "[", 
                RowBox[{"True", ",", 
                 RowBox[{"Flatten", "@", "$VList"}]}], "]"}]}], ";"}], 
             ")"}]}], ",", 
           RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"$DACStep", "<", "1"}], ",", 
               RowBox[{"$DACStep", "=", 
                RowBox[{"$DACStep", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
           RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"$DACStep", ">", "0.001"}], ",", 
               RowBox[{"$DACStep", "=", 
                RowBox[{"$DACStep", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DACWidgets", "[", 
    RowBox[{"row_", ",", "column_"}], "]"}], ":=", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Checkbox", "[", 
       RowBox[{"Dynamic", "[", 
        RowBox[{"$ChanWiredList", "[", 
         RowBox[{"[", 
          RowBox[{"row", ",", "column"}], "]"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"Spacer", "[", "1", "]"}], ",", 
      RowBox[{"Dynamic", "@", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"$ChanWiredList", "[", 
          RowBox[{"[", 
           RowBox[{"row", ",", "column"}], "]"}], "]"}], ",", 
         RowBox[{"WiredChanSpinBox", "[", 
          RowBox[{"row", ",", "column", ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", "20"}], "}"}]}], "]"}], ",", 
         RowBox[{"SingleChanSpinBox", "[", 
          RowBox[{"row", ",", "column", ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", "20"}], "}"}]}], "]"}]}], "]"}]}]}], "}"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NIPCIe6738GUI", "[", "]"}], ":=", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FileNameSetter", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "$DACFile", "]"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Browse\>\""}]}], "]"}], ",", 
          RowBox[{"InputField", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "$DACFile", "]"}], ",", "String", ",", 
            RowBox[{"FieldSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"30", ",", "1"}], "}"}]}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Load\>\"", ",", 
            RowBox[{
             RowBox[{"$VList", "=", 
              RowBox[{"Import", "[", 
               RowBox[{"DataPath", "[", "$DACFile", "]"}], "]"}]}], ";", 
             RowBox[{"VoltageWriter", "@", 
              RowBox[{"WriteSingleSample", "[", 
               RowBox[{"True", ",", 
                RowBox[{"Flatten", "@", "$VList"}]}], "]"}]}], ";"}]}], "]"}],
           ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Save\>\"", ",", 
            RowBox[{
             RowBox[{"Export", "[", 
              RowBox[{"$DACFile", ",", "$VList"}], "]"}], ";"}]}], "]"}], ",", 
          RowBox[{"Spacer", "[", "10", "]"}], ",", 
          RowBox[{"Panel", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", 
             RowBox[{"$DACStep", ",", 
              RowBox[{"Initialization", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"$DACStep", "=", "0.001"}], ";", 
                 RowBox[{"$DACFile", "=", 
                  RowBox[{
                  "DataPath", "[", "\"\<DAC Voltage/DACVoltageList.csv\>\"", 
                   "]"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"45", ",", "25"}], "}"}]}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "]"}]}], "}"}], 
        "]"}], ",", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"DACWidgets", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"\"\<C\>\"", "<>", 
               RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<:\>\""}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"Spacings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0.5"}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Reset\>\"", ",", 
         RowBox[{
          RowBox[{"$VList", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{".0", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "8"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"VoltageWriter", "@", 
           RowBox[{"WriteSingleSample", "[", 
            RowBox[{"True", ",", 
             RowBox[{"Flatten", "@", "$VList"}]}], "]"}]}], ";"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}], 
           "}"}]}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "centerdc1", ",", "centerdc2", ",", "switch", ",", "rfbias1", ",", 
     "rfbias2", ",", "integraterhold", ",", "rfamplitudectrl", ",", 
     "flipper"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.32"}], ",", 
     RowBox[{"-", "1.3"}], ",", ".0", ",", "3.", ",", "3.6", ",", ".0", ",", 
     "3.3", ",", 
     RowBox[{"-", "3.3"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ChanWiredList", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"False", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$VList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "8.", ",", ".0", ",", "1.", ",", ".0", ",", "centerdc1", ",", ".0", ",",
        "1.1", ",", ".0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "8.", ",", "rfbias1", ",", "0.", ",", "8.", ",", "0.", ",", "1.", ",", 
       "0.", ",", "centerdc2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.", ",", "1.1", ",", ".0", ",", "8.", ",", "switch", ",", "rfbias2", 
       ",", "integraterhold", ",", "rfamplitudectrl"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.81", ",", "0.08", ",", "0.68", ",", "0.65", ",", 
       RowBox[{"-", "0.08"}], ",", "0.52", ",", "0.", ",", "flipper"}], 
      "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8214317228875823`*^9, 3.821431731758856*^9}, {
   3.8214322709572816`*^9, 3.8214322726803455`*^9}, 3.821481190556263*^9, {
   3.821484737009468*^9, 3.8214847477796707`*^9}, {3.821486352648595*^9, 
   3.8214863595581617`*^9}, {3.8214865285244007`*^9, 
   3.8214865335218115`*^9}, {3.821486643476353*^9, 3.8214867346160483`*^9}, {
   3.8214868047016115`*^9, 3.82148680765685*^9}, {3.821487070473923*^9, 
   3.821487071890137*^9}, {3.821498431918851*^9, 3.821498470914584*^9}, {
   3.82149879731843*^9, 3.821498800539851*^9}, {3.8214988334677706`*^9, 
   3.8214988789810734`*^9}, {3.8214989611403885`*^9, 
   3.8214990036587033`*^9}, {3.821499067908939*^9, 3.821499142436592*^9}, {
   3.821499666538502*^9, 3.8214997392670794`*^9}, {3.821499821692642*^9, 
   3.8214998343717394`*^9}, {3.8215003342178173`*^9, 
   3.8215003877541857`*^9}, {3.8215004743376923`*^9, 
   3.8215004828130302`*^9}, {3.821500534454985*^9, 3.8215006536287217`*^9}, {
   3.821500836684266*^9, 3.821500862347682*^9}, {3.821500932651763*^9, 
   3.8215009415604825`*^9}, {3.821500976593773*^9, 3.82150100697598*^9}, {
   3.8215010386149006`*^9, 3.821501070935527*^9}, {3.8215011074408674`*^9, 
   3.8215011112766495`*^9}, {3.821501156521196*^9, 3.8215011659329944`*^9}, {
   3.821518531763364*^9, 3.821518538544199*^9}, {3.822385847022726*^9, 
   3.8223858693809357`*^9}, {3.822385934837892*^9, 3.8223860944390893`*^9}, {
   3.82238628139314*^9, 3.8223862911749816`*^9}, 3.8223863953723392`*^9, {
   3.822386547544403*^9, 3.822386556064618*^9}, {3.8223866658799524`*^9, 
   3.8223866705045857`*^9}, {3.8223867109504256`*^9, 
   3.8223867318365717`*^9}, {3.822386800893901*^9, 3.822386804409499*^9}, 
   3.8223868541564665`*^9, 3.8223868867293625`*^9, {3.822386927783574*^9, 
   3.8223870126047473`*^9}, {3.8223870831989655`*^9, 3.822387090594189*^9}, 
   3.8223871373800755`*^9, {3.82238734404342*^9, 3.8223873609133067`*^9}, {
   3.8223875225829725`*^9, 3.822387540191883*^9}, 3.8223875938942733`*^9, {
   3.8223876391003838`*^9, 3.822387650613595*^9}, {3.8223877824201207`*^9, 
   3.822387797857837*^9}, {3.822388010239889*^9, 3.822388056922052*^9}, 
   3.8223881439602966`*^9, {3.8223881920058136`*^9, 3.822388267661496*^9}, {
   3.822388321405775*^9, 3.8223883382607017`*^9}, {3.822388434405593*^9, 
   3.8223884729824314`*^9}, {3.822388506266424*^9, 3.8223885115592694`*^9}, {
   3.822388554577232*^9, 3.822388563621047*^9}, {3.822388676357569*^9, 
   3.8223887097442865`*^9}, {3.822388769626152*^9, 3.822388809358899*^9}, {
   3.8223889310989876`*^9, 3.8223889433901186`*^9}, {3.822389083243126*^9, 
   3.8223890848996964`*^9}, {3.822389174217844*^9, 3.8223891774073143`*^9}, 
   3.822389355844142*^9, {3.8223894425195875`*^9, 3.8223894809408417`*^9}, 
   3.8223895205060368`*^9, {3.8223895578681245`*^9, 3.822389561321888*^9}, {
   3.82238961183381*^9, 3.8223896229460936`*^9}, {3.822389665633939*^9, 
   3.822389678307049*^9}, {3.8223897520099535`*^9, 3.8223897752119074`*^9}, {
   3.822389846667821*^9, 3.8223898566790495`*^9}, {3.822390237748999*^9, 
   3.822390269751418*^9}, {3.8223905941768465`*^9, 3.822390597260599*^9}},
 CellLabel->
  "In[4248]:=",ExpressionUUID->"eeb121b9-1579-4fb0-951e-3efcff71bbe3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CreateDialog", "[", 
  RowBox[{
   RowBox[{"NIPCIe6738GUI", "[", "]"}], ",", 
   RowBox[{"WindowMargins", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"400", ",", "Automatic"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "60"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"WindowTitle", "\[Rule]", "\"\<DAC\>\""}], ",", 
   RowBox[{"WindowFrameElements", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<CloseBox\>\"", ",", "\"\<ZoomBox\>\"", ",", "\"\<MinimizeBox\>\"", 
      ",", "\"\<ResizeArea\>\""}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8223879804744873`*^9, 3.8223879877969055`*^9}},
 CellLabel->
  "In[4257]:=",ExpressionUUID->"59213d47-4252-43ae-8009-f770f748bfda"],

Cell[BoxData[
 TemplateBox[{FrontEndObject[
    LinkObject["d4xte_shm", 3, 1]],288,
   "FrontEndObject[LinkObject[\"d4xte_shm\", 3, 1]]","288","\"DAC\""},
  "NotebookObjectUnsaved"]], "Output",
 CellChangeTimes->{
  3.82238798962003*^9, 3.822388065016406*^9, 3.822388106496482*^9, 
   3.8223883459351788`*^9, 3.8223884585091352`*^9, 3.8223885186233797`*^9, 
   3.822388595032048*^9, 3.8223886896739593`*^9, 3.8223887287305145`*^9, {
   3.82238879667083*^9, 3.8223888126540875`*^9}, {3.8223888772004786`*^9, 
   3.822388890073055*^9}, 3.822389099083766*^9, 3.822389184543231*^9, 
   3.822389367613668*^9, 3.822389527872339*^9, 3.822389567565192*^9, 
   3.822389628001575*^9, 3.8223897273449135`*^9, {3.822389758284176*^9, 
   3.8223897815409822`*^9}, 3.8223898732128353`*^9, {3.822390252186391*^9, 
   3.822390274434894*^9}, {3.822390577474511*^9, 3.8223906149522886`*^9}},
 CellLabel->
  "Out[4257]=",ExpressionUUID->"5d68aafb-a473-4060-818a-a6f6f0904c58"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["RFCtrl", "Subsection",
 CellChangeTimes->{{3.810268980450061*^9, 
  3.8102689844972334`*^9}},ExpressionUUID->"03bd7c63-feac-4fcc-8479-\
77d1ca4c0d9e"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"InitializeRFPar", ",", "rfGUI", ",", "RamanPLLGUI"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitializeRFPar", "[", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumberQ", "@", "k1"}]}], ",", 
       RowBox[{
        RowBox[{"k1", "=", 
         RowBox[{"-", "1.33"}]}], ";", 
        RowBox[{"kdc2", "=", 
         RowBox[{"-", "1.3"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"step1", "=", 
      RowBox[{"stepdc2", "=", 
       RowBox[{"steprf1", "=", 
        RowBox[{"step2", "=", 
         RowBox[{"step3", "=", 
          RowBox[{"step4", "=", 
           RowBox[{"step13", "=", "0.01"}]}]}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumberQ", "@", "k2"}]}], ",", 
       RowBox[{
        RowBox[{"k2", "=", "3.59"}], ";", 
        RowBox[{"krf1", "=", "3"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumberQ", "@", "s1"}]}], ",", 
       RowBox[{"s1", "=", "31.5"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumberQ", "@", "s2"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"-", "2"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"integraterhold", "\[Equal]", "0"}], ",", 
       RowBox[{"color", "=", "Green"}], ",", 
       RowBox[{"color", "=", "Red"}]}], "]"}], ";"}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rfGUI", "[", "]"}], ":=", 
   RowBox[{"Column", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Column", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TextCell", "[", 
             RowBox[{
             "\"\<Center dc 1 (invert)\>\"", ",", "\"\<Subsection\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<reset\>\"", ",", 
              RowBox[{
               RowBox[{"step1", "=", "0.01"}], ";", 
               RowBox[{"k1", "=", 
                RowBox[{"-", "1.335"}]}], ";", 
               RowBox[{"centerdc1", "=", "k1"}], ";", 
               RowBox[{"VoltageWriter", "@", 
                RowBox[{"WriteSingleSample", "[", 
                 RowBox[{"True", ",", "VoltageList"}], "]"}]}]}]}], "]"}], 
            ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"EventHandler", "[", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"k1", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k1", "=", 
                    RowBox[{"k1", "+", "step1"}]}], ";", 
                    RowBox[{"centerdc1", "=", "k1"}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k1", "=", 
                    RowBox[{"k1", "-", "step1"}]}], ";", 
                    RowBox[{"centerdc1", "=", "k1"}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step1", "<", "1"}], ",", 
                    RowBox[{"step1", "=", 
                    RowBox[{"step1", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step1", ">", "0.001"}], ",", 
                    RowBox[{"step1", "=", 
                    RowBox[{"step1", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step1", ",", "4"}], "]"}], "]"}], "<>", 
                   "\"\< V\>\""}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
              "}"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"Spacer", "[", "10", "]"}], ",", 
         RowBox[{"Column", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TextCell", "[", 
             RowBox[{"\"\<Center dc 2\>\"", ",", "\"\<Subsection\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<reset\>\"", ",", 
              RowBox[{
               RowBox[{"stepdc2", "=", "0.01"}], ";", 
               RowBox[{"kdc2", "=", 
                RowBox[{"-", "1.3"}]}], ";", 
               RowBox[{"centerdc2", "=", "kdc2"}], ";", 
               RowBox[{"VoltageWriter", "@", 
                RowBox[{"WriteSingleSample", "[", 
                 RowBox[{"True", ",", "VoltageList"}], "]"}]}]}]}], "]"}], 
            ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"EventHandler", "[", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"kdc2", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"kdc2", "=", 
                    RowBox[{"kdc2", "+", "stepdc2"}]}], ";", 
                    RowBox[{"centerdc2", "=", "kdc2"}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"kdc2", "=", 
                    RowBox[{"kdc2", "-", "stepdc2"}]}], ";", 
                    RowBox[{"centerdc2", "=", "kdc2"}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"stepdc2", "<", "1"}], ",", 
                    RowBox[{"stepdc2", "=", 
                    RowBox[{"stepdc2", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"stepdc2", ">", "0.001"}], ",", 
                    RowBox[{"stepdc2", "=", 
                    RowBox[{"stepdc2", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"stepdc2", ",", "4"}], "]"}], "]"}], "<>", 
                   "\"\< V\>\""}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
              "}"}], "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Column", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TextCell", "[", 
             RowBox[{
             "\"\<RF bias 1 (invert)\>\"", ",", "\"\<Subsection\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<reset\>\"", ",", 
              RowBox[{
               RowBox[{"steprf1", "=", "0.01"}], ";", 
               RowBox[{"krf1", "=", "3"}], ";", 
               RowBox[{"rfbias1", "=", "krf1"}], ";", 
               RowBox[{"VoltageWriter", "@", 
                RowBox[{"WriteSingleSample", "[", 
                 RowBox[{"True", ",", "VoltageList"}], "]"}]}]}]}], "]"}], 
            ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"EventHandler", "[", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"krf1", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"krf1", "=", 
                    RowBox[{"krf1", "+", "steprf1"}]}], ";", 
                    RowBox[{"rfbias1", "=", "krf1"}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"krf1", "=", 
                    RowBox[{"krf1", "-", "steprf1"}]}], ";", 
                    RowBox[{"rfbias1", "=", "krf1"}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"steprf1", "<", "1"}], ",", 
                    RowBox[{"steprf1", "=", 
                    RowBox[{"steprf1", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"steprf1", ">", "0.001"}], ",", 
                    RowBox[{"steprf1", "=", 
                    RowBox[{"steprf1", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"steprf1", ",", "4"}], "]"}], "]"}], "<>", 
                   "\"\< V\>\""}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
              "}"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"Spacer", "[", "10", "]"}], ",", 
         RowBox[{"Column", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TextCell", "[", 
             RowBox[{"\"\<RF bias 2\>\"", ",", "\"\<Subsection\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<reset\>\"", ",", 
              RowBox[{
               RowBox[{"step2", "=", "0.01"}], ";", 
               RowBox[{"k2", "=", "3.595"}], ";", 
               RowBox[{"rfbias2", "=", "k2"}], ";", 
               RowBox[{"VoltageWriter", "@", 
                RowBox[{"WriteSingleSample", "[", 
                 RowBox[{"True", ",", "VoltageList"}], "]"}]}]}]}], "]"}], 
            ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"EventHandler", "[", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"k2", ",", "4"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k2", "=", 
                    RowBox[{"k2", "+", "step2"}]}], ";", 
                    RowBox[{"rfbias2", "=", "k2"}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k2", "=", 
                    RowBox[{"k2", "-", "step2"}]}], ";", 
                    RowBox[{"rfbias2", "=", "k2"}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step2", "<", "1"}], ",", 
                    RowBox[{"step2", "=", 
                    RowBox[{"step2", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step2", ">", "0.001"}], ",", 
                    RowBox[{"step2", "=", 
                    RowBox[{"step2", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step2", ",", "4"}], "]"}], "]"}], "<>", 
                   "\"\< V\>\""}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
              "}"}], "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"TextCell", "[", 
            RowBox[{"\"\<RF control\>\"", ",", "\"\<Subsection\>\"", ",", 
             RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Button", "[", 
             RowBox[{"\"\<Connect\>\"", ",", 
              RowBox[{"RSsigForTrap", "=", 
               RowBox[{"RFOpen", "[", "\"\<192.168.32.9\>\"", "]"}]}]}], 
             "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Button", "[", 
                RowBox[{"\"\<RFOn\>\"", ",", 
                 RowBox[{"RSsigForTrap", "@", 
                  RowBox[{"Write", "[", "\"\<OUTP ON\\n\>\"", "]"}]}]}], 
                "]"}], ",", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<RFOff\>\"", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"ChoiceDialog", "[", 
                    RowBox[{"\"\<Click OK to continue\>\"", ",", 
                    RowBox[{"WindowMargins", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "200"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "200"}], "}"}]}], "}"}]}]}], 
                    "]"}], ",", 
                   RowBox[{"RSsigForTrap", "@", 
                    RowBox[{"Write", "[", "\"\<OUTP OFF\\n\>\"", "]"}]}]}], 
                  "]"}], ",", 
                 RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], 
              "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Column", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Panel", "[", 
                 RowBox[{
                  RowBox[{"EventHandler", "[", 
                   RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s1", ",", "5"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"55", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s1", "=", 
                    RowBox[{"s1", "+", "step3"}]}], ";", 
                    RowBox[{"RFFrequency", "[", 
                    RowBox[{"RSsigForTrap", ",", "s1"}], "]"}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s1", "=", 
                    RowBox[{"s1", "-", "step3"}]}], ";", 
                    RowBox[{"RFFrequency", "[", 
                    RowBox[{"RSsigForTrap", ",", "s1"}], "]"}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step3", "<", "0.001"}], ",", 
                    RowBox[{"step3", "=", 
                    RowBox[{"step3", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step3", ">", "0.0001"}], ",", 
                    RowBox[{"step3", "=", 
                    RowBox[{"step3", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Button", "[", 
                    RowBox[{"\"\<reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"s1", "=", 
                    RowBox[{"RFFrequency", "[", 
                    RowBox[{"RSsigForTrap", ",", "0"}], "]"}]}], ";", 
                    RowBox[{"step3", "=", "0.001"}]}]}], "]"}], ",", 
                   RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{
                    RowBox[{"step3", "*", 
                    RowBox[{"10", "^", "3"}]}], ",", "2"}], "]"}], "]"}], 
                    "<>", "\"\< kHz\>\""}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                  "}"}], "]"}]}], "}"}], ",", "Center"}], "]"}], ",", 
            RowBox[{"Column", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Panel", "[", 
                 RowBox[{
                  RowBox[{"EventHandler", "[", 
                   RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s2", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"45", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s2", "=", 
                    RowBox[{"s2", "+", "step4"}]}], ";", 
                    RowBox[{"RFAmplitude", "[", 
                    RowBox[{"RSsigForTrap", ",", "s2"}], "]"}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s2", "=", 
                    RowBox[{"s2", "-", "step4"}]}], ";", 
                    RowBox[{"RFAmplitude", "[", 
                    RowBox[{"RSsigForTrap", ",", "s2"}], "]"}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step4", "<", "0.1"}], ",", 
                    RowBox[{"step4", "=", 
                    RowBox[{"step4", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step4", ">", "0.01"}], ",", 
                    RowBox[{"step4", "=", 
                    RowBox[{"step4", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Button", "[", 
                    RowBox[{"\"\<reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"s2", "=", 
                    RowBox[{"RFAmplitude", "[", 
                    RowBox[{"RSsigForTrap", ",", "\"\<?\>\""}], "]"}]}], ";", 
                    RowBox[{"step4", "=", "0.01"}]}]}], "]"}], ",", 
                   RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step4", ",", "3"}], "]"}], "]"}], "<>", 
                    "\"\< dBm\>\""}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                  "}"}], "]"}]}], "}"}], ",", "Center"}], "]"}], ",", 
            RowBox[{"Column", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"TextCell", "[", 
                    RowBox[{"\"\<Amp:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                   RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"switch", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"switch", "=", 
                    RowBox[{"switch", "+", "step13"}]}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"switch", "=", 
                    RowBox[{"switch", "-", "step13"}]}], ";", 
                    RowBox[{"VoltageWriter", "@", 
                    RowBox[{"WriteSingleSample", "[", 
                    RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step13", "<", "1"}], ",", 
                    RowBox[{"step13", "=", 
                    RowBox[{"step13", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step13", ">", "0.01"}], ",", 
                    RowBox[{"step13", "=", 
                    RowBox[{"step13", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
                  "}"}], "]"}], ",", 
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Button", "[", 
                    RowBox[{"\"\<reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"switch", "=", ".88"}], ";", 
                    RowBox[{"step13", "=", "0.01"}], ";"}]}], "]"}], ",", 
                   RowBox[{"Panel", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step13", ",", "3"}], "]"}], "]"}], "<>", 
                    "\"\< V\>\""}], ",", 
                    RowBox[{"Initialization", "\[RuleDelayed]", 
                    RowBox[{"InitializeRFPar", "[", "]"}]}]}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                  "}"}], "]"}]}], "}"}], ",", "Center"}], "]"}]}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TextCell", "[", 
             RowBox[{"\"\<Power Switch\>\"", ",", "\"\<Subsection\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", ",", 
            RowBox[{"TextCell", "[", 
             RowBox[{"\"\<Integrator TTL\>\"", ",", "\"\<Subsection\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], ",", 
            RowBox[{"Dynamic", "@", 
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"color", ",", 
                 RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "10"}], "}"}]}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Button", "[", 
             RowBox[{"\"\<HighRF\>\"", ",", 
              RowBox[{
               RowBox[{"color", "=", "Green"}], ";", "\[IndentingNewLine]", 
               RowBox[{"integraterhold", "=", "0"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"rfamplitudectrl", "=", "3.3"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"VoltageWriter", "@", 
                RowBox[{"WriteSingleSample", "[", 
                 RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ",", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}], 
                "}"}]}]}], "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<LowRF\>\"", ",", 
              RowBox[{
               RowBox[{"color", "=", "Red"}], ";", 
               RowBox[{"integraterhold", "=", "3.3"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"rfamplitudectrl", "=", "0"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"VoltageWriter", "@", 
                RowBox[{"WriteSingleSample", "[", 
                 RowBox[{"True", ",", "VoltageList"}], "]"}]}]}], ",", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}], 
                "}"}]}]}], "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<Hold\>\"", ",", 
              RowBox[{
               RowBox[{"integraterhold", "=", "3.3"}], ";", 
               RowBox[{"VoltageWriter", "@", 
                RowBox[{"WriteSingleSample", "[", 
                 RowBox[{"True", ",", "VoltageList"}], "]"}]}], ";", 
               RowBox[{"color", "=", "Red"}]}], ",", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}], 
                "}"}]}]}], "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<Unhold\>\"", ",", 
              RowBox[{
               RowBox[{"integraterhold", "=", "0"}], ";", 
               RowBox[{"VoltageWriter", "@", 
                RowBox[{"WriteSingleSample", "[", 
                 RowBox[{"True", ",", "VoltageList"}], "]"}]}], ";", 
               RowBox[{"color", "=", "Green"}]}], ",", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}], 
                "}"}]}]}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RamanPLLGUI", "[", "]"}], ":=", 
  RowBox[{"Column", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"TextCell", "[", 
      RowBox[{"\"\<Raman PLL RF control\>\"", ",", "\"\<Subsection\>\""}], 
      "]"}], ",", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Connect\>\"", ",", 
             RowBox[{"RSsigForPLL", "=", 
              RowBox[{"RFOpen", "[", "\"\<192.168.32.14\>\"", "]"}]}]}], 
            "]"}], ",", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{"\"\<RFOn\>\"", ",", 
                RowBox[{"RSsigForPLL", "@", 
                 RowBox[{"Write", "[", "\"\<OUTP ON\\n\>\"", "]"}]}]}], "]"}],
               ",", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<RFOff\>\"", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"ChoiceDialog", "[", 
                   RowBox[{"\"\<Click OK to continue\>\"", ",", 
                    RowBox[{"WindowMargins", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "200"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "200"}], "}"}]}], "}"}]}]}], 
                   "]"}], ",", 
                  RowBox[{"RSsigForPLL", "@", 
                   RowBox[{"Write", "[", "\"\<OUTP OFF\\n\>\"", "]"}]}]}], 
                 "]"}], ",", 
                RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], 
             "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Column", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"EventHandler", "[", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s10", ",", "5"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s10", "=", 
                    RowBox[{"s10", "+", "step12"}]}], ";", 
                    RowBox[{"RFFrequency", "[", 
                    RowBox[{"RSsigForPLL", ",", "s10"}], "]"}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s10", "=", 
                    RowBox[{"s10", "-", "step12"}]}], ";", 
                    RowBox[{"RFFrequency", "[", 
                    RowBox[{"RSsigForPLL", ",", "s10"}], "]"}]}], ")"}]}], 
                    ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step12", "<", "0.01"}], ",", 
                    RowBox[{"step12", "=", 
                    RowBox[{"step12", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step12", ">", "0.0001"}], ",", 
                    RowBox[{"step12", "=", 
                    RowBox[{"step12", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Button", "[", 
                   RowBox[{"\"\<reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"s10", "=", 
                    RowBox[{"RFFrequency", "[", 
                    RowBox[{"RSsigForPLL", ",", "0"}], "]"}]}], ";", 
                    RowBox[{"step12", "=", "0.001"}]}]}], "]"}], ",", 
                  RowBox[{"Panel", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{
                    RowBox[{"step12", "*", 
                    RowBox[{"10", "^", "3"}]}], ",", "2"}], "]"}], "]"}], 
                    "<>", "\"\< kHz\>\""}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                 "}"}], "]"}]}], "}"}], ",", "Center"}], "]"}], ",", 
           RowBox[{"Column", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Panel", "[", 
                RowBox[{
                 RowBox[{"EventHandler", "[", 
                  RowBox[{
                   RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"s9", ",", "3"}], "]"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"55", ",", "20"}], "}"}]}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s9", "<", "11"}], ",", 
                    RowBox[{"s9", "=", 
                    RowBox[{"s9", "+", "step11"}]}], ",", "11"}], "]"}], ";", 
                    RowBox[{"RFAmplitude", "[", 
                    RowBox[{"RSsigForPLL", ",", "s9"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"s9", "=", 
                    RowBox[{"s9", "-", "step11"}]}], ";", 
                    RowBox[{"RFAmplitude", "[", 
                    RowBox[{"RSsigForPLL", ",", "s9"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step11", "<", "0.1"}], ",", 
                    RowBox[{"step11", "=", 
                    RowBox[{"step11", "*", "10"}]}]}], "]"}], ")"}]}], ",", 
                    RowBox[{"\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step11", ">", "0.01"}], ",", 
                    RowBox[{"step11", "=", 
                    RowBox[{"step11", "*", "0.1"}]}]}], "]"}], ")"}]}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Button", "[", 
                   RowBox[{"\"\<reset\>\"", ",", 
                    RowBox[{
                    RowBox[{"s9", "=", 
                    RowBox[{"RFAmplitude", "[", 
                    RowBox[{"RSsigForPLL", ",", "\"\<?\>\""}], "]"}]}], ";", 
                    RowBox[{"step11", "=", "0.01"}]}]}], "]"}], ",", 
                  RowBox[{"Panel", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetAccuracy", "[", 
                    RowBox[{"step11", ",", "3"}], "]"}], "]"}], "<>", 
                    "\"\< dBm\>\""}], "]"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Medium"}]}], "]"}]}], 
                 "}"}], "]"}]}], "}"}], ",", "Center"}], "]"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], "}"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8124217631708064`*^9, 3.812421777098548*^9}, 
   3.812423627361126*^9, {3.8124237398870997`*^9, 3.812423774976231*^9}, {
   3.8124238955655375`*^9, 3.812424007530853*^9}, {3.812424046264234*^9, 
   3.812424122208071*^9}, {3.812424310309869*^9, 3.8124243723369365`*^9}, {
   3.8124244884363513`*^9, 3.812424524564701*^9}, {3.8124245989167976`*^9, 
   3.8124246287609606`*^9}, {3.8124247293917565`*^9, 3.812424743432195*^9}, {
   3.8124247865458593`*^9, 3.8124247878453827`*^9}, {3.8131002215762763`*^9, 
   3.813100226028367*^9}, {3.8131021369323854`*^9, 3.8131021371418247`*^9}, {
   3.8131021697097015`*^9, 3.8131021699849644`*^9}, {3.8131024300193295`*^9, 
   3.8131024477848043`*^9}, {3.813102505377733*^9, 3.81310251162901*^9}, {
   3.81310353913626*^9, 3.8131035437170057`*^9}, {3.819594355915383*^9, 
   3.8195945325360856`*^9}, {3.819594672847042*^9, 3.8195946956201653`*^9}, {
   3.8195947414675484`*^9, 3.8195947422444715`*^9}, {3.8195963474684224`*^9, 
   3.8195964894410458`*^9}, {3.819596523437168*^9, 3.8195965663255196`*^9}, {
   3.8195966319171853`*^9, 3.819596647840619*^9}, {3.819596683526225*^9, 
   3.819596783460084*^9}, 3.8197548951169705`*^9, {3.8197549588775277`*^9, 
   3.819754961109561*^9}, {3.819755016907403*^9, 3.8197550224256516`*^9}, {
   3.8201337658813057`*^9, 3.820133784646144*^9}, {3.8201339957408495`*^9, 
   3.8201340021317654`*^9}, {3.8201342395461135`*^9, 3.8201342661689463`*^9}},
 CellLabel->
  "In[372]:=",ExpressionUUID->"beb57f7a-0215-4922-91ab-93d7a8b715b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sequencer", "Subsection",
 CellChangeTimes->{{3.810284319028922*^9, 
  3.810284322300171*^9}},ExpressionUUID->"dd6ace7e-5ed9-4525-80a5-\
3b08a2d018ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"SequenceValue", ",", "SequenceParameterList"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SequenceValue", "[", 
    RowBox[{"item_", ",", "par_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"item", "\[Equal]", "\"\<Time\>\""}], ",", 
     RowBox[{"Which", "@@", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"par", "==", 
          RowBox[{"ImportSequenceBodyHead", "@", "$SequenceBody"}]}], "]"}], 
        ",", 
        RowBox[{"ImportSequenceBodyTime", "@", "$SequenceBody"}]}], "]"}]}], 
     ",", 
     RowBox[{"item", "\[Equal]", "\"\<WLM\>\""}], ",", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"par", "==", "\"\<369.52\>\""}], ",", 
       RowBox[{"GetWavelengthNum", "[", "2", "]"}], ",", 
       RowBox[{"par", "==", "\"\<935.18\>\""}], ",", 
       RowBox[{"GetWavelengthNum", "[", "3", "]"}]}], "]"}], ",", 
     RowBox[{"item", "\[Equal]", "\"\<AOM\>\""}], ",", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"par", "==", "\"\<Frequency\>\""}], ",", ",", 
       RowBox[{"par", "==", "\"\<Amplitude\>\""}], ",", ",", 
       RowBox[{"par", "\[Equal]", "\"\<Phase\>\""}], ","}], "]"}], ",", 
     RowBox[{"item", "\[Equal]", "\"\<AWG\>\""}], ",", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"par", "==", "\"\<Frequency\>\""}], ",", ",", 
       RowBox[{"par", "\[Equal]", "\"\<Duration\>\""}], ",", ",", 
       RowBox[{"par", "==", "\"\<Amplitude\>\""}], ",", ",", 
       RowBox[{"par", "\[Equal]", "\"\<Phase\>\""}], ",", ",", 
       RowBox[{"par", "\[Equal]", "\"\<Gap\>\""}], ","}], "]"}], ",", 
     RowBox[{"item", "\[Equal]", "\"\<mcdds\>\""}], ",", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"par", "==", "\"\<Frequency\>\""}], ",", ",", 
       RowBox[{"par", "==", "\"\<Amplitude\>\""}], ",", ",", 
       RowBox[{"par", "\[Equal]", "\"\<Phase\>\""}], ","}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SequenceParameterList", "[", "par_", "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"par", "\[Equal]", "\"\<Time\>\""}], ",", 
     RowBox[{"ImportSequenceBodyHead", "@", "$SequenceBody"}], ",", 
     RowBox[{"par", "\[Equal]", "\"\<WLM\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<369.52\>\"", ",", "\"\<935.18\>\""}], "}"}], ",", 
     RowBox[{"par", "\[Equal]", "\"\<AOM\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Frequency\>\"", ",", "\"\<Amplitude\>\"", ",", "\"\<Phase\>\""}], 
      "}"}], ",", 
     RowBox[{"par", "\[Equal]", "\"\<AWG\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Frequency\>\"", ",", "\"\<Duration\>\"", ",", "\"\<Amplitude\>\"", 
       ",", "\"\<Phase\>\"", ",", "\"\<Gap\>\""}], "}"}], ",", 
     RowBox[{"par", "\[Equal]", "\"\<mcdds\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Frequency\>\"", ",", "\"\<Amplitude\>\"", ",", "\"\<Phase\>\""}], 
      "}"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"SequencerSweepPlot", ",", "SequencerScanPlot"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SequencerSweepPlot", "[", "]"}], ":=", 
   RowBox[{"DataPlot", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"$CountOrState", "\[Equal]", "\"\<State\>\""}], ",", 
       RowBox[{"100", 
        RowBox[{"Mean", "/@", 
         RowBox[{"ToState", "/@", "$SequencerPlot"}]}]}], ",", 
       RowBox[{"1.", 
        RowBox[{"Mean", "/@", "$SequencerPlot"}]}]}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SequencerScanPlot", "[", "]"}], ":=", 
    RowBox[{"DataPlot", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"$CountOrState", "\[Equal]", "\"\<State\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"100", 
             RowBox[{"Mean", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"Apply", "[", 
          RowBox[{"ToState", ",", "$SequencerPlot", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"1.", "*", 
             RowBox[{"Mean", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}], "&"}], "/@", 
         "$SequencerPlot"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "InitializeSequencerPar", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitializeSequencerPar", "[", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"StringQ", "[", "$SequenceFile", "]"}]}], ",", 
    RowBox[{
     RowBox[{"$SequenceFile", "=", "\"\<Sequence/Cooling.seq\>\""}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"$SequenceHead", ",", "$SequenceBody"}], "}"}], "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"DataPath", "[", "$SequenceFile", "]"}], ",", 
          "\"\<TEXT\>\""}], "]"}], ",", "$SequenceSeparator"}], "]"}]}], ";", 
     RowBox[{"$SequenceRepeats", "=", "200"}], ";"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8104595939083233`*^9, 3.810459629127445*^9}, 
   3.8104597306095037`*^9, 3.810548260017516*^9, {3.810956400610794*^9, 
   3.8109564479940367`*^9}, {3.81726280085303*^9, 3.8172628071791124`*^9}, {
   3.8175193843110557`*^9, 3.8175193997776933`*^9}, {3.817520805896338*^9, 
   3.8175208091197176`*^9}, 3.817521033649263*^9, {3.8175242877331543`*^9, 
   3.8175242893179154`*^9}, {3.817524322517132*^9, 3.8175243226707215`*^9}, 
   3.8175247384867125`*^9, {3.817593823717884*^9, 3.8175939159502287`*^9}, {
   3.817593973987023*^9, 3.817594029628222*^9}, 3.8175942464528217`*^9, 
   3.8175948343157115`*^9},
 CellLabel->
  "In[364]:=",ExpressionUUID->"142d97ed-88a9-47d5-ae12-4c2d7ccb383c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "SequencerGUI", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SequencerGUI", "[", "]"}], ":=", 
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "$SequenceFile", "]"}], ",", "String", 
              ",", 
              RowBox[{"FieldSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"25", ",", "1"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"FileNameSetter", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "$SequenceFile", "]"}], ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Browse\>\""}]}], "]"}], 
            ",", 
            RowBox[{"Spacer", "[", "5", "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<Load\>\"", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"$SequenceHead", ",", "$SequenceBody"}], "}"}], "=", 
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"Import", "[", 
                  RowBox[{
                   RowBox[{"DataPath", "[", "$SequenceFile", "]"}], ",", 
                   "\"\<TEXT\>\""}], "]"}], ",", "$SequenceSeparator"}], 
                "]"}]}]}], 
             RowBox[{"(*", 
              RowBox[{"SequenceLoad", "[", "$SequenceFile", "]"}], "*)"}], 
             "]"}], ",", 
            RowBox[{"Spacer", "[", "5", "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<Save\>\"", ",", 
              RowBox[{"ExportSequenceFile", "[", 
               RowBox[{
               "$SequenceFile", ",", "$SequenceBody", ",", "$SequenceHead"}], 
               "]"}]}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Pane", "[", 
             RowBox[{
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "$SequenceHead"}], ",", "String", ",", 
                RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                RowBox[{"FieldSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "Infinity"}], "}"}]}], "}"}]}]}], "]"}],
               ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"250", ",", "300"}], "}"}]}], ",", 
              RowBox[{"FrameMargins", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"5", ",", "5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"Scrollbars", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Pane", "[", 
             RowBox[{
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "$SequenceBody"}], ",", "String", ",", 
                RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                RowBox[{"FieldSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "Infinity"}], "}"}]}], "}"}]}]}], "]"}],
               ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"250", ",", "300"}], "}"}]}], ",", 
              RowBox[{"FrameMargins", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"5", ",", "5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"Scrollbars", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TextCell", "[", 
             RowBox[{"\"\<Repeats:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "@", "$SequenceRepeats"}], ",", 
              RowBox[{"FieldSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Spacer", "[", "10", "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{"Dynamic", "[", 
              RowBox[{
               RowBox[{"SequencerTrigger", "[", "$SequenceTrigger", "]"}], 
               ";", 
               RowBox[{"TextCell", "[", 
                RowBox[{"\"\<Trigger:\>\"", ",", "\"\<Text\>\""}], "]"}]}], 
              "]"}], "*)"}], 
            RowBox[{"TextCell", "[", 
             RowBox[{"\"\<Trigger:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
            RowBox[{"Checkbox", "[", 
             RowBox[{"Dynamic", "[", "$SequenceTrigger", "]"}], "]"}], ",", 
            RowBox[{"Spacer", "[", "10", "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Data\>\"", ",", 
                RowBox[{"SequencerCounts", "[", "]"}]}], "]"}], ",", 
              RowBox[{"Spacer", "[", "10", "]"}], ","}], "*)"}], 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"TextCell", "[", 
                RowBox[{"\"\<Sweep:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<On\>\"", ",", 
                 RowBox[{
                  RowBox[{"$SweepStatus", "=", "True"}], ";", 
                  RowBox[{"SequencerSweep", "[", "]"}]}], ",", 
                 RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], 
               ",", 
               RowBox[{"Spacer", "[", "5", "]"}], ",", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Off\>\"", ",", 
                 RowBox[{"$SweepStatus", "=", "False"}]}], "]"}]}], "}"}], 
             "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"Row", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TextCell", "[", 
                 RowBox[{"\"\<Start:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                RowBox[{"InputField", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "@", "$SequenceStart"}], ",", "Number", 
                  ",", 
                  RowBox[{"FieldSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}]}], "]"}]}], "}"}], "]"}],
              ",", 
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TextCell", "[", 
                 RowBox[{"\"\<End:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                RowBox[{"InputField", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "@", "$SequenceEnd"}], ",", "Number", 
                  ",", 
                  RowBox[{"FieldSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}]}], "]"}]}], "}"}], "]"}],
              ",", 
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TextCell", "[", 
                 RowBox[{"\"\<Step:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                RowBox[{"InputField", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "@", "$SequenceStep"}], ",", "Number", 
                  ",", 
                  RowBox[{"FieldSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}]}], "]"}]}], "}"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"Spacer", "[", "10", "]"}]}], "]"}], ",", 
         RowBox[{"Row", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Column", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"TextCell", "[", 
                  RowBox[{"\"\<Value:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", 
                    RowBox[{"SequenceValue", "[", 
                    RowBox[{"$SequenceItem", ",", "$SequenceParameter"}], 
                    "]"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "25"}], "}"}]}], ",", 
                   RowBox[{"Enabled", "\[Rule]", "False"}]}], "]"}]}], "}"}], 
               "]"}], ","}], "*)"}], 
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TextCell", "[", 
                 RowBox[{"\"\<Item:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                RowBox[{"PopupMenu", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", "$SequenceItem", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Time\>\"", ",", "\"\<WLM\>\"", ",", "\"\<AOM\>\"", 
                    ",", "\"\<AWG\>\"", ",", "\"\<mcdds\>\""}], "}"}]}], 
                 "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TextCell", "[", 
                 RowBox[{"\"\<Parameter:\>\"", ",", "\"\<Text\>\""}], "]"}], 
                ",", 
                RowBox[{"Dynamic", "@", 
                 RowBox[{"PopupMenu", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", "$SequenceParameter", "]"}], ",", 
                   RowBox[{
                   "SequenceParameterList", "[", "$SequenceItem", "]"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}]}]}], 
               "}"}], "]"}], ",", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"TextCell", "[", 
                 RowBox[{"\"\<Scan:\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<On\>\"", ",", 
                  RowBox[{
                   RowBox[{"$ScanStatus", "=", "True"}], ";", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"$SequenceItem", "\[Equal]", "\"\<Time\>\""}], 
                    ",", 
                    RowBox[{"SequencerScanTime", "[", "]"}], ",", 
                    RowBox[{"SequencerScan", "[", "]"}]}], "]"}]}], ",", 
                  RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], 
                ",", 
                RowBox[{"Spacer", "[", "5", "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Off\>\"", ",", 
                  RowBox[{"$ScanStatus", "=", "False"}]}], "]"}]}], 
               RowBox[{"(*", 
                RowBox[{"EventHandler", "[", 
                 RowBox[{
                  RowBox[{"Graphics", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"$SequencerScan", ",", 
                    RowBox[{"Initialization", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"$SequencerScan", "=", "Red"}], ")"}]}]}], "]"}], 
                    ",", 
                    RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"15", ",", "15"}], "}"}]}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"$SequencerScan", "=", 
                    RowBox[{"$SequencerScan", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Red", "\[Rule]", "Green"}], ",", 
                    RowBox[{"Green", "\[Rule]", "Red"}]}], "}"}]}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"$SequencerScan", "===", "Green"}], ",", 
                    RowBox[{"SequencerScan", "[", 
                    RowBox[{"$SequenceItem", ",", "$SequenceParameter", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "$SequenceStart", ",", "$SequenceEnd", ",", 
                    "$SequenceStep"}], "}"}]}], "]"}]}], "]"}]}], ")"}]}], 
                   "}"}], ",", 
                  RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], 
                "*)"}], "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"Spacer", "[", "10", "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ",", 
     RowBox[{"Spacer", "[", "10", "]"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Panel", "[", 
         RowBox[{
          RowBox[{"Dynamic", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Depth", "@", "$SequencerPlot"}], "\[Equal]", "3"}], 
             ",", 
             RowBox[{"SequencerSweepPlot", "[", "]"}], ",", 
             RowBox[{"SequencerScanPlot", "[", "]"}]}], "]"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"400", ",", "250"}], "}"}]}], ",", 
          RowBox[{"FrameMargins", "\[Rule]", "None"}], ",", 
          RowBox[{"Background", "\[Rule]", "White"}], ",", 
          RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "$SequenceDataFile"}], ",", "String", 
                ",", 
                RowBox[{"FieldSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"18", ",", "1"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PopupMenu", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", "$CountOrState", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Count\>\"", ",", "\"\<State\>\""}], "}"}], 
                   ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 RowBox[{"TextCell", "[", 
                  RowBox[{"\"\<>\>\"", ",", "\"\<Text\>\""}], "]"}], ",", 
                 RowBox[{"InputField", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", "DarkThreshold"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"25", ",", "20"}], "}"}]}]}], "]"}], ",", 
                 RowBox[{"Spacer", "[", "5", "]"}], ",", 
                 RowBox[{"Panel", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"$CountOrState", "===", "\"\<Count\>\""}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"Mean", "@", "$SequencerCounts"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"100", 
                    RowBox[{"Mean", "@", 
                    RowBox[{"ToState", "@", 
                    RowBox[{"N", "@", "$SequencerCounts"}]}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"55", ",", "40"}], "}"}]}]}], "]"}]}], "}"}], 
               "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Panel", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{
               RowBox[{"Histogram", "[", 
                RowBox[{"$SequencerCounts", ",", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "30"}], "}"}], ",", "All"}], "}"}]}], 
                 ",", 
                 RowBox[{"AspectRatio", "\[Rule]", 
                  RowBox[{"1", "/", "2"}]}], ",", 
                 RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
               RowBox[{"Initialization", "\[RuleDelayed]", 
                RowBox[{"InitializeSequencerPar", "[", "]"}]}]}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"190", ",", "100"}], "}"}]}], ",", 
             RowBox[{"Background", "\[Rule]", "White"}], ",", 
             RowBox[{"FrameMargins", "\[Rule]", "None"}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], "}"}], 
         "]"}]}], "}"}], "]"}]}], "}"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8102843263184223`*^9, 3.810284335837955*^9}, {
   3.8102843799319954`*^9, 3.8102844228312335`*^9}, {3.810284701848816*^9, 
   3.8102847325506835`*^9}, {3.8102850789270706`*^9, 3.810285088678982*^9}, {
   3.8102852513422265`*^9, 3.810285293468532*^9}, {3.8102853502306843`*^9, 
   3.8102853628778505`*^9}, {3.8102854029748573`*^9, 
   3.8102854542157793`*^9}, {3.8102854895622215`*^9, 3.810285492323834*^9}, {
   3.8102856828551316`*^9, 3.8102856861353564`*^9}, {3.810286290943396*^9, 
   3.8102863169488277`*^9}, {3.8102865622675595`*^9, 
   3.8102865694184294`*^9}, {3.810286652735543*^9, 3.810286681525525*^9}, {
   3.810287103229398*^9, 3.810287163395444*^9}, {3.810287199718274*^9, 
   3.8102872296262655`*^9}, {3.8102872883401957`*^9, 
   3.8102872925499363`*^9}, {3.810287324620142*^9, 3.8102873264103518`*^9}, {
   3.8102873574453287`*^9, 3.8102874709706297`*^9}, {3.810287503620287*^9, 
   3.810287586153497*^9}, {3.810288438418548*^9, 3.8102885214145203`*^9}, {
   3.810288676131627*^9, 3.8102887948570175`*^9}, {3.810288842500563*^9, 
   3.810288959744915*^9}, {3.8102889954374323`*^9, 3.8102890039965353`*^9}, {
   3.8102891032061334`*^9, 3.8102891754508667`*^9}, {3.810289219820171*^9, 
   3.810289310970331*^9}, {3.810289788345273*^9, 3.810289789721592*^9}, 
   3.810289836556301*^9, {3.810289870904414*^9, 3.810289872064311*^9}, {
   3.8102899331548843`*^9, 3.810289942970625*^9}, {3.8102899955210447`*^9, 
   3.810290070153391*^9}, {3.8102901215588727`*^9, 3.810290148680318*^9}, {
   3.8103347053887105`*^9, 3.810334741875104*^9}, {3.8103347962955203`*^9, 
   3.810334843562074*^9}, {3.8103350181151166`*^9, 3.8103350182597294`*^9}, 
   3.810335072008941*^9, {3.81033577046745*^9, 3.810335778547834*^9}, {
   3.810437302074961*^9, 3.810437314597142*^9}, 3.810459526899756*^9, {
   3.810459637687932*^9, 3.810459646945434*^9}, {3.8104598107271338`*^9, 
   3.8104598136171083`*^9}, {3.8104607948073034`*^9, 
   3.8104608066813407`*^9}, {3.810461688978658*^9, 3.810461692739691*^9}, {
   3.8104617381385856`*^9, 3.8104617750646257`*^9}, {3.8104618092170105`*^9, 
   3.8104618840929623`*^9}, {3.8104623240620003`*^9, 
   3.8104623894068336`*^9}, {3.810462701218934*^9, 3.8104627433924103`*^9}, {
   3.8104627776361933`*^9, 3.8104627780267267`*^9}, 3.81046392732506*^9, {
   3.8104639813586345`*^9, 3.810463985107753*^9}, {3.8104641634876657`*^9, 
   3.8104642247701674`*^9}, {3.810509289113803*^9, 3.810509321059884*^9}, {
   3.810509544930189*^9, 3.810509559573374*^9}, {3.810548098976431*^9, 
   3.810548123425915*^9}, {3.810548178994747*^9, 3.810548194009451*^9}, {
   3.810548365102025*^9, 3.810548422814257*^9}, {3.810548509906327*^9, 
   3.8105486127543616`*^9}, {3.810548682008421*^9, 3.810548689825512*^9}, 
   3.8105487634384537`*^9, {3.8105488026465316`*^9, 3.8105488243092175`*^9}, {
   3.8105488737194233`*^9, 3.8105488748354235`*^9}, 3.810548908220402*^9, {
   3.8105489653382735`*^9, 3.8105489782764244`*^9}, {3.8105493843332424`*^9, 
   3.810549445321132*^9}, 3.810549565292864*^9, {3.810549640190758*^9, 
   3.8105496915195713`*^9}, {3.8109565555882044`*^9, 3.810956586766796*^9}, {
   3.8109566214978848`*^9, 3.810956661561708*^9}, {3.810956730634926*^9, 
   3.810956735380231*^9}, {3.810956875349789*^9, 3.810956926555806*^9}, {
   3.810956962803835*^9, 3.8109570423709803`*^9}, {3.8109571495712023`*^9, 
   3.810957205266209*^9}, {3.810957269485504*^9, 3.8109573000926247`*^9}, {
   3.810957333560094*^9, 3.810957370869286*^9}, {3.8109574290905347`*^9, 
   3.8109574685998406`*^9}, {3.8109577099621572`*^9, 
   3.8109577828930545`*^9}, {3.810957995234008*^9, 3.810957996922491*^9}, {
   3.810958260919256*^9, 3.810958355499239*^9}, {3.8109584840613146`*^9, 
   3.8109585166830463`*^9}, {3.8109586321980247`*^9, 3.810958632442371*^9}, {
   3.8109588399342957`*^9, 3.810958850633673*^9}, 3.810959019706376*^9, {
   3.81095911617032*^9, 3.810959125146308*^9}, {3.813100257036415*^9, 
   3.813100309484108*^9}, {3.817262823583243*^9, 3.8172629105975423`*^9}, {
   3.817263106182592*^9, 3.8172632556618423`*^9}, 3.817263751661319*^9, {
   3.817265344804808*^9, 3.8172654087617683`*^9}, {3.817265621321325*^9, 
   3.8172656428268127`*^9}, {3.817265788636876*^9, 3.8172657888772335`*^9}, {
   3.817265828518222*^9, 3.8172658286528625`*^9}, 3.817267193953665*^9, 
   3.8172676332548513`*^9, {3.817267740262683*^9, 3.8172678002103653`*^9}, 
   3.8174217832008*^9, {3.8174242102421637`*^9, 3.8174242764102125`*^9}, 
   3.8174243376554255`*^9, {3.817424413722002*^9, 3.817424417580683*^9}, 
   3.8174245257873087`*^9, 3.817424621730729*^9, {3.81742526204834*^9, 
   3.817425318310878*^9}, {3.817425374064777*^9, 3.8174254643752613`*^9}, {
   3.817425607143459*^9, 3.8174256102730894`*^9}, {3.8174256516135335`*^9, 
   3.817425652648765*^9}, 3.817425791414666*^9, {3.8174258492849045`*^9, 
   3.817425876527052*^9}, {3.8174259543599052`*^9, 3.817425962511106*^9}, 
   3.817425993656814*^9, {3.817426057856127*^9, 3.8174260692237267`*^9}, {
   3.8174261181598577`*^9, 3.817426122255904*^9}, {3.8174261805280676`*^9, 
   3.817426212895508*^9}, 3.81743191599582*^9, {3.817431954815007*^9, 
   3.817431958584925*^9}, {3.8174319962252655`*^9, 3.817432008296982*^9}, {
   3.817432397565341*^9, 3.8174324149159403`*^9}, 3.8174325947410374`*^9, 
   3.8174331442226562`*^9, {3.81743426240664*^9, 3.817434262605109*^9}, {
   3.817434298949913*^9, 3.8174342991882763`*^9}, {3.8174373287394085`*^9, 
   3.817437376466771*^9}, {3.8175167331718297`*^9, 3.8175167546144867`*^9}, {
   3.8175168100711803`*^9, 3.8175168137722816`*^9}, {3.81751689838301*^9, 
   3.8175169384628253`*^9}, {3.8175169977971478`*^9, 
   3.8175170012529063`*^9}, {3.8175170411911*^9, 3.817517066924282*^9}, {
   3.8175171195256124`*^9, 3.817517141540738*^9}, {3.817517522181796*^9, 
   3.817517575035451*^9}, {3.8175177044684258`*^9, 3.817517724853909*^9}, {
   3.817517838190815*^9, 3.8175178398763065`*^9}, {3.8175178848809514`*^9, 
   3.8175178863181086`*^9}, {3.8175179543980427`*^9, 3.817517956296966*^9}, {
   3.8175180474681473`*^9, 3.817518053636651*^9}, {3.817518091724793*^9, 
   3.817518093979763*^9}, {3.8175194137892227`*^9, 3.817519455257325*^9}, {
   3.81751954793847*^9, 3.817519550483663*^9}, {3.817519656323618*^9, 
   3.8175197274025335`*^9}, 3.8175198416749353`*^9, {3.817521057556329*^9, 
   3.8175210862436113`*^9}, {3.8175213896272783`*^9, 3.8175213905378428`*^9}, 
   3.8175214549455986`*^9, {3.8175239723146706`*^9, 3.817523987011368*^9}, {
   3.8175414317318845`*^9, 3.8175414571628747`*^9}, {3.817541550843348*^9, 
   3.8175415722620673`*^9}, 3.817541663420097*^9, {3.817541750112257*^9, 
   3.8175417862206936`*^9}, {3.8175425096031666`*^9, 
   3.8175425248753242`*^9}, {3.8175940672805305`*^9, 
   3.8175940789164124`*^9}, {3.817594142444522*^9, 3.8175941434169197`*^9}, {
   3.817594330734429*^9, 3.817594334211131*^9}, {3.81759450823275*^9, 
   3.8175945092380605`*^9}, {3.817594555151275*^9, 3.817594568478635*^9}, {
   3.8175946161740837`*^9, 3.817594627611497*^9}, {3.8202980675208263`*^9, 
   3.8202980746647196`*^9}},ExpressionUUID->"1b5f48db-044b-43dc-8b45-\
46c3516eda05"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.820298155669055*^9, 
  3.8202981569955063`*^9}},ExpressionUUID->"b5149b47-c27c-45e6-97f6-\
72173c6c1ee8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CreateDialog", "[", 
  RowBox[{
   RowBox[{"SequencerGUI", "[", "]"}], ",", 
   RowBox[{"WindowTitle", "\[Rule]", "\"\<Sequencer\>\""}], ",", 
   RowBox[{"WindowFrameElements", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<CloseBox\>\"", ",", "\"\<ZoomBox\>\"", ",", "\"\<MinimizeBox\>\""}],
      "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.817423708013265*^9, 3.8174237176465034`*^9}, {
  3.817424053789562*^9, 3.817424058620643*^9}, {3.8175937131824865`*^9, 
  3.8175937146794834`*^9}, {3.8177202251692886`*^9, 3.8177202261795864`*^9}, {
  3.820298076097887*^9, 
  3.820298080065274*^9}},ExpressionUUID->"c46086e3-08a7-440c-aaae-\
18676b84f975"],

Cell[BoxData[
 TemplateBox[{
   FrontEndObject[
    LinkObject["wbtpc_shm", 3, 1]], 57, 
   "FrontEndObject[LinkObject[\"wbtpc_shm\", 3, 1]]", "57", "\"Sequencer\""},
  "NotebookObjectUnsaved"]], "Output",
 CellChangeTimes->{
  3.817424059688786*^9, 3.817424283555107*^9, 3.8174243429532576`*^9, 
   3.8174245710771904`*^9, 3.817425336446379*^9, {3.817425526980837*^9, 
   3.8174255485242233`*^9}, 3.817425658892069*^9, 3.817425757934202*^9, {
   3.817426081142852*^9, 3.8174261265384517`*^9}, {3.8174261897105117`*^9, 
   3.817426218343938*^9}, 3.8174318954338093`*^9, 3.8174319638219204`*^9, 
   3.8174320692729144`*^9, 3.8174322415864725`*^9, 3.8174331668900375`*^9, 
   3.817434158268136*^9, 3.8174342667959023`*^9, 3.81743559240585*^9, 
   3.817435756494032*^9, 3.817435997044732*^9, 3.8174360814230804`*^9, 
   3.817437424111356*^9, 3.8174374586978626`*^9, 3.8174387170297303`*^9, 
   3.8174387488137302`*^9, 3.8174389816081734`*^9, 3.8174390766559887`*^9, 
   3.817439403677442*^9, 3.8174403321673613`*^9, 3.8175167191642904`*^9, 
   3.8175167593528147`*^9, 3.817516912115286*^9, {3.817516943135329*^9, 
   3.8175169677594776`*^9}, {3.8175170486132517`*^9, 
   3.8175170744132557`*^9}, {3.817517123602709*^9, 3.8175171454073973`*^9}, 
   3.8175177445203156`*^9, 3.8175178441987476`*^9, 3.817517967003333*^9, 
   3.8175181002230663`*^9, 3.817518146520255*^9, 3.8175211274304667`*^9, {
   3.817521262151185*^9, 3.81752126998324*^9}, 3.8175215413595037`*^9, 
   3.817522219074105*^9, 3.817522412894887*^9, 3.8175237982112722`*^9, {
   3.817523991458475*^9, 3.817524007648179*^9}, 3.817524758583967*^9, 
   3.8175248597913103`*^9, 3.817539448529937*^9, 3.817539785423574*^9, 
   3.8175399053857613`*^9, 3.8175403989109364`*^9, 3.817540499800131*^9, 
   3.8175406895377197`*^9, 3.817541464585026*^9, 3.8175416721447644`*^9, 
   3.8175417943569345`*^9, 3.817542534220333*^9, 3.81754259126478*^9, 
   3.8175453873652244`*^9, 3.817545436124829*^9, 3.817593351111184*^9, 
   3.8175937171897707`*^9, 3.8175937649500456`*^9, 3.8175940844555984`*^9, 
   3.8175943690200424`*^9, 3.817594407814296*^9, 3.8175945627180405`*^9, 
   3.8175946315838733`*^9, {3.8175947000597515`*^9, 3.8175947120995517`*^9}, 
   3.817594750478915*^9, 3.8177202329933643`*^9, 3.818134894212604*^9, 
   3.8181351531760635`*^9, 3.8181352471706953`*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"7d84671e-107c-4a60-b202-7a3c7b129d49"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Integrated control panel", "Subsection",
 CellChangeTimes->{{3.8201893133077784`*^9, 
  3.820189317443159*^9}},ExpressionUUID->"fb27fed2-aa14-4a63-b32e-\
a24592cf31e5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "LaserCtrl", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LaserCtrl", "[", 
     RowBox[{"laser_", ",", "jsonMessages_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"itemList", "=", 
         RowBox[{"jsonMessages", "//", "Keys"}]}], ",", "pc", ",", "cc"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"pc", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"itemList", ",", "\"\<PC\>\""}], "]"}], ",", 
          RowBox[{"LaserPCSet", "[", 
           RowBox[{"laser", ",", 
            RowBox[{"jsonMessages", "[", "\"\<PC\>\"", "]"}]}], "]"}], ",", 
          "\"\<\>\""}], "]"}]}], ";", 
       RowBox[{"cc", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"itemList", ",", "\"\<CC\>\""}], "]"}], ",", 
          RowBox[{"LaserCCSet", "[", 
           RowBox[{"laser", ",", 
            RowBox[{"jsonMessages", "[", "\"\<CC\>\"", "]"}]}], "]"}], ",", 
          "\"\<\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Association", "@@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<PC\>\"", "->", "pc"}], ",", 
          RowBox[{"\"\<CC\>\"", "->", "cc"}]}], "}"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "ProcessMessages", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessMessages", "[", "messages_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "jsonMessages", ",", "DevicesList", ",", "laser370m", ",", "laser935m",
         ",", "laser399m", ",", "CCDm", ",", "RFm"}], "}"}], ",", 
      RowBox[{
       RowBox[{"jsonMessages", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Check", "[", 
          RowBox[{
           RowBox[{"ImportString", "[", 
            RowBox[{"messages", ",", "\"\<RawJSON\>\""}], "]"}], ",", 
           "\"\<NotValid\>\""}], "]"}]}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"jsonMessages", "=!=", "\"\<NotValid\>\""}], ",", 
         RowBox[{
          RowBox[{"DevicesList", "=", 
           RowBox[{"jsonMessages", "//", "Keys"}]}], ";", 
          RowBox[{"laser370m", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"DevicesList", ",", "\"\<Laser370\>\""}], "]"}], ",", 
             RowBox[{"LaserCtrl", "[", 
              RowBox[{"laser370", ",", 
               RowBox[{"jsonMessages", "[", "\"\<Laser370\>\"", "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"laser935m", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"DevicesList", ",", "\"\<Laser935\>\""}], "]"}], ",", 
             RowBox[{"LaserCtrl", "[", 
              RowBox[{"laser935", ",", 
               RowBox[{"jsonMessages", "[", "\"\<Laser935\>\"", "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"laser399m", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"DevicesList", ",", "\"\<Laser399\>\""}], "]"}], ",", 
             RowBox[{"LaserCtrl", "[", 
              RowBox[{"laser399", ",", 
               RowBox[{"jsonMessages", "[", "\"\<Laser399\>\"", "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ExportString", "[", 
            RowBox[{
             RowBox[{"Association", "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<Laser370\>\"", "->", "laser370m"}], ",", 
                RowBox[{"\"\<Laser935\>\"", "->", "laser935m"}], ",", 
                RowBox[{"\"\<Laser399\>\"", "->", "laser399m"}]}], "}"}]}], 
             ",", "\"\<JSON\>\"", ",", 
             RowBox[{"\"\<Compact\>\"", "\[Rule]", "True"}]}], "]"}], "<>", 
           "\"\<\\n\>\""}]}], ",", 
         RowBox[{"jsonMessages", "<>", "\"\<\\n\>\""}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "PublicateMessages", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PublicateMessages", "[", 
    RowBox[{"socket_", ",", "messages_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"socket", "[", "\"\<ConnectedClients\>\"", "]"}], "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", "messages"}], "]"}], "&"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8202198578627157`*^9, 3.820219865740657*^9}, 
   3.8202262282439322`*^9, {3.820271720071162*^9, 3.820271726893923*^9}, {
   3.8202717572727156`*^9, 3.8202718453213453`*^9}, {3.8202718838234224`*^9, 
   3.8202718841435666`*^9}, {3.82027192223175*^9, 3.8202719408559647`*^9}, 
   3.8202719748062086`*^9, {3.820276019482476*^9, 3.8202760238996677`*^9}, {
   3.8202830791501513`*^9, 3.820283119931136*^9}, {3.820283192318631*^9, 
   3.8202831948079767`*^9}, {3.8202848838737297`*^9, 3.820284897267925*^9}, {
   3.8202871718704996`*^9, 3.8202871889288993`*^9}, {3.8202873927829604`*^9, 
   3.820287393570854*^9}, {3.8202874323053102`*^9, 3.8202874602037325`*^9}, {
   3.820287745251747*^9, 3.820287787652403*^9}, {3.8202881794311075`*^9, 
   3.820288188398137*^9}},ExpressionUUID->"33459259-8dd4-4a60-899e-\
9e614a071ae5"],

Cell[CellGroupData[{

Cell["WSTP Link:", "Subsubsection",
 CellChangeTimes->{{3.8202008439324317`*^9, 
  3.8202008504500093`*^9}},ExpressionUUID->"9ed0bdb1-a2fb-4899-b8e0-\
75a8ba18a908"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"SessionBox", ",", "ControlPanel"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SessionBox", "[", "link_", "]"}], ":=", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"button", ",", 
        RowBox[{"valid", "=", "True"}], ",", "ready", ",", "connected", ",", 
        RowBox[{"in", "=", "\"\<\>\""}], ",", 
        RowBox[{"out", "=", "\"\<\>\""}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"button", "=", 
        RowBox[{"Function", "[", 
         RowBox[{",", 
          RowBox[{"Button", "[", 
           RowBox[{"##", ",", 
            RowBox[{"Enabled", "\[Rule]", 
             RowBox[{"Dynamic", "[", "valid", "]"}]}]}], "]"}], ",", 
          "HoldAll"}], "]"}]}], ";", 
       RowBox[{"DynamicWrapper", "[", 
        RowBox[{
         RowBox[{"Column", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Text", "[", "\"\<Link name:\>\"", "]"}], ",", 
               RowBox[{"Dynamic", "@", 
                RowBox[{"If", "[", 
                 RowBox[{"valid", ",", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Closed\>\""}], 
                 "]"}]}]}], "}"}], "]"}], ",", 
            RowBox[{"Text", "[", "\"\<Message:\>\"", "]"}], ",", 
            RowBox[{"Panel", "@", 
             RowBox[{"Pane", "[", 
              RowBox[{
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "@", "in"}], ",", "String", ",", 
                 RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                 RowBox[{"FieldSize", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "Infinity"}], "}"}]}], "}"}]}]}], "]"}],
                ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"250", ",", "300"}], "}"}]}], ",", 
               RowBox[{"FrameMargins", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"5", ",", "5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"Scrollbars", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}]}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Refresh", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"valid", ",", "connected", ",", "ready"}], "}"}], "=", 
             RowBox[{"Quiet", "@", 
              RowBox[{"Check", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"True", ",", 
                  RowBox[{"LinkConnectedQ", "@", "link"}], ",", 
                  RowBox[{"LinkReadyQ", "@", "link"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"False", ",", "False", ",", "False"}], "}"}]}], 
               "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{"ready", ",", 
              RowBox[{"in", "=", 
               RowBox[{"LinkRead", "[", "link", "]"}]}]}], 
             RowBox[{"(*", 
              RowBox[{";", 
               RowBox[{"ProcessMessage", "[", "in", "]"}]}], "*)"}], "]"}]}], 
           ",", 
           RowBox[{"If", "[", 
            RowBox[{"valid", ",", 
             RowBox[{"UpdateInterval", "\[Rule]", "0.1"}], ",", "None"}], 
            "]"}], ",", 
           RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
            RowBox[{"{", "}"}]}]}], "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ControlPanel", "[", "]"}], ":=", 
   RowBox[{"CreateDialog", "[", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PopupMenu", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "$ControlDevices", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Laser\>\"", ",", "\"\<CCD\>\"", ",", "\"\<RF\>\""}], 
                "}"}], ",", 
               RowBox[{"ImageSize", "->", 
                RowBox[{"{", 
                 RowBox[{"65", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"$ControlDevices", "==", "\"\<CCD\>\""}], ",", 
                RowBox[{"emccdGUI", "[", "]"}], ",", 
                RowBox[{"$ControlDevices", "==", "\"\<Laser\>\""}], ",", 
                RowBox[{"laserGUI", "[", "]"}], ",", 
                RowBox[{"$ControlDevices", "==", "\"\<RF\>\""}], ",", 
                RowBox[{"rfGUI", "[", "]"}]}], "]"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Link Create\>\"", ",", 
                  RowBox[{"$ChatServer", "=", 
                   RowBox[{"LinkCreate", "[", 
                    RowBox[{"LinkProtocol", "\[Rule]", "\"\<TCPIP\>\""}], 
                    "]"}]}], ",", 
                  RowBox[{"BaseStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}],
                     "}"}]}]}], "]"}], ",", 
                RowBox[{"Spacer", "[", "10", "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Link Close\>\"", ",", 
                  RowBox[{"LinkClose", "@", "$ChatServer"}], ",", 
                  RowBox[{"BaseStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}],
                     "}"}]}]}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"SessionBox", "[", "$ChatServer", "]"}]}]}], "}"}], 
           "]"}]}], "}"}], "}"}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Top"}]}], "]"}], ",", 
     RowBox[{"WindowMargins", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "60"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"WindowTitle", "->", "\"\<Control Panel\>\""}], ",", 
     RowBox[{"WindowFrameElements", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<CloseBox\>\"", ",", "\"\<ZoomBox\>\"", ",", "\"\<MinimizeBox\>\"",
         ",", "\"\<ResizeArea\>\""}], "}"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.820188463588769*^9, 3.820188504821991*^9}, {
   3.820188606421756*^9, 3.820188655757275*^9}, {3.8201886921228027`*^9, 
   3.820188747583395*^9}, {3.820188866270607*^9, 3.8201889072139006`*^9}, {
   3.8201889422470984`*^9, 3.8201889423091173`*^9}, {3.8201889764713306`*^9, 
   3.8201889765583925`*^9}, {3.820189103127183*^9, 3.8201891116471243`*^9}, {
   3.8201891498489637`*^9, 3.820189150661677*^9}, 3.8201894151133566`*^9, 
   3.8201944109835715`*^9, 3.8201962376376066`*^9, {3.8201963581384854`*^9, 
   3.8201963690732546`*^9}, {3.8201965213631563`*^9, 
   3.8201965337729826`*^9}, {3.8201965911635666`*^9, 
   3.8201965917240686`*^9}, {3.8201966966765127`*^9, 3.820196701330072*^9}, {
   3.820197776588244*^9, 3.820197777514767*^9}, 3.8202104480034924`*^9, {
   3.8202198437614117`*^9, 3.820219883402444*^9}, {3.8203699409446726`*^9, 
   3.8203699434898663`*^9}},ExpressionUUID->"4c0584e0-120f-4c1e-8b4e-\
35b50a10e6ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Socket connect:", "Subsubsection",
 CellChangeTimes->{{3.8202009162740493`*^9, 3.8202009217543993`*^9}, {
  3.8202037398274803`*^9, 
  3.8202037414441586`*^9}},ExpressionUUID->"1888aa25-143e-4ef2-809c-\
15f5724aa109"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"SessionBox", ",", "ControlPanel"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SessionBox", "[", "socket_", "]"}], ":=", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"valid", "=", "True"}], ",", "readylist", ",", "poslist", ",",
         "ready", ",", "connected", ",", 
        RowBox[{"chatMessages", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"in", "=", "\"\<\>\""}]}], "}"}], ",", 
      RowBox[{"DynamicWrapper", "[", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Info: \>\"", "]"}], ",", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"If", "[", 
                RowBox[{"valid", ",", 
                 RowBox[{"socket", "/@", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<DestinationIPAddress\>\"", ",", 
                    "\"\<DestinationPort\>\"", ",", "\"\<Protocol\>\""}], 
                   "}"}]}], ",", "\"\<Closed\>\""}], "]"}]}]}], "}"}], "]"}], 
           ",", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Clients number: \>\"", "]"}], ",", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"Length", "[", "connected", "]"}]}]}], "}"}], "]"}], 
           ",", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Text", "[", "\"\<Messages:\>\"", "]"}], ",", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<Clear\>\"", ",", 
                RowBox[{"chatMessages", "=", 
                 RowBox[{"{", "}"}]}]}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"Panel", "@", 
            RowBox[{"Pane", "[", 
             RowBox[{
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "@", "in"}], ",", "String", ",", 
                RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                RowBox[{"FieldSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "Infinity"}], "}"}]}], "}"}]}]}], "]"}],
               ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"250", ",", "300"}], "}"}]}], ",", 
              RowBox[{"FrameMargins", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"5", ",", "5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"Scrollbars", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}]}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"Refresh", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"valid", "=", 
            RowBox[{"Quiet", "@", 
             RowBox[{"Check", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"Sockets", "[", "]"}], ",", "socket"}], "]"}], ",", 
               "False"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"valid", ",", 
             RowBox[{
              RowBox[{"connected", "=", 
               RowBox[{"socket", "[", "\"\<ConnectedClients\>\"", "]"}]}], 
              ";", 
              RowBox[{"readylist", "=", 
               RowBox[{"Map", "[", 
                RowBox[{"SocketReadyQ", ",", "connected"}], "]"}]}], ";", 
              RowBox[{"poslist", "=", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Position", "[", 
                 RowBox[{"readylist", ",", " ", "True"}], "]"}]}]}], ";", 
              RowBox[{"ready", "=", 
               RowBox[{"Or", "@@", "readylist"}]}]}], ",", 
             RowBox[{"ready", "=", "False"}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{"ready", ",", 
             RowBox[{
              RowBox[{"chatMessages", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"chatMessages", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ByteArrayToString", "[", 
                    RowBox[{"SocketReadMessage", "[", 
                    RowBox[{"connected", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "&"}], "/@",
                   " ", "poslist"}]}], "]"}]}], ";", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"in", " ", "=", " ", 
               RowBox[{"StringJoin", "[", 
                RowBox[{"Riffle", "[", 
                 RowBox[{"chatMessages", ",", " ", "\"\<\\n------\\n\>\""}], 
                 "]"}], "]"}]}], ";", " ", 
              RowBox[{
               RowBox[{"PublicateMessages", "[", 
                RowBox[{"socket", ",", 
                 RowBox[{"ProcessMessages", "[", 
                  RowBox[{"chatMessages", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "]"}], "/@", 
               "poslist"}]}]}], "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"valid", ",", 
            RowBox[{"UpdateInterval", "\[Rule]", "0.1"}], ",", "None"}], 
           "]"}], ",", 
          RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
           RowBox[{"{", "}"}]}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ControlPanel", "[", "]"}], ":=", 
   RowBox[{"CreateDialog", "[", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PopupMenu", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "$ControlDevices", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Laser\>\"", ",", "\"\<CCD\>\"", ",", "\"\<RF\>\""}], 
                "}"}], ",", 
               RowBox[{"ImageSize", "->", 
                RowBox[{"{", 
                 RowBox[{"65", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"$ControlDevices", "==", "\"\<CCD\>\""}], ",", 
                RowBox[{"emccdGUI", "[", "]"}], ",", 
                RowBox[{"$ControlDevices", "==", "\"\<Laser\>\""}], ",", 
                RowBox[{"laserGUI", "[", "]"}], ",", 
                RowBox[{"$ControlDevices", "==", "\"\<RF\>\""}], ",", 
                RowBox[{"rfGUI", "[", "]"}]}], "]"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Link Create\>\"", ",", 
                  RowBox[{
                   RowBox[{"Quiet", "[", 
                    RowBox[{"Close", "@", "$ChatServer"}], "]"}], ";", 
                   RowBox[{"$ChatServer", "=", 
                    RowBox[{"SocketOpen", "[", 
                    RowBox[{"\"\<192.168.32.2:\>\"", "<>", 
                    RowBox[{"ToString", "@", "$SocketPort"}]}], "]"}]}]}], 
                  ",", 
                  RowBox[{"BaseStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}],
                     "}"}]}]}], "]"}], ",", 
                RowBox[{"Spacer", "[", "5", "]"}], ",", 
                RowBox[{"Button", "[", 
                 RowBox[{"\"\<Link Close\>\"", ",", 
                  RowBox[{"Quiet", "[", 
                   RowBox[{"Close", "@", "$ChatServer"}], "]"}], ",", 
                  RowBox[{"BaseStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"\"\<GenericButton\>\"", ",", "15", ",", "Bold"}],
                     "}"}]}]}], "]"}], ",", 
                RowBox[{"InputField", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", "$SocketPort", "]"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"40", ",", "20"}], "}"}]}], ",", 
                  RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
               "}"}], "]"}], ",", 
             RowBox[{"Dynamic", "@", 
              RowBox[{"SessionBox", "[", "$ChatServer", "]"}]}]}], "}"}], 
           "]"}]}], "}"}], "}"}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Top"}]}], "]"}], ",", 
     RowBox[{"WindowMargins", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "60"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"WindowTitle", "->", "\"\<Control Panel\>\""}], ",", 
     RowBox[{"WindowFrameElements", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<CloseBox\>\"", ",", "\"\<ZoomBox\>\"", ",", "\"\<MinimizeBox\>\"",
         ",", "\"\<ResizeArea\>\""}], "}"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820188463588769*^9, 3.820188504821991*^9}, {
   3.820188606421756*^9, 3.820188655757275*^9}, {3.8201886921228027`*^9, 
   3.820188747583395*^9}, {3.820188866270607*^9, 3.8201889072139006`*^9}, {
   3.8201889422470984`*^9, 3.8201889423091173`*^9}, {3.8201889764713306`*^9, 
   3.8201889765583925`*^9}, {3.820189103127183*^9, 3.8201891116471243`*^9}, {
   3.8201891498489637`*^9, 3.820189150661677*^9}, 3.8201894151133566`*^9, 
   3.8201944109835715`*^9, 3.8201962376376066`*^9, {3.8201963581384854`*^9, 
   3.8201963690732546`*^9}, {3.8201965213631563`*^9, 
   3.8201965337729826`*^9}, {3.8201965911635666`*^9, 
   3.8201965917240686`*^9}, {3.8201966966765127`*^9, 3.820196701330072*^9}, {
   3.820197776588244*^9, 3.820197777514767*^9}, {3.820203819087603*^9, 
   3.8202038661278567`*^9}, {3.8202039698715305`*^9, 
   3.8202040765683117`*^9}, {3.820204125273114*^9, 3.82020414404992*^9}, {
   3.820204612592885*^9, 3.820204720576228*^9}, {3.8202049962592745`*^9, 
   3.8202050109998703`*^9}, {3.820205057840656*^9, 3.820205110512854*^9}, {
   3.820205156722327*^9, 3.820205217496866*^9}, {3.8202061880733395`*^9, 
   3.8202061881461444`*^9}, {3.820206218570814*^9, 3.820206234673768*^9}, {
   3.820206299775738*^9, 3.820206302010764*^9}, {3.8202068431462107`*^9, 
   3.820206882516966*^9}, {3.8202070551225595`*^9, 3.82020710384332*^9}, {
   3.820207143730694*^9, 3.82020715318542*^9}, {3.8202073039451494`*^9, 
   3.82020730860968*^9}, {3.8202073554205465`*^9, 3.8202073872514567`*^9}, {
   3.8202076424422855`*^9, 3.82020772747398*^9}, {3.8202077745341797`*^9, 
   3.8202077927544737`*^9}, {3.8202089894425097`*^9, 
   3.8202089956509132`*^9}, {3.8202091106046214`*^9, 
   3.8202091728442435`*^9}, {3.8202092704224*^9, 3.820209295018649*^9}, {
   3.820209329491497*^9, 3.820209367578683*^9}, {3.820209399667903*^9, 
   3.8202094483078794`*^9}, 3.820210017310831*^9, {3.8202101875228233`*^9, 
   3.820210226955413*^9}, 3.820210424012645*^9, {3.8202110455563755`*^9, 
   3.8202110456830373`*^9}, {3.8202198880809374`*^9, 3.820219909905596*^9}, {
   3.82022238576271*^9, 3.8202223917317553`*^9}, {3.8202225779748926`*^9, 
   3.8202225781873245`*^9}, 3.820226429537837*^9, {3.820226544845599*^9, 
   3.820226562262041*^9}, 3.8202266035017996`*^9, 3.820271713355115*^9, {
   3.8202718546174955`*^9, 3.8202718632663755`*^9}, 3.820271948250198*^9, {
   3.8202730177552176`*^9, 3.820273021218958*^9}, {3.82027335288336*^9, 
   3.8202734410307245`*^9}, {3.8202738069714994`*^9, 
   3.8202738419529877`*^9}, {3.8202739204790726`*^9, 
   3.8202739263324256`*^9}, {3.8202740913732414`*^9, 3.820274129819468*^9}, {
   3.820274225477756*^9, 3.8202742286403017`*^9}, 3.820274260630786*^9, {
   3.8202745536504908`*^9, 3.820274554270832*^9}, {3.820274621692603*^9, 
   3.8202746266443653`*^9}, {3.820274920263468*^9, 3.8202749237461576`*^9}, {
   3.8202751081163044`*^9, 3.8202752460116835`*^9}, {3.8202752976995125`*^9, 
   3.820275368616938*^9}, {3.820275590108271*^9, 3.8202755942073135`*^9}, 
   3.8202758740941257`*^9, {3.8202759696796083`*^9, 3.8202759774398637`*^9}, {
   3.820276300343151*^9, 3.820276308596088*^9}, {3.8202763457896633`*^9, 
   3.820276369064446*^9}, {3.8202766024455757`*^9, 3.8202766043115883`*^9}, {
   3.820276756109803*^9, 3.820276756541649*^9}, {3.8202769013814664`*^9, 
   3.820276915720137*^9}, {3.820283157906621*^9, 3.820283179193716*^9}, {
   3.820283273033865*^9, 3.820283315251011*^9}, {3.820283437690707*^9, 
   3.820283488863912*^9}, {3.820283574499991*^9, 3.820283597184351*^9}, 
   3.8202841107663856`*^9, {3.820284148460622*^9, 3.8202841492993803`*^9}, 
   3.820284382332441*^9, {3.8202850235134473`*^9, 3.820285049186817*^9}, {
   3.820285079873786*^9, 3.820285082201563*^9}, {3.82028529887336*^9, 
   3.8202852996024113`*^9}, {3.8202854349775295`*^9, 3.820285451892313*^9}, {
   3.8202854907554255`*^9, 3.820285651549593*^9}, {3.820289542831011*^9, 
   3.8202896066284685`*^9}, 3.820289834885297*^9, {3.8202900455651116`*^9, 
   3.820290090735363*^9}, {3.820290503070118*^9, 3.8202905553752966`*^9}, {
   3.820290597678213*^9, 3.820290607909862*^9}, 3.820290646454825*^9, {
   3.820369951007764*^9, 3.820369953594844*^9}, {3.820370054810175*^9, 
   3.820370070442373*^9}, {3.820370189594737*^9, 3.820370189738353*^9}, {
   3.820376301124079*^9, 3.8203763172898493`*^9}, {3.8203763911722736`*^9, 
   3.8203763985774703`*^9}, 
   3.8203786645758467`*^9},ExpressionUUID->"85baee04-b7e0-47a5-9462-\
68da9843aac5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["test:", "Subsubsection",
 CellChangeTimes->{{3.820226238546392*^9, 
  3.820226239738206*^9}},ExpressionUUID->"f4406334-266a-4176-b974-\
7b1a7bfacbf0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"jsonMessages", "=", 
  RowBox[{"ExportString", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Laser935\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<CC\>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], ",", 
      RowBox[{"\"\<Laser370\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<PC\>\"", "\[Rule]", "\"\<\>\""}], ",", 
         RowBox[{"\"\<CC\>\"", "\[Rule]", "63.361"}]}], "}"}]}]}], "}"}], 
    ",", "\"\<JSON\>\"", ",", 
    RowBox[{"\"\<Compact\>\"", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8202201226369267`*^9, 3.8202201499918013`*^9}, {
  3.820220717970023*^9, 3.8202207637197247`*^9}, {3.820221361546625*^9, 
  3.820221385487627*^9}, {3.820221482520241*^9, 3.8202214827915154`*^9}, {
  3.8202215831193213`*^9, 3.820221623167266*^9}, {3.820221666757741*^9, 
  3.8202216677291446`*^9}, {3.8202217580407248`*^9, 3.820221773023673*^9}, {
  3.820221844418821*^9, 3.820221884192498*^9}, {3.8202219683704753`*^9, 
  3.82022199563958*^9}, {3.820223698749729*^9, 3.8202237017636714`*^9}, {
  3.8202237320985813`*^9, 3.820223737704595*^9}, {3.820223837891777*^9, 
  3.820223839737842*^9}, {3.8202247177407813`*^9, 3.8202247269740987`*^9}, {
  3.820224836837414*^9, 3.820224837107692*^9}, {3.8202257846048603`*^9, 
  3.8202257926543427`*^9}, {3.8202258979418893`*^9, 3.820225915728345*^9}, {
  3.8202259518577623`*^9, 3.8202259520023766`*^9}, {3.820226008215109*^9, 
  3.82022607244541*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"1be19a03-b92f-4495-8886-782eb61ae180"],

Cell[BoxData["\<\"{\\\"Laser935\\\":{\\\"CC\\\":\\\"\\\"},\\\"Laser370\\\":{\\\
\"PC\\\":\\\"\\\",\\\"CC\\\":6.3361e1}}\"\>"], "Output",
 CellChangeTimes->{
  3.820225916279869*^9, 3.8202259524272404`*^9, {3.820226036177363*^9, 
   3.820226072796471*^9}, 3.8202876455323153`*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"a2c673ff-9cb2-4e9d-a537-5d9b23e235f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "\"\<Laser370\>\"", ",", "\"\<Laser935\>\"", ",", "\"\<Laser399\>\""}], 
   "}"}], "/.", "jsonMessages"}]], "Input",
 CellChangeTimes->{{3.8202216694944253`*^9, 3.820221673909622*^9}, {
  3.8202217248015795`*^9, 3.82022179264921*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"cdf0f080-30d6-4934-bd10-439dae344d9f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"\"\>", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"CC\"\>", "\[Rule]", "\<\"\"\>"}], "\[RightAssociation]"}], 
   ",", "\<\"Laser399\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.820221674273651*^9, {3.8202217255136757`*^9, 3.820221793209712*^9}, {
   3.82022184975356*^9, 3.8202218859767294`*^9}, 3.8202219978985415`*^9, 
   3.8202237064441605`*^9, 3.820223739447935*^9, 3.8202238412617683`*^9, 
   3.820224729723748*^9, 3.820224786897912*^9, 3.8202248385737743`*^9, {
   3.820225929581311*^9, 3.8202259538683877`*^9}},
 CellLabel->
  "Out[188]=",ExpressionUUID->"695a7825-82b1-407f-b91f-c8fdeba8508b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MissingQ", "/@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Lookup", "[", 
      RowBox[{"jsonMessages", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Laser370\>\"", ",", "\"\<Laser935\>\"", ",", "\"\<Laser399\>\"", 
      ",", "\"\<CCD\>\""}], "}"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8202222516242867`*^9, 3.8202222760430107`*^9}, {
  3.8202234158669257`*^9, 3.820223479136794*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"4a2009a7-3672-4d9e-a664-c3ff977e6782"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.8202222698924527`*^9, 3.820222276461891*^9}, 
   3.8202234288771477`*^9, {3.8202234688812094`*^9, 3.8202234796334667`*^9}, {
   3.8202237108982553`*^9, 3.820223740812288*^9}, 3.8202238449588857`*^9, 
   3.820224731242688*^9, 3.8202247879092083`*^9, 3.820224839591053*^9, {
   3.820225932854562*^9, 3.820225954979418*^9}},
 CellLabel->
  "Out[189]=",ExpressionUUID->"5ce73c38-e13d-45fd-a64d-8a2b2ac32ddf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Lookup", "[", 
    RowBox[{"jsonMessages", ",", "#"}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
   "\"\<Laser370\>\"", ",", "\"\<Laser935\>\"", ",", "\"\<Laser399\>\"", ",", 
    "\"\<CCD\>\""}], "}"}]}]], "Input",
 CellLabel->
  "In[190]:=",ExpressionUUID->"9944c891-00b6-4f9a-bd69-6992ba1f9b06"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"\"\>", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"CC\"\>", "\[Rule]", "\<\"\"\>"}], "\[RightAssociation]"}], 
   ",", 
   RowBox[{"Missing", "[", 
    RowBox[{"\<\"KeyAbsent\"\>", ",", "\<\"Laser399\"\>"}], "]"}], ",", 
   RowBox[{"Missing", "[", 
    RowBox[{"\<\"KeyAbsent\"\>", ",", "\<\"CCD\"\>"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8202234963966556`*^9, {3.820223712226703*^9, 3.820223741876443*^9}, 
   3.820223846002098*^9, 3.820224732275926*^9, 3.820224788947435*^9, 
   3.8202248407190375`*^9, {3.8202259347624617`*^9, 3.8202259559318724`*^9}},
 CellLabel->
  "Out[190]=",ExpressionUUID->"b32bc9aa-38b1-4824-91c6-9141d922a87b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExportString", "[", 
  RowBox[{
   RowBox[{"ProcessMessages", "[", "jsonMessages", "]"}], ",", "\"\<JSON\>\"",
    ",", 
   RowBox[{"\"\<Compact\>\"", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.820225997278345*^9, 3.820225997392041*^9}, 
   3.820226089412055*^9, {3.8202264857256365`*^9, 3.820226519540245*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"eccc0918-9c32-4930-8d2e-09e33361aa77"],

Cell[BoxData["\<\"{\\\"Laser370\\\":{\\\"PC\\\":5.930650537137421e1,\\\"CC\\\"\
:null},\\\"Laser935\\\":{\\\"PC\\\":\\\"\\\",\\\"CC\\\":1.7009436844e2},\\\"\
Laser399\\\":{\\\"\\\":\\\"\\\"}}\"\>"], "Output",
 CellChangeTimes->{{3.820226476215062*^9, 3.8202265216346455`*^9}},
 CellLabel->
  "Out[210]=",ExpressionUUID->"d5e32d68-e1c9-4bfe-b36a-f1132b92d899"]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
WindowSize->{776, 791},
WindowMargins->{{498, Automatic}, {Automatic, 52}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (2018\:5e743\:670828\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 155, 3, 53, "Subsection",ExpressionUUID->"aae5bb65-3c71-483a-ac6d-46b917b7c43c"],
Cell[738, 27, 5121, 104, 219, "Input",ExpressionUUID->"122e15d1-cef4-4749-8891-6a5c45e18846"],
Cell[CellGroupData[{
Cell[5884, 135, 1373, 22, 28, "Input",ExpressionUUID->"ccd8f17b-a5d0-4b93-9433-71edab63da82"],
Cell[7260, 159, 2575, 47, 51, "Output",ExpressionUUID->"8d560ddb-7ba1-43f5-8789-af3d034f6aed"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[9884, 212, 155, 3, 37, "Subsection",ExpressionUUID->"96f05939-356d-4a31-b1df-158ea193db9b"],
Cell[10042, 217, 18810, 413, 1185, "Input",ExpressionUUID->"75edf22a-d5d0-4a75-baf1-6ed2522dcb5d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[28889, 635, 185, 4, 37, "Subsection",ExpressionUUID->"2353b441-99d1-4e4e-9cd7-42b5ecdadd73"],
Cell[29077, 641, 73463, 1556, 4529, "Input",ExpressionUUID->"b71b5c36-5fb3-4f6e-9bee-159cce4f8826",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[102577, 2202, 156, 3, 37, "Subsection",ExpressionUUID->"6c7cddd7-9c01-4d2b-8c0f-74c23f4e89ae"],
Cell[102736, 2207, 15469, 375, 998, "Input",ExpressionUUID->"2f6f2c05-bb6c-4917-877f-e20bb2237196"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118242, 2587, 261, 4, 53, "Subsection",ExpressionUUID->"6c6590b5-b4f9-4bc9-8a1e-c30139646fb8"],
Cell[118506, 2593, 16196, 378, 1055, "Input",ExpressionUUID->"eeb121b9-1579-4fb0-951e-3efcff71bbe3"],
Cell[CellGroupData[{
Cell[134727, 2975, 766, 19, 67, "Input",ExpressionUUID->"59213d47-4252-43ae-8009-f770f748bfda"],
Cell[135496, 2996, 956, 16, 51, "Output",ExpressionUUID->"5d68aafb-a473-4060-818a-a6f6f0904c58"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[136501, 3018, 156, 3, 37, "Subsection",ExpressionUUID->"03bd7c63-feac-4fcc-8479-77d1ca4c0d9e"],
Cell[136660, 3023, 43986, 958, 3180, "Input",ExpressionUUID->"beb57f7a-0215-4922-91ab-93d7a8b715b8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[180683, 3986, 157, 3, 37, "Subsection",ExpressionUUID->"dd6ace7e-5ed9-4525-80a5-3b08a2d018ea"],
Cell[180843, 3991, 6569, 159, 634, "Input",ExpressionUUID->"142d97ed-88a9-47d5-ae12-4c2d7ccb383c",
 InitializationCell->True],
Cell[187415, 4152, 25286, 509, 1261, "Input",ExpressionUUID->"1b5f48db-044b-43dc-8b45-46c3516eda05",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[212726, 4665, 157, 3, 44, "Subsubsection",ExpressionUUID->"b5149b47-c27c-45e6-97f6-72173c6c1ee8"],
Cell[CellGroupData[{
Cell[212908, 4672, 686, 15, 48, "Input",ExpressionUUID->"c46086e3-08a7-440c-aaae-18676b84f975"],
Cell[213597, 4689, 2404, 37, 51, "Output",ExpressionUUID->"7d84671e-107c-4a60-b202-7a3c7b129d49"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[216062, 4733, 174, 3, 37, "Subsection",ExpressionUUID->"fb27fed2-aa14-4a63-b32e-a24592cf31e5"],
Cell[216239, 4738, 5957, 139, 501, "Input",ExpressionUUID->"33459259-8dd4-4a60-899e-9e614a071ae5",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[222221, 4881, 165, 3, 44, "Subsubsection",ExpressionUUID->"9ed0bdb1-a2fb-4899-b8e0-75a8ba18a908"],
Cell[222389, 4886, 7975, 185, 561, "Input",ExpressionUUID->"4c0584e0-120f-4c1e-8b4e-35b50a10e6ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230401, 5076, 223, 4, 44, "Subsubsection",ExpressionUUID->"1888aa25-143e-4ef2-809c-15f5724aa109"],
Cell[230627, 5082, 14021, 288, 805, "Input",ExpressionUUID->"85baee04-b7e0-47a5-9462-68da9843aac5",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[244685, 5375, 156, 3, 44, "Subsubsection",ExpressionUUID->"f4406334-266a-4176-b974-7b1a7bfacbf0"],
Cell[CellGroupData[{
Cell[244866, 5382, 1581, 30, 67, "Input",ExpressionUUID->"1be19a03-b92f-4495-8886-782eb61ae180"],
Cell[246450, 5414, 362, 6, 32, "Output",ExpressionUUID->"a2c673ff-9cb2-4e9d-a537-5d9b23e235f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246849, 5425, 372, 9, 28, "Input",ExpressionUUID->"cdf0f080-30d6-4934-bd10-439dae344d9f"],
Cell[247224, 5436, 664, 13, 32, "Output",ExpressionUUID->"695a7825-82b1-407f-b91f-c8fdeba8508b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247925, 5454, 542, 14, 28, "Input",ExpressionUUID->"4a2009a7-3672-4d9e-a664-c3ff977e6782"],
Cell[248470, 5470, 534, 9, 32, "Output",ExpressionUUID->"5ce73c38-e13d-45fd-a64d-8a2b2ac32ddf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249041, 5484, 352, 10, 28, "Input",ExpressionUUID->"9944c891-00b6-4f9a-bd69-6992ba1f9b06"],
Cell[249396, 5496, 714, 16, 32, "Output",ExpressionUUID->"b32bc9aa-38b1-4824-91c6-9141d922a87b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250147, 5517, 437, 9, 28, "Input",ExpressionUUID->"eccc0918-9c32-4930-8d2e-09e33361aa77"],
Cell[250587, 5528, 359, 5, 52, "Output",ExpressionUUID->"d5e32d68-e1c9-4bfe-b36a-f1132b92d899"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

