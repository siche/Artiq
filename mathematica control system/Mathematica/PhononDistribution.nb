(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    404799,       9723]
NotebookOptionsPosition[    401877,       9632]
NotebookOutlinePosition[    402359,       9650]
CellTagsIndexPosition[    402316,       9647]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Parameter", "Section",
 Evaluatable->False]], "Section",
 CellChangeTimes->{3.5952190043274407`*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "r\[Pi]fitting", ",", "b\[Pi]fitting", ",", "\[Eta]fitting", ",", 
   "Repeattimes"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r\[Pi]fitting", "=", "13.5"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"b\[Pi]fitting", ":=", "PiBlue0"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b\[Pi]fitting", ":=", 
   RowBox[{
    RowBox[{"DrivePiWave", "[", 
     RowBox[{"1", ",", "3", ",", "1"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]fitting", "=", "0.07"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Repeattimes", "=", "100"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5933870291533213`*^9, 3.5933870374098*^9}, {
   3.5933886469247336`*^9, 3.5933886518544126`*^9}, {3.5933928397465916`*^9, 
   3.5933928790045805`*^9}, {3.593392949206502*^9, 3.593392949461547*^9}, 
   3.5933942734748096`*^9, {3.593396148159073*^9, 3.5933961595355186`*^9}, {
   3.5937486982429485`*^9, 3.593748698820179*^9}, {3.5939910319711657`*^9, 
   3.593991034474309*^9}, 3.593991069186281*^9, {3.5943565925625467`*^9, 
   3.594356598422555*^9}, {3.594357173392537*^9, 3.5943571756956563`*^9}, {
   3.594357326383073*^9, 3.5943573300530777`*^9}, {3.5943580465053997`*^9, 
   3.594358049089547*^9}, {3.5943584988069205`*^9, 3.5943585004060116`*^9}, {
   3.594358900763606*^9, 3.594358903483762*^9}, {3.594430370498716*^9, 
   3.594430372247816*^9}, {3.5945990956380634`*^9, 3.5945991045265713`*^9}, 
   3.594599500452217*^9, {3.594603660406153*^9, 3.5946036695576763`*^9}, 
   3.594607899616622*^9, 3.5946142107035956`*^9, 3.594614965522769*^9, {
   3.594616512460249*^9, 3.5946165135793123`*^9}, {3.5946167973535433`*^9, 
   3.594616821576929*^9}, 3.5946182292314425`*^9, {3.594620012035413*^9, 
   3.5946200131784782`*^9}, {3.5946206223103185`*^9, 3.594620624542446*^9}, {
   3.594681826617629*^9, 3.5946818312276354`*^9}, 3.5946818899191957`*^9, {
   3.594975836382115*^9, 3.5949758392202773`*^9}, {3.594988459532344*^9, 
   3.5949884606044054`*^9}, 3.595138050552554*^9, {3.5952235117051163`*^9, 
   3.595223514247261*^9}, {3.5952295152234974`*^9, 3.5952295153255033`*^9}, 
   3.5952368442746954`*^9, {3.595236930233612*^9, 3.595236938562088*^9}, 
   3.595237007881053*^9, 3.595237613716705*^9, 3.595238174520781*^9, {
   3.595239872900923*^9, 3.5952398732209415`*^9}, 3.595240580424391*^9, {
   3.595643150872709*^9, 3.5956431511437244`*^9}, {3.5956557349354763`*^9, 
   3.5956557730386553`*^9}, {3.5957288127315474`*^9, 3.5957288348198104`*^9}, 
   3.5957528918175583`*^9, {3.595753028800393*^9, 3.5957530289364014`*^9}, 
   3.5957766768033047`*^9, 3.5957773267974825`*^9, {3.5957773823646607`*^9, 
   3.595777403788886*^9}, 3.5957779243296595`*^9, 3.595778374070383*^9, {
   3.5957788402750483`*^9, 3.5957788407300744`*^9}, 3.5957790350891914`*^9, {
   3.595780121913883*^9, 3.59578012256892*^9}, 3.5957806391334667`*^9, {
   3.595781612815158*^9, 3.595781616582373*^9}, 3.5957838987919083`*^9, 
   3.5957858895937757`*^9, {3.5957891906735864`*^9, 3.595789200809166*^9}, {
   3.595790694999629*^9, 3.5957906956066637`*^9}, {3.59580793181837*^9, 
   3.595807934698374*^9}, {3.5958152526500053`*^9, 3.5958152602400155`*^9}, {
   3.5958153851688304`*^9, 3.595815390588838*^9}, 3.5958559085543814`*^9, {
   3.5958609781733465`*^9, 3.595860978277353*^9}, 3.595869768759748*^9, 
   3.595870348403902*^9, 3.595871429708749*^9, 3.595873314134532*^9, {
   3.5958741296011744`*^9, 3.5958741300642004`*^9}, {3.59587416135299*^9, 
   3.5958741617840147`*^9}, {3.5958881192337184`*^9, 3.595888119783719*^9}, {
   3.595895416012575*^9, 3.5958954179025774`*^9}, {3.595895462454753*^9, 
   3.595895465510818*^9}, {3.595917228557804*^9, 3.595917229807806*^9}, {
   3.5959172704290314`*^9, 3.5959172709290323`*^9}, 3.595928091924939*^9, {
   3.596172707367299*^9, 3.5961727105744824`*^9}, {3.5961760698956246`*^9, 
   3.5961760721277523`*^9}, {3.5961800109240384`*^9, 3.596180012403123*^9}, {
   3.5963479350597496`*^9, 3.5963479354107695`*^9}, {3.5963484034165382`*^9, 
   3.596348403607549*^9}, {3.5964117013791747`*^9, 3.5964117018091755`*^9}, {
   3.596412802800638*^9, 3.5964128032706385`*^9}, {3.5965130810926056`*^9, 
   3.596513097739558*^9}, {3.5968709908275895`*^9, 3.596870991346619*^9}, 
   3.5968710251625533`*^9, 3.596871056731359*^9, {3.5968711395140944`*^9, 
   3.596871140193133*^9}, {3.596871179290369*^9, 3.5968712553367186`*^9}, {
   3.5968713109609003`*^9, 3.596871315473158*^9}, {3.5968727119590325`*^9, 
   3.596872712935088*^9}, {3.596872758967721*^9, 3.596872761286854*^9}, {
   3.596872795254797*^9, 3.596872817582074*^9}, {3.5969478850368986`*^9, 
   3.596947897316916*^9}, {3.5969484914974813`*^9, 3.596948492017482*^9}, {
   3.5969485393469863`*^9, 3.5969485397569866`*^9}, {3.596948689154656*^9, 
   3.5969487198339586`*^9}, {3.5969494994576397`*^9, 3.59694949979764*^9}, {
   3.596949609348234*^9, 3.596949609884265*^9}, {3.596949810774373*^9, 
   3.5969498112743735`*^9}, {3.596949853895614*^9, 3.5969498544356146`*^9}, {
   3.5969500081296787`*^9, 3.5969500087996798`*^9}, {3.5969501589366474`*^9, 
   3.596950162756653*^9}, {3.5975533540086207`*^9, 3.5975533544556465`*^9}, 
   3.5975573940095835`*^9, 3.597557470399953*^9, {3.597558652503566*^9, 
   3.597558652959592*^9}, 3.597560105789689*^9, 3.597560139925641*^9, 
   3.5975601748696404`*^9, 3.5975602061964316`*^9, {3.5975602410604258`*^9, 
   3.597560241500451*^9}, {3.597568199948648*^9, 3.597568219603772*^9}, 
   3.5975683191234646`*^9, {3.597641838339339*^9, 3.597641840034436*^9}, {
   3.597642319191842*^9, 3.597642319926884*^9}, 3.59765178059589*^9, {
   3.597652032926244*^9, 3.5976520580362787`*^9}, {3.598689541322837*^9, 
   3.598689541992838*^9}, {3.598689634752968*^9, 3.5986896367129703`*^9}, {
   3.5986898911518707`*^9, 3.598689905767706*^9}, {3.598690040470411*^9, 
   3.598690041350461*^9}, {3.5986901585341635`*^9, 3.598690159309208*^9}, 
   3.598690497868065*^9, {3.598691029483941*^9, 3.5986910302719865`*^9}, {
   3.5986912676815653`*^9, 3.598691272917865*^9}, {3.598691350084279*^9, 
   3.5986913504853015`*^9}, {3.5986917495871286`*^9, 
   3.5986917573625736`*^9}, {3.5986927136525292`*^9, 
   3.5986927144425306`*^9}, {3.598694040674387*^9, 3.5986940411243877`*^9}, 
   3.5987660884013796`*^9, {3.598863915454995*^9, 3.5988639209743104`*^9}, 
   3.598864319348096*^9, 3.5988643777724376`*^9, {3.5988644697316976`*^9, 
   3.59886451365921*^9}, 3.598864573091609*^9, 3.5988646537532225`*^9, 
   3.5988647384100647`*^9, {3.5988648623441534`*^9, 3.5988648635762243`*^9}, 
   3.5988695841672263`*^9, 3.5988733301564846`*^9, 3.598919333088702*^9, 
   3.5989214625535*^9, {3.598921940741851*^9, 3.59892194142089*^9}, {
   3.598922119556079*^9, 3.598922135556994*^9}, 3.5989230274870095`*^9, 
   3.598923109997729*^9, 3.5989238527932143`*^9, {3.5989244847793617`*^9, 
   3.598924487147497*^9}, 3.598926959802925*^9, {3.5989279131794553`*^9, 
   3.5989279204198694`*^9}, 3.598928261833397*^9, {3.5989283034177756`*^9, 
   3.5989283044488344`*^9}, 3.598928929829604*^9, 3.598930628920787*^9, 
   3.598932471116154*^9, {3.5989340764159718`*^9, 3.5989340784310875`*^9}, 
   3.5989361840665226`*^9, {3.5989363153680325`*^9, 3.59893631619208*^9}, {
   3.5989364988315268`*^9, 3.5989365002626085`*^9}, 3.5989375470074787`*^9, 
   3.598939384914601*^9, 3.5989404188597393`*^9, 3.598941460562321*^9, 
   3.598942775914555*^9, {3.5989435109655976`*^9, 3.5989435154058514`*^9}, {
   3.59894378742041*^9, 3.598943788315461*^9}, {3.5989438411234818`*^9, 
   3.5989438430905943`*^9}, {3.5989442496798496`*^9, 
   3.5989442512329383`*^9}, {3.5989457942451935`*^9, 3.5989457946452165`*^9}, 
   3.5989503412042646`*^9, {3.598950436347707*^9, 3.5989504372187567`*^9}, {
   3.5989506985377035`*^9, 3.598950699143738*^9}, {3.5989510924152317`*^9, 
   3.598951092894259*^9}, {3.5989523120989933`*^9, 3.5989523126480246`*^9}, {
   3.598952396110799*^9, 3.5989523965088215`*^9}, {3.599185553352101*^9, 
   3.599185560695521*^9}, 3.5991856132155247`*^9, 3.599185840382518*^9, 
   3.5991859330388174`*^9, 3.5991860003726687`*^9, 3.599186425474983*^9, 
   3.5991864956019945`*^9, {3.599186577944704*^9, 3.5991865876802607`*^9}, {
   3.5991866882240114`*^9, 3.599186689503085*^9}, {3.5991867765960665`*^9, 
   3.599186776614067*^9}, 3.5991871021236854`*^9, 3.5991872983129067`*^9, 
   3.599187381475663*^9, 3.59918741987486*^9, 3.599187460106161*^9, 
   3.5991874987223697`*^9, {3.599187573513647*^9, 3.5991875736006527`*^9}, 
   3.5991876167851224`*^9, {3.5991876546812897`*^9, 3.5991876551363163`*^9}, {
   3.5991876906723485`*^9, 3.599187725888363*^9}, 3.59918782025576*^9, 
   3.5991879630309267`*^9, 3.5991889127912493`*^9, {3.5991891877579765`*^9, 
   3.5991891879739895`*^9}, {3.5991892341736317`*^9, 3.5991892343816433`*^9}, 
   3.599189651755516*^9, {3.599189867473854*^9, 3.5991898677528706`*^9}, {
   3.5991900293041105`*^9, 3.5991900294081163`*^9}, {3.5991905417964234`*^9, 
   3.5991905472367344`*^9}, 3.5992071665845604`*^9, 3.5992072005125012`*^9, {
   3.599207311384843*^9, 3.5992073114868484`*^9}, 3.5992690103397336`*^9, {
   3.5992827910749464`*^9, 3.599282791458968*^9}, {3.59928518166168*^9, 
   3.599285181804688*^9}, 3.5992853048017235`*^9, {3.5992853454410477`*^9, 
   3.599285346033081*^9}, 3.5992853887765265`*^9, {3.599285538033063*^9, 
   3.5992855392311316`*^9}, 3.601091903295684*^9, {3.601167080443571*^9, 
   3.6011670826446967`*^9}, 3.601198525134527*^9, {3.601198705004779*^9, 
   3.601198710774787*^9}, {3.601199305175619*^9, 3.6011993061356206`*^9}, {
   3.6011993510556836`*^9, 3.6011993532156863`*^9}, 3.601199471385852*^9, {
   3.6017798982276278`*^9, 3.6017798987616587`*^9}, {3.6018612601272726`*^9, 
   3.6018612602772727`*^9}, {3.601868820440559*^9, 3.601868822890562*^9}, {
   3.6021985076884737`*^9, 3.6021985085584745`*^9}, {3.6021985534385376`*^9, 
   3.6021985539285383`*^9}, {3.6034253094938383`*^9, 3.60342531144695*^9}, {
   3.6047404037817726`*^9, 3.6047404040217733`*^9}, 3.604740828162367*^9, 
   3.604742633440156*^9, {3.6047435886461477`*^9, 3.6047435888851614`*^9}, {
   3.6047437048047915`*^9, 3.6047437049327984`*^9}, {3.604743863427864*^9, 
   3.6047438643959193`*^9}, 3.6047445868037148`*^9, 3.6047458193193965`*^9, {
   3.6047463010909524`*^9, 3.604746305282192*^9}, 3.6047466041612873`*^9, 
   3.604751029034375*^9, {3.6048138419819098`*^9, 3.604813842608946*^9}, {
   3.604820070773555*^9, 3.6048200710635552`*^9}, {3.6053289649830513`*^9, 
   3.6053289659401064`*^9}, {3.605347083773387*^9, 3.6053470840774045`*^9}, {
   3.605410693485302*^9, 3.605410693575302*^9}, {3.6054120859272513`*^9, 
   3.6054120897572565`*^9}, {3.6055109405597353`*^9, 3.6055109418297367`*^9}, 
   3.6055110270998564`*^9, {3.6104252441340866`*^9, 3.610425245325155*^9}, {
   3.611474237855938*^9, 3.6114742382139587`*^9}, {3.6127438591631565`*^9, 
   3.6127438606442413`*^9}, {3.612743927395059*^9, 3.612743928058097*^9}, {
   3.6127441381301126`*^9, 3.6127441382811213`*^9}, {3.6138112948664436`*^9, 
   3.613811295046444*^9}, {3.613827442169612*^9, 3.6138274425686345`*^9}, {
   3.614589178852008*^9, 3.614589179258031*^9}, {3.614591975562543*^9, 
   3.6145919777725463`*^9}, {3.615022307115011*^9, 3.61502230885011*^9}, {
   3.6151908112241507`*^9, 3.6151908146863484`*^9}, {3.615273130562547*^9, 
   3.6152731313855944`*^9}, {3.615273272313655*^9, 3.615273272624673*^9}, {
   3.6152766902661505`*^9, 3.6152766911292*^9}, 3.615277323181351*^9, {
   3.615277414580579*^9, 3.615277415683642*^9}, {3.615277890761815*^9, 
   3.6152778911358366`*^9}, {3.6155396459636774`*^9, 
   3.6155396464197035`*^9}, {3.615539926185705*^9, 3.6155399281528177`*^9}, {
   3.6155401890567408`*^9, 3.6155401915348825`*^9}, {3.6155414556951885`*^9, 
   3.6155414816936755`*^9}, {3.6155416622850046`*^9, 
   3.6155416629330416`*^9}, {3.6185709486768985`*^9, 3.618570949056899*^9}, {
   3.620529918124539*^9, 3.6205299184145555`*^9}, {3.6252928779765196`*^9, 
   3.6252928780405235`*^9}, {3.6252959915636067`*^9, 3.625295992681671*^9}, 
   3.6254646112366514`*^9, {3.6254662281799235`*^9, 3.6254662548629613`*^9}, 
   3.6254665552943835`*^9, {3.6255340102498317`*^9, 3.625534010689832*^9}, 
   3.6264984881272964`*^9, 3.626498540878314*^9, 3.6264986279022913`*^9, 
   3.626498798636057*^9, 3.626499242689455*^9, 3.6264994781519227`*^9, {
   3.6264996304776354`*^9, 3.6264996320307245`*^9}, {3.626686887044775*^9, 
   3.6266868884688563`*^9}, {3.627109181697647*^9, 3.627109183512751*^9}, {
   3.6279787704012947`*^9, 3.627978770544303*^9}, {3.627981611964823*^9, 
   3.6279816130598855`*^9}, {3.628149559179854*^9, 3.628149560611936*^9}, {
   3.6303486227780066`*^9, 3.630348627410201*^9}, 3.630639552333521*^9, {
   3.6306399280428915`*^9, 3.6306399282928915`*^9}, {3.630643609076209*^9, 
   3.6306436098562098`*^9}, {3.6306459917487836`*^9, 3.630645992418784*^9}, 
   3.630646073051228*^9, 3.6306464116012135`*^9, {3.630651439893702*^9, 
   3.630651461590736*^9}, {3.6306568314763374`*^9, 3.630656834966342*^9}, {
   3.6306569040888004`*^9, 3.6306569047188015`*^9}, 3.630660985834161*^9, 
   3.630661366854954*^9, 3.6306626181015215`*^9, 3.630708249826991*^9, 
   3.6307520762402*^9, {3.630757262504176*^9, 3.6307572691355553`*^9}, {
   3.6307679814612656`*^9, 3.6307679828403444`*^9}, {3.6307695136249003`*^9, 
   3.6307695138809147`*^9}, {3.630915652630437*^9, 3.630915669050169*^9}, {
   3.6309255064687076`*^9, 3.6309255068047266`*^9}, {3.6309353603433094`*^9, 
   3.630935360807336*^9}, {3.631368876534875*^9, 3.6313688897016277`*^9}, {
   3.631369069092888*^9, 3.6313690727790995`*^9}, {3.6313693313228865`*^9, 
   3.631369332506955*^9}, 3.6322086596803465`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Red + Blue", "Section",
 Evaluatable->False]], "Section",
 CellChangeTimes->{3.5952190175374594`*^9}],

Cell[CellGroupData[{

Cell["PhononNumberFitting", "Subsection",
 CellChangeTimes->{
  3.595219195554491*^9, {3.6022031439149647`*^9, 3.602203149084972*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Alpha]V", ",", "\[Alpha]Cur"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]V", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Cur", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhononNumberFitting", "[", 
   RowBox[{"blue_List", ",", "red_List", ",", 
    RowBox[{"kmax_:", "15"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"red", ",", "blue", ","}], "*)"}], 
     RowBox[{
     "nred", ",", "nblue", ",", "Ared", ",", "Ablue", ",", "Bred", ",", 
      "Bblue", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", "level",
       ",", "Pk", ",", "p", ",", "Zero", ",", "zero", ",", "Origin", ",", 
      "Pred", ",", "Pblue", ",", "\[Chi]red", ",", "\[Chi]blue", ",", "na", 
      ",", "V", ",", "Cur", ",", "\[Chi]", ",", "result", ",", "distribution",
       ",", "\[Alpha]", ",", "nbar", ",", "fittingred", ",", "fittingblue", 
      ",", "Fred", ",", "Fblue", ",", "dev", ",", "param", ",", "parabolic", 
      ",", "RMS", ",", "rms", ",", "fittingpara", ",", "findpoint", ",", 
      "bestfitting", ",", "bestvalue", ",", "unc", ",", "devlength", ",", 
      "devnumber", ",", "Deviation", ",", "Param", ",", "Parabolic", ",", 
      "pkbestfitting", ",", "pkbestvalue", ",", "DataDeviation", ",", 
      "DataPk", ",", "\[Sigma]\[Chi]", ",", "Uncertain", ",", "interval", ",",
       "finalfitting", ",", "errorBar", ",", "ddev", ",", "normalization", 
      ",", "i", ",", "j", ",", "n", ",", "x", ",", "t", ",", "nik", ",", 
      "K"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nred", "=", 
      RowBox[{"Length", "[", "red", "]"}]}], ";", " ", 
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ared", "=", "0.9"}], ";", " ", 
     RowBox[{"Ablue", "=", "0.9"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bred", "=", "1"}], ";", 
     RowBox[{"Bblue", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalOmega]b", "=", 
      RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], ";", 
     RowBox[{"\[CapitalOmega]r", "=", 
      RowBox[{"\[Pi]", "/", "r\[Pi]fitting"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"level", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Pk", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"p", ",", 
        RowBox[{"kmax", "+", "9"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Zero", "=", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"zero", ",", 
         RowBox[{"kmax", "+", "9"}]}], "]"}], "*", "0"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Origin", "=", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Append", " ", "[", 
                 RowBox[{
                  RowBox[{"Most", "[", 
                   RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", "Zero", "]"}], "]"}], "]"}], "]"}], 
                    "]"}], "]"}], ",", "\[CapitalOmega]r"}], "]"}], ",", 
                "\[CapitalOmega]b"}], "]"}], ",", "Ared"}], "]"}], ",", 
            "Ablue"}], "]"}], ",", "Bred"}], "]"}], ",", "Bblue"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pred", "[", 
       RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "8"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"kmax", "+", "6"}], "]"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox["i"]], 
               RowBox[{"LaguerreL", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "4"}], "]"}], "]"}], " ", "t"}], 
              "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "9"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"kmax", "+", "7"}], "]"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "5"}], "]"}], "]"}], " ", "t"}], 
              "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", "Pk_List", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "nred"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pred", "[", 
              RowBox[{"Pk", ",", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "nblue"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{"Pk", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"nred", "+", "nblue"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"na", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"i", " ", 
        RowBox[{"p", "[", 
         RowBox[{"i", "+", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"i", "-", "na"}], ")"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Cur", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"kmax", "-", "1"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "+", 
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "2"}], "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"p", "[", 
            RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nred", "+", "nblue"}], ")"}], "*", 
            RowBox[{"\[Chi]", "[", "Pk", "]"}]}], "+", 
           RowBox[{"\[Alpha]V", "*", "V"}], "+", 
           RowBox[{"\[Alpha]Cur", "*", "Cur"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], 
              RowBox[{"kmax", "+", "1"}]], 
             RowBox[{"p", "[", "i", "]"}]}], "\[Equal]", "1"}], "&&", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Pk", "\[GreaterEqual]", "Zero"}], "]"}]}], "]"}], "&&", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"Pk", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "]"}], "\[LessEqual]", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
            "]"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "6"}], "]"}], "\[LessEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "7"}], "]"}], "\[LessEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "4"}], "]"}], "\[LessEqual]", " ", 
            RowBox[{"1.1", "*", "\[CapitalOmega]r"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "4"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"0.9", "\[CapitalOmega]r"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "5"}], "]"}], "\[LessEqual]", " ", 
            RowBox[{"1.1", "*", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "5"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"0.9", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "9"}], "]"}], "\[GreaterEqual]", "0"}]}]}], 
         "}"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"Pk", ",", "Origin"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kmax", "+", "1"}], ",", 
          RowBox[{
           RowBox[{"2", "devnumber"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{
           RowBox[{"2", " ", "devnumber"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{
          RowBox[{"Deviation", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "devnumber", "-", "1"}], ")"}], 
              "devlength"}], "devnumber"], 
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"result", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Param", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"param", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}], ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "8"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"parabolic", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RMS", "=", 
            RowBox[{"Array", "[", 
             RowBox[{"rms", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"fittingpara", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"Param", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",", 
           RowBox[{"findpoint", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"result", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{
               RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", 
                RowBox[{"Deviation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
                RowBox[{"FindMinValue", "[", 
                 RowBox[{
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", 
                    RowBox[{"i", "\[Rule]", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"fittingpara", ",", "findpoint"}], "}"}], "]"}]}],
                  "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"Parabolic", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Fit", "[", 
             RowBox[{"RMS", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "x", ",", 
                SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ",", 
           RowBox[{"Clear", "[", 
            RowBox[{"RMS", ",", "fittingpara", ",", "findpoint"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{
          RowBox[{"Parabolic", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestfitting", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestvalue", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"FindArgMin", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"FindMinValue", "[", 
             RowBox[{
              RowBox[{"Parabolic", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "}"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"pkbestfitting", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pkbestfitting", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", "0"}], 
          ",", 
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"result", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalization", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"pkbestfitting", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{
         RowBox[{"Length", "[", "blue", "]"}], "+", 
         RowBox[{"Length", "[", "red", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DataPk", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "8"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nred"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pred", "[", 
            RowBox[{"DataPk", ",", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"red", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"DataPk", ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"unc", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"interval", "=", 
            RowBox[{"x", "/.", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{"pkbestvalue", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", "\[Sigma]\[Chi]"}]}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"finalfitting", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DataPk", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "\[Rule]", 
         " ", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"errorBar", "[", 
        RowBox[{"type_:", "\"\<Rectangle\>\""}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0_", ",", "x1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y0_", ",", "y1_"}], "}"}]}], "}"}], ",", "value_", ",", 
        "meta_"}], "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "error", "}"}], ",", 
        RowBox[{
         RowBox[{"error", "=", 
          RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"error", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"error", "===", 
             RowBox[{"{", "}"}]}], ",", "0", ",", 
            RowBox[{"Last", "[", "error", "]"}]}], "]"}]}], ";", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ChartElementData", "[", "type", "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x0", ",", "x1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y0", ",", "y1"}], "}"}]}], "}"}], ",", "value", ",", 
             "meta"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}]}], "}"}]}], "}"}], 
              "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fittingred", "=", 
      RowBox[{"Pred", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"pkbestfitting", "/", "normalization"}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "8"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"pkbestfitting", "/", "normalization"}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "8"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fred", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingred", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"red", "[", 
           RowBox[{"[", 
            RowBox[{"nred", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Red"}], "}"}]}], 
        ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"distribution", "+", 
       RowBox[{"error", " ", "bar"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"(*", 
       RowBox[{"\"\<Distribution \>\"", ","}], "*)"}], 
      RowBox[{
       RowBox[{"finalfitting", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MatrixForm"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"(*", 
       RowBox[{"\"\<Error Bar \>\"", ","}], "*)"}], " ", 
      RowBox[{
       RowBox[{"finalfitting", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "MatrixForm"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"kmax", "+", "5"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(1, \(-1\)\)]\) = \>\"", 
       ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"kmax", "+", "4"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"finalfitting", ",", 
        RowBox[{"ChartElementFunction", "\[Rule]", 
         RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"List", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"Fred", ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"red", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"Fblue", ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"blue", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "]"}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.592543297333493*^9, 3.5925433915788836`*^9}, {
   3.592543425873845*^9, 3.592543591488318*^9}, 3.5925436394920635`*^9, {
   3.5925437084360065`*^9, 3.592543733155421*^9}, {3.5925437655862756`*^9, 
   3.5925438493180647`*^9}, {3.5925438942046323`*^9, 
   3.5925440305414305`*^9}, {3.5925443182328854`*^9, 3.592544320078991*^9}, 
   3.5925444067999516`*^9, {3.5925451192427006`*^9, 3.5925451351596107`*^9}, 
   3.592545253496379*^9, 3.5925455950069127`*^9, {3.592546442159367*^9, 
   3.5925465834804497`*^9}, {3.592546616297327*^9, 3.5925466166903496`*^9}, 
   3.5925468427033606`*^9, {3.5925469085761285`*^9, 3.5925469562568555`*^9}, {
   3.5925471063233547`*^9, 3.592547106518366*^9}, {3.5925471489727945`*^9, 
   3.5925471966445208`*^9}, {3.5925473605499797`*^9, 
   3.5925473984201455`*^9}, {3.592785372070339*^9, 3.5927854679598236`*^9}, {
   3.5927888360355034`*^9, 3.592788852651454*^9}, {3.592788918026193*^9, 
   3.59278901587779*^9}, {3.592834068944092*^9, 3.592834125255313*^9}, {
   3.592834275844926*^9, 3.592834291685832*^9}, {3.592834331790126*^9, 
   3.592834337469451*^9}, {3.592886199038349*^9, 3.592886228285022*^9}, {
   3.592886308029583*^9, 3.592886315380003*^9}, {3.5933902924877415`*^9, 
   3.5933903509501853`*^9}, {3.5933904652768793`*^9, 3.593390476142257*^9}, {
   3.5933905738806686`*^9, 3.5933905758869305`*^9}, {3.5933906077119665`*^9, 
   3.5933906777708707`*^9}, {3.5933907147255683`*^9, 
   3.5933908675189877`*^9}, {3.5933909219009*^9, 3.593390947415141*^9}, {
   3.593390995588279*^9, 3.593391035371323*^9}, {3.593391087640977*^9, 
   3.5933910950079*^9}, {3.5933911345509396`*^9, 3.593391186303503*^9}, {
   3.5933912191816826`*^9, 3.593391429392412*^9}, {3.5933923218227634`*^9, 
   3.593392340323117*^9}, {3.593392392530753*^9, 3.593392455854799*^9}, {
   3.593392501994664*^9, 3.5933926531918793`*^9}, {3.593392709329015*^9, 
   3.593392736635486*^9}, {3.59339300189321*^9, 3.5933930282755575`*^9}, {
   3.5933930654182725`*^9, 3.5933932416346817`*^9}, {3.5933933156150703`*^9, 
   3.593393372503314*^9}, {3.593393418091096*^9, 3.593393514270331*^9}, {
   3.5933935445991864`*^9, 3.593393636243828*^9}, {3.5933937042884817`*^9, 
   3.5933937307958374`*^9}, {3.5933938220794525`*^9, 3.5933939412566*^9}, {
   3.593393979796497*^9, 3.5933940727023053`*^9}, 3.5933942734748096`*^9, {
   3.593395700765211*^9, 3.5933957359306912`*^9}, {3.5933961481600842`*^9, 
   3.593396159536519*^9}, 3.593398360590062*^9, {3.593748299970694*^9, 
   3.5937483262725625`*^9}, {3.5937483564589005`*^9, 
   3.5937484001081543`*^9}, {3.594354332142893*^9, 3.5943543517260127`*^9}, {
   3.5943544146956143`*^9, 3.594354616354604*^9}, {3.5943546950140586`*^9, 
   3.5943547271438656`*^9}, 3.5943572287652807`*^9, {3.5943580322375903`*^9, 
   3.5943580383239355`*^9}, {3.5943582498378468`*^9, 3.594358254344103*^9}, {
   3.594358849252713*^9, 3.594358856077103*^9}, 3.594358953562601*^9, 
   3.5943589890136137`*^9, {3.594359020317359*^9, 3.594359020452367*^9}, {
   3.5943591018539677`*^9, 3.5943591309655733`*^9}, {3.5943637440542836`*^9, 
   3.594363746254287*^9}, {3.594429930988577*^9, 3.5944299446483583`*^9}, 
   3.5944304004854307`*^9, 3.5945991470990067`*^9, 3.594599195014747*^9, {
   3.594599416026388*^9, 3.594599429010131*^9}, {3.59459953844139*^9, 
   3.5945995504960794`*^9}, {3.5945997072520456`*^9, 
   3.5945997073960543`*^9}, {3.594599852125332*^9, 3.594599856412577*^9}, 
   3.594599989831208*^9, 3.5946133421949196`*^9, 3.5946134411305785`*^9, {
   3.594613489896368*^9, 3.5946135533599977`*^9}, {3.594613712120078*^9, 
   3.5946137245517893`*^9}, {3.594613776505761*^9, 3.5946137837601757`*^9}, {
   3.5946138634947367`*^9, 3.5946138666629176`*^9}, {3.5946139028179855`*^9, 
   3.5946139519117937`*^9}, 3.5946140719216576`*^9, {3.594614102615413*^9, 
   3.5946141367323647`*^9}, 3.5946142107045956`*^9, {3.5946142474536977`*^9, 
   3.594614269800976*^9}, 3.594614406133774*^9, {3.5946144372205515`*^9, 
   3.594614466621233*^9}, {3.594614511405795*^9, 3.5946145382723317`*^9}, 
   3.5946146741921053`*^9, {3.59461470678897*^9, 3.5946147199407225`*^9}, {
   3.594615007422165*^9, 3.5946150101323204`*^9}, 3.594615073279932*^9, {
   3.594615581716013*^9, 3.5946156153109345`*^9}, {3.5946158667713175`*^9, 
   3.5946158671723404`*^9}, {3.5946160693939066`*^9, 3.594616069553916*^9}, {
   3.5946163795446463`*^9, 3.5946163844799285`*^9}, {3.5946164672816644`*^9, 
   3.594616468487734*^9}, {3.594616519172632*^9, 3.5946165451581187`*^9}, {
   3.5946819552304287`*^9, 3.5946819934356647`*^9}, {3.594682395583123*^9, 
   3.5946823957231236`*^9}, {3.594682467895529*^9, 3.5946825355378385`*^9}, {
   3.5946825708741446`*^9, 3.59468257524415*^9}, {3.5946828781490707`*^9, 
   3.594682878369071*^9}, {3.594683839359455*^9, 3.594683842169459*^9}, {
   3.5946839669232635`*^9, 3.594683969853267*^9}, {3.5946850046756744`*^9, 
   3.594685005322712*^9}, 3.595213663291051*^9, {3.5952138971524887`*^9, 
   3.5952138991524916`*^9}, 3.59581530772236*^9, {3.595911314898021*^9, 
   3.5959113212891693`*^9}, {3.59591139631846*^9, 3.5959114278527374`*^9}, {
   3.5963441081548634`*^9, 3.596344123884763*^9}, {3.5963441574776845`*^9, 
   3.5963441616609235`*^9}, {3.5963442344050846`*^9, 
   3.5963442352681336`*^9}, {3.596344296027609*^9, 3.5963443106414447`*^9}, {
   3.596344387604847*^9, 3.596344387748855*^9}, {3.5963445844811077`*^9, 
   3.596344600838043*^9}, {3.5963452929976325`*^9, 3.596345293180643*^9}, {
   3.59634538387683*^9, 3.596345383987837*^9}, 3.596345814015433*^9, {
   3.5963458699346313`*^9, 3.5963458797931952`*^9}, {3.5963461492746086`*^9, 
   3.596346186977765*^9}, {3.5963470746845393`*^9, 3.596347105739315*^9}, {
   3.5963484102409286`*^9, 3.5963484362144136`*^9}, {3.596349542169671*^9, 
   3.596349542288678*^9}, {3.5964105197529545`*^9, 3.596410525382962*^9}, {
   3.596410689577893*^9, 3.596410693287898*^9}, {3.596410739340171*^9, 
   3.596410741250173*^9}, {3.596410781574486*^9, 3.5964107821544867`*^9}, {
   3.5964109906767583`*^9, 3.596410991885827*^9}, {3.5964110595232973`*^9, 
   3.596411060603299*^9}, {3.596411329667982*^9, 3.5964114288494034`*^9}, {
   3.596411524568003*^9, 3.5964115266980057`*^9}, {3.596411622746629*^9, 
   3.5964116229866295`*^9}, {3.5964116740889792`*^9, 3.59641167460898*^9}, {
   3.5964118965432105`*^9, 3.5964118972932115`*^9}, {3.5964119644966683`*^9, 
   3.5964119653966694`*^9}, {3.596411998258865*^9, 3.596412003088872*^9}, {
   3.596412037280115*^9, 3.596412037950116*^9}, {3.596412256305433*^9, 
   3.5964122633054423`*^9}, {3.5964128089696856`*^9, 3.596412815382902*^9}, {
   3.5964130646423683`*^9, 3.596413065262369*^9}, {3.596413543417215*^9, 
   3.596413545567218*^9}, {3.5964137555105505`*^9, 3.59641376487171*^9}, {
   3.596413847369259*^9, 3.5964138480292597`*^9}, {3.596414305758043*^9, 
   3.596414308878047*^9}, {3.5964146217667313`*^9, 3.5964146221567316`*^9}, {
   3.596414733232377*^9, 3.596414733682378*^9}, {3.5964148680741158`*^9, 
   3.5964148769382906`*^9}, {3.5964149899569387`*^9, 
   3.5964149969169483`*^9}, {3.596415111610674*^9, 3.5964151149706783`*^9}, {
   3.596415178564151*^9, 3.596415179574152*^9}, {3.5964152554856606`*^9, 
   3.596415256005661*^9}, {3.596415346172209*^9, 3.596415346282209*^9}, {
   3.596415438341608*^9, 3.596415448991623*^9}, {3.5964156572868934`*^9, 
   3.5964156737891607`*^9}, {3.59641575806262*^9, 3.596415758472621*^9}, {
   3.5964158573031197`*^9, 3.5964158611131253`*^9}, {3.5964159840889387`*^9, 
   3.59641598465894*^9}, {3.596419162135954*^9, 3.5964191627959547`*^9}, 
   3.596424630698441*^9, {3.5964246913127565`*^9, 3.596424692412758*^9}, {
   3.596424729313087*^9, 3.596424730173088*^9}, {3.5964259510584545`*^9, 
   3.5964259512984548`*^9}, {3.5964260294158363`*^9, 
   3.5964260296278486`*^9}, {3.5964261252525167`*^9, 
   3.5964261266525183`*^9}, {3.5964262202760053`*^9, 3.5964262213260064`*^9}, 
   3.596426315545514*^9, 3.596426416711233*^9, {3.5964264876958313`*^9, 
   3.596426491583844*^9}, {3.5964265729103127`*^9, 3.5964265814803247`*^9}, {
   3.6017799223980103`*^9, 3.6017799379879017`*^9}, {3.601780012504164*^9, 
   3.601780032943333*^9}, {3.6017803139614067`*^9, 3.6017803169525776`*^9}, {
   3.6022032047050495`*^9, 3.60220321910507*^9}, {3.6022033715852833`*^9, 
   3.6022035673655577`*^9}, {3.6022036645456934`*^9, 3.602203667365698*^9}, {
   3.6022040566862426`*^9, 3.602204063286252*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["CoherentStateFitting", "Subsection",
 CellChangeTimes->{3.5952191701144557`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoherentStateFitting", "[", 
   RowBox[{"blue_List", ",", "red_List", ",", "\[Alpha]startpoint_", ",", 
    RowBox[{"kmax_:", "10"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"red", ",", "blue", ","}], "*)"}], 
     RowBox[{
     "nred", ",", "nblue", ",", "Pred", ",", "Pblue", ",", "\[Chi]", ",", 
      "result", ",", "distribution", ",", "fittingred", ",", "fittingblue", 
      ",", "Fred", ",", "Fblue", ",", "\[Alpha]", ",", "Ar", ",", "Ab", ",", 
      "Br", ",", "Bb", ",", "\[Lambda]r", ",", "\[Lambda]b", ",", 
      "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", "pk", ",", "i", ",", 
      "t", ",", "devlength", ",", "devnumber", ",", "Deviation", ",", "dev", 
      ",", "RMS", ",", "rms", ",", "Parabolic", ",", "pkbestfitting", ",", 
      "pkbestvalue", ",", "x", ",", "DataDeviation", ",", "ddev", ",", 
      "DataPk", ",", "normalization", ",", "n", ",", "j", ",", 
      "\[Sigma]\[Chi]", ",", "interval", ",", "Uncertain"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"red", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"redname", ",", "S1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nred", "=", 
      RowBox[{"Length", "[", "red", "]"}]}], ";", 
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"Pred", "[", 
       RowBox[{
       "\[Alpha]_", ",", "Ared_", ",", "Bred_", ",", "\[Lambda]red_", ",", 
        "\[CapitalOmega]red_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              SuperscriptBox["\[Alpha]", "2"], ")"}], "i"], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              SuperscriptBox["\[Alpha]", "2"]}]]}], 
           RowBox[{
            RowBox[{"(", "i", ")"}], "!"}]], "*", 
          RowBox[{"(", 
           RowBox[{"Bred", "-", 
            RowBox[{"Ared", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]red"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox["i"]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]red", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{
       "\[Alpha]_", ",", "Ablue_", ",", "Bblue_", ",", "\[Lambda]blue_", ",", 
        "\[CapitalOmega]blue_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              SuperscriptBox["\[Alpha]", "2"], ")"}], "i"], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              SuperscriptBox["\[Alpha]", "2"]}]]}], 
           RowBox[{
            RowBox[{"(", "i", ")"}], "!"}]], "*", 
          RowBox[{"(", 
           RowBox[{"Bblue", "-", 
            RowBox[{"Ablue", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]blue"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]blue", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{
       "\[Alpha]_", ",", "Ar_", ",", "Ab_", ",", "Br_", ",", "Bb_", ",", 
        "\[Lambda]r_", ",", "\[Lambda]b_", ",", "\[CapitalOmega]r_", ",", 
        "\[CapitalOmega]b_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "nred"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pred", "[", 
              RowBox[{
              "\[Alpha]", ",", "Ar", ",", "Br", ",", "\[Lambda]r", ",", 
               "\[CapitalOmega]r", ",", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "nblue"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{
              "\[Alpha]", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
               "\[CapitalOmega]b", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"nred", "+", "nblue"}], ")"}]}]}], ";", "\n", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Chi]", "[", 
           RowBox[{
           "\[Alpha]", ",", "Ar", ",", "Ab", ",", "Br", ",", "Bb", ",", 
            "\[Lambda]r", ",", "\[Lambda]b", ",", "\[CapitalOmega]r", ",", 
            "\[CapitalOmega]b"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Alpha]", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"\[Lambda]r", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[Lambda]b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[CapitalOmega]r", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[CapitalOmega]b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"Ar", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ab", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ar", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Ab", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Br", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"Bb", "\[GreaterEqual]", "0"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "\[Alpha]startpoint"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ar", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ab", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Br", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Bb", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]r", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]b", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]r", ",", 
          RowBox[{"\[Pi]", "/", "r\[Pi]fitting"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]b", ",", 
          RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Deviation", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "devnumber", "-", "1"}], ")"}], " ", 
            "devlength", " "}], "devnumber"], "*", 
          RowBox[{"result", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{"result", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RMS", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"rms", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
          RowBox[{"Deviation", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"FindMinValue", "[", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{
              RowBox[{"Deviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Ar", ",", "Ab", ",", 
              "Br", ",", "Bb", ",", "\[Lambda]r", ",", "\[Lambda]b", ",", 
              "\[CapitalOmega]r", ",", "\[CapitalOmega]b"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ar", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ab", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Br", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Bb", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]r", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]r", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "8", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "9", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Fit", "[", 
       RowBox[{"RMS", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x", ",", 
          SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{
       RowBox[{"FindArgMin", "[", 
        RowBox[{"Parabolic", ",", "x"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"FindMinValue", "[", 
       RowBox[{"Parabolic", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{
         RowBox[{"Length", "[", "blue", "]"}], "+", 
         RowBox[{"Length", "[", "red", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nred"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pred", "[", 
            RowBox[{"pkbestfitting", ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "8", "]"}], "]"}], ",", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"red", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"pkbestfitting", ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "7", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "9", "]"}], "]"}], ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interval", "=", 
      RowBox[{"x", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{"Parabolic", "\[Equal]", 
         RowBox[{"pkbestvalue", "+", "\[Sigma]\[Chi]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "pkbestfitting"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "pkbestfitting"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"distribution", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"pk", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"result", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"distribution", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            SuperscriptBox[
             RowBox[{"(", "pkbestfitting", ")"}], "2"], ")"}], 
           RowBox[{"i", "-", "1"}]], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", "pkbestfitting", ")"}], "2"]}]]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "!"}]]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingred", "=", 
      RowBox[{"Pred", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "8", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "7", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "9", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fred", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingred", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"red", "[", 
           RowBox[{"[", 
            RowBox[{"nred", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Red"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Red Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(1, \(-1\)\)]\) = \>\"", 
       ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Alpha] = \>\"", ",", "pkbestfitting", ",", 
       "\"\< \[PlusMinus] \>\"", ",", "Uncertain"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"distribution", ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"List", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"Fred", ",", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"red", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"Fblue", ",", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"blue", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "]"}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5933867976409025`*^9, 3.593386800423719*^9}, {
   3.5933868616337*^9, 3.5933868924932995`*^9}, {3.593387091793706*^9, 
   3.59338711781283*^9}, {3.593387850012907*^9, 3.5933880802058783`*^9}, {
   3.593388122516448*^9, 3.5933881629173613`*^9}, {3.593388197299399*^9, 
   3.5933882097795506`*^9}, {3.593388657798051*^9, 3.5933886624937*^9}, {
   3.5933887931607003`*^9, 3.5933888011011977`*^9}, {3.593395187093926*^9, 
   3.593395206588404*^9}, {3.5933952890358934`*^9, 3.59339529162322*^9}, {
   3.59339533394759*^9, 3.5933953353457813`*^9}, {3.593395473241294*^9, 
   3.593395510068983*^9}, {3.593396148159073*^9, 3.593396159536519*^9}, {
   3.594354844038484*^9, 3.5943550474829335`*^9}, {3.594355103045064*^9, 
   3.5943553131328335`*^9}, {3.5943553644127307`*^9, 3.59435542026191*^9}, {
   3.594355468856679*^9, 3.594355605280321*^9}, {3.5943556667618017`*^9, 
   3.594355967932458*^9}, {3.5943560129829454`*^9, 3.594356152753182*^9}, {
   3.5943564315884504`*^9, 3.594356431738451*^9}, {3.5943566213188443`*^9, 
   3.5943566217288446`*^9}, {3.594356810534103*^9, 3.5943568125641055`*^9}, {
   3.5943568617524734`*^9, 3.594356863834563*^9}, {3.5943568943346057`*^9, 
   3.5943568960546083`*^9}, 3.594357216175263*^9, 3.5946142107045956`*^9, 
   3.59461485206728*^9, {3.5952082321704226`*^9, 3.5952082564594607`*^9}, {
   3.5952136978442593`*^9, 3.595213751613595*^9}, {3.5952138737524557`*^9, 
   3.5952138765924597`*^9}, {3.5952220260187807`*^9, 3.5952220362787952`*^9}, 
   3.59581529349234*^9, {3.595911262805786*^9, 3.595911283407977*^9}, {
   3.602202362373871*^9, 3.602202602984207*^9}, {3.6022027068243527`*^9, 
   3.602202711354359*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["SqueezedStateFitting", "Subsection",
 CellChangeTimes->{
  3.5952191701144557`*^9, {3.602202627614242*^9, 3.6022026305442457`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SqueezedStateFitting", "[", 
   RowBox[{"blue_List", ",", "red_List", ",", "rstartpoint_", ",", 
    RowBox[{"kmax_:", "10"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"red", ",", "blue", ","}], "*)"}], 
     RowBox[{
     "nred", ",", "nblue", ",", "Pred", ",", "Pblue", ",", "\[Chi]", ",", 
      "result", ",", "distribution", ",", "fittingred", ",", "fittingblue", 
      ",", "Fred", ",", "Fblue", ",", "r", ",", "Ar", ",", "Ab", ",", "Br", 
      ",", "Bb", ",", "\[Lambda]r", ",", "\[Lambda]b", ",", 
      "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", "pk", ",", "i", ",", 
      "t", ",", "devlength", ",", "devnumber", ",", "Deviation", ",", "dev", 
      ",", "RMS", ",", "rms", ",", "Parabolic", ",", "pkbestfitting", ",", 
      "pkbestvalue", ",", "x", ",", "DataDeviation", ",", "ddev", ",", 
      "DataPk", ",", "normalization", ",", "n", ",", "j", ",", 
      "\[Sigma]\[Chi]", ",", "interval", ",", "Uncertain"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"red", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"redname", ",", "S1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nred", "=", 
      RowBox[{"Length", "[", "red", "]"}]}], ";", 
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"Pred", "[", 
       RowBox[{
       "r_", ",", "Ared_", ",", "Bred_", ",", "\[Lambda]red_", ",", 
        "\[CapitalOmega]red_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"N", "[", 
            RowBox[{"Cosh", "[", "r", "]"}], "]"}]], 
          FractionBox[
           RowBox[{"i", "!"}], 
           RowBox[{
            SuperscriptBox["2", "i"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "/", "2"}], ")"}], "!"}], ")"}], "2"]}]], 
          RowBox[{"N", "[", 
           SuperscriptBox[
            RowBox[{"Tanh", "[", "r", "]"}], "i"], "]"}], 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "i"]}], ")"}], "2"], "*", 
          RowBox[{"(", 
           RowBox[{"Bred", "-", 
            RowBox[{"Ared", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]red"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox["i"]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]red", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{
       "r_", ",", "Ablue_", ",", "Bblue_", ",", "\[Lambda]blue_", ",", 
        "\[CapitalOmega]blue_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"N", "[", 
            RowBox[{"Cosh", "[", "r", "]"}], "]"}]], 
          FractionBox[
           RowBox[{"i", "!"}], 
           RowBox[{
            SuperscriptBox["2", "i"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "/", "2"}], ")"}], "!"}], ")"}], "2"]}]], 
          RowBox[{"N", "[", 
           SuperscriptBox[
            RowBox[{"Tanh", "[", "r", "]"}], "i"], "]"}], 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "i"]}], ")"}], "2"], "*", 
          RowBox[{"(", 
           RowBox[{"Bblue", "-", 
            RowBox[{"Ablue", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]blue"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]blue", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{
       "r_", ",", "Ar_", ",", "Ab_", ",", "Br_", ",", "Bb_", ",", 
        "\[Lambda]r_", ",", "\[Lambda]b_", ",", "\[CapitalOmega]r_", ",", 
        "\[CapitalOmega]b_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "nred"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pred", "[", 
              RowBox[{
              "r", ",", "Ar", ",", "Br", ",", "\[Lambda]r", ",", 
               "\[CapitalOmega]r", ",", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "nblue"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{
              "r", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
               "\[CapitalOmega]b", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"nred", "+", "nblue"}], ")"}]}]}], ";", "\n", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Chi]", "[", 
           RowBox[{
           "r", ",", "Ar", ",", "Ab", ",", "Br", ",", "Bb", ",", "\[Lambda]r",
             ",", "\[Lambda]b", ",", "\[CapitalOmega]r", ",", 
            "\[CapitalOmega]b"}], "]"}], ",", 
          RowBox[{
           RowBox[{"r", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"\[Lambda]r", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[Lambda]b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[CapitalOmega]r", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[CapitalOmega]b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"Ar", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ab", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ar", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Ab", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Br", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"Bb", "\[GreaterEqual]", "0"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "rstartpoint"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ar", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ab", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Br", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Bb", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]r", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]b", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]r", ",", 
          RowBox[{"\[Pi]", "/", "r\[Pi]fitting"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]b", ",", 
          RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Deviation", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "devnumber", "-", "1"}], ")"}], " ", 
            "devlength", " "}], "devnumber"], "*", 
          RowBox[{"result", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{"result", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RMS", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"rms", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
          RowBox[{"Deviation", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"FindMinValue", "[", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{
              RowBox[{"Deviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Ar", ",", "Ab", ",", 
              "Br", ",", "Bb", ",", "\[Lambda]r", ",", "\[Lambda]b", ",", 
              "\[CapitalOmega]r", ",", "\[CapitalOmega]b"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ar", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ab", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Br", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Bb", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]r", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]r", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "8", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "9", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Fit", "[", 
       RowBox[{"RMS", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x", ",", 
          SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{
       RowBox[{"FindArgMin", "[", 
        RowBox[{"Parabolic", ",", "x"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"FindMinValue", "[", 
       RowBox[{"Parabolic", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{
         RowBox[{"Length", "[", "blue", "]"}], "+", 
         RowBox[{"Length", "[", "red", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nred"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pred", "[", 
            RowBox[{"pkbestfitting", ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "8", "]"}], "]"}], ",", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"red", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"pkbestfitting", ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "7", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "9", "]"}], "]"}], ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interval", "=", 
      RowBox[{"x", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{"Parabolic", "\[Equal]", 
         RowBox[{"pkbestvalue", "+", "\[Sigma]\[Chi]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "pkbestfitting"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "pkbestfitting"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"distribution", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"pk", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"result", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "\[LessEqual]", "kmax"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"distribution", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"N", "[", 
           RowBox[{"Cosh", "[", "pkbestfitting", "]"}], "]"}]], 
         FractionBox[
          RowBox[{"i", "!"}], 
          RowBox[{
           SuperscriptBox["2", "i"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "/", "2"}], ")"}], "!"}], ")"}], "2"]}]], 
         RowBox[{"N", "[", 
          SuperscriptBox[
           RowBox[{"Tanh", "[", "pkbestfitting", "]"}], "i"], "]"}], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "i"]}], ")"}], "2"]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fittingred", "=", 
      RowBox[{"Pred", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "8", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "7", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "9", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fred", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingred", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"red", "[", 
           RowBox[{"[", 
            RowBox[{"nred", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Red"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Red Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(1, \(-1\)\)]\) = \>\"", 
       ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<r = \>\"", ",", "pkbestfitting", ",", "\"\< \[PlusMinus] \>\"", 
       ",", "Uncertain"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"distribution", ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"List", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"Fred", ",", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"red", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"Fblue", ",", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"blue", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "]"}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5933867976409025`*^9, 3.593386800423719*^9}, {
   3.5933868616337*^9, 3.5933868924932995`*^9}, {3.593387091793706*^9, 
   3.59338711781283*^9}, {3.593387850012907*^9, 3.5933880802058783`*^9}, {
   3.593388122516448*^9, 3.5933881629173613`*^9}, {3.593388197299399*^9, 
   3.5933882097795506`*^9}, {3.593388657798051*^9, 3.5933886624937*^9}, {
   3.5933887931607003`*^9, 3.5933888011011977`*^9}, {3.593395187093926*^9, 
   3.593395206588404*^9}, {3.5933952890358934`*^9, 3.59339529162322*^9}, {
   3.59339533394759*^9, 3.5933953353457813`*^9}, {3.593395473241294*^9, 
   3.593395510068983*^9}, {3.593396148159073*^9, 3.593396159536519*^9}, {
   3.594354844038484*^9, 3.5943550474829335`*^9}, {3.594355103045064*^9, 
   3.5943553131328335`*^9}, {3.5943553644127307`*^9, 3.59435542026191*^9}, {
   3.594355468856679*^9, 3.594355605280321*^9}, {3.5943556667618017`*^9, 
   3.594355967932458*^9}, {3.5943560129829454`*^9, 3.594356152753182*^9}, {
   3.5943564315884504`*^9, 3.594356431738451*^9}, {3.5943566213188443`*^9, 
   3.5943566217288446`*^9}, {3.594356810534103*^9, 3.5943568125641055`*^9}, {
   3.5943568617524734`*^9, 3.594356863834563*^9}, {3.5943568943346057`*^9, 
   3.5943568960546083`*^9}, 3.594357216175263*^9, 3.5946142107045956`*^9, 
   3.59461485206728*^9, {3.5952082321704226`*^9, 3.5952082564594607`*^9}, {
   3.5952136978442593`*^9, 3.595213751613595*^9}, {3.5952138737524557`*^9, 
   3.5952138765924597`*^9}, {3.5952220260187807`*^9, 3.5952220362787952`*^9}, 
   3.59581529349234*^9, {3.595911262805786*^9, 3.595911283407977*^9}, {
   3.602202362373871*^9, 3.602202602984207*^9}, {3.6022026556442814`*^9, 
   3.6022026948743362`*^9}, {3.602202878014592*^9, 3.6022029560247016`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["ThermalStateFitting", "Subsection",
 CellChangeTimes->{
  3.5952191701144557`*^9, {3.602202634024251*^9, 3.6022026384242573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ThermalStateFitting", "[", 
   RowBox[{"blue_List", ",", "red_List", ",", "nbarstartpoint_", ",", 
    RowBox[{"kmax_:", "10"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"red", ",", "blue", ","}], "*)"}], 
     RowBox[{
     "nred", ",", "nblue", ",", "Pred", ",", "Pblue", ",", "\[Chi]", ",", 
      "result", ",", "distribution", ",", "fittingred", ",", "fittingblue", 
      ",", "Fred", ",", "Fblue", ",", "nbar", ",", "Ar", ",", "Ab", ",", "Br",
       ",", "Bb", ",", "\[Lambda]r", ",", "\[Lambda]b", ",", 
      "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", "pk", ",", "i", ",", 
      "t", ",", "devlength", ",", "devnumber", ",", "Deviation", ",", "dev", 
      ",", "RMS", ",", "rms", ",", "Parabolic", ",", "pkbestfitting", ",", 
      "pkbestvalue", ",", "x", ",", "DataDeviation", ",", "ddev", ",", 
      "DataPk", ",", "normalization", ",", "n", ",", "j", ",", 
      "\[Sigma]\[Chi]", ",", "interval", ",", "Uncertain"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"red", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"redname", ",", "S1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nred", "=", 
      RowBox[{"Length", "[", "red", "]"}]}], ";", 
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"Pred", "[", 
       RowBox[{
       "nbar_", ",", "Ared_", ",", "Bred_", ",", "\[Lambda]red_", ",", 
        "\[CapitalOmega]red_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox["nbar", "i"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "nbar"}], ")"}], 
            RowBox[{"i", "+", "1"}]]], "*", 
          RowBox[{"(", 
           RowBox[{"Bred", "-", 
            RowBox[{"Ared", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]red"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox["i"]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]red", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{
       "nbar_", ",", "Ablue_", ",", "Bblue_", ",", "\[Lambda]blue_", ",", 
        "\[CapitalOmega]blue_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox["nbar", "i"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "nbar"}], ")"}], 
            RowBox[{"i", "+", "1"}]]], "*", 
          RowBox[{"(", 
           RowBox[{"Bblue", "-", 
            RowBox[{"Ablue", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]blue"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]blue", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{
       "nbar_", ",", "Ar_", ",", "Ab_", ",", "Br_", ",", "Bb_", ",", 
        "\[Lambda]r_", ",", "\[Lambda]b_", ",", "\[CapitalOmega]r_", ",", 
        "\[CapitalOmega]b_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "nred"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pred", "[", 
              RowBox[{
              "nbar", ",", "Ar", ",", "Br", ",", "\[Lambda]r", ",", 
               "\[CapitalOmega]r", ",", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "nblue"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{
              "nbar", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
               "\[CapitalOmega]b", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"nred", "+", "nblue"}], ")"}]}]}], ";", "\n", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Chi]", "[", 
           RowBox[{
           "nbar", ",", "Ar", ",", "Ab", ",", "Br", ",", "Bb", ",", 
            "\[Lambda]r", ",", "\[Lambda]b", ",", "\[CapitalOmega]r", ",", 
            "\[CapitalOmega]b"}], "]"}], ",", 
          RowBox[{
           RowBox[{"nbar", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"\[Lambda]r", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[Lambda]b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[CapitalOmega]r", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[CapitalOmega]b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"Ar", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ab", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ar", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Ab", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Br", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"Bb", "\[GreaterEqual]", "0"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nbar", ",", "nbarstartpoint"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ar", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ab", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Br", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Bb", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]r", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]b", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]r", ",", 
          RowBox[{"\[Pi]", "/", "r\[Pi]fitting"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]b", ",", 
          RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Deviation", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "devnumber", "-", "1"}], ")"}], " ", 
            "devlength", " "}], "devnumber"], "*", 
          RowBox[{"result", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{"result", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RMS", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"rms", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
          RowBox[{"Deviation", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"FindMinValue", "[", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{
              RowBox[{"Deviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Ar", ",", "Ab", ",", 
              "Br", ",", "Bb", ",", "\[Lambda]r", ",", "\[Lambda]b", ",", 
              "\[CapitalOmega]r", ",", "\[CapitalOmega]b"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ar", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ab", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Br", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Bb", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]r", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]r", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "8", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "9", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Fit", "[", 
       RowBox[{"RMS", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x", ",", 
          SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{
       RowBox[{"FindArgMin", "[", 
        RowBox[{"Parabolic", ",", "x"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"FindMinValue", "[", 
       RowBox[{"Parabolic", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{
         RowBox[{"Length", "[", "blue", "]"}], "+", 
         RowBox[{"Length", "[", "red", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nred"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pred", "[", 
            RowBox[{"pkbestfitting", ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "8", "]"}], "]"}], ",", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"red", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"pkbestfitting", ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "7", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "9", "]"}], "]"}], ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interval", "=", 
      RowBox[{"x", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{"Parabolic", "\[Equal]", 
         RowBox[{"pkbestvalue", "+", "\[Sigma]\[Chi]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "pkbestfitting"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "pkbestfitting"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"distribution", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"pk", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"result", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "\[LessEqual]", "kmax"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"distribution", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        FractionBox[
         SuperscriptBox["pkbestfitting", "i"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "pkbestfitting"}], ")"}], 
          RowBox[{"i", "+", "1"}]]]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fittingred", "=", 
      RowBox[{"Pred", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "8", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "7", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "9", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fred", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingred", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"red", "[", 
           RowBox[{"[", 
            RowBox[{"nred", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Red"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Red Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(1, \(-1\)\)]\) = \>\"", 
       ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<<n> = \>\"", ",", "pkbestfitting", ",", "\"\< \[PlusMinus] \>\"", 
       ",", "Uncertain"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"distribution", ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"List", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"Fred", ",", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"red", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"Fblue", ",", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"blue", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "]"}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5933867976409025`*^9, 3.593386800423719*^9}, {
   3.5933868616337*^9, 3.5933868924932995`*^9}, {3.593387091793706*^9, 
   3.59338711781283*^9}, {3.593387850012907*^9, 3.5933880802058783`*^9}, {
   3.593388122516448*^9, 3.5933881629173613`*^9}, {3.593388197299399*^9, 
   3.5933882097795506`*^9}, {3.593388657798051*^9, 3.5933886624937*^9}, {
   3.5933887931607003`*^9, 3.5933888011011977`*^9}, {3.593395187093926*^9, 
   3.593395206588404*^9}, {3.5933952890358934`*^9, 3.59339529162322*^9}, {
   3.59339533394759*^9, 3.5933953353457813`*^9}, {3.593395473241294*^9, 
   3.593395510068983*^9}, {3.593396148159073*^9, 3.593396159536519*^9}, {
   3.594354844038484*^9, 3.5943550474829335`*^9}, {3.594355103045064*^9, 
   3.5943553131328335`*^9}, {3.5943553644127307`*^9, 3.59435542026191*^9}, {
   3.594355468856679*^9, 3.594355605280321*^9}, {3.5943556667618017`*^9, 
   3.594355967932458*^9}, {3.5943560129829454`*^9, 3.594356152753182*^9}, {
   3.5943564315884504`*^9, 3.594356431738451*^9}, {3.5943566213188443`*^9, 
   3.5943566217288446`*^9}, {3.594356810534103*^9, 3.5943568125641055`*^9}, {
   3.5943568617524734`*^9, 3.594356863834563*^9}, {3.5943568943346057`*^9, 
   3.5943568960546083`*^9}, 3.594357216175263*^9, 3.5946142107045956`*^9, 
   3.59461485206728*^9, {3.5952082321704226`*^9, 3.5952082564594607`*^9}, {
   3.5952136978442593`*^9, 3.595213751613595*^9}, {3.5952138737524557`*^9, 
   3.5952138765924597`*^9}, {3.5952220260187807`*^9, 3.5952220362787952`*^9}, 
   3.59581529349234*^9, {3.595911262805786*^9, 3.595911283407977*^9}, {
   3.602202362373871*^9, 3.602202602984207*^9}, {3.602202725574379*^9, 
   3.6022028546145597`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["DisplacedNumberStateFitting", "Subsection",
 CellChangeTimes->{3.595219195554491*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "\[Alpha]V", ",", "\[Alpha]Cur", ",", "T1fitting", ",", "T2fitting", ",", 
    "\[Eta]\[CapitalOmega]fitting", ",", "\[Delta]fitting"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]V", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Cur", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T1fitting", "=", 
   RowBox[{"45", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2fitting", "=", 
   RowBox[{"50", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]\[CapitalOmega]fitting", "=", 
   RowBox[{"2", "\[Pi]", " ", 
    FractionBox["0.5", "13.5"], 
    SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]fitting", "=", 
   RowBox[{"2", "\[Pi]", " ", "20", " ", 
    SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DNSFitting", "[", 
   RowBox[{"blue_List", ",", "red_List", ",", "numberstate_", ",", 
    RowBox[{"kmax_:", "15"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"red", ",", "blue", ","}], "*)"}], 
     RowBox[{
     "nred", ",", "nblue", ",", "Ared", ",", "Ablue", ",", "Bred", ",", 
      "Bblue", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", "level",
       ",", "Pk", ",", "p", ",", "Zero", ",", "zero", ",", "Origin", ",", 
      "Pred", ",", "Pblue", ",", "\[Chi]red", ",", "\[Chi]blue", ",", "na", 
      ",", "V", ",", "Cur", ",", "\[Chi]", ",", "result", ",", "distribution",
       ",", "\[Alpha]", ",", "nbar", ",", "fittingred", ",", "fittingblue", 
      ",", "Fred", ",", "Fblue", ",", "dev", ",", "param", ",", "parabolic", 
      ",", "RMS", ",", "rms", ",", "fittingpara", ",", "findpoint", ",", 
      "bestfitting", ",", "bestvalue", ",", "unc", ",", "devlength", ",", 
      "devnumber", ",", "Deviation", ",", "Param", ",", "Parabolic", ",", 
      "pkbestfitting", ",", "pkbestvalue", ",", "DataDeviation", ",", 
      "DataPk", ",", "\[Sigma]\[Chi]", ",", "Uncertain", ",", "interval", ",",
       "finalfitting", ",", "errorBar", ",", "ddev", ",", "normalization", 
      ",", "i", ",", "j", ",", "n", ",", "x", ",", "t", ",", "nik", ",", 
      "K"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"red", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"redname", ",", "S1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nred", "=", 
      RowBox[{"Length", "[", "red", "]"}]}], ";", " ", 
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ared", "=", "0.9"}], ";", " ", 
     RowBox[{"Ablue", "=", "0.9"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bred", "=", "1"}], ";", 
     RowBox[{"Bblue", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalOmega]b", "=", 
      RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], ";", 
     RowBox[{"\[CapitalOmega]r", "=", 
      RowBox[{"\[Pi]", "/", "r\[Pi]fitting"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"level", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"T1_", ",", "T2_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "T1", " ", "\[Delta]fitting"}]], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "T2", " ", "\[Delta]fitting"}]], 
             "+", 
             RowBox[{"\[ImaginaryI]", " ", "T2", " ", "\[Delta]fitting"}]}], 
            ")"}]}], 
          RowBox[{"T2", " ", 
           SuperscriptBox["\[Delta]fitting", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "T1", " ", "\[Delta]fitting"}]], 
            " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"\[ImaginaryI]", " ", "T1", " ", "\[Delta]fitting"}]}], 
             ")"}]}]}], 
          RowBox[{"T1", " ", 
           SuperscriptBox["\[Delta]fitting", "2"]}]]}], ")"}], " ", 
       "\[Eta]\[CapitalOmega]fitting"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nik", "[", 
       RowBox[{"n_", ",", "k_", ",", "T1_", ",", "T2_"}], "]"}], ":=", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"T1", ",", "T2"}], "]"}], "]"}], "2"], "2"]}]], 
       RowBox[{"Sum", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"\[Alpha]", "[", 
              RowBox[{"T1", ",", "T2"}], "]"}], 
             RowBox[{"k", "-", "n"}]], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"\[Alpha]", "[", 
                  RowBox[{"T1", ",", "T2"}], "]"}], "]"}], "2"]}], ")"}], 
             "i"], 
            SqrtBox[
             RowBox[{
              RowBox[{"n", "!"}], 
              RowBox[{"k", "!"}]}]]}], ")"}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k", "-", "n", "+", "i"}], ")"}], "!"}], 
           RowBox[{"i", "!"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "i"}], ")"}], "!"}]}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"n", "-", "k"}], ",", "0"}], "]"}], ",", "n"}], "}"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"K", "[", 
       RowBox[{"n_", ",", "k_", ",", "T1_", ",", "T2_"}], "]"}], ":=", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"nik", "[", 
          RowBox[{"n", ",", "k", ",", "T1", ",", "T2"}], "]"}], "*", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Delta]fitting", 
           RowBox[{"(", 
            RowBox[{"k", "+", 
             FractionBox["1", "2"]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"T1", "+", "T2"}], ")"}]}]]}], "]"}], "2"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pk", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"p", ",", 
        RowBox[{"kmax", "+", "9"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Zero", "=", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"zero", ",", 
         RowBox[{"kmax", "+", "9"}]}], "]"}], "*", "0"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Origin", "=", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Append", " ", "[", 
                 RowBox[{
                  RowBox[{"Most", "[", 
                   RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", "Zero", "]"}], "]"}], "]"}], "]"}], 
                    "]"}], "]"}], ",", "\[CapitalOmega]r"}], "]"}], ",", 
                "\[CapitalOmega]b"}], "]"}], ",", "Ared"}], "]"}], ",", 
            "Ablue"}], "]"}], ",", "Bred"}], "]"}], ",", "Bblue"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", "kmax"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Origin", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"K", "[", 
         RowBox[{
         "numberstate", ",", "i", ",", "T1fitting", ",", "T2fitting"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pred", "[", 
       RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "8"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"kmax", "+", "6"}], "]"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox["i"]], 
               RowBox[{"LaguerreL", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "4"}], "]"}], "]"}], " ", "t"}], 
              "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "9"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"kmax", "+", "7"}], "]"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "5"}], "]"}], "]"}], " ", "t"}], 
              "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", "Pk_List", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "nred"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pred", "[", 
              RowBox[{"Pk", ",", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "nblue"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{"Pk", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"nred", "+", "nblue"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"na", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"i", " ", 
        RowBox[{"p", "[", 
         RowBox[{"i", "+", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"i", "-", "na"}], ")"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Cur", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"kmax", "-", "1"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "+", 
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "2"}], "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"p", "[", 
            RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nred", "+", "nblue"}], ")"}], "*", 
            RowBox[{"\[Chi]", "[", "Pk", "]"}]}], "+", 
           RowBox[{"\[Alpha]V", "*", "V"}], "+", 
           RowBox[{"\[Alpha]Cur", "*", "Cur"}]}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"kmax", "+", "1"}]], 
              RowBox[{"p", "[", "i", "]"}]}], "\[Equal]", "1"}], "&&"}], 
           "*)"}], 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Pk", "\[GreaterEqual]", "Zero"}], "]"}]}], "]"}], "&&", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"Pk", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "]"}], "\[LessEqual]", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
            "]"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "6"}], "]"}], "\[LessEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "7"}], "]"}], "\[LessEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "4"}], "]"}], "\[LessEqual]", " ", 
            RowBox[{"1.1", "*", "\[CapitalOmega]r"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "4"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"0.9", "\[CapitalOmega]r"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "5"}], "]"}], "\[LessEqual]", " ", 
            RowBox[{"1.1", "*", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "5"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"0.9", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "9"}], "]"}], "\[GreaterEqual]", "0"}]}]}], 
         "}"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"Pk", ",", "Origin"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kmax", "+", "1"}], ",", 
          RowBox[{
           RowBox[{"2", "devnumber"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{
           RowBox[{"2", " ", "devnumber"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{
          RowBox[{"Deviation", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "devnumber", "-", "1"}], ")"}], 
              "devlength"}], "devnumber"], 
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"result", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Param", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"param", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}], ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "8"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"parabolic", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RMS", "=", 
            RowBox[{"Array", "[", 
             RowBox[{"rms", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"fittingpara", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"Param", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",", 
           RowBox[{"findpoint", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"result", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{
               RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", 
                RowBox[{"Deviation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
                RowBox[{"FindMinValue", "[", 
                 RowBox[{
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", 
                    RowBox[{"i", "\[Rule]", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"fittingpara", ",", "findpoint"}], "}"}], "]"}]}],
                  "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"Parabolic", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Fit", "[", 
             RowBox[{"RMS", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "x", ",", 
                SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ",", 
           RowBox[{"Clear", "[", 
            RowBox[{"RMS", ",", "fittingpara", ",", "findpoint"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{
          RowBox[{"Parabolic", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestfitting", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestvalue", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"FindArgMin", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"FindMinValue", "[", 
             RowBox[{
              RowBox[{"Parabolic", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "}"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"pkbestfitting", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pkbestfitting", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", "0"}], 
          ",", 
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"result", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalization", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"pkbestfitting", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{
         RowBox[{"Length", "[", "blue", "]"}], "+", 
         RowBox[{"Length", "[", "red", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DataPk", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "8"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nred"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pred", "[", 
            RowBox[{"DataPk", ",", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"red", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"DataPk", ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"unc", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"interval", "=", 
            RowBox[{"x", "/.", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{"pkbestvalue", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", "\[Sigma]\[Chi]"}]}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"finalfitting", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DataPk", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "\[Rule]", 
         " ", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"errorBar", "[", 
        RowBox[{"type_:", "\"\<Rectangle\>\""}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0_", ",", "x1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y0_", ",", "y1_"}], "}"}]}], "}"}], ",", "value_", ",", 
        "meta_"}], "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "error", "}"}], ",", 
        RowBox[{
         RowBox[{"error", "=", 
          RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"error", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"error", "===", 
             RowBox[{"{", "}"}]}], ",", "0", ",", 
            RowBox[{"Last", "[", "error", "]"}]}], "]"}]}], ";", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ChartElementData", "[", "type", "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x0", ",", "x1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y0", ",", "y1"}], "}"}]}], "}"}], ",", "value", ",", 
             "meta"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}]}], "}"}]}], "}"}], 
              "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fittingred", "=", 
      RowBox[{"Pred", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"pkbestfitting", "/", "normalization"}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "8"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"pkbestfitting", "/", "normalization"}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "8"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fred", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingred", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"red", "[", 
           RowBox[{"[", 
            RowBox[{"nred", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Red"}], "}"}]}], 
        ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"distribution", "+", 
       RowBox[{"error", " ", "bar"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"(*", 
       RowBox[{"\"\<Distribution \>\"", ","}], "*)"}], 
      RowBox[{
       RowBox[{"finalfitting", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MatrixForm"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"(*", 
       RowBox[{"\"\<Error Bar \>\"", ","}], "*)"}], " ", 
      RowBox[{
       RowBox[{"finalfitting", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "MatrixForm"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"kmax", "+", "5"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(1, \(-1\)\)]\) = \>\"", 
       ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"kmax", "+", "4"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"finalfitting", ",", 
        RowBox[{"ChartElementFunction", "\[Rule]", 
         RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"List", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"Fred", ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"red", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"Fblue", ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"blue", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "]"}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.592543297333493*^9, 3.5925433915788836`*^9}, {
   3.592543425873845*^9, 3.592543591488318*^9}, 3.5925436394920635`*^9, {
   3.5925437084360065`*^9, 3.592543733155421*^9}, {3.5925437655862756`*^9, 
   3.5925438493180647`*^9}, {3.5925438942046323`*^9, 
   3.5925440305414305`*^9}, {3.5925443182328854`*^9, 3.592544320078991*^9}, 
   3.5925444067999516`*^9, {3.5925451192427006`*^9, 3.5925451351596107`*^9}, 
   3.592545253496379*^9, 3.5925455950069127`*^9, {3.592546442159367*^9, 
   3.5925465834804497`*^9}, {3.592546616297327*^9, 3.5925466166903496`*^9}, 
   3.5925468427033606`*^9, {3.5925469085761285`*^9, 3.5925469562568555`*^9}, {
   3.5925471063233547`*^9, 3.592547106518366*^9}, {3.5925471489727945`*^9, 
   3.5925471966445208`*^9}, {3.5925473605499797`*^9, 
   3.5925473984201455`*^9}, {3.592785372070339*^9, 3.5927854679598236`*^9}, {
   3.5927888360355034`*^9, 3.592788852651454*^9}, {3.592788918026193*^9, 
   3.59278901587779*^9}, {3.592834068944092*^9, 3.592834125255313*^9}, {
   3.592834275844926*^9, 3.592834291685832*^9}, {3.592834331790126*^9, 
   3.592834337469451*^9}, {3.592886199038349*^9, 3.592886228285022*^9}, {
   3.592886308029583*^9, 3.592886315380003*^9}, {3.5933902924877415`*^9, 
   3.5933903509501853`*^9}, {3.5933904652768793`*^9, 3.593390476142257*^9}, {
   3.5933905738806686`*^9, 3.5933905758869305`*^9}, {3.5933906077119665`*^9, 
   3.5933906777708707`*^9}, {3.5933907147255683`*^9, 
   3.5933908675189877`*^9}, {3.5933909219009*^9, 3.593390947415141*^9}, {
   3.593390995588279*^9, 3.593391035371323*^9}, {3.593391087640977*^9, 
   3.5933910950079*^9}, {3.5933911345509396`*^9, 3.593391186303503*^9}, {
   3.5933912191816826`*^9, 3.593391429392412*^9}, {3.5933923218227634`*^9, 
   3.593392340323117*^9}, {3.593392392530753*^9, 3.593392455854799*^9}, {
   3.593392501994664*^9, 3.5933926531918793`*^9}, {3.593392709329015*^9, 
   3.593392736635486*^9}, {3.59339300189321*^9, 3.5933930282755575`*^9}, {
   3.5933930654182725`*^9, 3.5933932416346817`*^9}, {3.5933933156150703`*^9, 
   3.593393372503314*^9}, {3.593393418091096*^9, 3.593393514270331*^9}, {
   3.5933935445991864`*^9, 3.593393636243828*^9}, {3.5933937042884817`*^9, 
   3.5933937307958374`*^9}, {3.5933938220794525`*^9, 3.5933939412566*^9}, {
   3.593393979796497*^9, 3.5933940727023053`*^9}, 3.5933942734748096`*^9, {
   3.593395700765211*^9, 3.5933957359306912`*^9}, {3.5933961481600842`*^9, 
   3.593396159536519*^9}, 3.593398360590062*^9, {3.593748299970694*^9, 
   3.5937483262725625`*^9}, {3.5937483564589005`*^9, 
   3.5937484001081543`*^9}, {3.594354332142893*^9, 3.5943543517260127`*^9}, {
   3.5943544146956143`*^9, 3.594354616354604*^9}, {3.5943546950140586`*^9, 
   3.5943547271438656`*^9}, 3.5943572287652807`*^9, {3.5943580322375903`*^9, 
   3.5943580383239355`*^9}, {3.5943582498378468`*^9, 3.594358254344103*^9}, {
   3.594358849252713*^9, 3.594358856077103*^9}, 3.594358953562601*^9, 
   3.5943589890136137`*^9, {3.594359020317359*^9, 3.594359020452367*^9}, {
   3.5943591018539677`*^9, 3.5943591309655733`*^9}, {3.5943637440542836`*^9, 
   3.594363746254287*^9}, {3.594429930988577*^9, 3.5944299446483583`*^9}, 
   3.5944304004854307`*^9, 3.5945991470990067`*^9, 3.594599195014747*^9, {
   3.594599416026388*^9, 3.594599429010131*^9}, {3.59459953844139*^9, 
   3.5945995504960794`*^9}, {3.5945997072520456`*^9, 
   3.5945997073960543`*^9}, {3.594599852125332*^9, 3.594599856412577*^9}, 
   3.594599989831208*^9, 3.5946133421949196`*^9, 3.5946134411305785`*^9, {
   3.594613489896368*^9, 3.5946135533599977`*^9}, {3.594613712120078*^9, 
   3.5946137245517893`*^9}, {3.594613776505761*^9, 3.5946137837601757`*^9}, {
   3.5946138634947367`*^9, 3.5946138666629176`*^9}, {3.5946139028179855`*^9, 
   3.5946139519117937`*^9}, 3.5946140719216576`*^9, {3.594614102615413*^9, 
   3.5946141367323647`*^9}, 3.5946142107045956`*^9, {3.5946142474536977`*^9, 
   3.594614269800976*^9}, 3.594614406133774*^9, {3.5946144372205515`*^9, 
   3.594614466621233*^9}, {3.594614511405795*^9, 3.5946145382723317`*^9}, 
   3.5946146741921053`*^9, {3.59461470678897*^9, 3.5946147199407225`*^9}, {
   3.594615007422165*^9, 3.5946150101323204`*^9}, 3.594615073279932*^9, {
   3.594615581716013*^9, 3.5946156153109345`*^9}, {3.5946158667713175`*^9, 
   3.5946158671723404`*^9}, {3.5946160693939066`*^9, 3.594616069553916*^9}, {
   3.5946163795446463`*^9, 3.5946163844799285`*^9}, {3.5946164672816644`*^9, 
   3.594616468487734*^9}, {3.594616519172632*^9, 3.5946165451581187`*^9}, {
   3.5946819552304287`*^9, 3.5946819934356647`*^9}, {3.594682395583123*^9, 
   3.5946823957231236`*^9}, {3.594682467895529*^9, 3.5946825355378385`*^9}, {
   3.5946825708741446`*^9, 3.59468257524415*^9}, {3.5946828781490707`*^9, 
   3.594682878369071*^9}, {3.594683839359455*^9, 3.594683842169459*^9}, {
   3.5946839669232635`*^9, 3.594683969853267*^9}, {3.5946850046756744`*^9, 
   3.594685005322712*^9}, 3.595213663291051*^9, {3.5952138971524887`*^9, 
   3.5952138991524916`*^9}, 3.59581530772236*^9, {3.595911314898021*^9, 
   3.5959113212891693`*^9}, {3.59591139631846*^9, 3.5959114278527374`*^9}, {
   3.5963441081548634`*^9, 3.596344123884763*^9}, {3.5963441574776845`*^9, 
   3.5963441616609235`*^9}, {3.5963442344050846`*^9, 
   3.5963442352681336`*^9}, {3.596344296027609*^9, 3.5963443106414447`*^9}, {
   3.596344387604847*^9, 3.596344387748855*^9}, {3.5963445844811077`*^9, 
   3.596344600838043*^9}, {3.5963452929976325`*^9, 3.596345293180643*^9}, {
   3.59634538387683*^9, 3.596345383987837*^9}, 3.596345814015433*^9, {
   3.5963458699346313`*^9, 3.5963458797931952`*^9}, {3.5963461492746086`*^9, 
   3.596346186977765*^9}, {3.5963470746845393`*^9, 3.596347105739315*^9}, {
   3.5963484102409286`*^9, 3.5963484362144136`*^9}, {3.596349542169671*^9, 
   3.596349542288678*^9}, {3.5964105197529545`*^9, 3.596410525382962*^9}, {
   3.596410689577893*^9, 3.596410693287898*^9}, {3.596410739340171*^9, 
   3.596410741250173*^9}, {3.596410781574486*^9, 3.5964107821544867`*^9}, {
   3.5964109906767583`*^9, 3.596410991885827*^9}, {3.5964110595232973`*^9, 
   3.596411060603299*^9}, {3.596411329667982*^9, 3.5964114288494034`*^9}, {
   3.596411524568003*^9, 3.5964115266980057`*^9}, {3.596411622746629*^9, 
   3.5964116229866295`*^9}, {3.5964116740889792`*^9, 3.59641167460898*^9}, {
   3.5964118965432105`*^9, 3.5964118972932115`*^9}, {3.5964119644966683`*^9, 
   3.5964119653966694`*^9}, {3.596411998258865*^9, 3.596412003088872*^9}, {
   3.596412037280115*^9, 3.596412037950116*^9}, {3.596412256305433*^9, 
   3.5964122633054423`*^9}, {3.5964128089696856`*^9, 3.596412815382902*^9}, {
   3.5964130646423683`*^9, 3.596413065262369*^9}, {3.596413543417215*^9, 
   3.596413545567218*^9}, {3.5964137555105505`*^9, 3.59641376487171*^9}, {
   3.596413847369259*^9, 3.5964138480292597`*^9}, {3.596414305758043*^9, 
   3.596414308878047*^9}, {3.5964146217667313`*^9, 3.5964146221567316`*^9}, {
   3.596414733232377*^9, 3.596414733682378*^9}, {3.5964148680741158`*^9, 
   3.5964148769382906`*^9}, {3.5964149899569387`*^9, 
   3.5964149969169483`*^9}, {3.596415111610674*^9, 3.5964151149706783`*^9}, {
   3.596415178564151*^9, 3.596415179574152*^9}, {3.5964152554856606`*^9, 
   3.596415256005661*^9}, {3.596415346172209*^9, 3.596415346282209*^9}, {
   3.596415438341608*^9, 3.596415448991623*^9}, {3.5964156572868934`*^9, 
   3.5964156737891607`*^9}, {3.59641575806262*^9, 3.596415758472621*^9}, {
   3.5964158573031197`*^9, 3.5964158611131253`*^9}, {3.5964159840889387`*^9, 
   3.59641598465894*^9}, {3.596419162135954*^9, 3.5964191627959547`*^9}, 
   3.596424630698441*^9, {3.5964246913127565`*^9, 3.596424692412758*^9}, {
   3.596424729313087*^9, 3.596424730173088*^9}, {3.5964259510584545`*^9, 
   3.5964259512984548`*^9}, {3.5964260294158363`*^9, 
   3.5964260296278486`*^9}, {3.5964261252525167`*^9, 
   3.5964261266525183`*^9}, {3.5964262202760053`*^9, 3.5964262213260064`*^9}, 
   3.596426315545514*^9, 3.596426416711233*^9, {3.5964264876958313`*^9, 
   3.596426491583844*^9}, {3.5964265729103127`*^9, 3.5964265814803247`*^9}, {
   3.6017799223980103`*^9, 3.6017799379879017`*^9}, {3.601780012504164*^9, 
   3.601780032943333*^9}, {3.6017803139614067`*^9, 3.6017803169525776`*^9}, {
   3.6022037058657513`*^9, 3.6022038913560114`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["NumberStateFitting", "Subsection",
 CellChangeTimes->{3.5952192115357294`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Alpha]V", ",", "\[Alpha]Cur"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]V", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Cur", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhononNumberFitting", "[", 
   RowBox[{"blue_List", ",", "red_List", ",", "numberstate_", ",", 
    RowBox[{"kmax_:", "10"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"red", ",", "blue", ","}], "*)"}], 
     RowBox[{
     "nred", ",", "nblue", ",", "Ared", ",", "Ablue", ",", "Bred", ",", 
      "Bblue", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", "level",
       ",", "Pk", ",", "p", ",", "Zero", ",", "zero", ",", "Origin", ",", 
      "Pred", ",", "Pblue", ",", "\[Chi]red", ",", "\[Chi]blue", ",", "na", 
      ",", "V", ",", "Cur", ",", "\[Chi]", ",", "result", ",", "distribution",
       ",", "\[Alpha]", ",", "nbar", ",", "fittingred", ",", "fittingblue", 
      ",", "Fred", ",", "Fblue", ",", "dev", ",", "param", ",", "parabolic", 
      ",", "RMS", ",", "rms", ",", "fittingpara", ",", "findpoint", ",", 
      "bestfitting", ",", "bestvalue", ",", "unc", ",", "devlength", ",", 
      "devnumber", ",", "Deviation", ",", "Param", ",", "Parabolic", ",", 
      "pkbestfitting", ",", "pkbestvalue", ",", "DataDeviation", ",", 
      "DataPk", ",", "\[Sigma]\[Chi]", ",", "Uncertain", ",", "interval", ",",
       "finalfitting", ",", "errorBar", ",", "ddev", ",", "normalization", 
      ",", "i", ",", "j", ",", "n", ",", "x", ",", "t", ",", 
      "newdistribution", ",", "distribution1", ",", "distribution2"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"red", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"redname", ",", "S1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nred", "=", 
      RowBox[{"Length", "[", "red", "]"}]}], ";", " ", 
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ared", "=", "0.9"}], ";", " ", 
     RowBox[{"Ablue", "=", "0.9"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bred", "=", "1"}], ";", 
     RowBox[{"Bblue", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalOmega]b", "=", 
      RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], ";", 
     RowBox[{"\[CapitalOmega]r", "=", 
      RowBox[{"\[Pi]", "/", "r\[Pi]fitting"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"level", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Pk", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"p", ",", 
        RowBox[{"kmax", "+", "7"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Zero", "=", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"zero", ",", 
         RowBox[{"kmax", "+", "7"}]}], "]"}], "*", "0"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Origin", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", "Zero", "]"}], "]"}], "]"}], "]"}], 
                    "]"}], "]"}], ",", "\[CapitalOmega]r"}], "]"}], ",", 
                  "\[CapitalOmega]b"}], "]"}], ",", "Ared"}], "]"}], ",", 
              "Ablue"}], "]"}], ",", "Bred"}], "]"}], ",", "Bblue"}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"numberstate", "+", "1"}], "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pred", "[", 
       RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "8"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"kmax", "+", "6"}], "]"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], " ", "t"}]], 
             " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox["i"]], 
               RowBox[{"LaguerreL", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "4"}], "]"}], "]"}], " ", "t"}], 
              "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "9"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"kmax", "+", "7"}], "]"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], " ", "t"}]], 
             " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "5"}], "]"}], "]"}], " ", "t"}], 
              "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", "Pk_List", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "nred"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pred", "[", 
              RowBox[{"Pk", ",", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "nblue"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{"Pk", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"nred", "+", "nblue"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"na", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"i", " ", 
        RowBox[{"p", "[", 
         RowBox[{"i", "+", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"i", "-", "na"}], ")"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Cur", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"kmax", "-", "1"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "+", 
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "2"}], "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"p", "[", 
            RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nred", "+", "nblue"}], ")"}], "*", 
            RowBox[{"\[Chi]", "[", "Pk", "]"}]}], "+", 
           RowBox[{"\[Alpha]V", "*", "V"}], "+", 
           RowBox[{"\[Alpha]Cur", "*", "Cur"}]}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"kmax", "+", "1"}]], 
              RowBox[{"p", "[", "i", "]"}]}], "\[Equal]", "1"}], "&&"}], 
           "*)"}], 
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Pk", "\[GreaterEqual]", "Zero"}], "]"}]}], "]"}], "&&", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"Pk", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "]"}], "\[LessEqual]", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
            "]"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "6"}], "]"}], "\[LessEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "7"}], "]"}], "\[LessEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "4"}], "]"}], "\[LessEqual]", " ", 
            RowBox[{"1.1", "*", "\[CapitalOmega]r"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "4"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"0.9", "\[CapitalOmega]r"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "5"}], "]"}], "\[LessEqual]", " ", 
            RowBox[{"1.1", "*", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "5"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"0.9", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "8"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "9"}], "]"}], "\[GreaterEqual]", "0"}]}]}], 
         "}"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"Pk", ",", "Origin"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kmax", "+", "1"}], ",", 
          RowBox[{
           RowBox[{"2", "devnumber"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{
           RowBox[{"2", " ", "devnumber"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{
          RowBox[{"Deviation", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "devnumber", "-", "1"}], ")"}], 
              "devlength"}], "devnumber"], 
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"result", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Param", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"param", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}], ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "8"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"parabolic", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RMS", "=", 
            RowBox[{"Array", "[", 
             RowBox[{"rms", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"fittingpara", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"Param", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",", 
           RowBox[{"findpoint", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"result", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{
               RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", 
                RowBox[{"Deviation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
                RowBox[{"FindMinValue", "[", 
                 RowBox[{
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", 
                    RowBox[{"i", "\[Rule]", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"fittingpara", ",", "findpoint"}], "}"}], "]"}]}],
                  "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"Parabolic", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Fit", "[", 
             RowBox[{"RMS", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "x", ",", 
                SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ",", 
           RowBox[{"Clear", "[", 
            RowBox[{"RMS", ",", "fittingpara", ",", "findpoint"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{
          RowBox[{"Parabolic", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestfitting", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestvalue", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"FindArgMin", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"FindMinValue", "[", 
             RowBox[{
              RowBox[{"Parabolic", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "}"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"pkbestfitting", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pkbestfitting", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", "0"}], 
          ",", 
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"result", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalization", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"pkbestfitting", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{
         RowBox[{"Length", "[", "blue", "]"}], "+", 
         RowBox[{"Length", "[", "red", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DataPk", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "8"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nred"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pred", "[", 
            RowBox[{"DataPk", ",", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"red", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"DataPk", ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"unc", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"interval", "=", 
            RowBox[{"x", "/.", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{"pkbestvalue", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", "\[Sigma]\[Chi]"}]}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"finalfitting", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DataPk", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "\[Rule]", 
         " ", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"errorBar", "[", 
        RowBox[{"type_:", "\"\<Rectangle\>\""}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0_", ",", "x1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y0_", ",", "y1_"}], "}"}]}], "}"}], ",", "value_", ",", 
        "meta_"}], "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "error", "}"}], ",", 
        RowBox[{
         RowBox[{"error", "=", 
          RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"error", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"error", "===", 
             RowBox[{"{", "}"}]}], ",", "0", ",", 
            RowBox[{"Last", "[", "error", "]"}]}], "]"}]}], ";", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ChartElementData", "[", "type", "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x0", ",", "x1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y0", ",", "y1"}], "}"}]}], "}"}], ",", "value", ",", 
             "meta"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}]}], "}"}]}], "}"}], 
              "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newdistribution", "=", 
      RowBox[{"pkbestfitting", "/", "normalization"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingred", "=", 
      RowBox[{"Pred", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"newdistribution", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "8"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"newdistribution", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "8"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fred", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingred", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"red", "[", 
           RowBox[{"[", 
            RowBox[{"nred", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Red"}], "}"}]}], 
        ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], ";", 
     RowBox[{"(*", 
      RowBox[{"distribution", "+", 
       RowBox[{"error", " ", "bar"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Distribution \>\"", ",", " ", 
         RowBox[{
          RowBox[{"finalfitting", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Error Bar \>\"", ",", " ", 
         RowBox[{
          RowBox[{"finalfitting", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"kmax", "+", "5"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(1, \(-1\)\)]\) = \>\"", 
       ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"kmax", "+", "4"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"finalfitting", ",", 
        RowBox[{"ChartElementFunction", "\[Rule]", 
         RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"List", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"Fred", ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"red", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"Fblue", ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"blue", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
              "}"}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "]"}], "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.592543297333493*^9, 3.5925433915788836`*^9}, {
   3.592543425873845*^9, 3.592543591488318*^9}, 3.5925436394920635`*^9, {
   3.5925437084360065`*^9, 3.592543733155421*^9}, {3.5925437655862756`*^9, 
   3.5925438493180647`*^9}, {3.5925438942046323`*^9, 
   3.5925440305414305`*^9}, {3.5925443182328854`*^9, 3.592544320078991*^9}, 
   3.5925444067999516`*^9, {3.5925451192427006`*^9, 3.5925451351596107`*^9}, 
   3.592545253496379*^9, 3.5925455950069127`*^9, {3.592546442159367*^9, 
   3.5925465834804497`*^9}, {3.592546616297327*^9, 3.5925466166903496`*^9}, 
   3.5925468427033606`*^9, {3.5925469085761285`*^9, 3.5925469562568555`*^9}, {
   3.5925471063233547`*^9, 3.592547106518366*^9}, {3.5925471489727945`*^9, 
   3.5925471966445208`*^9}, {3.5925473605499797`*^9, 
   3.5925473984201455`*^9}, {3.592785372070339*^9, 3.5927854679598236`*^9}, {
   3.5927888360355034`*^9, 3.592788852651454*^9}, {3.592788918026193*^9, 
   3.59278901587779*^9}, {3.592834068944092*^9, 3.592834125255313*^9}, {
   3.592834275844926*^9, 3.592834291685832*^9}, {3.592834331790126*^9, 
   3.592834337469451*^9}, {3.592886199038349*^9, 3.592886228285022*^9}, {
   3.592886308029583*^9, 3.592886315380003*^9}, {3.5933902924877415`*^9, 
   3.5933903509501853`*^9}, {3.5933904652768793`*^9, 3.593390476142257*^9}, {
   3.5933905738806686`*^9, 3.5933905758869305`*^9}, {3.5933906077119665`*^9, 
   3.5933906777708707`*^9}, {3.5933907147255683`*^9, 
   3.5933908675189877`*^9}, {3.5933909219009*^9, 3.593390947415141*^9}, {
   3.593390995588279*^9, 3.593391035371323*^9}, {3.593391087640977*^9, 
   3.5933910950079*^9}, {3.5933911345509396`*^9, 3.593391186303503*^9}, {
   3.5933912191816826`*^9, 3.593391429392412*^9}, {3.5933923218227634`*^9, 
   3.593392340323117*^9}, {3.593392392530753*^9, 3.593392455854799*^9}, {
   3.593392501994664*^9, 3.5933926531918793`*^9}, {3.593392709329015*^9, 
   3.593392736635486*^9}, {3.59339300189321*^9, 3.5933930282755575`*^9}, {
   3.5933930654182725`*^9, 3.5933932416346817`*^9}, {3.5933933156150703`*^9, 
   3.593393372503314*^9}, {3.593393418091096*^9, 3.593393514270331*^9}, {
   3.5933935445991864`*^9, 3.593393636243828*^9}, {3.5933937042884817`*^9, 
   3.5933937307958374`*^9}, {3.593394231954545*^9, 3.593394233945794*^9}, 
   3.5933942734748096`*^9, {3.593394903334874*^9, 3.593394907065349*^9}, {
   3.5933949789564724`*^9, 3.5933950077991385`*^9}, {3.5933950864141436`*^9, 
   3.593395128620494*^9}, {3.593395180794129*^9, 3.5933951809691477`*^9}, {
   3.593396148159073*^9, 3.593396159536519*^9}, {3.5934779016562567`*^9, 
   3.593478150164196*^9}, {3.593478302878742*^9, 3.5934783787039785`*^9}, {
   3.5934785573711596`*^9, 3.593478592553561*^9}, {3.593725394899545*^9, 
   3.5937254038326817`*^9}, {3.5937254684318905`*^9, 
   3.5937254702191286`*^9}, {3.59372551737411*^9, 3.5937256241146746`*^9}, {
   3.593725664034748*^9, 3.593725725757476*^9}, {3.5937257561473513`*^9, 
   3.5937257580025887`*^9}, {3.5937479105281105`*^9, 
   3.5937480780427046`*^9}, {3.593989855581293*^9, 3.5939898573573947`*^9}, {
   3.593989913522589*^9, 3.593989971803903*^9}, {3.5939900038757267`*^9, 
   3.593990073353671*^9}, {3.5939904952506905`*^9, 3.593990523144271*^9}, {
   3.593990649504448*^9, 3.593990678240078*^9}, {3.5939910765106945`*^9, 
   3.593991082326028*^9}, 3.5939949000653653`*^9, {3.5939949588837295`*^9, 
   3.5939950141538906`*^9}, 3.593995059435481*^9, {3.593995145208988*^9, 
   3.593995146744068*^9}, {3.593995182751936*^9, 3.593995200183817*^9}, {
   3.5939952632080755`*^9, 3.593995266951269*^9}, {3.593995325561329*^9, 
   3.5939954080175858`*^9}, {3.5939954545169945`*^9, 3.593995508313826*^9}, {
   3.593995578485396*^9, 3.5939955825725927`*^9}, {3.593995629532982*^9, 
   3.593995636740341*^9}, {3.593995711292207*^9, 3.5939957328353024`*^9}, {
   3.593995773059366*^9, 3.593995784494957*^9}, {3.593995870502449*^9, 
   3.593995873084566*^9}, 3.5939959080443583`*^9, {3.593995944727214*^9, 
   3.5939959589949408`*^9}, {3.593996039013055*^9, 3.593996143015336*^9}, {
   3.593996175206987*^9, 3.5939962860457177`*^9}, {3.593996318161351*^9, 
   3.593996323515626*^9}, {3.5939963586723766`*^9, 3.593996439312557*^9}, {
   3.593999712039507*^9, 3.5939997249501724`*^9}, {3.59399999773426*^9, 
   3.5940000216324625`*^9}, {3.594000109047018*^9, 3.5940001716452155`*^9}, {
   3.594000208653078*^9, 3.594000212019269*^9}, {3.5940002814668684`*^9, 
   3.5940003182668314`*^9}, {3.594000382242014*^9, 3.5940003870342765`*^9}, {
   3.594000604731682*^9, 3.5940006723432426`*^9}, {3.5940007199626236`*^9, 
   3.59400072008663*^9}, {3.594000779169713*^9, 3.59400083445958*^9}, {
   3.594000953975685*^9, 3.5940009629911757`*^9}, {3.594000995143862*^9, 
   3.5940010037913537`*^9}, {3.594001048592621*^9, 3.5940010559359837`*^9}, {
   3.594001108349636*^9, 3.5940011701168056`*^9}, {3.5940012492869177`*^9, 
   3.594001253548139*^9}, {3.5940012850137663`*^9, 3.5940012853657866`*^9}, {
   3.5940013580735097`*^9, 3.5940013963604774`*^9}, {3.5940014434198666`*^9, 
   3.5940014567235503`*^9}, {3.594001504021963*^9, 3.5940015326354094`*^9}, 
   3.5940015767796884`*^9, {3.5940016111474276`*^9, 3.5940016782148285`*^9}, {
   3.5940017083984385`*^9, 3.594001773761799*^9}, {3.5940018204192176`*^9, 
   3.594001963232521*^9}, {3.5940020357453175`*^9, 3.594002178207595*^9}, {
   3.594002255354648*^9, 3.594002259473864*^9}, {3.5940022917375126`*^9, 
   3.5940023153967953`*^9}, {3.594002373087729*^9, 3.594002460759185*^9}, {
   3.594002555136058*^9, 3.594002555294067*^9}, {3.594002794176309*^9, 
   3.5940028556094947`*^9}, {3.594002949528367*^9, 3.5940029550156517`*^9}, {
   3.5940030890336185`*^9, 3.5940031099596877`*^9}, {3.5940031544519587`*^9, 
   3.594003187714703*^9}, {3.5940032300668597`*^9, 3.594003289377878*^9}, {
   3.594003321570558*^9, 3.594003376168655*^9}, {3.594354201228405*^9, 
   3.594354230212063*^9}, {3.59435428838339*^9, 3.5943542887984133`*^9}, {
   3.594354651768598*^9, 3.594354661453148*^9}, {3.594357150527339*^9, 
   3.5943571885918193`*^9}, {3.594357752002668*^9, 3.5943577645626855`*^9}, {
   3.5943578054519424`*^9, 3.5943579491259356`*^9}, {3.5943584072187386`*^9, 
   3.594358433647244*^9}, {3.5943584664940825`*^9, 3.594358479718835*^9}, {
   3.594358526814514*^9, 3.594358641372947*^9}, 3.5943586884696083`*^9, {
   3.594358719974386*^9, 3.594358736814334*^9}, {3.59436372792207*^9, 
   3.594363730482074*^9}, {3.594608000208376*^9, 3.5946080049426465`*^9}, {
   3.5946081900542345`*^9, 3.5946082012128725`*^9}, {3.5946082536518717`*^9, 
   3.5946082653655415`*^9}, 3.5946142107035956`*^9, 3.594614868755234*^9, {
   3.594615086792705*^9, 3.59461511852852*^9}, {3.594615165303196*^9, 
   3.5946152064085464`*^9}, {3.5946153021990256`*^9, 
   3.5946153683808107`*^9}, {3.594615471117687*^9, 3.594615529881048*^9}, {
   3.5946157248191977`*^9, 3.594615791326002*^9}, {3.594615834172453*^9, 
   3.594615834283459*^9}, {3.594616063366562*^9, 3.594616063477568*^9}, {
   3.594616395643567*^9, 3.5946163995307894`*^9}, {3.5946164747980947`*^9, 
   3.5946164753771276`*^9}, {3.5946828998791013`*^9, 3.5946829000991015`*^9}, 
   3.595213672651064*^9, {3.5952139057886453`*^9, 3.5952139091186495`*^9}, 
   3.5958153164223723`*^9, {3.595911332299185*^9, 3.595911338489193*^9}, {
   3.602203911026039*^9, 3.602204041426221*^9}, {3.6022041216163335`*^9, 
   3.602204127336342*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Blue", "Section",
 CellChangeTimes->{3.595219029607476*^9}],

Cell[CellGroupData[{

Cell["PhononNumberFittingBlue", "Subsection",
 CellChangeTimes->{3.5952192442987785`*^9, 3.598868084232435*^9, 
  3.5988701986813745`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Alpha]V", ",", "\[Alpha]Cur"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]V", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Cur", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhononNumberFittingBlue", "[", 
   RowBox[{"blue_List", ",", 
    RowBox[{"kmax_:", "15"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"red", ",", 
      RowBox[{"(*", 
       RowBox[{"blue", ","}], "*)"}], "nred", ",", "nblue", ",", "Ared", ",", 
      "Ablue", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", "level",
       ",", "Pk", ",", "p", ",", "Zero", ",", "zero", ",", "Origin", ",", 
      "Pred", ",", "Pblue", ",", "\[Chi]red", ",", "\[Chi]blue", ",", "na", 
      ",", "V", ",", "Cur", ",", "\[Chi]", ",", "result", ",", 
      "distribution1", ",", "distribution2", ",", "\[Alpha]", ",", "nbar", 
      ",", "fittingred", ",", "fittingblue", ",", "Fred", ",", "Fblue", ",", 
      "dev", ",", "param", ",", "parabolic", ",", "RMS", ",", "rms", ",", 
      "fittingpara", ",", "findpoint", ",", "bestfitting", ",", "bestvalue", 
      ",", "unc", ",", "devlength", ",", "devnumber", ",", "Deviation", ",", 
      "Param", ",", "Parabolic", ",", "pkbestfitting", ",", "pkbestvalue", 
      ",", "DataDeviation", ",", "DataPk", ",", "\[Sigma]\[Chi]", ",", 
      "Uncertain", ",", "interval", ",", "finalfitting", ",", "errorBar", ",",
       "ddev", ",", "normalization", ",", "i", ",", "j", ",", "n", ",", "x", 
      ",", "t", ",", "newdistribution", ",", "a", ",", "b", ",", "c", ",", 
      "prob"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"nblue", "=", 
       RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ablue", "=", "0.95"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]b", "=", 
       RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"level", "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Pk", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"p", ",", 
         RowBox[{"kmax", "+", "5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Zero", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"zero", ",", 
          RowBox[{"kmax", "+", "5"}]}], "]"}], "*", "0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Origin", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Most", "[", 
            RowBox[{"Most", "[", "Zero", "]"}], "]"}], ",", 
           "\[CapitalOmega]b"}], "]"}], ",", "Ablue"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pblue", "[", 
        RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "kmax"], 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"kmax", "+", "5"}], "]"}], "]"}], "-", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"kmax", "+", "4"}], "]"}], "]"}], " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], "*", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}], "0.7"], "*", " ", "t"}]], 
              " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                FractionBox["1", 
                 SqrtBox[
                  RowBox[{"i", "+", "1"}]]], 
                RowBox[{"LaguerreL", "[", 
                 RowBox[{"i", ",", "1", ",", 
                  SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"kmax", "+", "3"}], "]"}], "]"}], " ", "t"}], 
               "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Chi]", "[", "Pk_List", "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "nblue"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{"Pk", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], ")"}], 
        "/", 
        RowBox[{"(", "nblue", ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"na", "=", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "kmax"], 
        RowBox[{"i", " ", 
         RowBox[{"p", "[", 
          RowBox[{"i", "+", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "kmax"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"i", "+", "1"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"i", "-", "na"}], ")"}]}], ")"}], "2"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Cur", "=", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "1"}], 
         RowBox[{"kmax", "-", "1"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "+", 
           RowBox[{"p", "[", 
            RowBox[{"i", "+", "2"}], "]"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"p", "[", 
             RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], "2"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"FindArgMin", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", "nblue", ")"}], "*", 
             RowBox[{"\[Chi]", "[", "Pk", "]"}]}], "+", 
            RowBox[{"\[Alpha]V", "*", "V"}], "+", 
            RowBox[{"\[Alpha]Cur", "*", "Cur"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"kmax", "+", "1"}]], 
              RowBox[{"p", "[", "i", "]"}]}], "\[Equal]", "1"}], "&&", 
            RowBox[{"Apply", "[", 
             RowBox[{"And", ",", 
              RowBox[{"Thread", "[", 
               RowBox[{"Pk", "\[GreaterEqual]", "Zero"}], "]"}]}], "]"}], "&&", 
            RowBox[{"Apply", "[", 
             RowBox[{"And", ",", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"Pk", ",", 
                  RowBox[{"kmax", "+", "1"}]}], "]"}], "\[LessEqual]", 
                RowBox[{"Table", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
             "]"}], "&&", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"kmax", "+", "4"}], "]"}], "\[LessEqual]", "1"}], "&&", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"kmax", "+", "3"}], "]"}], "\[LessEqual]", " ", 
             RowBox[{"1.05", "*", "\[CapitalOmega]b"}]}], "&&", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"kmax", "+", "3"}], "]"}], "\[GreaterEqual]", " ", 
             RowBox[{"0.95", "\[CapitalOmega]b"}]}]}]}], "}"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"Pk", ",", "Origin"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"devlength", "=", "0.0005"}], ";", "\[IndentingNewLine]", 
      RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Deviation", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"dev", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kmax", "+", "1"}], ",", 
           RowBox[{
            RowBox[{"2", "devnumber"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"kmax", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{
            RowBox[{"2", " ", "devnumber"}], "+", "1"}]}], ",", 
          RowBox[{"j", "++"}], ",", 
          RowBox[{
           RowBox[{"Deviation", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "-", "devnumber", "-", "1"}], ")"}], 
               "devlength"}], "devnumber"], 
             RowBox[{"result", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "+", 
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Param", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{"param", ",", 
           RowBox[{"kmax", "+", "1"}]}], "]"}], ",", 
         RowBox[{"Take", "[", 
          RowBox[{"result", ",", 
           RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Parabolic", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"parabolic", ",", 
         RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"kmax", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"result", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RMS", "=", 
             RowBox[{"Array", "[", 
              RowBox[{"rms", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"2", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}],
               "]"}]}], ",", 
            RowBox[{"fittingpara", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"Param", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], 
            ",", 
            RowBox[{"findpoint", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"result", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"j", "\[LessEqual]", 
               RowBox[{
                RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
              RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"RMS", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", 
                 RowBox[{"Deviation", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"RMS", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
                 RowBox[{"FindMinValue", "[", 
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", 
                    RowBox[{"i", "\[Rule]", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                   ",", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"fittingpara", ",", "findpoint"}], "}"}], "]"}]}],
                   "]"}]}]}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Parabolic", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"Fit", "[", 
              RowBox[{"RMS", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "x", ",", 
                 SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ",", 
            RowBox[{"Clear", "[", 
             RowBox[{"RMS", ",", "fittingpara", ",", "findpoint"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{
           RowBox[{"Parabolic", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"pkbestfitting", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"bestfitting", ",", 
         RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pkbestvalue", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"bestvalue", ",", 
         RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"kmax", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"result", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pkbestfitting", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"FindArgMin", "[", 
               RowBox[{
                RowBox[{"Parabolic", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"pkbestvalue", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"FindMinValue", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pkbestfitting", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
            RowBox[{
             RowBox[{"pkbestvalue", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "}"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"kmax", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{"pkbestfitting", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", "0"}], 
           ",", 
           RowBox[{"pkbestfitting", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}]}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"pkbestfitting", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"result", ",", 
         RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"normalization", "=", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], "kmax"], 
        RowBox[{"pkbestfitting", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"DataDeviation", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"ddev", ",", 
         RowBox[{"Length", "[", "blue", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DataPk", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"pkbestfitting", ",", 
         RowBox[{"Take", "[", 
          RowBox[{"result", ",", 
           RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "=", "1"}], ";", 
         RowBox[{"j", "=", "1"}]}], ",", 
        RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{
         RowBox[{"ddev", "[", 
          RowBox[{"n", "++"}], "]"}], "=", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pblue", "[", 
             RowBox[{"DataPk", ",", 
              RowBox[{"blue", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
            RowBox[{"blue", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]\[Chi]", "=", 
       RowBox[{"1.96", "*", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"DataDeviation", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}],
           "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
           SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Uncertain", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"unc", ",", 
         RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"kmax", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pkbestfitting", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"interval", "=", 
             RowBox[{"x", "/.", 
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{"Parabolic", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
                RowBox[{
                 RowBox[{"pkbestvalue", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "+", "\[Sigma]\[Chi]"}]}], 
               "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Uncertain", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"interval", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"pkbestfitting", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"interval", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"pkbestfitting", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "}"}],
           ",", 
          RowBox[{
           RowBox[{"Uncertain", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"finalfitting", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"DataPk", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "\[Rule]",
           " ", 
          RowBox[{
           RowBox[{"Uncertain", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"errorBar", "[", 
         RowBox[{"type_:", "\"\<Rectangle\>\""}], "]"}], "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x0_", ",", "x1_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y0_", ",", "y1_"}], "}"}]}], "}"}], ",", "value_", ",", 
         "meta_"}], "]"}], ":=", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "error", "}"}], ",", 
         RowBox[{
          RowBox[{"error", "=", 
           RowBox[{"Flatten", "[", "meta", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"error", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"error", "===", 
              RowBox[{"{", "}"}]}], ",", "0", ",", 
             RowBox[{"Last", "[", "error", "]"}]}], "]"}]}], ";", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ChartElementData", "[", "type", "]"}], "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x0", ",", "x1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y0", ",", "y1"}], "}"}]}], "}"}], ",", "value", ",",
               "meta"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}]}], "}"}]}], "}"}], 
               "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fittingblue", "=", 
       RowBox[{"Pblue", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"pkbestfitting", ",", 
           RowBox[{"Take", "[", 
            RowBox[{"result", ",", 
             RowBox[{"-", "4"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Fblue", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{"fittingblue", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
         ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Print", "[", 
       RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], "*)"}], ";", 
     RowBox[{"(*", 
      RowBox[{"distribution", "+", 
       RowBox[{"error", " ", "bar"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Distribution \>\"", ",", " ", 
         RowBox[{
          RowBox[{"finalfitting", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Error Bar \>\"", ",", " ", 
         RowBox[{
          RowBox[{"finalfitting", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Pi]b\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"\[Pi]", "/", 
        RowBox[{"result", "[", 
         RowBox[{"[", 
          RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<WFA = \>\"", ",", 
         RowBox[{
          FractionBox["2", "\[Pi]"], 
          RowBox[{"Total", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{
               RowBox[{
                StyleBox["finalfitting",
                 FontWeight->"Plain"], 
                StyleBox["[",
                 FontWeight->"Bold"], 
                StyleBox[
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}],
                 FontWeight->"Bold"], 
                StyleBox["]",
                 FontWeight->"Bold"]}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"finalfitting", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
            "]"}], "]"}]}], ",", "\"\< \[PlusMinus] \>\"", ",", 
         RowBox[{
          FractionBox["2", "\[Pi]"], 
          SuperscriptBox[
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{
                RowBox[{"finalfitting", 
                 StyleBox["[",
                  FontWeight->"Bold"], 
                 StyleBox[
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}],
                  FontWeight->"Bold"], 
                 StyleBox["]",
                  FontWeight->"Bold"]}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "2"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"finalfitting", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
             "]"}], "]"}], 
           FractionBox["1", "2"]]}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"finalfitting", ",", 
        RowBox[{"ChartElementFunction", "\[Rule]", 
         RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"prob", "=", 
        RowBox[{"BarChart", "[", 
         RowBox[{"finalfitting", ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"ChartElementFunction", "\[Rule]", 
             RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ","}], 
           "*)"}], 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", 
           "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", 
                 "1"}], "}"}], ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", 
               "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<F:\\\\Experiments\\\\Phonon Shift_Wigner \
Function\\\\Paper\\\\Figures\\\\SuperPos01Add3Prob.jpg\>\"", ",", "prob", ",", 
         RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Show", "[", 
       RowBox[{"Fblue", ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"blue", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"List", "@@", "#"}], "&"}], "/@", "finalfitting"}], ",", 
       RowBox[{"Param", "\[LeftDoubleBracket]", 
        RowBox[{"kmax", "+", "4"}], "\[RightDoubleBracket]"}]}], "}"}]}]}], 
   RowBox[{"(*", 
    RowBox[{"\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "*)"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{
  3.594614526029631*^9, {3.5946146091493855`*^9, 3.594614640748193*^9}, {
   3.594615389562022*^9, 3.5946154144544463`*^9}, {3.5946158932178297`*^9, 
   3.5946158934978456`*^9}, {3.5946160549450803`*^9, 
   3.5946160550800877`*^9}, {3.5946164087733183`*^9, 
   3.5946164115084743`*^9}, {3.5946164804164157`*^9, 
   3.5946164811714587`*^9}, {3.594620296531685*^9, 3.594620299546858*^9}, {
   3.5946203807195005`*^9, 3.5946204614621186`*^9}, {3.5946208211126895`*^9, 
   3.594620835213496*^9}, {3.59462090836768*^9, 3.5946209126049223`*^9}, {
   3.5946209671740437`*^9, 3.594620970764249*^9}, {3.594682909789115*^9, 
   3.5946829132322025`*^9}, {3.5952120026433687`*^9, 3.595212010173379*^9}, {
   3.595212152773026*^9, 3.595212153303027*^9}, 3.595212734612481*^9, 
   3.5956564750058055`*^9, 3.595656960615581*^9, 3.5958079484283934`*^9, 
   3.5958153231214447`*^9, {3.595911166943272*^9, 3.5959111762532854`*^9}, {
   3.597551352879163*^9, 3.597551358860505*^9}, {3.5975514194389696`*^9, 
   3.5975514565330915`*^9}, {3.597553408768753*^9, 3.5975534088887596`*^9}, 
   3.59764212456071*^9, {3.5976423440452633`*^9, 3.5976423441082673`*^9}, {
   3.5976518044459233`*^9, 3.5976518258159533`*^9}, 3.598864808165055*^9, {
   3.5988648576538854`*^9, 3.598864858116912*^9}, {3.59886576442975*^9, 
   3.598865764549757*^9}, {3.5988687649773717`*^9, 3.598868766225443*^9}, {
   3.598869079248347*^9, 3.5988690797303743`*^9}, {3.598869156286753*^9, 
   3.598869156854786*^9}, {3.598869342072379*^9, 3.598869343062436*^9}, {
   3.5988696970826845`*^9, 3.598869697978736*^9}, 3.598919339310058*^9, {
   3.5989274248035216`*^9, 3.5989274251395407`*^9}, {3.5989276286031785`*^9, 
   3.5989276292212133`*^9}, {3.598930963756938*^9, 3.598930964211964*^9}, {
   3.5989337772398605`*^9, 3.5989337776578836`*^9}, 3.598942781815892*^9, {
   3.5989464096783943`*^9, 3.5989464210480447`*^9}, {3.598950539615613*^9, 
   3.598950540406658*^9}, 3.5991856190508585`*^9, {3.599185785551382*^9, 
   3.599185787058468*^9}, {3.5991885605121*^9, 3.5991885605671034`*^9}, {
   3.599188635072365*^9, 3.599188636630454*^9}, 3.599188696317868*^9, {
   3.5991888759171405`*^9, 3.5991888781402674`*^9}, 3.599188915788421*^9, 
   3.5991889686444445`*^9, 3.599189079579789*^9, {3.5991891213311777`*^9, 
   3.5991891246913695`*^9}, 3.5991893276949806`*^9, {3.5991894207873054`*^9, 
   3.5991894242735047`*^9}, 3.599189510290425*^9, 3.5991896617840896`*^9, 
   3.59918976091876*^9, {3.599190141676538*^9, 3.599190141836547*^9}, {
   3.5991905208332243`*^9, 3.599190524681444*^9}, 3.5991905551291857`*^9, {
   3.5991947059540977`*^9, 3.599194787484212*^9}, {3.599194895093454*^9, 
   3.5991949360957994`*^9}, {3.599195093338793*^9, 3.599195133082066*^9}, {
   3.599207205004758*^9, 3.5992072247398868`*^9}, {3.599269033359766*^9, 
   3.5992690343397675`*^9}, {3.599286297339493*^9, 3.5992863001836557`*^9}, {
   3.5992863342976065`*^9, 3.599286349616483*^9}, {3.5992864056556883`*^9, 
   3.599286429769068*^9}, 3.601091923645848*^9, 3.6018603668541*^9, {
   3.601861307157338*^9, 3.6018613072973385`*^9}, {3.6018614496175375`*^9, 
   3.6018614501875386`*^9}, {3.601861584237726*^9, 3.6018615844177265`*^9}, 
   3.6018621122984657`*^9, {3.601862931759613*^9, 3.6018629365796194`*^9}, {
   3.6018643107562404`*^9, 3.6018643233262577`*^9}, {3.6018644554964433`*^9, 
   3.601864456756445*^9}, {3.601864555436583*^9, 3.601864557716586*^9}, {
   3.6018647500768557`*^9, 3.601864763206874*^9}, {3.601864823246958*^9, 
   3.6018648737370286`*^9}, {3.6018650078972178`*^9, 
   3.6018650250472417`*^9}, {3.601865072457308*^9, 3.6018650759573126`*^9}, {
   3.6018651436874075`*^9, 3.6018651502074165`*^9}, 3.6018652854676065`*^9, {
   3.601865385125747*^9, 3.6018653900157537`*^9}, 3.601865494945901*^9, {
   3.601865609766062*^9, 3.601865610736063*^9}, {3.601865798836327*^9, 
   3.6018657997463284`*^9}, {3.601865833796376*^9, 3.6018658358563786`*^9}, {
   3.6018658821364436`*^9, 3.6018658840364466`*^9}, 3.6018659262365055`*^9, {
   3.6018659799265804`*^9, 3.6018659818465834`*^9}, {3.601866078066718*^9, 
   3.601866190046875*^9}, {3.6018662490869575`*^9, 3.601866290377015*^9}, {
   3.601866328047068*^9, 3.601866364367119*^9}, {3.601866466327262*^9, 
   3.601866466507262*^9}, {3.60186660053745*^9, 3.601866642127508*^9}, {
   3.6018667236976223`*^9, 3.6018667428376493`*^9}, {3.6018671782882595`*^9, 
   3.6018672184683156`*^9}, {3.6018672496083593`*^9, 3.601867251218362*^9}, {
   3.601867323138462*^9, 3.6018673237484627`*^9}, {3.601867708349002*^9, 
   3.601867708769002*^9}, {3.601867751979062*^9, 3.6018677526690636`*^9}, {
   3.6018680069494195`*^9, 3.601868008149421*^9}, {3.601868077399518*^9, 
   3.6018680861695304`*^9}, {3.6018681255595856`*^9, 3.601868162559637*^9}, {
   3.6018682055996976`*^9, 3.6018682057496977`*^9}, {3.6018682518897624`*^9, 
   3.601868252389763*^9}, {3.6018682999898295`*^9, 3.6018683003798304`*^9}, {
   3.6018684285500107`*^9, 3.6018684289900107`*^9}, {3.601868482610086*^9, 
   3.601868498850109*^9}, {3.6018686197402782`*^9, 3.6018686201902785`*^9}, {
   3.6021976248532352`*^9, 3.602197627033239*^9}, 3.6022041374363556`*^9, 
   3.6034310198454514`*^9, {3.604271191701441*^9, 3.6042712283645377`*^9}, {
   3.604273051984843*^9, 3.6042730576311655`*^9}, {3.6042730956793423`*^9, 
   3.6042731767509794`*^9}, {3.6042732820069995`*^9, 3.6042733383022194`*^9}, 
   3.604273414520579*^9, {3.6042734774391775`*^9, 3.604273478135217*^9}, {
   3.6042735647711725`*^9, 3.604273579027988*^9}, {3.6042737479226484`*^9, 
   3.60427374847468*^9}, {3.6042738362096977`*^9, 3.6042738368657355`*^9}, {
   3.6042740112167077`*^9, 3.60427401143272*^9}, {3.604274124272174*^9, 
   3.6042741614473004`*^9}, {3.6042742548556433`*^9, 3.604274255398674*^9}, {
   3.604274329862933*^9, 3.6042743336061473`*^9}, {3.604274576756055*^9, 
   3.604274586523614*^9}, {3.604275081345916*^9, 3.604275090314429*^9}, {
   3.60427526097619*^9, 3.6042752611592007`*^9}, {3.6042759037329535`*^9, 
   3.6042759206909237`*^9}, {3.604276040963803*^9, 3.6042760442829924`*^9}, 
   3.6042762754432144`*^9, {3.604276351363557*^9, 3.604276353555682*^9}, {
   3.604276470346362*^9, 3.604276470553374*^9}, 3.60427657557038*^9, {
   3.604276701920607*^9, 3.604276706424865*^9}, {3.604276889239321*^9, 
   3.6042768928955307`*^9}, {3.604277226388605*^9, 3.604277230716853*^9}, {
   3.604277408516022*^9, 3.6042774101481156`*^9}, {3.604277521083461*^9, 
   3.604277521562488*^9}, {3.604277575282561*^9, 3.604277596402769*^9}, {
   3.6042776950744123`*^9, 3.604277698997637*^9}, {3.604277807673853*^9, 
   3.604277810617021*^9}, {3.604277882521134*^9, 3.604277883224174*^9}, {
   3.6042779547412643`*^9, 3.6042779719462485`*^9}, {3.604278041426223*^9, 
   3.6042780420742598`*^9}, {3.604278160233018*^9, 3.604278187612584*^9}, {
   3.604278853247656*^9, 3.6042788765639896`*^9}, {3.604297409891423*^9, 
   3.6042974131114273`*^9}, {3.604297614211709*^9, 3.6042976147017097`*^9}, {
   3.6042984158828316`*^9, 3.6042984166028323`*^9}, {3.604350643198391*^9, 
   3.604350657538411*^9}, {3.6043507056684785`*^9, 3.6043507071984806`*^9}, 
   3.6046421260219812`*^9, {3.6046422284538403`*^9, 3.604642231444011*^9}, {
   3.604642634754079*^9, 3.604642649905946*^9}, {3.6046427236431637`*^9, 
   3.604642746338462*^9}, 3.604642850441416*^9, 3.604642931833071*^9, {
   3.6046429906884375`*^9, 3.6046430004719973`*^9}, {3.604643054792104*^9, 
   3.6046430592253575`*^9}, {3.6046430912161875`*^9, 
   3.6046430995666647`*^9}, {3.6046431441132126`*^9, 
   3.6046431449772625`*^9}, {3.604643188447749*^9, 3.604643234221367*^9}, {
   3.604643358989503*^9, 3.6046433596845427`*^9}, 3.604643579330106*^9, {
   3.605392320628787*^9, 3.6053923207897964`*^9}, {3.6114773249495096`*^9, 
   3.611477329109748*^9}, {3.6114774043320503`*^9, 3.611477408954314*^9}, {
   3.61190534093718*^9, 3.6119053512007666`*^9}, {3.6127452137906365`*^9, 
   3.6127452138786416`*^9}, {3.613208784279352*^9, 3.613208791102742*^9}, 
   3.6156902098017907`*^9, 3.6156905616069126`*^9, 3.615694931070832*^9, {
   3.615695033936715*^9, 3.6156950762531357`*^9}, {3.615695135093501*^9, 
   3.6156951481902504`*^9}, {3.615695231005987*^9, 3.6156952321890545`*^9}, 
   3.6156952668700385`*^9, 3.6156952994859037`*^9, {3.615695369229893*^9, 
   3.6156953779563923`*^9}, 3.6156954301343765`*^9, 3.615695478644151*^9, {
   3.6156955728995423`*^9, 3.6156955894234877`*^9}, {3.615695684036899*^9, 
   3.6156956861540203`*^9}, {3.6156960627045574`*^9, 
   3.6156960718130784`*^9}, {3.6156961048179665`*^9, 3.6156961129514313`*^9}, 
   3.6163452956341066`*^9, 3.6186231358876944`*^9, 3.6186234914200296`*^9, {
   3.6186235295252094`*^9, 3.6186235300862417`*^9}, {3.6270250550288773`*^9, 
   3.62702505646896*^9}, {3.62702513847365*^9, 3.6270251424518776`*^9}, 
   3.6270251925447426`*^9, {3.6270254821623077`*^9, 3.6270254823303175`*^9}, {
   3.6270255954637885`*^9, 3.627025610041622*^9}, {3.6270258147433305`*^9, 
   3.6270258188145633`*^9}, {3.6270259505390973`*^9, 3.627025982495925*^9}, {
   3.630746663901641*^9, 3.63074673179695*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["CoherentStateFittingBlue", "Subsection",
 CellChangeTimes->{3.595219235715763*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoherentStateFittingBlue", "[", 
   RowBox[{"blue_List", ",", "\[Alpha]startpoint_", ",", 
    RowBox[{"kmax_:", "15"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"red", ",", 
      RowBox[{"(*", 
       RowBox[{"blue", ","}], "*)"}], "nred", ",", "nblue", ",", "Pred", ",", 
      "Pblue", ",", "\[Chi]", ",", "result", ",", "distribution", ",", 
      "fittingred", ",", "fittingblue", ",", "Fred", ",", "Fblue", ",", 
      "\[Alpha]", ",", "Ar", ",", "Ab", ",", "Bb", ",", "\[Lambda]r", ",", 
      "\[Lambda]b", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", 
      "pk", ",", "i", ",", "t", ",", "devlength", ",", "devnumber", ",", 
      "Deviation", ",", "dev", ",", "RMS", ",", "rms", ",", "Parabolic", ",", 
      "pkbestfitting", ",", "pkbestvalue", ",", "x", ",", "DataDeviation", 
      ",", "ddev", ",", "DataPk", ",", "normalization", ",", "n", ",", "j", 
      ",", "\[Sigma]\[Chi]", ",", "interval", ",", "Uncertain"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{
       "\[Alpha]_", ",", "Ablue_", ",", "Bblue_", ",", "\[Lambda]blue_", ",", 
        "\[CapitalOmega]blue_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              SuperscriptBox["\[Alpha]", "2"], ")"}], "i"], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              SuperscriptBox["\[Alpha]", "2"]}]]}], 
           RowBox[{
            RowBox[{"(", "i", ")"}], "!"}]], "*", 
          RowBox[{"(", 
           RowBox[{"Bblue", "-", 
            RowBox[{"Ablue", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]blue"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]blue", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{
       "\[Alpha]_", ",", "Ab_", ",", "Bb_", ",", "\[Lambda]b_", ",", 
        "\[CapitalOmega]b_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"j", "=", "1"}], "nblue"], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{
            "\[Alpha]", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
             "\[CapitalOmega]b", ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"], "/", 
        "nblue"}]}]}], ";", "\n", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nblue", "*", 
           RowBox[{"\[Chi]", "[", 
            RowBox[{
            "\[Alpha]", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
             "\[CapitalOmega]b"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"\[Alpha]", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[Lambda]b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"\[CapitalOmega]b", "\[GreaterEqual]", 
              RowBox[{"0.95", 
               RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}]}], "&&", 
             RowBox[{"\[CapitalOmega]b", "\[LessEqual]", " ", 
              RowBox[{"1.05", 
               RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}]}], "&&"}], "*)"}], 
           RowBox[{"Ab", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ab", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Bb", "\[GreaterEqual]", "0"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "\[Alpha]startpoint"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ab", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Bb", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]b", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]b", ",", 
          RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Deviation", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "devnumber", "-", "1"}], ")"}], " ", 
            "devlength", " "}], "devnumber"], "*", 
          RowBox[{"result", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{"result", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RMS", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"rms", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
          RowBox[{"Deviation", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"FindMinValue", "[", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{
              RowBox[{"Deviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Ab", ",", "Bb", ",", 
              "\[Lambda]b", ",", "\[CapitalOmega]b"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ab", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Bb", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Fit", "[", 
       RowBox[{"RMS", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x", ",", 
          SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{
       RowBox[{"FindArgMin", "[", 
        RowBox[{"Parabolic", ",", "x"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"FindMinValue", "[", 
       RowBox[{"Parabolic", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{"Length", "[", "blue", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{
             RowBox[{"result", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interval", "=", 
      RowBox[{"x", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{"Parabolic", "\[Equal]", 
         RowBox[{"pkbestvalue", "+", "\[Sigma]\[Chi]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "pkbestfitting"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "pkbestfitting"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"distribution", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"pk", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"distribution", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"result", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}], "2"], ")"}], 
           RowBox[{"i", "-", "1"}]], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"result", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}], "2"]}]]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "!"}]]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
         RowBox[{"result", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Pi]b\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"\[Pi]", "/", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Alpha] = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \[PlusMinus] \>\"", ",", 
       "Uncertain"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "distribution", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"distribution", ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Show", "[", 
       RowBox[{"Fblue", ",", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"blue", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "result", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       "Uncertain"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{
  3.594614481334075*^9, {3.5946146066852446`*^9, 3.5946146091493855`*^9}, 
   3.5946146446934185`*^9, {3.595208133694813*^9, 3.5952081645519724`*^9}, {
   3.5952116425819874`*^9, 3.5952116506519985`*^9}, {3.5952143849635544`*^9, 
   3.595214385363555*^9}, {3.5952144476259522`*^9, 3.5952144485259533`*^9}, {
   3.5952194363489327`*^9, 3.595219439108937*^9}, 3.5952219086860685`*^9, {
   3.595221956096388*^9, 3.5952219615163956`*^9}, {3.5952221531345406`*^9, 
   3.5952221573345466`*^9}, {3.595222291896309*^9, 3.59522229256631*^9}, {
   3.595238659277508*^9, 3.595238708288311*^9}, 3.5958153360465574`*^9, 
   3.5958881613960176`*^9, 3.595888237334382*^9, {3.595888571149384*^9, 
   3.595888597539421*^9}, 3.595888700592127*^9, 3.5959068333725452`*^9, {
   3.595910094131813*^9, 3.595910111311837*^9}, {3.5959101868942356`*^9, 
   3.5959101917442427`*^9}, {3.5959102263275075`*^9, 
   3.5959102349175196`*^9}, {3.5959110741997833`*^9, 3.595911115371081*^9}, 
   3.5959171825073853`*^9, {3.595917335999338*^9, 3.595917391579816*^9}, {
   3.595917448651082*^9, 3.5959174580210953`*^9}, {3.5959278714623294`*^9, 
   3.5959278781257105`*^9}, 3.595927920517135*^9, {3.595927965812726*^9, 
   3.5959279717320642`*^9}, {3.595928011755354*^9, 3.595928065835447*^9}, 
   3.595935214145471*^9, {3.5961619035083537`*^9, 3.596161912116846*^9}, {
   3.5961619990358176`*^9, 3.596161999179826*^9}, {3.5961620507557755`*^9, 
   3.596162146099229*^9}, 3.596164618403637*^9, 3.596172953166358*^9, {
   3.5961730569742956`*^9, 3.5961730571823072`*^9}, {3.596173175646083*^9, 
   3.5961733138529882`*^9}, {3.5961761491921597`*^9, 
   3.5961762051123586`*^9}, {3.596176239513326*^9, 3.596176246520727*^9}, {
   3.5961762792325983`*^9, 3.596176279408608*^9}, {3.596178162384308*^9, 
   3.5961781625523176`*^9}, {3.5961782394567165`*^9, 3.596178280847084*^9}, 
   3.5961783283197994`*^9, {3.596180595209458*^9, 3.5961806160886517`*^9}, {
   3.5961806472824364`*^9, 3.596180650624627*^9}, {3.5961806849315896`*^9, 
   3.5961806950561686`*^9}, {3.5970276504587708`*^9, 
   3.5970276572271576`*^9}, {3.599207349785039*^9, 3.59920734980404*^9}, 
   3.601091930017212*^9, {3.601591235308117*^9, 3.601591258336434*^9}, {
   3.601591755750884*^9, 3.6015917635983334`*^9}, {3.6015918813750696`*^9, 
   3.6015918842952366`*^9}, {3.602200806721693*^9, 3.6022010016719656`*^9}, {
   3.6022036254056387`*^9, 3.602203625525639*^9}, 3.6022041497163725`*^9, 
   3.603425466792835*^9, {3.6034266481624055`*^9, 3.603426650831558*^9}, 
   3.6034266846804943`*^9, {3.6034269144946384`*^9, 3.6034269438703194`*^9}, {
   3.6034269774362392`*^9, 3.6034269778232613`*^9}, {3.6034270410858793`*^9, 
   3.6034270461011667`*^9}, {3.6034272759123106`*^9, 3.6034272769043674`*^9}, 
   3.603427378560182*^9, {3.6034285412556844`*^9, 3.603428542079732*^9}, 
   3.6119070218243213`*^9, {3.6157887217147346`*^9, 3.6157887315302963`*^9}, {
   3.619764760912339*^9, 3.6197647727770176`*^9}, {3.631369457624111*^9, 
   3.6313694577311172`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["SqueezedStateFittingBlue", "Subsection",
 CellChangeTimes->{
  3.595219235715763*^9, {3.6012687784955034`*^9, 3.6012687838468094`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SqueezedStateFittingBlue", "[", 
   RowBox[{"blue_List", ",", "\[Alpha]startpoint_", ",", 
    RowBox[{"kmax_:", "40"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"red", ",", 
      RowBox[{"(*", 
       RowBox[{"blue", ","}], "*)"}], "nred", ",", "nblue", ",", "Pred", ",", 
      "Pblue", ",", "\[Chi]", ",", "result", ",", "distribution", ",", 
      "fittingred", ",", "fittingblue", ",", "Fred", ",", "Fblue", ",", 
      "\[Alpha]", ",", "Ar", ",", "Ab", ",", "Bb", ",", "\[Lambda]r", ",", 
      "\[Lambda]b", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", 
      "pk", ",", "i", ",", "t", ",", "devlength", ",", "devnumber", ",", 
      "Deviation", ",", "dev", ",", "RMS", ",", "rms", ",", "Parabolic", ",", 
      "pkbestfitting", ",", "pkbestvalue", ",", "x", ",", "DataDeviation", 
      ",", "ddev", ",", "DataPk", ",", "normalization", ",", "n", ",", "j", 
      ",", "\[Sigma]\[Chi]", ",", "interval", ",", "Uncertain"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{
       "\[Alpha]_", ",", "Ablue_", ",", "Bblue_", ",", "\[Lambda]blue_", ",", 
        "\[CapitalOmega]blue_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"N", "[", 
            RowBox[{"Cosh", "[", "\[Alpha]", "]"}], "]"}]], 
          FractionBox[
           RowBox[{"i", "!"}], 
           RowBox[{
            SuperscriptBox["2", "i"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "/", "2"}], ")"}], "!"}], ")"}], "2"]}]], 
          RowBox[{"N", "[", 
           SuperscriptBox[
            RowBox[{"Tanh", "[", "\[Alpha]", "]"}], "i"], "]"}], 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "i"]}], ")"}], "2"], "*", 
          RowBox[{"(", 
           RowBox[{"Bblue", "-", 
            RowBox[{"Ablue", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]blue"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]blue", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{
       "\[Alpha]_", ",", "Ab_", ",", "Bb_", ",", "\[Lambda]b_", ",", 
        "\[CapitalOmega]b_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"j", "=", "1"}], "nblue"], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{
            "\[Alpha]", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
             "\[CapitalOmega]b", ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"], "/", 
        "nblue"}]}]}], ";", "\n", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nblue", "*", 
           RowBox[{"\[Chi]", "[", 
            RowBox[{
            "\[Alpha]", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
             "\[CapitalOmega]b"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"\[Alpha]", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[Lambda]b", "\[GreaterEqual]", "0"}], 
           RowBox[{"(*", 
            RowBox[{"&&", 
             RowBox[{"\[CapitalOmega]b", "\[GreaterEqual]", 
              RowBox[{"0.95", 
               RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}]}], "&&", 
             RowBox[{"\[CapitalOmega]b", "\[LessEqual]", " ", 
              RowBox[{"1.05", 
               RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}]}]}], "*)"}], "&&", 
           RowBox[{"Ab", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ab", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Bb", "\[GreaterEqual]", "0"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "\[Alpha]startpoint"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ab", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Bb", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]b", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]b", ",", 
          RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Deviation", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "devnumber", "-", "1"}], ")"}], " ", 
            "devlength", " "}], "devnumber"], "*", 
          RowBox[{"result", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{"result", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RMS", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"rms", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
          RowBox[{"Deviation", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"FindMinValue", "[", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{
              RowBox[{"Deviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Ab", ",", "Bb", ",", 
              "\[Lambda]b", ",", "\[CapitalOmega]b"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ab", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Bb", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Fit", "[", 
       RowBox[{"RMS", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x", ",", 
          SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{
       RowBox[{"FindArgMin", "[", 
        RowBox[{"Parabolic", ",", "x"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"FindMinValue", "[", 
       RowBox[{"Parabolic", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{"Length", "[", "blue", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"pkbestfitting", ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interval", "=", 
      RowBox[{"x", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{"Parabolic", "\[Equal]", 
         RowBox[{"pkbestvalue", "+", "\[Sigma]\[Chi]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "pkbestfitting"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "pkbestfitting"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"distribution", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"pk", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", "=", "0"}], ",", 
       RowBox[{"n", "\[LessEqual]", "kmax"}], ",", 
       RowBox[{"n", "++"}], ",", 
       RowBox[{
        RowBox[{"distribution", "[", 
         RowBox[{"[", 
          RowBox[{"n", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"Abs", "[", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"Cosh", "[", 
            RowBox[{"result", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]], 
          FractionBox[
           RowBox[{"n", "!"}], 
           RowBox[{
            SuperscriptBox["2", "n"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "/", "2"}], ")"}], "!"}], ")"}], "2"]}]], 
          SuperscriptBox[
           RowBox[{"Tanh", "[", 
            RowBox[{"result", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "n"], 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "n"]}], ")"}], "2"]}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{
        RowBox[{"result", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<r = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \[PlusMinus] \>\"", ",", 
       "Uncertain"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "distribution", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"distribution", ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Show", "[", 
       RowBox[{"Fblue", ",", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"blue", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{
  3.594614481334075*^9, {3.5946146066852446`*^9, 3.5946146091493855`*^9}, 
   3.5946146446934185`*^9, {3.595208133694813*^9, 3.5952081645519724`*^9}, {
   3.5952116425819874`*^9, 3.5952116506519985`*^9}, {3.5952143849635544`*^9, 
   3.595214385363555*^9}, {3.5952144476259522`*^9, 3.5952144485259533`*^9}, {
   3.5952194363489327`*^9, 3.595219439108937*^9}, 3.5952219086860685`*^9, {
   3.595221956096388*^9, 3.5952219615163956`*^9}, {3.5952221531345406`*^9, 
   3.5952221573345466`*^9}, {3.595222291896309*^9, 3.59522229256631*^9}, {
   3.595238659277508*^9, 3.595238708288311*^9}, 3.5958153360465574`*^9, 
   3.5958881613960176`*^9, 3.595888237334382*^9, {3.595888571149384*^9, 
   3.595888597539421*^9}, 3.595888700592127*^9, 3.5959068333725452`*^9, {
   3.595910094131813*^9, 3.595910111311837*^9}, {3.5959101868942356`*^9, 
   3.5959101917442427`*^9}, {3.5959102263275075`*^9, 
   3.5959102349175196`*^9}, {3.5959110741997833`*^9, 3.595911115371081*^9}, 
   3.5959171825073853`*^9, {3.595917335999338*^9, 3.595917391579816*^9}, {
   3.595917448651082*^9, 3.5959174580210953`*^9}, {3.5959278714623294`*^9, 
   3.5959278781257105`*^9}, 3.595927920517135*^9, {3.595927965812726*^9, 
   3.5959279717320642`*^9}, {3.595928011755354*^9, 3.595928065835447*^9}, 
   3.595935214145471*^9, {3.5961619035083537`*^9, 3.596161912116846*^9}, {
   3.5961619990358176`*^9, 3.596161999179826*^9}, {3.5961620507557755`*^9, 
   3.596162146099229*^9}, 3.596164618403637*^9, 3.596172953166358*^9, {
   3.5961730569742956`*^9, 3.5961730571823072`*^9}, {3.596173175646083*^9, 
   3.5961733138529882`*^9}, {3.5961761491921597`*^9, 
   3.5961762051123586`*^9}, {3.596176239513326*^9, 3.596176246520727*^9}, {
   3.5961762792325983`*^9, 3.596176279408608*^9}, {3.596178162384308*^9, 
   3.5961781625523176`*^9}, {3.5961782394567165`*^9, 3.596178280847084*^9}, 
   3.5961783283197994`*^9, {3.596180595209458*^9, 3.5961806160886517`*^9}, {
   3.5961806472824364`*^9, 3.596180650624627*^9}, {3.5961806849315896`*^9, 
   3.5961806950561686`*^9}, {3.5970276504587708`*^9, 
   3.5970276572271576`*^9}, {3.599207349785039*^9, 3.59920734980404*^9}, {
   3.601268918471509*^9, 3.6012689676193204`*^9}, {3.601860396668805*^9, 
   3.601860397008825*^9}, {3.6021970533324356`*^9, 3.6021970977424974`*^9}, {
   3.6021971334925475`*^9, 3.6021971746926055`*^9}, {3.602197219422668*^9, 
   3.60219727807275*^9}, {3.6021973363428316`*^9, 3.6021973637828703`*^9}, {
   3.602197541633119*^9, 3.6021975463531256`*^9}, {3.602197598053198*^9, 
   3.6021975999232006`*^9}, {3.602197739463396*^9, 3.602197740623398*^9}, {
   3.602197783583458*^9, 3.602197786003461*^9}, {3.6021981491979713`*^9, 
   3.6021981611479883`*^9}, {3.60219823385809*^9, 3.6021982398380985`*^9}, {
   3.6021982743381467`*^9, 3.6021982864781637`*^9}, {3.6021983165482063`*^9, 
   3.6021983274982214`*^9}, {3.602198452158396*^9, 3.60219846225841*^9}, {
   3.602198612928621*^9, 3.6021986335386496`*^9}, {3.602198906599032*^9, 
   3.602198910419037*^9}, {3.602199138669357*^9, 3.6021991604593873`*^9}, 
   3.6022007244215775`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["ThermalStateFittingBlue", "Subsection",
 CellChangeTimes->{3.5952192555779123`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ThermalStateFittingBlue", "[", 
   RowBox[{"blue_List", ",", "nbarstartpoint_", ",", 
    RowBox[{"kmax_:", "15"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"red", ",", 
      RowBox[{"(*", 
       RowBox[{"blue", ","}], "*)"}], "nred", ",", "nblue", ",", "Pred", ",", 
      "Pblue", ",", "\[Chi]", ",", "result", ",", "distribution", ",", 
      "fittingred", ",", "fittingblue", ",", "Fred", ",", "Fblue", ",", 
      "nbar", ",", "Ar", ",", "Ab", ",", "Bb", ",", "\[Lambda]r", ",", 
      "\[Lambda]b", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", 
      "pk", ",", "i", ",", "t", ",", "devlength", ",", "devnumber", ",", 
      "Deviation", ",", "dev", ",", "RMS", ",", "rms", ",", "Parabolic", ",", 
      "pkbestfitting", ",", "pkbestvalue", ",", "x", ",", "DataDeviation", 
      ",", "ddev", ",", "DataPk", ",", "normalization", ",", "n", ",", "j", 
      ",", "\[Sigma]\[Chi]", ",", "interval", ",", "Uncertain"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{
       "nbar_", ",", "Ablue_", ",", "Bblue_", ",", "\[Lambda]blue_", ",", 
        "\[CapitalOmega]blue_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           SuperscriptBox["nbar", "i"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "nbar"}], ")"}], 
            RowBox[{"i", "+", "1"}]]], "*", 
          RowBox[{"(", 
           RowBox[{"Bblue", "-", 
            RowBox[{"Ablue", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]blue"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]blue", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{
       "nbar_", ",", "Ab_", ",", "Bb_", ",", "\[Lambda]b_", ",", 
        "\[CapitalOmega]b_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"j", "=", "1"}], "nblue"], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{
            "nbar", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
             "\[CapitalOmega]b", ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"], "/", 
        "nblue"}]}]}], ";", "\n", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Chi]", "[", 
           RowBox[{
           "nbar", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
            "\[CapitalOmega]b"}], "]"}], ",", 
          RowBox[{
           RowBox[{"nbar", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"\[Lambda]b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[CapitalOmega]b", "\[GreaterEqual]", 
            RowBox[{"0.95", 
             RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}]}], "&&", 
           RowBox[{"\[CapitalOmega]b", "\[LessEqual]", " ", 
            RowBox[{"1.05", 
             RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}]}], "&&", 
           RowBox[{"Ab", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ab", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Bb", "\[GreaterEqual]", "0"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nbar", ",", "nbarstartpoint"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ab", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Bb", ",", "1.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]b", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]b", ",", 
          RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Deviation", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "devnumber", "-", "1"}], ")"}], " ", 
            "devlength", " "}], "devnumber"], "*", 
          RowBox[{"result", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{"result", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RMS", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"rms", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
          RowBox[{"Deviation", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"FindMinValue", "[", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{
              RowBox[{"Deviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Ab", ",", "Bb", ",", 
              "\[Lambda]b", ",", "\[CapitalOmega]b"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ab", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Bb", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Fit", "[", 
       RowBox[{"RMS", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x", ",", 
          SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{
       RowBox[{"FindArgMin", "[", 
        RowBox[{"Parabolic", ",", "x"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"FindMinValue", "[", 
       RowBox[{"Parabolic", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{"Length", "[", "blue", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"pkbestfitting", ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interval", "=", 
      RowBox[{"x", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{"Parabolic", "\[Equal]", 
         RowBox[{"pkbestvalue", "+", "\[Sigma]\[Chi]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "pkbestfitting"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "pkbestfitting"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"distribution", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"pk", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"distribution", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        FractionBox[
         SuperscriptBox["pkbestfitting", 
          RowBox[{"i", "-", "1"}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "pkbestfitting"}], ")"}], "i"]]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"\[Pi]", "/", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<<n> = \>\"", ",", "pkbestfitting", ",", "\"\< \[PlusMinus] \>\"", 
       ",", "Uncertain"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"distribution", ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Show", "[", 
       RowBox[{"Fblue", ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"blue", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{
  3.5946144591578064`*^9, 3.5946146091493855`*^9, 3.5946146482766237`*^9, {
   3.5951380307884235`*^9, 3.5951380308504267`*^9}, {3.5951383574011045`*^9, 
   3.595138359808242*^9}, {3.595138570850313*^9, 3.5951386276935644`*^9}, {
   3.5952081966561766`*^9, 3.5952081971261773`*^9}, {3.5952116696492424`*^9, 
   3.5952116850023174`*^9}, {3.59521944887895*^9, 3.595219454530085*^9}, {
   3.595221973266412*^9, 3.595221979765548*^9}, 3.5958153423165665`*^9, {
   3.5959111456211233`*^9, 3.595911155383256*^9}, {3.6018604176270037`*^9, 
   3.6018604179370213`*^9}, {3.601869362171317*^9, 3.601869423331403*^9}, {
   3.601869454011446*^9, 3.6018695174715347`*^9}, {3.601869557971592*^9, 
   3.601869565711602*^9}, {3.6018696814217644`*^9, 3.6018696829217663`*^9}, {
   3.601869790301917*^9, 3.601869793541921*^9}, {3.6022036416456614`*^9, 
   3.6022036417856617`*^9}, {3.6022041631563916`*^9, 
   3.6022041643363934`*^9}, {3.6218229353336706`*^9, 3.6218229367337503`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["DisplacedNumberStateFittingBlue", "Subsection",
 CellChangeTimes->{3.5952192757679405`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "\[Alpha]V", ",", "\[Alpha]Cur", ",", "T1fitting", ",", "T2fitting", ",", 
    "\[Eta]\[CapitalOmega]fitting", ",", "\[Delta]fitting"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]V", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Cur", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T1fitting", "=", 
   RowBox[{"45", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2fitting", "=", 
   RowBox[{"50", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]\[CapitalOmega]fitting", "=", 
   RowBox[{"2", "\[Pi]", " ", 
    FractionBox["0.5", "13.5"], 
    SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]fitting", "=", 
   RowBox[{"2", "\[Pi]", " ", "20", " ", 
    SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DNSFittingBlue", "[", 
   RowBox[{"blue_List", ",", "numberstate_", ",", 
    RowBox[{"kmax_:", "15"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"red", ",", 
      RowBox[{"(*", 
       RowBox[{"blue", ","}], "*)"}], "nred", ",", "nblue", ",", "Ared", ",", 
      "Ablue", ",", "Bblue", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b",
       ",", "level", ",", "Pk", ",", "p", ",", "Zero", ",", "zero", ",", 
      "Origin", ",", "Pred", ",", "Pblue", ",", "\[Chi]red", ",", 
      "\[Chi]blue", ",", "na", ",", "V", ",", "Cur", ",", "\[Chi]", ",", 
      "result", ",", "distribution", ",", "\[Alpha]", ",", "nbar", ",", 
      "fittingred", ",", "fittingblue", ",", "Fred", ",", "Fblue", ",", "dev",
       ",", "param", ",", "parabolic", ",", "RMS", ",", "rms", ",", 
      "fittingpara", ",", "findpoint", ",", "bestfitting", ",", "bestvalue", 
      ",", "unc", ",", "devlength", ",", "devnumber", ",", "Deviation", ",", 
      "Param", ",", "Parabolic", ",", "pkbestfitting", ",", "pkbestvalue", 
      ",", "DataDeviation", ",", "DataPk", ",", "\[Sigma]\[Chi]", ",", 
      "Uncertain", ",", "interval", ",", "finalfitting", ",", "errorBar", ",",
       "ddev", ",", "normalization", ",", "i", ",", "j", ",", "n", ",", "x", 
      ",", "t", ",", "nik", ",", "K"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ablue", "=", "0.9"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bblue", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalOmega]b", "=", 
      RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"level", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"T1_", ",", "T2_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "T1", " ", "\[Delta]fitting"}]], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "T2", " ", "\[Delta]fitting"}]], 
             "+", 
             RowBox[{"\[ImaginaryI]", " ", "T2", " ", "\[Delta]fitting"}]}], 
            ")"}]}], 
          RowBox[{"T2", " ", 
           SuperscriptBox["\[Delta]fitting", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "T1", " ", "\[Delta]fitting"}]], 
            " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"\[ImaginaryI]", " ", "T1", " ", "\[Delta]fitting"}]}], 
             ")"}]}]}], 
          RowBox[{"T1", " ", 
           SuperscriptBox["\[Delta]fitting", "2"]}]]}], ")"}], " ", 
       "\[Eta]\[CapitalOmega]fitting"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nik", "[", 
       RowBox[{"n_", ",", "k_", ",", "T1_", ",", "T2_"}], "]"}], ":=", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"T1", ",", "T2"}], "]"}], "]"}], "2"], "2"]}]], 
       RowBox[{"Sum", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"\[Alpha]", "[", 
              RowBox[{"T1", ",", "T2"}], "]"}], 
             RowBox[{"k", "-", "n"}]], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{"\[Alpha]", "[", 
                  RowBox[{"T1", ",", "T2"}], "]"}], "]"}], "2"]}], ")"}], 
             "i"], 
            SqrtBox[
             RowBox[{
              RowBox[{"n", "!"}], 
              RowBox[{"k", "!"}]}]]}], ")"}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k", "-", "n", "+", "i"}], ")"}], "!"}], 
           RowBox[{"i", "!"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "i"}], ")"}], "!"}]}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"n", "-", "k"}], ",", "0"}], "]"}], ",", "n"}], "}"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"K", "[", 
       RowBox[{"n_", ",", "k_", ",", "T1_", ",", "T2_"}], "]"}], ":=", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"nik", "[", 
          RowBox[{"n", ",", "k", ",", "T1", ",", "T2"}], "]"}], "*", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Delta]fitting", 
           RowBox[{"(", 
            RowBox[{"k", "+", 
             FractionBox["1", "2"]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"T1", "+", "T2"}], ")"}]}]]}], "]"}], "2"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pk", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"p", ",", 
        RowBox[{"kmax", "+", "5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Zero", "=", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"zero", ",", 
         RowBox[{"kmax", "+", "5"}]}], "]"}], "*", "0"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Origin", "=", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Most", "[", 
             RowBox[{"Most", "[", 
              RowBox[{"Most", "[", "Zero", "]"}], "]"}], "]"}], ",", 
            "\[CapitalOmega]b"}], "]"}], ",", "Ablue"}], "]"}], ",", 
        "Bblue"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", "kmax"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Origin", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{"K", "[", 
         RowBox[{
         "numberstate", ",", "i", ",", "T1fitting", ",", "T2fitting"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "5"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"kmax", "+", "4"}], "]"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], " ", "t"}]], 
             " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "3"}], "]"}], "]"}], " ", "t"}], 
              "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", "Pk_List", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "nblue"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pblue", "[", 
             RowBox[{"Pk", ",", 
              RowBox[{"blue", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
            RowBox[{"blue", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], ")"}], 
       "/", 
       RowBox[{"(", "nblue", ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"na", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"i", " ", 
        RowBox[{"p", "[", 
         RowBox[{"i", "+", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"i", "-", "na"}], ")"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Cur", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"kmax", "-", "1"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "+", 
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "2"}], "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"p", "[", 
            RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", "nblue", ")"}], "*", 
            RowBox[{"\[Chi]", "[", "Pk", "]"}]}], "+", 
           RowBox[{"\[Alpha]V", "*", "V"}], "+", 
           RowBox[{"\[Alpha]Cur", "*", "Cur"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], 
              RowBox[{"kmax", "+", "1"}]], 
             RowBox[{"p", "[", "i", "]"}]}], "\[Equal]", "1"}], "&&", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Pk", "\[GreaterEqual]", "Zero"}], "]"}]}], "]"}], "&&", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"Pk", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "]"}], "\[LessEqual]", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
            "]"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "4"}], "]"}], "\[LessEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "3"}], "]"}], "\[LessEqual]", " ", 
            RowBox[{"1.05", "*", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "3"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"0.95", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "5"}], "]"}], "\[GreaterEqual]", "0"}]}]}], 
         "}"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"Pk", ",", "Origin"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kmax", "+", "1"}], ",", 
          RowBox[{
           RowBox[{"2", "devnumber"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{
           RowBox[{"2", " ", "devnumber"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{
          RowBox[{"Deviation", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "devnumber", "-", "1"}], ")"}], 
              "devlength"}], "devnumber"], 
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"result", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Param", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"param", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}], ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"parabolic", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RMS", "=", 
            RowBox[{"Array", "[", 
             RowBox[{"rms", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"fittingpara", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"Param", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",", 
           RowBox[{"findpoint", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"result", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{
               RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", 
                RowBox[{"Deviation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
                RowBox[{"FindMinValue", "[", 
                 RowBox[{
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", 
                    RowBox[{"i", "\[Rule]", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"fittingpara", ",", "findpoint"}], "}"}], "]"}]}],
                  "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"Parabolic", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Fit", "[", 
             RowBox[{"RMS", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "x", ",", 
                SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ",", 
           RowBox[{"Clear", "[", 
            RowBox[{"RMS", ",", "fittingpara", ",", "findpoint"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{
          RowBox[{"Parabolic", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestfitting", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestvalue", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"FindArgMin", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"FindMinValue", "[", 
             RowBox[{
              RowBox[{"Parabolic", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "}"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"pkbestfitting", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pkbestfitting", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", "0"}], 
          ",", 
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"result", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalization", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"pkbestfitting", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{"Length", "[", "blue", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DataPk", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"DataPk", ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"unc", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"interval", "=", 
            RowBox[{"x", "/.", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{"pkbestvalue", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", "\[Sigma]\[Chi]"}]}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"finalfitting", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DataPk", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "\[Rule]", 
         " ", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"errorBar", "[", 
        RowBox[{"type_:", "\"\<Rectangle\>\""}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0_", ",", "x1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y0_", ",", "y1_"}], "}"}]}], "}"}], ",", "value_", ",", 
        "meta_"}], "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "error", "}"}], ",", 
        RowBox[{
         RowBox[{"error", "=", 
          RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"error", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"error", "===", 
             RowBox[{"{", "}"}]}], ",", "0", ",", 
            RowBox[{"Last", "[", "error", "]"}]}], "]"}]}], ";", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ChartElementData", "[", "type", "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x0", ",", "x1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y0", ",", "y1"}], "}"}]}], "}"}], ",", "value", ",", 
             "meta"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}]}], "}"}]}], "}"}], 
              "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"pkbestfitting", "/", "normalization"}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "4"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"distribution", "+", 
       RowBox[{"error", " ", "bar"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"(*", 
       RowBox[{"\"\<Distribution \>\"", ","}], " ", "*)"}], 
      RowBox[{
       RowBox[{"finalfitting", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MatrixForm"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"(*", 
       RowBox[{"\"\<Error Bar \>\"", ","}], " ", "*)"}], 
      RowBox[{
       RowBox[{"finalfitting", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "MatrixForm"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"finalfitting", ",", 
        RowBox[{"ChartElementFunction", "\[Rule]", 
         RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Show", "[", 
       RowBox[{"Fblue", ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"blue", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{
  3.594614427718008*^9, {3.5946146066852446`*^9, 3.5946146091493855`*^9}, 
   3.5946146519968357`*^9, {3.5946159008642673`*^9, 3.5946159010072756`*^9}, {
   3.5946160474946537`*^9, 3.594616047637662*^9}, {3.5946164269293566`*^9, 
   3.5946164302725477`*^9}, {3.594616497014365*^9, 3.5946164976554017`*^9}, 
   3.5946165542116365`*^9, 3.5952117033923426`*^9, 3.595211746863548*^9, {
   3.595211845806366*^9, 3.59521187623055*^9}, 3.5952122903679743`*^9, 
   3.5952127087324443`*^9, {3.595219467160103*^9, 3.595219470880108*^9}, {
   3.5956564998122244`*^9, 3.5956565240246096`*^9}, 3.5956569664559155`*^9, 
   3.5958153481465745`*^9, {3.595911193692395*^9, 3.595911206245494*^9}, {
   3.595911443721871*^9, 3.595911458891892*^9}, {3.5963445156111684`*^9, 
   3.5963445475569954`*^9}, {3.596344719617837*^9, 3.5963447521526976`*^9}, 
   3.5963452993279943`*^9, {3.596345388969122*^9, 3.5963453891631327`*^9}, {
   3.5963457360259724`*^9, 3.5963457942093*^9}, {3.5963458593620267`*^9, 
   3.5963458621781874`*^9}, {3.5963458922169056`*^9, 3.59634589264293*^9}, {
   3.5963493944722233`*^9, 3.5963493982704406`*^9}, {3.5964132308543315`*^9, 
   3.5964132482643557`*^9}, {3.5964135374872065`*^9, 
   3.5964135397472095`*^9}, {3.5964138829173365`*^9, 3.596413883799387*^9}, {
   3.5964139160944734`*^9, 3.5964139167444744`*^9}, {3.596413955955696*^9, 
   3.5964139560756965`*^9}, {3.5964140213702583`*^9, 
   3.5964140509904375`*^9}, {3.596414267516738*^9, 3.5964142705267425`*^9}, {
   3.59641935606828*^9, 3.5964193575082827`*^9}, {3.5964246410984554`*^9, 
   3.5964246415584564`*^9}, {3.5964246863627496`*^9, 3.596424687252751*^9}, {
   3.5964247340830936`*^9, 3.5964247345430946`*^9}, {3.601780026136944*^9, 
   3.601780042784896*^9}, {3.601780226673414*^9, 3.6017802508007936`*^9}, {
   3.6017802921591597`*^9, 3.6017803078860593`*^9}, {3.6017808439177184`*^9, 
   3.601780846276853*^9}, {3.6022017902630696`*^9, 3.6022017956230774`*^9}, {
   3.602201831943128*^9, 3.60220185447316*^9}, {3.6022018994732227`*^9, 
   3.6022019377932763`*^9}, {3.6022019718833237`*^9, 
   3.6022019719933243`*^9}, {3.602202013843383*^9, 3.6022020594234467`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["NumberStateFittingBlue", "Subsection",
 CellChangeTimes->{3.595219291207092*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Alpha]V", ",", "\[Alpha]Cur"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]V", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Cur", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumberStateFittingBlue", "[", 
   RowBox[{"blue_List", ",", "numberstate_", ",", 
    RowBox[{"kmax_:", "15"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"red", ",", 
      RowBox[{"(*", 
       RowBox[{"blue", ","}], "*)"}], "nred", ",", "nblue", ",", "Ared", ",", 
      "Ablue", ",", "Bblue", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b",
       ",", "level", ",", "Pk", ",", "p", ",", "Zero", ",", "zero", ",", 
      "Origin", ",", "Pred", ",", "Pblue", ",", "\[Chi]red", ",", 
      "\[Chi]blue", ",", "na", ",", "V", ",", "Cur", ",", "\[Chi]", ",", 
      "result", ",", "distribution1", ",", "distribution2", ",", "\[Alpha]", 
      ",", "nbar", ",", "fittingred", ",", "fittingblue", ",", "Fred", ",", 
      "Fblue", ",", "dev", ",", "param", ",", "parabolic", ",", "RMS", ",", 
      "rms", ",", "fittingpara", ",", "findpoint", ",", "bestfitting", ",", 
      "bestvalue", ",", "unc", ",", "devlength", ",", "devnumber", ",", 
      "Deviation", ",", "Param", ",", "Parabolic", ",", "pkbestfitting", ",", 
      "pkbestvalue", ",", "DataDeviation", ",", "DataPk", ",", 
      "\[Sigma]\[Chi]", ",", "Uncertain", ",", "interval", ",", 
      "finalfitting", ",", "errorBar", ",", "ddev", ",", "normalization", ",",
       "i", ",", "j", ",", "n", ",", "x", ",", "t", ",", "newdistribution", 
      ",", "\[Chi]j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ablue", "=", "0.95"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Bblue", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalOmega]b", "=", 
      RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"level", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Pk", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"p", ",", 
        RowBox[{"kmax", "+", "5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Zero", "=", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"zero", ",", 
         RowBox[{"kmax", "+", "5"}]}], "]"}], "*", "0"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Origin", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Most", "[", 
               RowBox[{"Most", "[", 
                RowBox[{"Most", "[", "Zero", "]"}], "]"}], "]"}], ",", 
              "\[CapitalOmega]b"}], "]"}], ",", "Ablue"}], "]"}], ",", 
          "Bblue"}], "]"}], ",", 
        RowBox[{
         RowBox[{"numberstate", "+", "1"}], "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "5"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"kmax", "+", "4"}], "]"}], "]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"p", "[", 
                 RowBox[{"[", 
                  RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], "  ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}], "0.7"], " ", " ", "t"}]], 
             " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "3"}], "]"}], "]"}], " ", "t"}], 
              "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]j", "[", "Pk_List", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "nblue"], 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             FractionBox[
              RowBox[{"blue", "[", 
               RowBox[{"[", 
                RowBox[{"nblue", ",", "1"}], "]"}], "]"}], "2"]}], ",", "1", 
            ",", "1"}], "]"}], "*", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{"Pk", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        ")"}], "/", 
       RowBox[{"(", "nblue", ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", "Pk_List", "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "nblue"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pblue", "[", 
             RowBox[{"Pk", ",", 
              RowBox[{"blue", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
            RowBox[{"blue", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], ")"}], 
       "/", 
       RowBox[{"(", "nblue", ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"na", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"i", " ", 
        RowBox[{"p", "[", 
         RowBox[{"i", "+", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"i", "-", "na"}], ")"}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Cur", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"kmax", "-", "1"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "+", 
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "2"}], "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"p", "[", 
            RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", "nblue", ")"}], "*", 
            RowBox[{"\[Chi]j", "[", "Pk", "]"}]}], "+", 
           RowBox[{"\[Alpha]V", "*", "V"}], "+", 
           RowBox[{"\[Alpha]Cur", "*", "Cur"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"i", "=", "1"}], 
              RowBox[{"kmax", "+", "1"}]], 
             RowBox[{"p", "[", "i", "]"}]}], "\[Equal]", "1"}], "&&", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Pk", "\[GreaterEqual]", "Zero"}], "]"}]}], "]"}], "&&", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"Pk", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "]"}], "\[LessEqual]", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
            "]"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "4"}], "]"}], "\[LessEqual]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "3"}], "]"}], "\[LessEqual]", " ", 
            RowBox[{"1.05", "*", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "3"}], "]"}], "\[GreaterEqual]", " ", 
            RowBox[{"0.95", "\[CapitalOmega]b"}]}], "&&", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"kmax", "+", "5"}], "]"}], "\[GreaterEqual]", "0"}]}]}], 
         "}"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"Pk", ",", "Origin"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kmax", "+", "1"}], ",", 
          RowBox[{
           RowBox[{"2", "devnumber"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{
           RowBox[{"2", " ", "devnumber"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{
          RowBox[{"Deviation", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "devnumber", "-", "1"}], ")"}], 
              "devlength"}], "devnumber"], 
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"result", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Param", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"param", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}], ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"parabolic", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RMS", "=", 
            RowBox[{"Array", "[", 
             RowBox[{"rms", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"fittingpara", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"Param", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",", 
           RowBox[{"findpoint", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"result", ",", 
                RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{
               RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", 
                RowBox[{"Deviation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"RMS", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
                RowBox[{"FindMinValue", "[", 
                 RowBox[{
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", 
                    RowBox[{"i", "\[Rule]", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"fittingpara", ",", "findpoint"}], "}"}], "]"}]}],
                  "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"Parabolic", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Fit", "[", 
             RowBox[{"RMS", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "x", ",", 
                SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ",", 
           RowBox[{"Clear", "[", 
            RowBox[{"RMS", ",", "fittingpara", ",", "findpoint"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{
          RowBox[{"Parabolic", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestfitting", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"bestvalue", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"FindArgMin", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"FindMinValue", "[", 
             RowBox[{
              RowBox[{"Parabolic", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
           RowBox[{
            RowBox[{"pkbestvalue", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "}"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"pkbestfitting", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pkbestfitting", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", "0"}], 
          ",", 
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"result", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalization", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{"pkbestfitting", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{"Length", "[", "blue", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DataPk", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{"DataPk", ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"unc", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"interval", "=", 
            RowBox[{"x", "/.", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{"pkbestvalue", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", "\[Sigma]\[Chi]"}]}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"interval", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"pkbestfitting", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "}"}], 
         ",", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"finalfitting", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DataPk", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "\[Rule]", 
         " ", 
         RowBox[{
          RowBox[{"Uncertain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"errorBar", "[", 
        RowBox[{"type_:", "\"\<Rectangle\>\""}], "]"}], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0_", ",", "x1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y0_", ",", "y1_"}], "}"}]}], "}"}], ",", "value_", ",", 
        "meta_"}], "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "error", "}"}], ",", 
        RowBox[{
         RowBox[{"error", "=", 
          RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"error", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"error", "===", 
             RowBox[{"{", "}"}]}], ",", "0", ",", 
            RowBox[{"Last", "[", "error", "]"}]}], "]"}]}], ";", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ChartElementData", "[", "type", "]"}], "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x0", ",", "x1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y0", ",", "y1"}], "}"}]}], "}"}], ",", "value", ",", 
             "meta"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "+", "error"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "x0"}], "+", "x1"}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "3"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", 
                    RowBox[{"y1", "-", "error"}]}], "}"}]}], "}"}]}], "}"}], 
              "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"pkbestfitting", "/", "normalization"}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "4"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "150"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ","}], 
         "*)"}], 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<t(us)\>\"", ",", "\"\<State\>\""}], "}"}]}], ","}], 
         "*)"}], 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "15"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], ";", 
     RowBox[{"(*", 
      RowBox[{"distribution", "+", 
       RowBox[{"error", " ", "bar"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Distribution \>\"", ",", " ", 
         RowBox[{
          RowBox[{"finalfitting", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Error Bar \>\"", ",", " ", 
         RowBox[{
          RowBox[{"finalfitting", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
        "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", 
         RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"finalfitting", ",", 
        RowBox[{"ChartElementFunction", "\[Rule]", 
         RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "PlotLabel", "\[Rule]", 
           "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ","}], "*)"}], 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5", ",", "12.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.3"}], "\[IndentingNewLine]", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Phonon\>\"", ",", "\"\<Distribution\>\""}], "}"}]}], 
          ","}], "*)"}], 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontWeight", "\[Rule]", "\"\<Bold\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "15"}]}], "}"}]}], ",", 
        RowBox[{"ChartStyle", "\[Rule]", "\"\<DarkRainbow\>\""}]}], "]"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Show", "[", 
       RowBox[{"Fblue", ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"blue", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], "]"}]}],
           ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "150"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.3"}]}], "]"}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.5946000777212353`*^9, 3.594600111785184*^9}, {
   3.594600151443452*^9, 3.5946002009542837`*^9}, {3.5946002318150487`*^9, 
   3.594600248503003*^9}, 3.5946002986808734`*^9, 3.5946004243210597`*^9, {
   3.594600479527217*^9, 3.5946004863356066`*^9}, {3.5946005770287943`*^9, 
   3.594600603263294*^9}, {3.5946078205511*^9, 3.5946078261754217`*^9}, 
   3.5946078697809153`*^9, {3.594608286474749*^9, 3.5946082936011567`*^9}, {
   3.5946083405228405`*^9, 3.5946084976268263`*^9}, {3.594608537013079*^9, 
   3.5946086296813793`*^9}, {3.5946098430227785`*^9, 
   3.5946098930396395`*^9}, {3.5946116774997044`*^9, 3.594611842521143*^9}, 
   3.5946118775221453`*^9, {3.5946119160263476`*^9, 3.5946119234887743`*^9}, 
   3.5946119537385044`*^9, {3.5946120749144354`*^9, 3.594612119648994*^9}, {
   3.594612151257802*^9, 3.5946122287192326`*^9}, {3.594612300048312*^9, 
   3.594612409837592*^9}, {3.594612444208558*^9, 3.5946124911262417`*^9}, {
   3.59461252274605*^9, 3.59461252326608*^9}, {3.5946125618952894`*^9, 
   3.5946125895978737`*^9}, {3.594612620621648*^9, 3.5946127158520947`*^9}, {
   3.5946128111795473`*^9, 3.594612857346188*^9}, {3.594612892010171*^9, 
   3.5946129193387337`*^9}, {3.594612956394853*^9, 3.594613100129074*^9}, {
   3.5946131317628837`*^9, 3.594613142553501*^9}, {3.5946131858729787`*^9, 
   3.594613267312637*^9}, 3.594613448057975*^9, 3.5946136143504863`*^9, {
   3.5946138081755724`*^9, 3.594613808286579*^9}, {3.594614037552692*^9, 
   3.594614041736931*^9}, 3.5946142107045956`*^9, 3.5946143856466017`*^9, 
   3.5946146091493855`*^9, 3.594614655333027*^9, {3.594615906698601*^9, 
   3.5946159068166075`*^9}, {3.5946160406252613`*^9, 
   3.5946160407922707`*^9}, {3.5946164382550044`*^9, 3.594616441011162*^9}, {
   3.594616502096656*^9, 3.594616503098713*^9}, {3.594616615999171*^9, 
   3.5946166495850916`*^9}, {3.594617065875902*^9, 3.59461706601091*^9}, {
   3.594617159088234*^9, 3.594617268791508*^9}, {3.59461732039946*^9, 
   3.5946173359263477`*^9}, {3.5946174707130575`*^9, 
   3.5946174727201724`*^9}, {3.594617533854669*^9, 3.5946175372858653`*^9}, {
   3.5946176395737157`*^9, 3.5946176397237244`*^9}, {3.5946180606918025`*^9, 
   3.5946180659061003`*^9}, {3.595211784572786*^9, 3.5952117865927887`*^9}, {
   3.5952119313578095`*^9, 3.595211959215049*^9}, {3.5952124336857204`*^9, 
   3.5952124973552055`*^9}, {3.595212589431697*^9, 3.5952126738042727`*^9}, {
   3.5952138358981323`*^9, 3.595213851088153*^9}, 3.595815354496583*^9, {
   3.595911212775503*^9, 3.5959112271955233`*^9}, {3.596513161557208*^9, 
   3.5965131623992567`*^9}, 3.596871054044205*^9, {3.5968714114816494`*^9, 
   3.5968714324098463`*^9}, {3.5968714704330215`*^9, 3.59687148788902*^9}, {
   3.5968715822264156`*^9, 3.5968716081548986`*^9}, {3.596871687287425*^9, 
   3.596871809733428*^9}, {3.5968718512778044`*^9, 3.596871871753976*^9}, {
   3.5968719084290733`*^9, 3.596872036297387*^9}, {3.596872125063464*^9, 
   3.596872135535063*^9}, 3.5968721862709646`*^9, {3.5968722221260157`*^9, 
   3.5968722464154053`*^9}, {3.596872314597305*^9, 3.596872342853921*^9}, {
   3.5968727217275915`*^9, 3.5968727273119106`*^9}, {3.5968729133855534`*^9, 
   3.596872919481902*^9}, {3.596948309209408*^9, 3.5969483769119015`*^9}, {
   3.5969484103919487`*^9, 3.5969484108019485`*^9}, {3.596948631468404*^9, 
   3.5969486393184147`*^9}, {3.596949184754701*^9, 3.5969491885047064`*^9}, {
   3.596949231027916*^9, 3.5969492438511305`*^9}, {3.5969492959204464`*^9, 
   3.596949297800449*^9}, {3.596949334042618*^9, 3.596949367004833*^9}, {
   3.596949401054881*^9, 3.5969494083861074`*^9}, {3.5969494392461505`*^9, 
   3.596949439716151*^9}, {3.596949569808042*^9, 3.596949572077165*^9}, {
   3.5969497714521837`*^9, 3.596949777734327*^9}, {3.5969498811778803`*^9, 
   3.596949952971404*^9}, {3.59695010881736*^9, 3.5969501242573814`*^9}, {
   3.5969501797566767`*^9, 3.596950210478977*^9}, {3.5969502572471848`*^9, 
   3.596950259017187*^9}, 3.597027961985589*^9, {3.6018604252124376`*^9, 
   3.6018604255804586`*^9}, {3.602202085593483*^9, 3.6022022149836645`*^9}, {
   3.6022022458237076`*^9, 3.60220226911374*^9}, 3.6022041793864145`*^9}]
}, Closed]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{952, 985},
WindowMargins->{{Automatic, 250}, {Automatic, 287}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification->1.100000023841858,
FrontEndVersion->"10.0 for Microsoft Windows (32-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 124, 2, 78, "Section"],
Cell[706, 26, 13813, 197, 133, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[14556, 228, 125, 2, 78, "Section"],
Cell[CellGroupData[{
Cell[14706, 234, 134, 2, 75, "Subsection"],
Cell[14843, 238, 43523, 1021, 122, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[58403, 1264, 86, 1, 61, "Subsection"],
Cell[58492, 1267, 24948, 613, 122, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[83477, 1885, 137, 2, 61, "Subsection"],
Cell[83617, 1889, 25899, 642, 122, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[109553, 2536, 136, 2, 61, "Subsection"],
Cell[109692, 2540, 24319, 595, 122, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[134048, 3140, 91, 1, 61, "Subsection"],
Cell[134142, 3143, 48568, 1164, 122, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[182747, 4312, 84, 1, 61, "Subsection"],
Cell[182834, 4315, 43157, 1026, 122, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[226040, 5347, 65, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[226130, 5352, 138, 2, 53, "Subsection"],
Cell[226271, 5356, 44481, 1025, 2684, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[270789, 6386, 88, 1, 53, "Subsection"],
Cell[270880, 6389, 20366, 488, 1322, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[291283, 6882, 141, 2, 53, "Subsection"],
Cell[291427, 6886, 20304, 485, 1969, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[311768, 7376, 89, 1, 43, "Subsection"],
Cell[311860, 7379, 16761, 417, 1841, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[328658, 7801, 97, 1, 47, "Subsection"],
Cell[328758, 7804, 36349, 922, 3912, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}]
}, Closed]],
Cell[CellGroupData[{
Cell[365144, 8731, 86, 1, 47, "Subsection"],
Cell[365233, 8734, 36616, 894, 3781, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
