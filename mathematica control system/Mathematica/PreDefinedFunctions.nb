(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    628109,      14220]
NotebookOptionsPosition[    625687,      14165]
NotebookOutlinePosition[    626141,      14183]
CellTagsIndexPosition[    626098,      14180]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Pre-defined functions", "Section",
 CellChangeTimes->{{3.7763155594693995`*^9, 
  3.7763155654164886`*^9}},ExpressionUUID->"c11c87c0-a425-4993-a937-\
084d58749241"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "SequenceSlice", ",", "RamseyFrequencyFit", ",", "HeatingRateFit", ",", 
    "StateOverlap", ",", "ScanPar", ",", "CalibrateForCarrierRabi", ",", 
    "CalibrateForCarrierShift", ",", "TwoQubitState", ",", 
    "MSGatePopulationFit", ",", "GaussianCoherenceFit", ",", 
    "FittedAveragePhononNumberVariation", ",", "SpinPopulationVariation", ",",
     "openCloseTaggedCell", ",", "ThermalStateFit", ",", 
    "ThermalStateFitBlue", ",", "TwoModeSBC", ",", "OneModeSBC", ",", 
    "CoherenceTimeFit", ",", "PhononNumberFitByRBRatio", ",", 
    "QRMFullCalibrate", ",", "IonPositionFit", ",", 
    "CalibrateDuringExperiment", ",", "QRModelFullCalibrate", ",", 
    "SpotSizeFitByRaman", ",", "PhononNumberVariationPlot", ",", 
    "SDFScanTimeFit", ",", "SDFScanDetuningFit", ",", "IonFind", ",", 
    "LaserWavelengthSet", ",", "PulseInducedCarrShift", ",", "PseudoCounts", 
    ",", "BesselCoherenceFit", ",", "CheckLockPoint", ",", "QRMWaveString", 
    ",", "ToInterval"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "ErrorBarPlots`"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7763153852944083`*^9, 3.7763154109617352`*^9}, {
   3.776378872256059*^9, 3.7763788728664265`*^9}, {3.776498414341691*^9, 
   3.7764984412108026`*^9}, {3.7765540070193615`*^9, 3.776554027933407*^9}, {
   3.7765574639437075`*^9, 3.7765574968875647`*^9}, {3.776557905906227*^9, 
   3.776557908442442*^9}, {3.7765579647079024`*^9, 3.776557971785965*^9}, {
   3.776558028463323*^9, 3.7765581477122707`*^9}, {3.776558187022097*^9, 
   3.77655818746192*^9}, {3.776570671447076*^9, 3.7765706777532043`*^9}, {
   3.776570730400346*^9, 3.776570753223284*^9}, 3.7765709765826807`*^9, {
   3.776571514061926*^9, 3.7765715855596323`*^9}, {3.7765719456123047`*^9, 
   3.776571947724653*^9}, {3.776572040265059*^9, 3.7765720681574326`*^9}, {
   3.7765721438608875`*^9, 3.7765721563504705`*^9}, {3.776572200397621*^9, 
   3.7765722054132023`*^9}, {3.7765852953852863`*^9, 3.776585297775891*^9}, {
   3.7766538158308015`*^9, 3.776653816126012*^9}, {3.776664875670165*^9, 
   3.776664972356722*^9}, {3.7766650070269613`*^9, 3.7766650355837746`*^9}, {
   3.7766651285021687`*^9, 3.7766651342299333`*^9}, {3.7766652747998357`*^9, 
   3.7766652813054295`*^9}, {3.7766653344352803`*^9, 
   3.7766653604675856`*^9}, {3.776673479533696*^9, 3.776673500207828*^9}, {
   3.7766735335047417`*^9, 3.776673755755886*^9}, {3.7766739334644227`*^9, 
   3.7766739427755113`*^9}, {3.776678579583706*^9, 3.7766786656450567`*^9}, {
   3.776678757072441*^9, 3.7766787747120733`*^9}, {3.7766788354635324`*^9, 
   3.77667883824337*^9}, {3.77667890400642*^9, 3.776679041689842*^9}, {
   3.7766792089270997`*^9, 3.7766792234711866`*^9}, {3.7766796588631287`*^9, 
   3.7766796688384395`*^9}, {3.776737549712283*^9, 3.7767375591939144`*^9}, {
   3.776742525790571*^9, 3.7767425729503937`*^9}, {3.776742664478509*^9, 
   3.776742730246545*^9}, {3.776742797301139*^9, 3.776742797928461*^9}, 
   3.7767428570772076`*^9, {3.776808875249836*^9, 3.776808902201726*^9}, {
   3.776853563248475*^9, 3.776853564892078*^9}, 3.776853877273296*^9, {
   3.776853973932682*^9, 3.7768539917300644`*^9}, {3.77685403592881*^9, 
   3.7768541463304296`*^9}, {3.776854204877784*^9, 3.776854240701936*^9}, {
   3.776854292304871*^9, 3.776854442354411*^9}, {3.7768545393538866`*^9, 
   3.7768545578035245`*^9}, {3.7768550233220205`*^9, 3.776855026393802*^9}, {
   3.776855106533387*^9, 3.776855163404228*^9}, {3.7768552008161325`*^9, 
   3.7768552287503934`*^9}, {3.7768552769763637`*^9, 3.7768552979821625`*^9}, 
   3.776855337279023*^9, {3.77699929868612*^9, 3.7769993889479923`*^9}, {
   3.7769994344891453`*^9, 3.77699943901005*^9}, {3.776999489835605*^9, 
   3.776999497306616*^9}, {3.7769995590135174`*^9, 3.7769995876841297`*^9}, {
   3.7769997152099323`*^9, 3.7769997338081713`*^9}, {3.7769997955958576`*^9, 
   3.776999869388894*^9}, {3.776999917956411*^9, 3.7769999583275414`*^9}, {
   3.777000008548176*^9, 3.7770000228299646`*^9}, {3.777178518473421*^9, 
   3.777178528544489*^9}, 3.777178564310841*^9, {3.7771788495241127`*^9, 
   3.77717894022755*^9}, {3.7771805501612015`*^9, 3.777180603323034*^9}, {
   3.777180672489067*^9, 3.777180672705488*^9}, {3.7771903791571097`*^9, 
   3.7771903977344294`*^9}, {3.77719043056962*^9, 3.7771905021651564`*^9}, {
   3.777190537381979*^9, 3.777190572886032*^9}, {3.777190654572584*^9, 
   3.777190657917637*^9}, {3.7771907223044515`*^9, 3.777190784222867*^9}, 
   3.7771909394776783`*^9, 3.77719100947449*^9, {3.777191077132556*^9, 
   3.7771910783891954`*^9}, {3.777191117208384*^9, 3.777191257169095*^9}, {
   3.7771913384148245`*^9, 3.777191341181426*^9}, {3.7771914004359655`*^9, 
   3.777191495271353*^9}, {3.7771921595090218`*^9, 3.777192159962809*^9}, {
   3.7771946655043893`*^9, 3.7771947215146046`*^9}, {3.7771947865835943`*^9, 
   3.777194848451146*^9}, {3.777195900593465*^9, 3.7771959135976896`*^9}, {
   3.7772018685759697`*^9, 3.777201877502099*^9}, {3.777201935941818*^9, 
   3.777201951851272*^9}, {3.77720198518114*^9, 3.777202009016399*^9}, {
   3.7772020714374695`*^9, 3.7772021066562862`*^9}, {3.7772021808897676`*^9, 
   3.7772022277424726`*^9}, {3.7772023794776964`*^9, 
   3.7772025125248966`*^9}, {3.7772025452204604`*^9, 3.777202581797644*^9}, {
   3.7772026132754664`*^9, 3.7772026458214293`*^9}, {3.7772027113831015`*^9, 
   3.7772028643749647`*^9}, {3.7772028978434625`*^9, 
   3.7772029518769636`*^9}, {3.7772032136997857`*^9, 
   3.7772032500455894`*^9}, {3.7772033174323807`*^9, 3.7772033429611106`*^9}, 
   3.7772034970719814`*^9, 3.777241172994464*^9, {3.77724648842017*^9, 
   3.7772465797160225`*^9}, 3.7772466733380833`*^9, {3.777247175283695*^9, 
   3.7772471858274975`*^9}, {3.777281505776205*^9, 3.7772815159639606`*^9}, {
   3.7774173412845755`*^9, 3.7774173577884407`*^9}, {3.777418825327888*^9, 
   3.7774188270971565`*^9}, {3.777437934306897*^9, 3.7774379563309994`*^9}, {
   3.777438485518824*^9, 3.7774384856355124`*^9}, {3.777439196454612*^9, 
   3.77743920445422*^9}, {3.7777050998174706`*^9, 3.777705140356061*^9}, {
   3.7777052547561274`*^9, 3.7777052584821634`*^9}, {3.777707374553282*^9, 
   3.7777073761270723`*^9}, {3.777707784655362*^9, 3.777707792470463*^9}, {
   3.7777078382779627`*^9, 3.7777078639911995`*^9}, {3.7777085285460215`*^9, 
   3.777708572844556*^9}, {3.777709312306058*^9, 3.7777093687969875`*^9}, {
   3.7777097632551126`*^9, 3.7777097873357153`*^9}, {3.7777099221322374`*^9, 
   3.7777099393023205`*^9}, {3.7777099977669716`*^9, 3.777710009749926*^9}, {
   3.7777101490613747`*^9, 3.7777101519057674`*^9}, 3.777712243514305*^9, {
   3.7777122772690363`*^9, 3.7777123174914722`*^9}, {3.7777123615586257`*^9, 
   3.7777123879191313`*^9}, {3.777713613087737*^9, 3.777713619157505*^9}, 
   3.777715039393453*^9, 3.7777150773389783`*^9, {3.777715607670744*^9, 
   3.7777156114177237`*^9}, {3.7777178107615657`*^9, 
   3.7777178198791833`*^9}, {3.777717865755499*^9, 3.7777178964075284`*^9}, {
   3.777793681419482*^9, 3.777793712367176*^9}, {3.77779404357016*^9, 
   3.777794055209036*^9}, {3.7777941033453074`*^9, 3.7777941078606396`*^9}, {
   3.777794189956489*^9, 3.7777942192487974`*^9}, {3.777794284029559*^9, 
   3.7777944025131073`*^9}, {3.7777944471208153`*^9, 3.777794451247779*^9}, {
   3.7777946742565765`*^9, 3.77779467812523*^9}, 3.7778134343154078`*^9, {
   3.777851383641488*^9, 3.7778513946829605`*^9}, {3.7778514395898685`*^9, 
   3.777851457636607*^9}, {3.777851507121273*^9, 3.777851521750152*^9}, {
   3.777851561719265*^9, 3.7778515887828903`*^9}, {3.777853117114765*^9, 
   3.777853133084059*^9}, {3.7778542832632046`*^9, 3.7778543399795313`*^9}, 
   3.77785987370522*^9, {3.7779540259014635`*^9, 3.777954040789649*^9}, {
   3.777954671640602*^9, 3.77795473649716*^9}, {3.777961303031126*^9, 
   3.777961339513564*^9}, {3.777961402558964*^9, 3.777961403340873*^9}, {
   3.7779647969552755`*^9, 3.7779648471889386`*^9}, {3.777964905622673*^9, 
   3.777964939108124*^9}, {3.777964978620459*^9, 3.7779650111135645`*^9}, {
   3.777965203478136*^9, 3.7779652058009243`*^9}, {3.7782181211860466`*^9, 
   3.7782181321756573`*^9}, {3.7782182573568926`*^9, 
   3.7782182620912323`*^9}, {3.7784084205474634`*^9, 3.778408420658167*^9}, {
   3.7784084703582573`*^9, 3.7784084978327837`*^9}, {3.778409017841837*^9, 
   3.778409018710513*^9}, {3.7784618961458673`*^9, 3.778461908538726*^9}, {
   3.778462179081231*^9, 3.7784622099716225`*^9}, {3.7784626255697536`*^9, 
   3.7784626399792194`*^9}, {3.778462742745398*^9, 3.7784627760782585`*^9}, {
   3.7784629830451975`*^9, 3.7784629832885466`*^9}, {3.778463061607104*^9, 
   3.7784630703606944`*^9}, {3.778463310245186*^9, 3.778463368636035*^9}, {
   3.7784634256455784`*^9, 3.7784634287891717`*^9}, {3.778463484501184*^9, 
   3.7784635169264708`*^9}, {3.7784727032481384`*^9, 3.778472729484975*^9}, {
   3.778472997457353*^9, 3.778473012545005*^9}, {3.7787319890494795`*^9, 
   3.778732115317808*^9}, {3.7787321530907936`*^9, 3.778732168728973*^9}, {
   3.778732240348071*^9, 3.778732310970211*^9}, {3.7787323537862396`*^9, 
   3.7787323719726057`*^9}, {3.778732509643319*^9, 3.7787325322069793`*^9}, {
   3.7787326472357435`*^9, 3.778732699892926*^9}, {3.778732736875699*^9, 
   3.7787327771579742`*^9}, {3.778732867983936*^9, 3.7787328991426096`*^9}, {
   3.7787367835338254`*^9, 3.7787368338163576`*^9}, {3.7787512003554063`*^9, 
   3.778751200539914*^9}, {3.7787512530435066`*^9, 3.778751256806443*^9}, 
   3.778753088809078*^9, {3.7787531304397473`*^9, 3.778753165007306*^9}, {
   3.7787531980499415`*^9, 3.7787533011183124`*^9}, {3.778753340501991*^9, 
   3.778753420078185*^9}, {3.778753456365145*^9, 3.778753489271147*^9}, {
   3.7787535714892755`*^9, 3.7787535793831654`*^9}, {3.7787537953585186`*^9, 
   3.7787537961184864`*^9}, {3.7787540474443655`*^9, 3.778754056233859*^9}, {
   3.778842046507412*^9, 3.7788420524086304`*^9}, {3.7795134041846266`*^9, 
   3.779513418493362*^9}, {3.7795134555213404`*^9, 3.77951346343019*^9}, {
   3.779586767081542*^9, 3.77958677211907*^9}, {3.7795868888997707`*^9, 
   3.7795868958880825`*^9}, {3.779586990537966*^9, 3.7795869920967975`*^9}, 
   3.77966542134295*^9, 3.779686750813852*^9, {3.7796868485774093`*^9, 
   3.7796868501821175`*^9}, {3.7796870496616616`*^9, 
   3.7796873001388254`*^9}, {3.7796873331086564`*^9, 
   3.7796873334986134`*^9}, {3.779687365481085*^9, 3.779687368936843*^9}, {
   3.7798578400838623`*^9, 3.779857852790865*^9}, {3.7798580861596704`*^9, 
   3.779858087830202*^9}, {3.779858136789215*^9, 3.7798581758945923`*^9}, {
   3.779858653320281*^9, 3.7798586579349337`*^9}, 3.779858723408764*^9, {
   3.779858787654879*^9, 3.779858807510757*^9}, {3.7798589390019627`*^9, 
   3.7798590099052672`*^9}, {3.779859926931079*^9, 3.7798599776244535`*^9}, 
   3.7798600711651926`*^9, {3.7798605352366304`*^9, 3.779860536931097*^9}, {
   3.7800139276885023`*^9, 3.7800139368908825`*^9}, {3.7801834354284816`*^9, 
   3.7801834375827184`*^9}, {3.7801837148549*^9, 3.780183739943776*^9}, {
   3.780183793436661*^9, 3.780183797045007*^9}, {3.7801839885845594`*^9, 
   3.7801840176886935`*^9}, {3.7801840691220875`*^9, 3.780184127624569*^9}, 
   3.780184508303096*^9, {3.780184780875852*^9, 3.7801847829672556`*^9}, {
   3.780185263594378*^9, 3.7801852887789984`*^9}, {3.780185337050852*^9, 
   3.7801853946278095`*^9}, {3.780185461754218*^9, 3.780185535314414*^9}, {
   3.780185605622311*^9, 3.7801856368477697`*^9}, {3.780185878072394*^9, 
   3.780185881288789*^9}, {3.78021704900165*^9, 3.780217117314226*^9}, {
   3.780217177223153*^9, 3.7802172098797827`*^9}, {3.780307547120505*^9, 
   3.780307575789802*^9}, 3.7803772971917114`*^9, {3.7803776440856256`*^9, 
   3.7803776724946203`*^9}, {3.7803777165308046`*^9, 3.780377762248491*^9}, {
   3.7803778003665094`*^9, 3.7803778848514767`*^9}, {3.7803781457684155`*^9, 
   3.7803781802800827`*^9}, {3.780378214480582*^9, 3.780378214825659*^9}, {
   3.7803783340915728`*^9, 3.7803783506004047`*^9}, {3.7803784550519533`*^9, 
   3.780378512821396*^9}, {3.7803789772957344`*^9, 3.780379033185207*^9}, {
   3.7803790808117867`*^9, 3.7803791094032917`*^9}, {3.7803791488836656`*^9, 
   3.7803792194379034`*^9}, {3.780379262836794*^9, 3.780379332177279*^9}, {
   3.780379588063677*^9, 3.780379608833109*^9}, {3.7803797006384916`*^9, 
   3.78037975011213*^9}, {3.780379785415678*^9, 3.780379896021761*^9}, {
   3.7803799307937317`*^9, 3.7803799344230213`*^9}, 3.7803800393313484`*^9, {
   3.780380075290143*^9, 3.7803801204313717`*^9}, {3.7803802037873597`*^9, 
   3.78038020976038*^9}, {3.780380254048889*^9, 3.7803802602193813`*^9}, {
   3.7803803404956083`*^9, 3.7803803498396096`*^9}, {3.780380403978765*^9, 
   3.7803804226508093`*^9}, 3.780380512264056*^9, {3.780380587243456*^9, 
   3.780380592710828*^9}, {3.7803806520151644`*^9, 3.7803806926644106`*^9}, {
   3.7803807642917776`*^9, 3.780380782322538*^9}, {3.7803910599443564`*^9, 
   3.7803910606295233`*^9}, {3.780391385625025*^9, 3.7803913923530245`*^9}, {
   3.780805507471404*^9, 3.7808055519993477`*^9}, {3.780805617711647*^9, 
   3.7808056393916793`*^9}, {3.7808057666773467`*^9, 3.780805770383437*^9}, {
   3.780805802623235*^9, 3.7808058403543506`*^9}, {3.7808060032029305`*^9, 
   3.7808060313337154`*^9}, 3.7808062858023243`*^9, 3.780806333312293*^9, {
   3.780806471951603*^9, 3.7808065466718187`*^9}, {3.780806617515399*^9, 
   3.7808066259987164`*^9}, {3.7808066643042955`*^9, 
   3.7808066944476995`*^9}, {3.7808067274444733`*^9, 
   3.7808068066397233`*^9}, {3.7808070097197046`*^9, 3.780807037948228*^9}, {
   3.7808071228392487`*^9, 3.7808071603170414`*^9}, {3.7808072669589057`*^9, 
   3.7808072737836576`*^9}, {3.7808073847748923`*^9, 3.780807400848914*^9}, {
   3.7808074327117205`*^9, 3.7808075033588257`*^9}, {3.780807583620225*^9, 
   3.7808075866251907`*^9}, {3.7808881436432877`*^9, 
   3.7808881965996943`*^9}, {3.780889008386162*^9, 3.7808890818218117`*^9}, {
   3.7808893263739357`*^9, 3.780889328532164*^9}, {3.7808893732914877`*^9, 
   3.780889460752637*^9}, {3.7808896566887484`*^9, 3.780889658044124*^9}, 
   3.7808898222361126`*^9, {3.7808900421900053`*^9, 3.7808900816913877`*^9}, {
   3.780890136592594*^9, 3.780890152240755*^9}, {3.7808912486821203`*^9, 
   3.7808912667408347`*^9}, {3.7808984619531994`*^9, 
   3.7808984621626396`*^9}, {3.780898637864852*^9, 3.780898643532697*^9}, {
   3.7808986993534455`*^9, 3.7808987225893173`*^9}, 3.7809081369614305`*^9, {
   3.780908470692111*^9, 3.780908499541973*^9}, {3.781171630241144*^9, 
   3.781171686761962*^9}, {3.7812616496668844`*^9, 3.781261653513595*^9}, {
   3.7812616975607777`*^9, 3.781261732655905*^9}, {3.7812617709215517`*^9, 
   3.781261852897283*^9}, {3.781261897786214*^9, 3.781261963124447*^9}, {
   3.7812620012903605`*^9, 3.781262023380275*^9}, {3.781262338870401*^9, 
   3.7812623610031996`*^9}, {3.781262412522396*^9, 3.7812624245163145`*^9}, {
   3.781262467167232*^9, 3.7812624922631054`*^9}, {3.7813882096817513`*^9, 
   3.781388234905283*^9}, {3.7813883460011244`*^9, 3.781388362884963*^9}, {
   3.7813884231687155`*^9, 3.781388515281333*^9}, {3.781388627000506*^9, 
   3.7813886694100685`*^9}, {3.7813887791734734`*^9, 3.781388821142215*^9}, {
   3.781388949498887*^9, 3.7813889500414352`*^9}, {3.7813894234601336`*^9, 
   3.781389445317669*^9}, {3.781389531035391*^9, 3.7813895767431316`*^9}, {
   3.781389625302246*^9, 3.781389626678564*^9}, {3.781389898824627*^9, 
   3.781389899181672*^9}, {3.7813899429336443`*^9, 3.7813899431650248`*^9}, {
   3.7813899996010704`*^9, 3.7813902056429486`*^9}, {3.7813902400688667`*^9, 
   3.7813902799452047`*^9}, {3.7813903468642097`*^9, 
   3.7813904127888746`*^9}, {3.7813905797991543`*^9, 3.781390580009592*^9}, {
   3.7813907389514537`*^9, 3.781390754629518*^9}, 3.7814323137093983`*^9, {
   3.781432447568187*^9, 3.781432480314597*^9}, {3.7814325370638046`*^9, 
   3.781432553972577*^9}, {3.7814329234787846`*^9, 3.781433015876639*^9}, {
   3.7814330699360404`*^9, 3.781433079846532*^9}, {3.78143318215094*^9, 
   3.7814332974575176`*^9}, {3.7814746651317945`*^9, 
   3.7814746731284046`*^9}, {3.7814747317067194`*^9, 3.781474740391489*^9}, {
   3.781474790245141*^9, 3.781474791860819*^9}, {3.781474852993302*^9, 
   3.78147485661661*^9}, {3.7814789368774805`*^9, 3.7814790151790385`*^9}, {
   3.7815195152178645`*^9, 3.781519536740296*^9}, {3.7815753509638076`*^9, 
   3.781575382734825*^9}, {3.7815754892190013`*^9, 3.781575530411818*^9}, {
   3.7818490621280355`*^9, 3.7818490656625834`*^9}, {3.7818497878872747`*^9, 
   3.7818497933077803`*^9}, {3.781849826804207*^9, 3.7818498302140894`*^9}, {
   3.781850047564869*^9, 3.7818501131728587`*^9}, {3.7819354867682695`*^9, 
   3.7819354870894103`*^9}, {3.782018005485952*^9, 3.782018006480293*^9}, {
   3.782018067567938*^9, 3.7820181277240744`*^9}, {3.7820181838519816`*^9, 
   3.7820181915424166`*^9}, 3.782030301099427*^9, {3.7820303514597583`*^9, 
   3.7820303567246785`*^9}, 3.7820304729389095`*^9, {3.782030504506494*^9, 
   3.782030504644126*^9}, {3.7820305647244644`*^9, 3.782030615069836*^9}, {
   3.7820307407477584`*^9, 3.7820307411905746`*^9}, {3.782031214933955*^9, 
   3.7820312261140585`*^9}, {3.7820994312345915`*^9, 
   3.7820994672113843`*^9}, {3.7820995249479904`*^9, 3.782099526112875*^9}, {
   3.7821139161907015`*^9, 3.7821139664981737`*^9}, {3.7821198562922173`*^9, 
   3.7821199087978115`*^9}, {3.7821199903208103`*^9, 3.782120013167715*^9}, {
   3.782120075601761*^9, 3.7821201152078495`*^9}, {3.7821202599727316`*^9, 
   3.7821202909129934`*^9}, {3.782189261764991*^9, 3.782189262077156*^9}, {
   3.7821893601369333`*^9, 3.782189366537817*^9}, {3.7822645120762815`*^9, 
   3.782264573822166*^9}, {3.7822682271639805`*^9, 3.782268269466857*^9}, {
   3.7822683036833596`*^9, 3.782268405159999*^9}, {3.7822685152396345`*^9, 
   3.7822685333871064`*^9}, {3.782268567456002*^9, 3.782268710871493*^9}, {
   3.782268834501892*^9, 3.7822688752180123`*^9}, {3.7822689105704775`*^9, 
   3.782268912543201*^9}, {3.782268947672261*^9, 3.782269002931492*^9}, {
   3.782269035177264*^9, 3.782269039197513*^9}, {3.7822691357612915`*^9, 
   3.7822691462691917`*^9}, {3.782269275802805*^9, 3.7822693108381157`*^9}, {
   3.782269353924897*^9, 3.782269356762311*^9}, {3.782269636672798*^9, 
   3.7822696542647552`*^9}, {3.7822697067583823`*^9, 3.782269712725425*^9}, {
   3.782269773448047*^9, 3.7822698905130014`*^9}, {3.7822700187809997`*^9, 
   3.782270020997074*^9}, {3.7822705365300283`*^9, 3.782270542520009*^9}, 
   3.782270593495694*^9, {3.7822721845889363`*^9, 3.7822722698289948`*^9}, 
   3.7822724628937197`*^9, {3.782272934053785*^9, 3.782272983234271*^9}, {
   3.782273813874049*^9, 3.7822738683763037`*^9}, {3.78227392607202*^9, 
   3.7822739744656105`*^9}, {3.7822740080109067`*^9, 3.782274023960255*^9}, {
   3.7822745773630285`*^9, 3.782274616427565*^9}, {3.782274844336113*^9, 
   3.7822748447160974`*^9}, {3.782293779695088*^9, 3.7822937871132507`*^9}, 
   3.782358922883029*^9, {3.7823589802576017`*^9, 3.7823590413781595`*^9}, {
   3.7823590818289905`*^9, 3.78235913050007*^9}, {3.7823591871964574`*^9, 
   3.782359279635265*^9}, 3.782359322882618*^9, {3.7823593590698485`*^9, 
   3.7823593739869585`*^9}, {3.7823594398009644`*^9, 
   3.7823594676265554`*^9}, {3.7823595194619417`*^9, 
   3.7823596029437027`*^9}, {3.782359648785118*^9, 3.7823596506790533`*^9}, {
   3.7823598036729307`*^9, 3.78235982011596*^9}, {3.782359881382128*^9, 
   3.782359925222893*^9}, {3.7823599592618685`*^9, 3.7823600288976545`*^9}, {
   3.782360118515009*^9, 3.7823601666303434`*^9}, {3.7823603255094833`*^9, 
   3.7823603547443066`*^9}, 3.7823604220922093`*^9, {3.782360500632185*^9, 
   3.7823606173640327`*^9}, {3.782379873760433*^9, 3.7823798804186287`*^9}, {
   3.7823801163689203`*^9, 3.782380130584905*^9}, {3.782380198221039*^9, 
   3.782380225304614*^9}, {3.7823802570916123`*^9, 3.782380262223888*^9}, {
   3.782380293195068*^9, 3.7823803839553647`*^9}, {3.7823804587044773`*^9, 
   3.782380497910636*^9}, {3.782380570656107*^9, 3.7823805854345875`*^9}, {
   3.7823806164855547`*^9, 3.782380634491404*^9}, 3.782381677080407*^9, {
   3.782381766019573*^9, 3.782381793799288*^9}, {3.7823818563390493`*^9, 
   3.7823819071033*^9}, {3.7823819425285687`*^9, 3.7823819619406586`*^9}, 
   3.782382096817983*^9, {3.7823821650315714`*^9, 3.782382184572318*^9}, {
   3.7823822501310062`*^9, 3.7823822504571342`*^9}, {3.782382335016014*^9, 
   3.7823823355964622`*^9}, {3.7823824181457167`*^9, 
   3.7823824788214626`*^9}, {3.7824714989468403`*^9, 3.782471558602315*^9}, {
   3.782471589052887*^9, 3.7824716030793786`*^9}, {3.782471644718032*^9, 
   3.782471644817765*^9}, {3.782471697755205*^9, 3.7824717080716176`*^9}, {
   3.7824717849639997`*^9, 3.7824717880567293`*^9}, {3.782471938011733*^9, 
   3.7824719748681746`*^9}, {3.7824721110420303`*^9, 3.782472142266533*^9}, {
   3.7824722354722905`*^9, 3.7824722620771456`*^9}, {3.7824723115518456`*^9, 
   3.7824724027918596`*^9}, {3.782472433304266*^9, 3.782472471388425*^9}, {
   3.782472567635051*^9, 3.782472630287511*^9}, {3.78247284052232*^9, 
   3.78247284452761*^9}, {3.7825140890105352`*^9, 3.782514100629465*^9}, {
   3.7825534201858616`*^9, 3.7825534451899977`*^9}, {3.7825535514249134`*^9, 
   3.7825535837594476`*^9}, {3.7825537796306667`*^9, 
   3.7825538393928556`*^9}, {3.7825538722559757`*^9, 3.782553905841166*^9}, {
   3.7825541602827606`*^9, 3.782554204573323*^9}, {3.7825542449872513`*^9, 
   3.782554275844735*^9}, {3.782554400998063*^9, 3.782554489173271*^9}, {
   3.7825546215054007`*^9, 3.7825546566145153`*^9}, {3.782554869814396*^9, 
   3.78255491613852*^9}, {3.7825549676597457`*^9, 3.782554985141*^9}, {
   3.7825550347283964`*^9, 3.7825550415232267`*^9}, {3.782555174812796*^9, 
   3.7825551998219194`*^9}, {3.7825555284611015`*^9, 3.782555530233362*^9}, {
   3.7825555953512297`*^9, 3.782555649585202*^9}, {3.782598368859758*^9, 
   3.782598372059203*^9}, {3.782598547726449*^9, 3.782598635290294*^9}, {
   3.782598667730545*^9, 3.782598677841508*^9}, {3.782598753792406*^9, 
   3.7825989182725687`*^9}, {3.7825989624713755`*^9, 3.782598966265231*^9}, {
   3.7825993184165397`*^9, 3.782599329921773*^9}, {3.782599378909774*^9, 
   3.7825993790424194`*^9}, {3.7825997132646723`*^9, 
   3.7825997428106627`*^9}, {3.782600307968369*^9, 3.78260032393966*^9}, {
   3.7826003807268047`*^9, 3.7826003980833917`*^9}, {3.7826004388094854`*^9, 
   3.7826004417406473`*^9}, {3.7826029154440737`*^9, 3.782602996864349*^9}, {
   3.7826030301383696`*^9, 3.782603041742339*^9}, {3.7826031362775416`*^9, 
   3.782603141132559*^9}, {3.7826037072088084`*^9, 3.7826037123570414`*^9}, {
   3.782605737821727*^9, 3.782605740778819*^9}, {3.7826057717111025`*^9, 
   3.782605809836152*^9}, {3.7826181074285693`*^9, 3.7826181091200457`*^9}, {
   3.7826181416640196`*^9, 3.7826181504724646`*^9}, {3.7827056778111115`*^9, 
   3.7827057002620754`*^9}, {3.782706168007274*^9, 3.7827061822242556`*^9}, {
   3.7831516305443363`*^9, 3.7831516559553847`*^9}, {3.7831604974426975`*^9, 
   3.7831605091264534`*^9}, {3.7833397650940323`*^9, 3.783339780269451*^9}, {
   3.78333981607271*^9, 3.7833398610364723`*^9}, {3.7833399961521573`*^9, 
   3.7833400236595993`*^9}, {3.7834064017623835`*^9, 
   3.7834064183540154`*^9}, {3.783406513638215*^9, 3.7834065171398516`*^9}, {
   3.7834067211951847`*^9, 3.7834067315903873`*^9}, {3.7834084346691675`*^9, 
   3.783408492150456*^9}, {3.7834090220999384`*^9, 3.783409166232438*^9}, {
   3.783409233053443*^9, 3.7834093302764482`*^9}, {3.7834094192958145`*^9, 
   3.7834094712016506`*^9}, {3.7834121027182474`*^9, 
   3.7834121028229675`*^9}, {3.7834121541387434`*^9, 3.783412198650614*^9}, {
   3.7834123333824177`*^9, 3.783412333724101*^9}, {3.783412364613903*^9, 
   3.783412373905274*^9}, {3.7834160035000134`*^9, 3.7834160863211813`*^9}, {
   3.78341627883186*^9, 3.78341628093324*^9}, {3.783416570573597*^9, 
   3.7834165851127176`*^9}, {3.783416677068817*^9, 3.7834166811110077`*^9}, {
   3.7834167245009785`*^9, 3.7834167248400717`*^9}, {3.7834196165584736`*^9, 
   3.7834196168088045`*^9}, {3.7834198846670747`*^9, 3.783419888223564*^9}, {
   3.783420001354041*^9, 3.7834200015076303`*^9}, {3.783421758582719*^9, 
   3.783421758828063*^9}, 3.7834224150341306`*^9, {3.783422451806223*^9, 
   3.783422454119038*^9}, {3.783422496355094*^9, 3.7834225134623475`*^9}, {
   3.7834225644041233`*^9, 3.783422586432218*^9}, {3.7834859244900584`*^9, 
   3.783485927372351*^9}, {3.7834914817148495`*^9, 3.78349148186445*^9}, {
   3.7834916068342667`*^9, 3.7834916141167927`*^9}, {3.7834916444736147`*^9, 
   3.7834916505304184`*^9}, {3.783505337627492*^9, 3.7835053636179905`*^9}, {
   3.7835063164091225`*^9, 3.7835063217269025`*^9}, {3.783506366562008*^9, 
   3.7835063669878693`*^9}, {3.7835064038891916`*^9, 
   3.7835064092438726`*^9}, {3.783507580080925*^9, 3.7835075890349817`*^9}, {
   3.783567752426464*^9, 3.78356776892335*^9}, {3.7838198677227516`*^9, 
   3.783819868135648*^9}, {3.7838199990066833`*^9, 3.7838200004468327`*^9}, {
   3.7838452992914524`*^9, 3.7838453013599186`*^9}, {3.783845520771189*^9, 
   3.7838455209457226`*^9}, {3.7838455513145137`*^9, 
   3.7838456017296977`*^9}, {3.783845741683446*^9, 3.7838457418011312`*^9}, {
   3.7838460446133785`*^9, 3.7838461319647903`*^9}, {3.783846524934945*^9, 
   3.7838465487362976`*^9}, {3.7840944316814485`*^9, 
   3.7840944549312754`*^9}, {3.7840945772432003`*^9, 3.784094613317733*^9}, {
   3.7840947482798295`*^9, 3.7840947800468807`*^9}, {3.7841061330948524`*^9, 
   3.7841061600058904`*^9}, 3.784106310079576*^9, {3.784106370147947*^9, 
   3.784106427973316*^9}, {3.784106602466701*^9, 3.7841066108951626`*^9}, {
   3.7841067205409575`*^9, 3.784106724462471*^9}, {3.784106786580361*^9, 
   3.7841068375390916`*^9}, {3.784106949505681*^9, 3.7841070118599386`*^9}, {
   3.784107091319456*^9, 3.784107097403187*^9}, {3.784107163138403*^9, 
   3.7841071739135895`*^9}, {3.784107244545711*^9, 3.784107247473881*^9}, {
   3.784107394647323*^9, 3.7841075141168485`*^9}, 3.784107571265028*^9, {
   3.784109295486271*^9, 3.7841093051913185`*^9}, {3.7841093450357704`*^9, 
   3.7841094507091875`*^9}, {3.7841094855360565`*^9, 
   3.7841095132290025`*^9}, {3.7841097306696215`*^9, 
   3.7841097315382986`*^9}, {3.7841097658944273`*^9, 3.784109766456922*^9}, {
   3.7841099643517303`*^9, 3.7841099906713486`*^9}, 3.784110052960779*^9, {
   3.7841101041229672`*^9, 3.784110193278554*^9}, 3.7841105037283773`*^9, 
   3.78411053435448*^9, {3.784156750499432*^9, 3.784156766767928*^9}, {
   3.7841579800125785`*^9, 3.7841579882475567`*^9}, {3.784158499455531*^9, 
   3.7841585116229935`*^9}, {3.784169043363319*^9, 3.784169065043344*^9}, {
   3.7841691065782747`*^9, 3.784169182057435*^9}, {3.78416922219211*^9, 
   3.784169278015832*^9}, {3.7841693791533794`*^9, 3.7841694058370256`*^9}, {
   3.784169439570816*^9, 3.7841694786303663`*^9}, 3.7841698318587947`*^9, {
   3.7841699179226513`*^9, 3.7841700234883566`*^9}, {3.7841700664295273`*^9, 
   3.7841700925566607`*^9}, {3.7841701289702864`*^9, 3.784170159936479*^9}, {
   3.784170481181435*^9, 3.784170487953327*^9}, {3.7843292013711452`*^9, 
   3.7843292095512705`*^9}, {3.7843726718828964`*^9, 3.784372681443331*^9}, {
   3.784415621030654*^9, 3.7844156256931844`*^9}, {3.7844157476152844`*^9, 
   3.7844157513143926`*^9}, {3.7844271742190447`*^9, 
   3.7844271781265955`*^9}, {3.784455234188792*^9, 3.7844552379607058`*^9}, {
   3.7845219705251226`*^9, 3.78452198693923*^9}, {3.7846311999160852`*^9, 
   3.784631206265108*^9}, {3.784695822825816*^9, 3.784695826250658*^9}, {
   3.7847065487146115`*^9, 3.784706619369673*^9}, {3.7847066533956833`*^9, 
   3.7847066568693943`*^9}, {3.7847067221907177`*^9, 3.784706754309828*^9}, 
   3.784711827792777*^9, {3.784711875900132*^9, 3.7847119388827105`*^9}, {
   3.784711974354854*^9, 3.7847119772949915`*^9}, {3.7851073445114565`*^9, 
   3.7851073469549227`*^9}, 3.78511929728771*^9, {3.7851196155400033`*^9, 
   3.7851197811790667`*^9}, {3.785119841183607*^9, 3.7851199259210105`*^9}, {
   3.785119989156911*^9, 3.7851199949723587`*^9}, {3.785120043937422*^9, 
   3.785120044499918*^9}, {3.7851201871005874`*^9, 3.7851202044102993`*^9}, {
   3.7851202543896503`*^9, 3.78512028257129*^9}, {3.7851204420468335`*^9, 
   3.7851205588664455`*^9}, {3.785120678639161*^9, 3.7851206788107014`*^9}, {
   3.7851208657158966`*^9, 3.78512087939332*^9}, {3.7851209921049175`*^9, 
   3.7851210271591787`*^9}, {3.7851222867718363`*^9, 
   3.7851222960350657`*^9}, {3.7851223275717325`*^9, 3.785122328583029*^9}, {
   3.785122409352043*^9, 3.78512241286864*^9}, {3.785125039228465*^9, 
   3.785125044422575*^9}, {3.7851255420408897`*^9, 3.785125549582721*^9}, {
   3.7851255810445895`*^9, 3.7851256511600924`*^9}, {3.785125760574506*^9, 
   3.7851258359379764`*^9}, {3.785125939575837*^9, 3.7851259396536293`*^9}, {
   3.785127351947002*^9, 3.7851273569256873`*^9}, {3.785127407458557*^9, 
   3.7851274414177465`*^9}, {3.7851280686195416`*^9, 3.785128083766037*^9}, {
   3.7851282013540897`*^9, 3.7851282198157225`*^9}, {3.7851282810928593`*^9, 
   3.7851283360239673`*^9}, {3.785128781534622*^9, 3.785128812160725*^9}, {
   3.785128882849696*^9, 3.7851288833453703`*^9}, {3.785129524587617*^9, 
   3.785129729731042*^9}, {3.7851305531501284`*^9, 3.785130562522067*^9}, {
   3.7851306511650257`*^9, 3.7851306733975744`*^9}, 3.785130816266526*^9, {
   3.785131008020754*^9, 3.785131056731498*^9}, {3.7851314389783263`*^9, 
   3.785131485839017*^9}, {3.7851315608554134`*^9, 3.785131571105005*^9}, {
   3.785131606571164*^9, 3.7851316319971733`*^9}, {3.7851323773520126`*^9, 
   3.7851324632509584`*^9}, {3.785132652463982*^9, 3.7851326726011353`*^9}, {
   3.785132745962956*^9, 3.78513274611854*^9}, {3.785134208949768*^9, 
   3.785134212889233*^9}, {3.7851342575158978`*^9, 3.785134304584032*^9}, {
   3.785134348998265*^9, 3.785134354901477*^9}, {3.7851972513783035`*^9, 
   3.785197263456006*^9}, {3.78519855873429*^9, 3.7851985751743274`*^9}, {
   3.7851986216560297`*^9, 3.7851986486957226`*^9}, {3.7852021928522587`*^9, 
   3.785202202113495*^9}, {3.7852024675097957`*^9, 3.785202474002434*^9}, {
   3.7852025377130632`*^9, 3.78520254211928*^9}, {3.7852026633052177`*^9, 
   3.7852026704730487`*^9}, {3.7852029965720243`*^9, 3.785203112359396*^9}, {
   3.7852031532809677`*^9, 3.7852031587573233`*^9}, {3.785203257602001*^9, 
   3.7852032589035215`*^9}, {3.7852035576955185`*^9, 
   3.7852036493913136`*^9}, {3.7852038271828794`*^9, 3.785203837203086*^9}, {
   3.7852038891960506`*^9, 3.7852038919756165`*^9}, {3.7852039503884153`*^9, 
   3.785203988714926*^9}, {3.785204027124216*^9, 3.7852040609876595`*^9}, {
   3.7852041193196735`*^9, 3.7852041354465485`*^9}, {3.7852042791163597`*^9, 
   3.7852043353130836`*^9}, {3.7852048347206125`*^9, 3.785204841794696*^9}, {
   3.7852049246980033`*^9, 3.78520504381946*^9}, 3.7852050800625415`*^9, {
   3.7852051135699396`*^9, 3.78520513102227*^9}, 3.7852051633528147`*^9, {
   3.7852052601340113`*^9, 3.785205309189831*^9}, {3.7852053555348997`*^9, 
   3.7852054292906675`*^9}, {3.7852054774249516`*^9, 
   3.7852054854135895`*^9}, {3.7852055182098894`*^9, 3.785205576184857*^9}, 
   3.7852056240977316`*^9, {3.785205820818681*^9, 3.785205896675828*^9}, {
   3.785205965464878*^9, 3.7852059707736826`*^9}, {3.7852071841410046`*^9, 
   3.7852072154373155`*^9}, {3.785207817267954*^9, 3.7852078647110853`*^9}, {
   3.7853004938176565`*^9, 3.7853005274357586`*^9}, {3.785300603991041*^9, 
   3.7853006078447375`*^9}, {3.7853010258738804`*^9, 
   3.7853010561319666`*^9}, {3.785301337768839*^9, 3.785301396976511*^9}, {
   3.785301483228863*^9, 3.7853015290732713`*^9}, {3.7853016766316824`*^9, 
   3.7853016985680227`*^9}, 3.785301939541147*^9, 3.7853020091589804`*^9, {
   3.7853026274835124`*^9, 3.7853026309332876`*^9}, {3.7855741334214687`*^9, 
   3.7855741655355916`*^9}, {3.7855750163962965`*^9, 
   3.7855750678118057`*^9}, {3.785577379074295*^9, 3.785577379377484*^9}, {
   3.785579003227131*^9, 3.785579006929231*^9}, {3.7855790901257553`*^9, 
   3.7855791040445347`*^9}, {3.7855792043882046`*^9, 3.7855792633505325`*^9}, 
   3.785579296778144*^9, {3.7855794779706163`*^9, 3.7855794781980076`*^9}, {
   3.7855795212099886`*^9, 3.7855795220786653`*^9}, {3.785579649976652*^9, 
   3.7855796959816303`*^9}, {3.785579739052454*^9, 3.7855797434536843`*^9}, {
   3.785579998951455*^9, 3.785580026601516*^9}, {3.785580392209839*^9, 
   3.785580414600963*^9}, {3.7855804539437556`*^9, 3.7855804692986946`*^9}, 
   3.785580522075564*^9, {3.785638686319376*^9, 3.78563868699457*^9}, {
   3.785638867602605*^9, 3.785638891780949*^9}, {3.785638929130073*^9, 
   3.78563892998379*^9}, {3.7856417475270834`*^9, 3.785641790584942*^9}, 
   3.785641827392514*^9, {3.785743903911502*^9, 3.7857439138239946`*^9}, {
   3.785744301713735*^9, 3.785744334516019*^9}, {3.7857446336141973`*^9, 
   3.7857446337488375`*^9}, {3.7857448487040243`*^9, 
   3.7857448653505087`*^9}, {3.7859222472788935`*^9, 3.785922255202715*^9}, {
   3.785988741636729*^9, 3.7859887463321795`*^9}, {3.7860082625852127`*^9, 
   3.786008266201547*^9}, {3.7860138102187843`*^9, 3.7860138144534664`*^9}, {
   3.7860143494186387`*^9, 3.7860143521024656`*^9}, {3.7860612826769075`*^9, 
   3.7860612889760714`*^9}, {3.786061563364881*^9, 3.786061566776762*^9}, {
   3.7860625241921787`*^9, 3.786062527369686*^9}, {3.786165471119266*^9, 
   3.786165480068347*^9}, {3.786177977196444*^9, 3.786177997757489*^9}, {
   3.7861788585926933`*^9, 3.7861789196136003`*^9}, {3.786179784901902*^9, 
   3.786179812463238*^9}, {3.7861804791722927`*^9, 3.7861804846406765`*^9}, {
   3.786180659782566*^9, 3.78618066156979*^9}, {3.7861843361685123`*^9, 
   3.7861843381502156`*^9}, {3.786184427197215*^9, 3.786184432675573*^9}, {
   3.786184487157955*^9, 3.7861845046312532`*^9}, {3.7861850139050922`*^9, 
   3.786185058117923*^9}, {3.7861853192818975`*^9, 3.7861853225591383`*^9}, {
   3.786186287646701*^9, 3.7861863099451036`*^9}, {3.786186392831569*^9, 
   3.78618642132641*^9}, {3.786186474976018*^9, 3.786186511079522*^9}, {
   3.786186587396546*^9, 3.786186614828228*^9}, {3.786186785386369*^9, 
   3.7861867875735235`*^9}, {3.786224225058548*^9, 3.786224304930071*^9}, 
   3.7862243597056704`*^9, {3.7862243914069405`*^9, 3.78622440486896*^9}, {
   3.786224552453503*^9, 3.7862245563720303`*^9}, {3.7862246115016823`*^9, 
   3.78622473347069*^9}, {3.7862247795944133`*^9, 3.7862247909959393`*^9}, {
   3.7862249655005326`*^9, 3.786225023968263*^9}, {3.786225506679098*^9, 
   3.786225506981291*^9}, {3.786230899818508*^9, 3.7862309054674106`*^9}, {
   3.7862309438019514`*^9, 3.7862309477873*^9}, {3.7862320390127287`*^9, 
   3.7862320401816053`*^9}, {3.786232612866961*^9, 3.786232816162603*^9}, {
   3.7862328632437673`*^9, 3.786232864366766*^9}, 3.7863176954100103`*^9, {
   3.786317737206299*^9, 3.7863178459715967`*^9}, 3.7863180081152277`*^9, 
   3.786318069707607*^9, {3.786319933473379*^9, 3.7863199414460707`*^9}, {
   3.78632012759155*^9, 3.7863201407214575`*^9}, {3.7863205420936904`*^9, 
   3.7863205491019588`*^9}, {3.786320616304344*^9, 3.7863206546877546`*^9}, {
   3.7863291014011326`*^9, 3.7863291533103924`*^9}, {3.786329242840102*^9, 
   3.7863293268306165`*^9}, {3.786329584875926*^9, 3.786329594015498*^9}, {
   3.786329924065358*^9, 3.7863299276248446`*^9}, {3.7863301148245068`*^9, 
   3.786330162701544*^9}, {3.786330197396812*^9, 3.7863302330086308`*^9}, {
   3.786335826828849*^9, 3.786335931032339*^9}, {3.786335963794775*^9, 
   3.7863359972633204`*^9}, 3.78633605894147*^9, {3.7863363382549353`*^9, 
   3.786336345943386*^9}, {3.786444595601116*^9, 3.786444613528201*^9}, {
   3.7864449475464554`*^9, 3.78644501541107*^9}, {3.786445051395891*^9, 
   3.7864450592199793`*^9}, {3.7864451187139673`*^9, 
   3.7864451207415476`*^9}, {3.786595703119054*^9, 3.786595718266569*^9}, {
   3.786595759775625*^9, 3.7865957928951054`*^9}, {3.786595860783656*^9, 
   3.7865958614778013`*^9}, {3.7865959729985332`*^9, 
   3.7865960534365425`*^9}, {3.786596102147352*^9, 3.7865962715196614`*^9}, 
   3.786596324730442*^9, {3.786596357440018*^9, 3.7865963630719657`*^9}, {
   3.7865964402816033`*^9, 3.7865964446898212`*^9}, 3.7865965850217495`*^9, {
   3.786596641249467*^9, 3.7865967594365835`*^9}, {3.786596980066893*^9, 
   3.7865971625661187`*^9}, 3.786597203267335*^9, {3.7865972416417694`*^9, 
   3.78659724175746*^9}, 3.7865984561836047`*^9, {3.7865997725682397`*^9, 
   3.786599772653013*^9}, {3.78661032624697*^9, 3.7866103373492966`*^9}, {
   3.786611334384473*^9, 3.7866113477377825`*^9}, {3.7866113872122774`*^9, 
   3.7866113873329554`*^9}, {3.7866114608933463`*^9, 
   3.7866114837642183`*^9}, {3.7866118520758142`*^9, 
   3.7866118688958583`*^9}, {3.786661007857752*^9, 3.7866610244653645`*^9}, {
   3.7866614534547844`*^9, 3.786661489876438*^9}, {3.7866615316687374`*^9, 
   3.7866615409618998`*^9}, {3.7866617645483093`*^9, 
   3.7866617646400642`*^9}, {3.786661869516755*^9, 3.786661892089424*^9}, {
   3.786661951905551*^9, 3.7866619528799467`*^9}, {3.7866620091176367`*^9, 
   3.7866620094856534`*^9}, {3.7866627360587063`*^9, 
   3.7866627361724024`*^9}, {3.7866759322821827`*^9, 3.78667594168904*^9}, {
   3.786677384944287*^9, 3.786677395182922*^9}, {3.7866807362471347`*^9, 
   3.7866807821225214`*^9}, {3.7866810167953*^9, 3.7866811206796436`*^9}, {
   3.786681182673949*^9, 3.7866812234479694`*^9}, {3.786681258208065*^9, 
   3.7866812621465387`*^9}, {3.7866814989077363`*^9, 
   3.7866815952572165`*^9}, {3.7866816510441127`*^9, 3.786681675220496*^9}, {
   3.786682042696325*^9, 3.786682056657012*^9}, {3.7866996462577496`*^9, 
   3.786699776990334*^9}, {3.7867005532655463`*^9, 3.786700568346239*^9}, {
   3.7867007273103676`*^9, 3.7867007351434317`*^9}, {3.7867635919658136`*^9, 
   3.7867635972317395`*^9}, {3.786861501388754*^9, 3.7868615137178016`*^9}, {
   3.7868619932553663`*^9, 3.786862017456682*^9}, {3.786960132628612*^9, 
   3.786960155854536*^9}, {3.787284245243659*^9, 3.787284260597622*^9}, {
   3.7872952788883295`*^9, 3.787295310990528*^9}, {3.787567882622756*^9, 
   3.7875679270849185`*^9}, {3.7879966061007347`*^9, 
   3.7879966067140956`*^9}, {3.800597410189348*^9, 3.800597425705826*^9}, {
   3.8005974766714396`*^9, 3.8005975096432066`*^9}, {3.8048370254904704`*^9, 
   3.8048370461701717`*^9}, {3.804837201971548*^9, 3.8048372290820527`*^9}, {
   3.804838704437671*^9, 3.8048387200579014`*^9}, {3.804907478092116*^9, 
   3.8049074938729167`*^9}, {3.8050874708907166`*^9, 3.8050874721333942`*^9}, 
   3.805087655841147*^9, {3.8050880129292693`*^9, 3.8050880131197596`*^9}, {
   3.805088757632152*^9, 3.805088764733163*^9}, 3.8070553496622405`*^9},
 CellLabel->
  "In[5478]:=",ExpressionUUID->"935a2aae-60e6-4112-80ce-5b8e50ab5612"],

Cell[CellGroupData[{

Cell["Common-used", "Subsection",
 CellChangeTimes->{{3.805087701530969*^9, 
  3.8050877043175178`*^9}},ExpressionUUID->"79eb9fab-3952-4233-9564-\
6ae0c30f7cf8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SequenceSlice", "[", 
    RowBox[{
    "sequence_List", ",", "s_List", ",", "n_Integer", ",", "m_Integer"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"head", ",", "tail"}], "}"}], ",", 
     RowBox[{
      RowBox[{"head", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Cooling\>\"", "[", "1000", "]"}], ",", 
         RowBox[{"\"\<Pumping\>\"", "[", "5", "]"}], ",", 
         RowBox[{"\"\<Zero\>\"", "[", "1", "]"}]}], "}"}]}], ";", 
      RowBox[{"tail", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Detection\>\"", "[", 
            RowBox[{"250", ",", "1", ",", "1"}], "]"}], ",", 
           RowBox[{"\"\<Zero\>\"", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";", 
      RowBox[{"Join", "[", 
       RowBox[{"head", ",", 
        RowBox[{"sequence", "[", 
         RowBox[{"[", 
          RowBox[{"n", ";;", "m"}], "]"}], "]"}], ",", "tail"}], "]"}]}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScanPar", "[", 
     RowBox[{"Item_String", ",", "Par_", ",", "Range_List", ",", 
      RowBox[{"Stat_:", "True"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"CtrlSignalValue", "[", 
       RowBox[{
        RowBox[{"sequencer", "@", "\"\<Item\>\""}], ",", "Item"}], "]"}], ";", 
      RowBox[{"Pause", "[", "0.2", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CtrlSignalValue", "[", 
       RowBox[{
        RowBox[{"sequencer", "@", "\"\<Parameter\>\""}], ",", "Par"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Pause", "[", "0.2", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CtrlSetValue", "[", 
       RowBox[{
        RowBox[{"sequencer", "@", "\"\<Start\>\""}], ",", 
        RowBox[{
        "Range", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CtrlSetValue", "[", 
       RowBox[{
        RowBox[{"sequencer", "@", "\"\<End\>\""}], ",", 
        RowBox[{
        "Range", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CtrlSetValue", "[", 
       RowBox[{
        RowBox[{"sequencer", "@", "\"\<Step\>\""}], ",", 
        RowBox[{
        "Range", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pause", "[", "0.2", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CtrlSignalValue", "[", 
       RowBox[{
        RowBox[{"sequencer", "@", "\"\<Scan\>\""}], ",", "Stat"}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Pause", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CtrlGetValue", "[", 
       RowBox[{"sequencer", "@", "\"\<data file\>\""}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CheckLockPoint", "[", "target_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Sweep\>\""}], ",", "False"}], "]"}], 
       ";", 
       RowBox[{"SequenceFile", "@", 
        RowBox[{"DataPath", "@", "\"\<Sequence\\\\Cooling.seq\>\""}]}], ";", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Count or State\>\""}], ",", "0"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Trigger\>\""}], ",", "False"}], "]"}],
        ";", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Data\>\""}], ",", "True"}], "]"}], 
       ";", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"CtrlGetValue", "[", 
           RowBox[{"sequencer", "@", "\"\<Data\>\""}], "]"}], "===", "True"}],
          ",", 
         RowBox[{"Pause", "[", "0.1", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{"CtrlGetValue", "[", 
          RowBox[{"sequencer", "@", "\"\<Average Plot\>\""}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"c", ">", "5"}], "&&", 
          RowBox[{"Lock370", "===", "True"}]}], ",", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"target", "-", "1.5"}], "<=", "c", "\[LessEqual]", 
              RowBox[{"target", "+", "1.5"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"c", "-", "target"}], ")"}], "<", "0"}], ",", 
              RowBox[{"reference1", "-=", "1*^-6"}], ",", 
              RowBox[{"reference1", "+=", "1*^-6"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"SetPIDCourseNum", "[", 
             RowBox[{"2", ",", 
              RowBox[{"ToString", "@", 
               RowBox[{"SetAccuracy", "[", 
                RowBox[{"reference1", ",", "7"}], "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"c", "=", 
             RowBox[{"Mean", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"CtrlSignalValue", "[", 
                   RowBox[{
                    RowBox[{"sequencer", "@", "\"\<Data\>\""}], ",", "True"}],
                    "]"}], ";", 
                  RowBox[{"While", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"CtrlGetValue", "[", 
                    RowBox[{"sequencer", "@", "\"\<Data\>\""}], "]"}], "===", 
                    "True"}], ",", 
                    RowBox[{"Pause", "[", "0.1", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"CtrlGetValue", "[", 
                   RowBox[{"sequencer", "@", "\"\<Average Plot\>\""}], 
                   "]"}]}], ",", "5"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}]}], "]"}]}],
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LaserWavelengthSet", "[", 
     RowBox[{
      RowBox[{"Wavelength_:", "369.526240"}], ",", 
      RowBox[{"symbol_:", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ActW", ",", "SetV", ",", "s", ",", "wavel"}], "}"}], ",", 
      RowBox[{
       RowBox[{"wavel", "=", 
        RowBox[{"Floor", "[", "Wavelength", "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "369.5252", "\[LessEqual]", "Wavelength", "<=", "369.5265"}], "||", 
          RowBox[{
          "935.1795", "\[LessEqual]", "Wavelength", "\[LessEqual]", 
           "935.1890"}], "||", 
          RowBox[{
          "398.9105", "\[LessEqual]", "Wavelength", "\[LessEqual]", 
           "398.9120"}]}], ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"wavel", "\[Equal]", "369"}], ",", 
            RowBox[{
             RowBox[{"CtrlSignalValue", "[", 
              RowBox[{
               RowBox[{"LaserPanel", "@", "\"\<Laser\>\""}], ",", "0"}], 
              "]"}], ";", 
             RowBox[{"s", "=", "2000"}]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"wavel", "\[Equal]", "935"}], ",", 
              RowBox[{
               RowBox[{"CtrlSignalValue", "[", 
                RowBox[{
                 RowBox[{"LaserPanel", "@", "\"\<Laser\>\""}], ",", "1"}], 
                "]"}], ";", 
               RowBox[{"s", "=", "1000"}]}], ",", 
              RowBox[{
               RowBox[{"CtrlSignalValue", "[", 
                RowBox[{
                 RowBox[{"LaserPanel", "@", "\"\<Laser\>\""}], ",", "2"}], 
                "]"}], ";", 
               RowBox[{"s", "=", "800"}]}]}], "]"}]}], "]"}], ";", 
          RowBox[{"Pause", "[", "2", "]"}], ";", 
          RowBox[{"ActW", "=", 
           RowBox[{"ToExpression", "@", 
            RowBox[{"CtrlGetValue", "[", 
             RowBox[{"LaserPanel", "@", "\"\<Act Wavelength (nm)\>\""}], 
             "]"}]}]}], ";", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "5*^-6"}], "<=", 
               RowBox[{"(", 
                RowBox[{"Wavelength", "-", "ActW"}], ")"}], "\[LessEqual]", 
               "5*^-6"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"SetV", "=", 
              RowBox[{"CtrlGetValue", "@", 
               RowBox[{"LaserPanel", "@", "\"\<Set Voltage (V)\>\""}]}]}], 
             ";", 
             RowBox[{"Pause", "[", ".1", "]"}], ";", 
             RowBox[{"CtrlSignalValue", "[", 
              RowBox[{
               RowBox[{"LaserPanel", "@", "\"\<Set Voltage (V)\>\""}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"Wavelength", "-", "ActW"}], ")"}]}], "*", "s"}], 
                "+", "SetV"}]}], "]"}], ";", 
             RowBox[{"Pause", "[", "3", "]"}], ";", 
             RowBox[{"ActW", "=", 
              RowBox[{"ToExpression", "@", 
               RowBox[{"CtrlGetValue", "[", 
                RowBox[{"LaserPanel", "@", "\"\<Act Wavelength (nm)\>\""}], 
                "]"}]}]}]}]}], "]"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{"symbol", ",", 
            RowBox[{
             RowBox[{"CtrlSignalValue", "[", 
              RowBox[{
               RowBox[{"LaserPanel", "@", "\"\<Set Wavelength (nm)\>\""}], 
               ",", "Wavelength"}], "]"}], ";", 
             RowBox[{"CtrlSignalValue", "[", 
              RowBox[{
               RowBox[{"LaserPanel", "@", "\"\<Lock\>\""}], ",", "True"}], 
              "]"}]}], ",", "Null"}], "]"}]}], ",", 
         RowBox[{"Print", "[", "\"\<Invalid Wavelength\>\"", "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"CtrlGetValue", "@", 
        RowBox[{"LaserPanel", "@", "\"\<Act Wavelength (nm)\>\""}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"openCloseTaggedCell", "[", 
     RowBox[{"nb_", ",", "tags_String", ",", 
      RowBox[{"to", ":", 
       RowBox[{"(", 
        RowBox[{"Open", "|", "Closed"}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SelectionMove", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cells", "[", 
          RowBox[{"nb", ",", 
           RowBox[{"CellTags", "\[Rule]", "tags"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "All", ",", "CellGroup", ",", 
        RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"content", "=", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"$Context", "=", "\"\<FrontEnd`\>\""}], ",", 
               RowBox[{"$ContextPath", "=", 
                RowBox[{"{", "\"\<System`\>\"", "}"}]}]}], "}"}], ",", 
             RowBox[{"NotebookRead", "[", "nb", "]"}]}], "]"}]}], ",", 
          RowBox[{"target", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"First", "@", 
              RowBox[{"First", "@", 
               RowBox[{
                RowBox[{"NotebookRead", "[", "nb", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"from", "=", 
           RowBox[{"to", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Closed", "\[Rule]", "Open"}], ",", 
              RowBox[{"Open", "\[Rule]", "Closed"}]}], "}"}]}]}]}], "}"}], 
        ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"content", ",", 
            RowBox[{"Cell", "[", 
             RowBox[{"CellGroupData", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cell", "[", 
                  RowBox[{"_", ",", "target", ",", "___"}], "]"}], ",", 
                 "__"}], "}"}], ",", "from"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"NotebookWrite", "[", 
           RowBox[{"nb", ",", 
            RowBox[{"Cell", "[", 
             RowBox[{"CellGroupData", "[", 
              RowBox[{
               RowBox[{"content", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "to"}], "]"}], 
             "]"}], ",", 
            RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}]}], "]"}]}], 
       "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalibrateDuringExperiment", "[", "tag_String", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"symbol", "=", "True"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CtrlSignalValue", "[", 
       RowBox[{
        RowBox[{"sequencer", "@", "\"\<Trigger\>\""}], ",", "False"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"CtrlSignalValue", "[", 
       RowBox[{
        RowBox[{"sequencer", "@", "\"\<Repeats\>\""}], ",", "200"}], "]"}], 
      ";", 
      RowBox[{"CtrlSignalValue", "[", 
       RowBox[{
        RowBox[{"sequencer", "@", "\"\<Count or State\>\""}], ",", "1"}], 
       "]"}], ";", 
      RowBox[{"openCloseTaggedCell", "[", 
       RowBox[{
        RowBox[{"EvaluationNotebook", "[", "]"}], ",", "tag", ",", "Open"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SelectionMove", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cells", "[", 
          RowBox[{"CellTags", "\[Rule]", "tag"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "All", ",", "Cell"}], "]"}], 
      ";", 
      RowBox[{"FrontEndTokenExecute", "[", "\"\<Evaluate\>\"", "]"}]}], 
     ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpotSizeFitByRaman", "[", "data_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nlm", ",", "x", ",", "x0", ",", "w0", ",", "a", ",", "dataprocessed", 
        ",", "datasorted", ",", "repeats", ",", "graph"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"datasorted", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"data", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"repeats", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataprocessed", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"datasorted", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Mean", "@", 
               RowBox[{"datasorted", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"ErrorBar", "@", 
             RowBox[{"StandardDeviation", "@", 
              RowBox[{"datasorted", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "datasorted"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{
          RowBox[{"dataprocessed", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"a", " ", 
           RowBox[{"E", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
              RowBox[{"w0", "^", "2"}]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", 
              RowBox[{
               RowBox[{"MaximalBy", "[", 
                RowBox[{
                 RowBox[{"dataprocessed", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "Last"}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x0", ",", 
              RowBox[{
               RowBox[{"MaximalBy", "[", 
                RowBox[{
                 RowBox[{"dataprocessed", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "Last"}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", "w0"}], 
           "}"}], ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"nlm", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{
               RowBox[{"datasorted", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "0.1"}], ",", 
              RowBox[{
               RowBox[{"datasorted", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "+", 
               "0.1"}]}], "}"}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<location(um)\>\"", ",", "\"\<Rabi frequency(MHz)\>\""}], 
              "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          RowBox[{"ErrorListPlot", "[", 
           RowBox[{"dataprocessed", ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "@", "graph"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Fitted spot radius = \>\"", ",", 
         RowBox[{"100", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"w0", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], "]"}]}],
          ",", "\"\<um\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<spot size fitting \>\"", "<>", 
          RowBox[{"ToString", "@", "repeats"}], "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.csv\>\""}], ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{"datasorted", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<fitted center=\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"x0", "/.", 
                RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
               "]"}]}], ",", 
             RowBox[{"\"\<fitted spot radius=\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"100", " ", 
                RowBox[{"Abs", "[", 
                 RowBox[{"w0", "/.", 
                  RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
                 "]"}]}], "]"}]}]}], "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<Spot radius fitting \>\"", "<>", 
          RowBox[{"ToString", "@", "repeats"}], "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.png\>\""}], ",", "graph", ",", 
         RowBox[{"ImageResolution", "\[Rule]", "100"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x0", "/.", 
        RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThermalStateFit", "[", 
     RowBox[{"rawdat_List", 
      RowBox[{"(*", 
       RowBox[{
       "blue", " ", "sideband", " ", "Rabi", " ", "oscillation", " ", 
        "data"}], "*)"}], ",", "pt0_", 
      RowBox[{"(*", 
       RowBox[{"pre", "-", 
        RowBox[{
        "estimated", " ", "blue", " ", "sideband", " ", "Pi", " ", "time"}]}],
        "*)"}], ",", 
      RowBox[{"nth0_:", "0.5"}], 
      RowBox[{"(*", 
       RowBox[{"pre", "-", 
        RowBox[{"estimated", " ", "thermal", " ", "state", " ", "level"}]}], 
       "*)"}], ",", 
      RowBox[{"\[Eta]_:", " ", "\[Eta]1"}], 
      RowBox[{"(*", 
       RowBox[{"Lamb", "-", 
        RowBox[{"Dicke", " ", "Parameter"}]}], "*)"}], ",", 
      RowBox[{"plot_:", " ", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dat", ",", "maxN", ",", "s", ",", "func", ",", "A", ",", "B", ",", 
        "nth", ",", "\[Lambda]", ",", "pt", ",", "t", ",", "fit", ",", "par", 
        ",", "R2", ",", "pd", ",", "pf", ",", "cst"}], "}"}], ",", 
      RowBox[{
       RowBox[{"dat", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "0"}],
                "}"}], ",", 
              RowBox[{"Length", "[", "#", "]"}]}], "]"}]}], ")"}], "&"}], "[",
          "rawdat", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maxN", "=", 
        RowBox[{"Round", "[", 
         RowBox[{"-", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"1", "+", 
             RowBox[{"1", "/", "nth0"}]}], ",", "0.01"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"dat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "3"}], ",", "2"}], "]"}], "]"}], "]"}], "<", 
           RowBox[{"Mean", "[", 
            RowBox[{"dat", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"func", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"A", " ", "s"}], ")"}], "/", "2"}], " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"nth", "^", "i"}], "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "nth"}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}]}]}], " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "\[Lambda]"}], " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "+", "1"}], ")"}], "^", "0.7"}], " ", "#"}], 
                "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"LaguerreL", "[", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"\[Eta]", "^", "2"}]}], "]"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"i", "+", "1"}], "]"}]}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[Pi]", " ", "#"}], ")"}], "/", "pt"}]}], "]"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "maxN"}], "}"}]}], "]"}]}], "+", 
           "B"}], ")"}], "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fit", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"dat", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"func", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0", "\[LessEqual]", "\[Lambda]", "\[LessEqual]", 
               RowBox[{"1", "/", 
                RowBox[{"Max", "[", 
                 RowBox[{"dat", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], ")"}], 
             "&&", 
             RowBox[{"(", 
              RowBox[{"nth", ">", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"1.05", ">", "A", ">", "0.9"}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"A", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"B", ",", "0.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nth", ",", "nth0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"pt", ",", "pt0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]", ",", 
              RowBox[{"0.1", "/", 
               RowBox[{"Max", "[", 
                RowBox[{"dat", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], "}"}]}],
            "}"}], ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Off", "[", 
        RowBox[{"FittedModel", "::", "constr"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"par", "=", 
        RowBox[{
        "fit", "[", "\"\<ParameterConfidenceIntervalTableEntries\>\"", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"R2", "=", 
        RowBox[{"fit", "[", "\"\<RSquared\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"On", "[", 
        RowBox[{"FittedModel", "::", "constr"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pd", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"dat", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Blue", ",", 
             RowBox[{"PointSize", "[", "Large", "]"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pf", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ListLinePlot", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"fit", "[", "t", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"Min", "[", "#", "]"}], ",", 
                RowBox[{"Max", "[", "#", "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Max", "[", "#", "]"}], "-", 
                   RowBox[{"Min", "[", "#", "]"}]}], ")"}], "/", "300"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", "Thick"}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "[", 
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cst", "[", 
         RowBox[{"v_", ",", "p_"}], "]"}], ":=", 
        RowBox[{"ToString", "[", 
         RowBox[{"NumberForm", "[", 
          RowBox[{"v", ",", "p", ",", 
           RowBox[{"ExponentFunction", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Null", "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"plot", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Show", "[", 
            RowBox[{"pd", ",", "pf", ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<\[Pi]-time: \>\"", "<>", 
            RowBox[{"cst", "[", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", 
                RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"100", ",", "3"}], "}"}]}], "]"}], "<>", 
            "\"\<\[PlusMinus]\>\"", "<>", 
            RowBox[{"cst", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", 
                   RowBox[{"4", ",", "3", ",", "2"}], "]"}], "]"}], "-", 
                 RowBox[{"par", "[", 
                  RowBox[{"[", 
                   RowBox[{"4", ",", "3", ",", "1"}], "]"}], "]"}]}], ")"}], 
               "/", "2"}], ",", "2"}], "]"}], "<>", "\"\<,   <n>: \>\"", "<>", 
            RowBox[{"cst", "[", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "<>", 
            "\"\<\[PlusMinus]\>\"", "<>", 
            RowBox[{"cst", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "3", ",", "2"}], "]"}], "]"}], "-", 
                 RowBox[{"par", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "3", ",", "1"}], "]"}], "]"}]}], ")"}], 
               "/", "2"}], ",", "2"}], "]"}], "<>", 
            "\"\<,   \\!\\(\\*SuperscriptBox[\\(R\\), \\(2\\)]\\): \>\"", "<>", 
            RowBox[{"cst", "[", 
             RowBox[{"R2", ",", 
              RowBox[{"{", 
               RowBox[{"100", ",", "6"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"par", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "SBCWaveString", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SBCWaveString", "[", 
     RowBox[{"n_Integer", ",", 
      RowBox[{"gap", ":", 
       RowBox[{"_", "?", "NumberQ"}], ":", "8"}], ",", 
      RowBox[{"par", ":", 
       RowBox[{"{", "__List", "}"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sbc", "}"}], ",", 
      RowBox[{
       RowBox[{"sbc", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              FractionBox[
               RowBox[{
                SqrtBox[
                 RowBox[{"n", "-", "j", "+", "1"}]], " ", 
                RowBox[{"par", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}]}], 
               RowBox[{"LaguerreL", "[", 
                RowBox[{
                 RowBox[{"n", "-", "j"}], ",", "1", ",", 
                 SuperscriptBox[
                  RowBox[{"par", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "2"]}], "]"}]], 
              ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "par"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}]}], ";", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{"sbc", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "gap", ",", "0", ",", "0", ",", "0"}], "}"}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "gap", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
        "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "SBCSequence", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SBCSequence", "[", 
     RowBox[{"n_Integer", ",", 
      RowBox[{"par", ":", 
       RowBox[{"{", "__List", "}"}]}], ",", 
      RowBox[{"seq_List:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"detection_:", "300"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sbc", "}"}], ",", 
      RowBox[{
       RowBox[{"sbc", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Raman\>\"", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  SqrtBox[
                   RowBox[{"n", "-", "j", "+", "1"}]], " ", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], 
                 RowBox[{"LaguerreL", "[", 
                  RowBox[{
                   RowBox[{"n", "-", "j"}], ",", "1", ",", 
                   SuperscriptBox[
                    RowBox[{"par", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "2"]}], "]"}]], 
                "+", "3"}], "]"}], ",", 
              RowBox[{"\"\<Pumping\>\"", "[", "4", "]"}], ",", 
              RowBox[{"\"\<Zero\>\"", "[", "1", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "par"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}]}], ";", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Cooling\>\"", "[", "1000", "]"}], ",", 
           RowBox[{"\"\<Pumping\>\"", "[", "5", "]"}], ",", 
           RowBox[{"\"\<Zero\>\"", "[", "1", "]"}], ",", 
           RowBox[{"\"\<AWG\>\"", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"Join", "@@", "sbc"}], ",", "seq", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Detection\>\"", "[", 
            RowBox[{"detection", ",", "1", ",", "1"}], "]"}], ",", 
           RowBox[{"\"\<Zero\>\"", "[", "1", "]"}]}], "}"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TwoModeSBC", "[", 
     RowBox[{"n_Integer", ",", 
      RowBox[{"T1_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"red", " ", "sideband", " ", "pi", " ", "time"}], "*)"}], ",", 
      RowBox[{"\[Eta]1_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"Lamb", "-", 
        RowBox[{"Dicke", " ", "parameter"}]}], "*)"}], ",", 
      RowBox[{"T2_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"red", " ", "sideband", " ", "pi", " ", "time"}], "*)"}], ",", 
      RowBox[{"\[Eta]2_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"Lamb", "-", 
        RowBox[{"Dicke", " ", "parameter"}]}], "*)"}], ",", 
      RowBox[{"seq_List:", " ", 
       RowBox[{"{", "}"}]}], 
      RowBox[{"(*", 
       RowBox[{"addtional", " ", "sequence"}], "*)"}], ",", 
      RowBox[{"detection", ":", 
       RowBox[{"_", "?", "NumberQ"}], ":", "300"}], ",", 
      RowBox[{"pumping", ":", 
       RowBox[{"_", "?", "NumberQ"}], ":", "3"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sbcseq", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"sbcseq", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Cooling\>\"", "[", "1000", "]"}], ",", 
           RowBox[{"\"\<Pumping\>\"", "[", "5", "]"}]}], "}"}], ",", 
         RowBox[{"Join", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Gap\>\"", "[", "0.5", "]"}], ",", 
              RowBox[{"\"\<Raman1\>\"", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"n", "-", "i", "+", "1"}], "]"}], " ", "T1"}], 
                 ")"}], "/", 
                RowBox[{"LaguerreL", "[", 
                 RowBox[{
                  RowBox[{"n", "-", "i"}], ",", "1", ",", 
                  RowBox[{"\[Eta]1", "^", "2"}]}], "]"}]}], "]"}], ",", 
              RowBox[{"\"\<Zero\>\"", "[", "0.5", "]"}], ",", 
              RowBox[{"\"\<Pumping\>\"", "[", "pumping", "]"}], ",", 
              RowBox[{"\"\<Gap\>\"", "[", "0.5", "]"}], ",", 
              RowBox[{"\"\<Raman2\>\"", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"n", "-", "i", "+", "1"}], "]"}], " ", "T2"}], 
                 ")"}], "/", 
                RowBox[{"LaguerreL", "[", 
                 RowBox[{
                  RowBox[{"n", "-", "i"}], ",", "1", ",", 
                  RowBox[{"\[Eta]2", "^", "2"}]}], "]"}]}], "]"}], ",", 
              RowBox[{"\"\<Zero\>\"", "[", "0.5", "]"}], ",", 
              RowBox[{"\"\<Pumping\>\"", "[", "pumping", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", "seq", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Detection\>\"", "[", 
            RowBox[{"detection", ",", "1", ",", "1"}], "]"}], ",", 
           RowBox[{"\"\<Zero\>\"", "[", "1", "]"}]}], "}"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TwoModeSBC", "[", 
     RowBox[{"n_Integer", ",", "m_Integer", ",", 
      RowBox[{"T1_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"red", " ", "sideband", " ", "pi", " ", "time"}], "*)"}], ",", 
      RowBox[{"\[Eta]1_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"Lamb", "-", 
        RowBox[{"Dicke", " ", "parameter"}]}], "*)"}], ",", 
      RowBox[{"T2_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"red", " ", "sideband", " ", "pi", " ", "time"}], "*)"}], ",", 
      RowBox[{"\[Eta]2_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"Lamb", "-", 
        RowBox[{"Dicke", " ", "parameter"}]}], "*)"}], ",", 
      RowBox[{"seq_List:", " ", 
       RowBox[{"{", "}"}]}], 
      RowBox[{"(*", 
       RowBox[{"addtional", " ", "sequence"}], "*)"}], ",", 
      RowBox[{"detection_:", "300"}], ",", 
      RowBox[{"pumping_:", "3"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sbcseq", ",", "t", ",", "list1", ",", "list2", ",", "r1", ",", "r2", 
        ",", "M0", ",", "N0"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[LessEqual]", "m"}], ",", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"m", "-", "n"}]}], ";", 
          RowBox[{"M0", "=", "m"}], ";", 
          RowBox[{"N0", "=", "n"}], ";", 
          RowBox[{"r1", "=", "\"\<Raman2\>\""}], ";", 
          RowBox[{"r2", "=", "\"\<Raman1\>\""}]}], ",", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"n", "-", "m"}]}], ";", 
          RowBox[{"M0", "=", "n"}], ";", 
          RowBox[{"N0", "=", "m"}], ";", "\[IndentingNewLine]", 
          RowBox[{"r1", "=", "\"\<Raman1\>\""}], ";", 
          RowBox[{"r2", "=", "\"\<Raman2\>\""}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"list1", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Gap\>\"", "[", "0.5", "]"}], ",", 
                 RowBox[{"r1", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"M0", "-", "i", "+", "1"}], "]"}], " ", "T2"}], 
                    ")"}], "/", 
                   RowBox[{"LaguerreL", "[", 
                    RowBox[{
                    RowBox[{"M0", "-", "i"}], ",", "1", ",", 
                    RowBox[{"\[Eta]2", "^", "2"}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"\"\<Zero\>\"", "[", ".5", "]"}], ",", 
                 RowBox[{"\"\<Pumping\>\"", "[", "pumping", "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"2", " ", "t"}]}], "}"}]}], "]"}], ",", "2"}], "]"}],
            ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<Gap\>\"", "[", "0.5", "]"}], ",", 
               RowBox[{"r2", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"N0", "-", "i", "+", "1"}], "]"}], " ", "T1"}], 
                  ")"}], "/", 
                 RowBox[{"LaguerreL", "[", 
                  RowBox[{
                   RowBox[{"N0", "-", "i"}], ",", "1", ",", 
                   RowBox[{"\[Eta]1", "^", "2"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"\"\<Zero\>\"", "[", ".5", "]"}], ",", 
               RowBox[{"\"\<Pumping\>\"", "[", "pumping", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "t"}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"list2", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<Gap\>\"", "[", "0.5", "]"}], ",", 
               RowBox[{"r1", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"M0", "-", "i", "+", "1"}], "]"}], " ", "T2"}], 
                  ")"}], "/", 
                 RowBox[{"LaguerreL", "[", 
                  RowBox[{
                   RowBox[{"M0", "-", "i"}], ",", "1", ",", 
                   RowBox[{"\[Eta]2", "^", "2"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"\"\<Zero\>\"", "[", ".5", "]"}], ",", 
               RowBox[{"\"\<Pumping\>\"", "[", "pumping", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"2", " ", "t"}], "+", "1"}], ",", "M0"}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<Gap\>\"", "[", "0.5", "]"}], ",", 
               RowBox[{"r2", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"N0", "-", "i", "+", "1"}], "]"}], " ", "T1"}], 
                  ")"}], "/", 
                 RowBox[{"LaguerreL", "[", 
                  RowBox[{
                   RowBox[{"N0", "-", "i"}], ",", "1", ",", 
                   RowBox[{"\[Eta]1", "^", "2"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"\"\<Zero\>\"", "[", ".5", "]"}], ",", 
               RowBox[{"\"\<Pumping\>\"", "[", "pumping", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"t", "+", "1"}], ",", "N0"}], "}"}]}], "]"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sbcseq", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Cooling\>\"", "[", "1000", "]"}], ",", 
            RowBox[{"\"\<Pumping\>\"", "[", "5", "]"}]}], "}"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"list1", ",", "list2"}], "]"}], ",", "seq", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Detection\>\"", "[", 
             RowBox[{"detection", ",", "1", ",", "1"}], "]"}], ",", 
            RowBox[{"\"\<Zero\>\"", "[", "1", "]"}]}], "}"}]}], "]"}]}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OneModeSBC", "[", 
     RowBox[{
      RowBox[{"symbol", ":", 
       RowBox[{"(", 
        RowBox[{
        "\"\<Raman1\>\"", "|", "\"\<Raman2\>\"", "|", "\"\<Raman4\>\""}], 
        ")"}]}], ",", "n_Integer", 
      RowBox[{"(*", 
       RowBox[{"thermal", " ", "state", " ", "level"}], "*)"}], ",", 
      RowBox[{"T_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"red", " ", "sideband", " ", "pi", " ", "time"}], "*)"}], ",", 
      RowBox[{"\[Eta]_", "?", "NumberQ"}], 
      RowBox[{"(*", 
       RowBox[{"Lamb", "-", 
        RowBox[{"Dicke", " ", "parameter"}]}], "*)"}], ",", 
      RowBox[{"seq_List:", " ", 
       RowBox[{"{", "}"}]}], 
      RowBox[{"(*", 
       RowBox[{"addtional", " ", "sequence"}], "*)"}], ",", 
      RowBox[{"detection_:", "300"}], ",", 
      RowBox[{"pumping_:", "3"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sbcseq", "}"}], ",", 
      RowBox[{"sbcseq", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Cooling\>\"", "[", "1000", "]"}], ",", 
           RowBox[{"\"\<Pumping\>\"", "[", "5", "]"}]}], "}"}], ",", 
         RowBox[{"Join", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Gap\>\"", "[", "0.5", "]"}], ",", 
              RowBox[{"symbol", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"n", "-", "i", "+", "1"}], "]"}], " ", "T"}], 
                 ")"}], "/", 
                RowBox[{"LaguerreL", "[", 
                 RowBox[{
                  RowBox[{"n", "-", "i"}], ",", "1", ",", 
                  RowBox[{"\[Eta]1", "^", "2"}]}], "]"}]}], "]"}], ",", 
              RowBox[{"\"\<Zero\>\"", "[", ".5", "]"}], ",", 
              RowBox[{"\"\<Pumping\>\"", "[", "pumping", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", "seq", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Detection\>\"", "[", 
            RowBox[{"detection", ",", "1", ",", "1"}], "]"}], ",", 
           RowBox[{"\"\<Zero\>\"", "[", "1", "]"}]}], "}"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PhononNumberFitByRBRatio", "[", 
     RowBox[{"rsbfile_String", ",", "bsbfile_String", ",", 
      RowBox[{"plot_Symbol:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nbar", ",", "rsbdat", ",", "bsbdat", ",", "R"}], "}"}], ",", 
      RowBox[{
       RowBox[{"rsbdat", "=", 
        RowBox[{"Average", "[", 
         RowBox[{"rsbfile", ",", 
          RowBox[{"S1", "[", "]"}]}], "]"}]}], ";", 
       RowBox[{"bsbdat", "=", 
        RowBox[{"Average", "[", 
         RowBox[{"bsbfile", ",", 
          RowBox[{"S1", "[", "]"}]}], "]"}]}], ";", 
       RowBox[{"R", "=", 
        RowBox[{
         RowBox[{"Total", "@", 
          RowBox[{"rsbdat", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "/", 
         RowBox[{"Total", "@", 
          RowBox[{"bsbdat", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nbar", "=", 
        RowBox[{"R", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "R"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Average phonon number:\>\"", ",", "nbar"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"plot", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rsbdat", ",", "bsbdat"}], "}"}], ",", 
            RowBox[{"PlotLegends", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<red sidebnad\>\"", ",", "\"\<blue sideband\>\""}], 
              "}"}]}], ",", 
            RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}], "]"}]}],
         "]"}], ";", "nbar"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HeatingRateFit", "[", "data_List", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lm", ",", "x", ",", "T", ",", "dataprocessed", ",", "graph", ",", 
        "heatingrate"}], "}"}], ",", 
      RowBox[{
       RowBox[{"dataprocessed", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Mean", "@", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"ErrorBar", "@", 
             RowBox[{"StandardDeviation", "@", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "+", "500"}]}], ";", 
       RowBox[{"lm", "=", 
        RowBox[{"LinearModelFit", "[", 
         RowBox[{
          RowBox[{"dataprocessed", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "x", ",", "x"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ErrorListPlot", "[", 
           RowBox[{"dataprocessed", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", ".02", "]"}]}], "}"}]}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<t(us)\>\"", ",", "\"\<average phonon number\>\""}],
               "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"lm", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "T"}], "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"heatingrate", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"lm", "'"}], "[", "x", "]"}], "*", "1000"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<heating rate \>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.png\>\""}], ",", "graph", ",", 
         RowBox[{"ImageResolution", "\[Rule]", "100"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<heating rate measurement data\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.csv\>\""}], ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{"data", ",", 
           RowBox[{"\"\<heating rate=\>\"", "<>", 
            RowBox[{"ToString", "[", "heatingrate", "]"}], "<>", 
            "\"\</ms\>\""}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<HeatingRate=\>\"", ",", "heatingrate", ",", "\"\</ms\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", "graph"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "@", "CoherenceTimeFit"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoherenceTimeFit", "[", 
     RowBox[{"data_List", ",", "\[Tau]0_", ",", 
      RowBox[{"pitime_:", "0"}], ",", 
      RowBox[{"\[Phi]0_:", 
       RowBox[{"Pi", "/", "2"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "f", ",", "\[Phi]", ",", "\[Tau]", ",", "t", ",", 
        "nlm", ",", "T", ",", "f0", ",", "pos", ",", "fig"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"data", ",", "First"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"data", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"f0", "=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           RowBox[{"RabiFrequencyFit", "[", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", 
               RowBox[{"pos", "+", 
                RowBox[{"Floor", "[", 
                 RowBox[{"0.5", " ", "pos"}], "]"}]}]}], "]"}], "]"}], 
            "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", "*", "Pi", "*", "f", " ", "t"}], "+", "\[Phi]"}], 
             "]"}], "*", 
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "t"}], "/", "\[Tau]"}], ")"}]}]}], "+", "b"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", ".5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", ".5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pitime", "\[Equal]", "0"}], ",", "f0", ",", 
                RowBox[{"1.", "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "pitime"}], ")"}]}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Phi]", ",", "\[Phi]0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Tau]", ",", "\[Tau]0"}], "}"}]}], "}"}], ",", "t"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<coherence time=\>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Tau]", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
          "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "3"}]}]}], ",", "\"\<ms\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fig", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"nlm", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "T"}], "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<t(\[Mu]s)\>\"", ",", "\"\<P(\[UpArrow])\>\""}], 
              "}"}]}], ",", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", "Bold", ",", "12"}], "}"}]}], ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"All", ",", "Automatic"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"All", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"FrameTicksStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", "Bold", ",", "12"}], "]"}]}]}], "]"}], 
          ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"data", ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
            RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Export", "[", 
          RowBox[{
          "\"\<Z:\\\\Desktop\\\\phd work\\\\experiments with Rabi \
model\\\\QRM experiment 1\\\\manuscript\\\\Rabi_model_revised second \
round\\\\supplementary material\\\\5ms motional coherence.png\>\"", ",", 
           "fig", ",", 
           RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "fig"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GaussianCoherenceFit", "[", 
     RowBox[{"data_List", ",", "\[Tau]0_", ",", "pitime_", ",", 
      RowBox[{"\[Phi]0_:", 
       RowBox[{"Pi", "/", "2"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "f", ",", "\[Phi]", ",", "\[Tau]", ",", "t", ",", 
        "nlm", ",", "T", ",", "f0"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"data", ",", "First"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"f0", "=", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"RabiFrequencyFit", "[", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Length", "@", "data"}], ")"}], "/", "2"}], 
                  "]"}]}], "]"}], "]"}], "]"}]}], ")"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"f0", "=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "pitime"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", "*", "Pi", "*", "f", " ", "t"}], "+", "\[Phi]"}], 
             "]"}], "*", 
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t", "/", "\[Tau]"}], ")"}], "^", "2"}]}], ")"}]}]}],
            "+", "b"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", ".5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", ".5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "f0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Phi]", ",", "\[Phi]0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Tau]", ",", "\[Tau]0"}], "}"}]}], "}"}], ",", "t"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<coherence time=\>\"", ",", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"\[Tau]", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], "]"}], 
          "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "3"}]}]}], ",", "\"\<ms\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"nlm", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "T"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<t(\[Mu]s)\>\"", ",", "\"\<P(\[UpArrow])\>\""}], 
             "}"}]}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Bold", ",", "12"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"All", ",", "Automatic"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"All", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", "12"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"data", ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
           RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RamseyFrequencyFit", "[", 
     RowBox[{"data_List", ",", "T_", ",", 
      RowBox[{"plot_Symbol:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "\[Omega]0", ",", "f", ",", "max", ",", "X1", ",", 
        "X2", ",", "nlm"}], "}"}], ",", 
      RowBox[{
       RowBox[{"max", "=", 
        RowBox[{
         RowBox[{"MaximalBy", "[", 
          RowBox[{"data", ",", "Last"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"X1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MinimalBy", "[", 
           RowBox[{"data", ",", "First"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"X2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"data", ",", "First"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", "\[Pi]", 
              RowBox[{"(", 
               RowBox[{"f", "-", "\[Omega]0"}], ")"}], "T"}], "]"}]}], "+", 
           "b"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "0.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "0.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Omega]0", ",", 
              RowBox[{"max", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], ",", "f"}], 
         "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{"plot", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"nlm", "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "X1", ",", "X2"}], "}"}]}], "]"}], ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{"data", ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
            RowBox[{"PlotRange", "->", "All"}]}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "\[Omega]0"}], "}"}], "/.", 
        RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BesselCoherenceFit", "[", 
     RowBox[{"data_List", ",", "ZeroPoint_", ",", 
      RowBox[{"fn_:", "50*^-6"}], ",", 
      RowBox[{"\[Phi]0_:", "0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "f", ",", "\[Phi]", ",", "\[Omega]", ",", "t", ",",
         "nlm", ",", "T", ",", "f0", ",", "N0", ",", "pos"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"data", ",", "First"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"data", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"f0", "=", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           RowBox[{"RabiFrequencyFit", "[", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", 
               RowBox[{"pos", "+", 
                RowBox[{"Floor", "[", 
                 RowBox[{"0.5", " ", "pos"}], "]"}]}]}], "]"}], "]"}], 
            "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"2", "Pi", " ", "fn"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", "*", "Pi", "*", "f", " ", "t"}], "+", "\[Phi]"}], 
             "]"}], "*", 
            RowBox[{"BesselJ", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               FractionBox[
                RowBox[{"N0", " "}], "\[Omega]"], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "-", 
                  RowBox[{"2", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Omega]", " ", "t"}], "]"}]}]}], ")"}], "^", 
                "0.5"}]}]}], "]"}]}], "+", "b"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", ".5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", ".5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "f0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Phi]", ",", "\[Phi]0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"N0", ",", 
              RowBox[{"2.405", "/", "ZeroPoint"}]}], "}"}]}], "}"}], ",", 
          "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Noise amplitude=\>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"N0", "/.", 
             RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
           "/", 
           RowBox[{"(", 
            RowBox[{"2", "Pi"}], ")"}]}], "*", 
          RowBox[{"10", "^", "3"}]}], ",", "\"\<kHz\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"nlm", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "T"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<t(\[Mu]s)\>\"", ",", "\"\<P(\[UpArrow])\>\""}], 
             "}"}]}], ",", 
           RowBox[{"FrameStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "Bold", ",", "12"}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"All", ",", "Automatic"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"All", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", "12"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"data", ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
           RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"BesselCoherenceFit", "[", 
      RowBox[{"data_List", ",", "ZeroPoint_", ",", 
       RowBox[{"\[Phi]0_:", "0"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "a", ",", "b", ",", "f", ",", "\[Phi]", ",", "t", ",", "nlm", ",", 
         "T", ",", "f0", ",", "N0", ",", "pos"}], "}"}], ",", 
       RowBox[{
        RowBox[{"T", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"MaximalBy", "[", 
            RowBox[{"data", ",", "First"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"data", ",", 
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"data", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#1", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "<", 
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"f0", "=", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"RabiFrequencyFit", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", 
                RowBox[{"pos", "+", 
                 RowBox[{"Floor", "[", 
                  RowBox[{"0.5", " ", "pos"}], "]"}]}]}], "]"}], "]"}], 
             "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nlm", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"2", "*", "Pi", "*", "f", " ", "t"}], "+", "\[Phi]"}], 
              "]"}], "*", 
             RowBox[{"BesselJ", "[", 
              RowBox[{"0", ",", 
               RowBox[{"N0", " ", "t"}]}], "]"}]}], "+", "b"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a", ",", ".5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"b", ",", ".5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"f", ",", "f0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Phi]", ",", "\[Phi]0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"N0", ",", 
               RowBox[{"2.405", "/", "ZeroPoint"}]}], "}"}]}], "}"}], ",", 
           "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Noise amplitude=\>\"", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"N0", "/.", 
              RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}],
             "/", 
            RowBox[{"(", 
             RowBox[{"2", "Pi"}], ")"}]}], "*", 
           RowBox[{"10", "^", "3"}]}], ",", "\"\<kHz\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"nlm", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "T"}], "}"}]}], "]"}], ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"data", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", "0.015", "]"}]}], "}"}]}]}], "]"}], 
          ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CarrierRabiDecay", "[", 
     RowBox[{"data_List", ",", "nbar0_", ",", 
      RowBox[{"kmax_:", "100"}], ",", 
      RowBox[{"plot_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nlm", ",", "T", ",", "nbar", ",", "\[CapitalOmega]", ",", 
        "\[CapitalOmega]0", ",", "pos", ",", "t", ",", "\[Eta]", ",", 
        "func"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"data", ",", "First"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"data", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"\[CapitalOmega]0", "=", 
        RowBox[{"Pi", "/", 
         RowBox[{"RabiFrequencyFit", "[", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"pos", "+", 
              RowBox[{"Floor", "[", 
               RowBox[{"0.5", " ", "pos"}], "]"}]}]}], "]"}], "]"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Eta]", "=", "\[Eta]1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{"{", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"nbar", "^", "n"}], "/", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"nbar", "+", "1"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1"}], ")"}]}]}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[CapitalOmega]", " ", 
                    RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Eta]", "^", "2"}]}], "/", "2"}], ")"}]}], " ", 
                    RowBox[{
                    RowBox[{"LaguerreL", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"\[Eta]", "^", "2"}]}], "]"}], "/", "2"}]}], 
                   ")"}], "t"}], "]"}], ")"}], "^", "2"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "0", ",", "kmax"}], "}"}]}], "]"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nbar", ",", "nbar0"}], "}"}]}], "}"}], ",", "t"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"func", "=", 
        RowBox[{"Normal", "@", "nlm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Average phonon number=\>\"", ",", 
         RowBox[{"nbar", "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Carrier Rabi rate=\>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
          "/", 
          RowBox[{"(", 
           RowBox[{"2", "Pi"}], ")"}]}], ",", "\"\<MHz\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"plot", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{"func", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{"data", ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "Medium"}], "}"}]}]}], "]"}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pi", "/", 
        RowBox[{"(", 
         RowBox[{"\[CapitalOmega]", "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
         ")"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TwoModeCarrierRabiDecay", "[", 
     RowBox[{"data_List", ",", "nbar0_", ",", "mbar0_", ",", 
      RowBox[{"kmax_:", "100"}], ",", 
      RowBox[{"plot_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nlm", ",", "T", ",", "nbar", ",", "mbar", ",", "\[CapitalOmega]", ",",
         "\[CapitalOmega]0", ",", "pos", ",", "t", ",", "\[Eta]1", ",", 
        "\[Eta]2", ",", "func"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"data", ",", "First"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"data", ",", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"data", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"\[CapitalOmega]0", "=", 
        RowBox[{"Pi", "/", 
         RowBox[{"RabiFrequencyFit", "[", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"pos", "+", 
              RowBox[{"Floor", "[", 
               RowBox[{"0.5", " ", "pos"}], "]"}]}]}], "]"}], "]"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{"{", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"nbar", "^", "n"}], "/", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"nbar", "+", "1"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1"}], ")"}]}]}], " ", 
              RowBox[{
               RowBox[{"mbar", "^", "m"}], "/", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"mbar", "+", "1"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "1"}], ")"}]}]}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[CapitalOmega]", " ", 
                    RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Eta]1", "^", "2"}]}], "/", "2"}], ")"}]}], " ", 
                    RowBox[{"LaguerreL", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"\[Eta]1", "^", "2"}]}], "]"}], 
                    RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Eta]2", "^", "2"}]}], "/", "2"}], ")"}]}], " ", 
                    RowBox[{
                    RowBox[{"LaguerreL", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"\[Eta]2", "^", "2"}]}], "]"}], "/", "2"}]}], 
                   ")"}], "t"}], "]"}], ")"}], "^", "2"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "0", ",", "kmax"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "0", ",", "kmax"}], "}"}]}], "]"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nbar", ",", "nbar0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"mbar", ",", "mbar0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Eta]1", ",", "0.07"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Eta]2", ",", "0.09"}], "}"}]}], "}"}], ",", "t"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"func", "=", 
        RowBox[{"Normal", "@", "nlm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<X mode average phonon number=\>\"", ",", 
         RowBox[{"nbar", "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Y mode average phonon number=\>\"", ",", 
         RowBox[{"mbar", "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Eta]x=\>\"", ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[Eta]1", "/.", 
           RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Eta]y=\>\"", ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[Eta]2", "/.", 
           RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Carrier Rabi rate=\>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
          "/", 
          RowBox[{"(", 
           RowBox[{"2", "Pi"}], ")"}]}], ",", "\"\<MHz\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"plot", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{"func", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{"data", ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
              RowBox[{"PlotMarkers", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "Medium"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"PlotRange", "->", "All"}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pi", "/", 
        RowBox[{"(", 
         RowBox[{"\[CapitalOmega]", "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
         ")"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThermalStateFitBlue", "[", 
     RowBox[{"data_List", ",", "sbpitime_", ",", 
      RowBox[{"kmax_:", "100"}], ",", 
      RowBox[{"\[Eta]_:", "\[Eta]1"}], ",", 
      RowBox[{"plot_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nlm", ",", "T", ",", "ticks", ",", "nbar", ",", "averagephononnumber",
         ",", "\[CapitalOmega]sb", ",", "\[CapitalOmega]sb0", ",", "p1", ",", 
        "p2", ",", "p3", ",", "t"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{"MaximalBy", "[", 
          RowBox[{"data", ",", "First"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"\[CapitalOmega]sb0", "=", 
        RowBox[{"Pi", "/", "sbpitime"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"nbar", "^", "n"}], "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"nbar", "+", "1"}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"n", "+", "1"}], ")"}]}]}], " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[CapitalOmega]sb", " ", 
                   RowBox[{
                    RowBox[{"LaguerreL", "[", 
                    RowBox[{"n", ",", "1", ",", 
                    RowBox[{"\[Eta]", "^", "2"}]}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"n", "+", "1"}], "]"}]}], ")"}]}], " ", "t"}], 
                  "]"}], ")"}], "^", "2"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "0", ",", "kmax"}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"0.9", "\[CapitalOmega]sb0"}], "<=", "\[CapitalOmega]sb",
              "\[LessEqual]", 
             RowBox[{"1.1", "\[CapitalOmega]sb0"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]sb", ",", 
            RowBox[{"{", 
             RowBox[{"nbar", ",", "0.1"}], "}"}]}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"{", 
              RowBox[{"\[Eta]", ",", "0.07"}], "}"}]}], "*)"}], "}"}], ",", 
          "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"averagephononnumber", "=", 
        RowBox[{"nbar", "/.", 
         RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Pi]\), \(b\)]\): \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Pi", "/", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]sb", "/.", 
              RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
             ")"}]}], "]"}], "<>", "\"\<, Average phonon number: \>\"", "<>", 
          RowBox[{"ToString", "@", "averagephononnumber"}]}], "]"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ticks", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\"\<0.0\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0"}], "}"}]}], "}"}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.1", "i"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"i", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
                RowBox[{"0.1", "i"}], ",", "\"\<\>\""}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
                  "0.01", ",", "0.005"}], "]"}], ",", "0"}], "}"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0.5", ",", "9.5", ",", "0.5"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"1", ",", "\"\<1.0\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0"}], "}"}]}], "}"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"BarChart", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"averagephononnumber", "^", "n"}], "/", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"averagephononnumber", "+", "1"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"n", "+", "1"}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", "kmax"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", 
           "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Bold", ",", "Black", ",", 
             RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "4"}], "]"}], "\[Equal]", 
                    "0"}], ",", 
                    RowBox[{"i", "-", "1"}], ",", "\"\<\>\""}], "]"}]}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", 
               "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "12"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"nlm", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "T"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.004", "]"}], ",", "Blue"}], "}"}]}],
           ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Bold", ",", "Black", ",", 
             RowBox[{"FontSize", "->", "14"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<t(us)\>\"", ",", "\"\<P(\[UpArrow])\>\""}], "}"}]}], 
          ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ticks", ",", "Automatic"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "12"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p3", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"data", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"PointSize", "[", "0.012", "]"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"plot", ",", 
         RowBox[{
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{"p2", ",", "p3"}], "]"}]}], ";", 
          RowBox[{"Print", "[", "p1", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"averagephononnumber", ",", 
         RowBox[{"Pi", "/", 
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]sb", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
           ")"}]}]}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalibrateForCarrierRabi", "[", 
     RowBox[{"data_List", ",", 
      RowBox[{"symbol_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nlm", ",", "a", ",", "b", ",", "x"}], "}"}], ",", 
      RowBox[{
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{"a", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"b", " ", "x"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<amplitude vs Rabi rate \>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.csv\>\""}], ",", "data"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symbol", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{"data", ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"nlm", "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "/.", 
        RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalibrateForCarrierShift", "[", 
     RowBox[{"data_List", ",", "\[Delta]1_", ",", "\[Delta]2_", ",", 
      RowBox[{"symbol_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nlm", ",", "a", ",", "b", ",", "x", ",", "table"}], "}"}], 
      ",", 
      RowBox[{"data", ";", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{"a", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Sin", "[", 
              RowBox[{"b", " ", "x"}], "]"}], ")"}], "^", "2"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<amplitude vs carrier shift \>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.csv\>\""}], ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{"data", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<red detuning=\>\"", "<>", 
              RowBox[{"ToString", "@", "\[Delta]1"}]}], ",", 
             RowBox[{"\"\<blue detuning=\>\"", "<>", 
              RowBox[{"ToString", "@", "\[Delta]2"}]}]}], "}"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symbol", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{"data", ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"nlm", "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}]}],
         "]"}], ";", "\[IndentingNewLine]", "nlm"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IonPositionFit", "[", 
     RowBox[{"data_List", ",", "initialx_", ",", "initialy_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "data3D", ",", "fm", ",", "\[Mu]1", ",", "\[Mu]2", ",", "\[Sigma]1", 
        ",", "\[Sigma]2", ",", "k", ",", "base", ",", "x", ",", "y", ",", 
        "pos"}], "}"}], ",", 
      RowBox[{
       RowBox[{"data3D", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "initialx", "-", "1"}], 
               ",", 
               RowBox[{
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", "initialy", "-", "1"}], 
               ",", "#1"}], "}"}], "&"}], ",", "data", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"MaximalBy", "[", 
         RowBox[{"data3D", ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data3D", ",", 
          RowBox[{"base", "+", 
           RowBox[{"k", " ", 
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x", "-", "\[Mu]1"}], ")"}], "/", "\[Sigma]1"}], 
                  ")"}], "^", "2"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y", "-", "\[Mu]2"}], ")"}], "/", "\[Sigma]2"}], 
                 ")"}], "^", "2"}]}], ")"}]}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Mu]1", ",", 
              RowBox[{"pos", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Mu]2", ",", 
              RowBox[{"pos", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
            "\[Sigma]1", ",", "\[Sigma]2", ",", 
            RowBox[{"{", 
             RowBox[{"base", ",", 
              RowBox[{"Mean", "@", 
               RowBox[{"(", 
                RowBox[{"Mean", "/@", "data"}], ")"}]}]}], "}"}], ",", "k"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Mu]1", ",", "\[Mu]2"}], "}"}], "/.", 
        RowBox[{"fm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IonFind", "[", 
     RowBox[{"data_List", ",", 
      RowBox[{"threshold_:", "1500"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "peak", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"peak", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Max", "/@", "data"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"peak", ">", "threshold"}], ",", "True", ",", "False"}], 
        "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PulseInducedCarrShift", "[", 
     RowBox[{
     "range_List", ",", "carrfreq_", ",", "Pitime_", ",", "amplitude_", ",", 
      "freq__"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"file", "=", 
         RowBox[{"NewData", "[", 
          RowBox[{"\"\<Pulse induced carrier shift\>\"", "<>", "\"\<-\>\""}], 
          "]"}]}], ",", 
        RowBox[{"data", "=", 
         RowBox[{"{", "}"}]}], ",", "counts", ",", 
        RowBox[{"stop", "=", "False"}], ",", "l"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"{", "freq", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SequencerAxis", "@@", "range"}], ";", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"awg", "@", "\"\<Wave File\>\""}], ",", 
         RowBox[{"ExportWaveFile", "[", 
          RowBox[{"\"\<Wave/acStarkShift.csv\>\"", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"l", "\[Equal]", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
               "freq", ",", "0.1", ",", "amplitude", ",", "0", ",", "0"}], 
               "}"}], "}"}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "freq", "}"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", 
                   "amplitude", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0.1", ",", "0", ",", "0", ",", "0", ",", 
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"ToString", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", 
                    RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<,\>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<[\>\""}], ",", 
                    RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<]\>\""}]}], "}"}]}], 
                   "]"}]}], "}"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"awg", "@", "\"\<Row\>\""}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"l", "\[Equal]", "1"}], ",", "0", ",", "l"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Item\>\""}], ",", "\"\<AOM\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Parameter\>\""}], ",", "0"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Start\>\""}], ",", "carrfreq"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Repeats\>\""}], ",", "100"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Count or State\>\""}], ",", "1"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "@", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<\[FilledCircle]STOP\>\"", ",", 
          RowBox[{"stop", "=", "True"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CtrlSignalValue", "[", 
        RowBox[{
         RowBox[{"sequencer", "@", "\"\<Sequence File\>\""}], ",", 
         RowBox[{"ExportSequenceFile", "[", 
          RowBox[{"\"\<Sequence/acStarkShift.seq\>\"", ",", 
           RowBox[{"TwoModeSBC", "[", 
            RowBox[{
            "n", ",", "m", ",", "RedXPi", ",", "\[Eta]1", ",", "RedYPi", ",", 
             "\[Eta]2", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<Raman3\>\"", "[", 
                RowBox[{"Pitime", "/", "2"}], "]"}], ",", 
               RowBox[{"\"\<AWG\>\"", "[", "1", "]"}], ",", 
               RowBox[{"\"\<Gap\>\"", "[", "2", "]"}], ",", 
               RowBox[{"\"\<Raman3\>\"", "[", 
                RowBox[{"Pitime", "/", "2"}], "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pause", "[", "0.5", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"stop", ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
          RowBox[{"SequencerCompiled", "[", 
           RowBox[{"ExportCompiledSequence", "@", 
            RowBox[{"CompileSequence", "[", 
             RowBox[{"TwoModeSBC", "[", 
              RowBox[{
              "n", ",", "m", ",", "RedXPi", ",", "\[Eta]1", ",", "RedYPi", 
               ",", "\[Eta]2", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Raman3\>\"", "[", 
                  RowBox[{"Pitime", "/", "2"}], "]"}], ",", 
                 RowBox[{"\"\<AWG\>\"", "[", "1", "]"}], ",", 
                 RowBox[{"\"\<Gap\>\"", "[", 
                  RowBox[{"t", "+", "2"}], "]"}], ",", 
                 RowBox[{"\"\<Raman3\>\"", "[", 
                  RowBox[{"Pitime", "/", "2"}], "]"}]}], "}"}]}], "]"}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"CtrlSignalValue", "[", 
           RowBox[{
            RowBox[{"awg", "@", "\"\<Duration (us)\>\""}], ",", "t"}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Pause", "[", "0.1", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"CtrlGetValue", "[", 
              RowBox[{"awg", "@", "\"\<Action\>\""}], "]"}], "===", "True"}], 
            ",", "Null"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"counts", "=", 
           RowBox[{"SequencerCounts", "[", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"data", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "counts"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"range", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"ExportData", "[", 
        RowBox[{"file", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<C\>\"", "\[Rule]", 
            RowBox[{"\[LeftAssociation]", 
             RowBox[{"\"\<Channel\>\"", "\[Rule]", 
              RowBox[{"{", "1", "}"}]}], "\[RightAssociation]"}]}], ",", 
           RowBox[{"\"\<X\>\"", "\[Rule]", 
            RowBox[{"List", "/@", 
             RowBox[{"data", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"\"\<Y_Count\>\"", "\[Rule]", 
            RowBox[{"data", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
          "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PseudoCounts", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"DarkCenter_:", "0.1"}], ",", 
      RowBox[{"BrightCenter_:", "8"}], ",", 
      RowBox[{"n_Integer:", "1000"}]}], "]"}], ":=", 
    RowBox[{"RandomVariate", "[", 
     RowBox[{
      RowBox[{"MixtureDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PoissonDistribution", "[", "DarkCenter", "]"}], ",", 
          RowBox[{"PoissonDistribution", "[", "BrightCenter", "]"}]}], 
         "}"}]}], "]"}], ",", "n"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StateOverlap", "[", 
     RowBox[{"Path_String", ",", 
      RowBox[{"Range_:", 
       RowBox[{"{", 
        RowBox[{"0", ",", "20"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"b", ",", "d", ",", "bdata", ",", "ddata", ",", "graph"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"b", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Average", "[", 
             RowBox[{"Path", ",", 
              RowBox[{"S1", "[", "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"MaximalBy", "[", 
              RowBox[{
               RowBox[{"Average", "[", 
                RowBox[{"Path", ",", 
                 RowBox[{"S1", "[", "]"}]}], "]"}], ",", "Last"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"d", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Average", "[", 
             RowBox[{"Path", ",", 
              RowBox[{"S1", "[", "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"MinimalBy", "[", 
              RowBox[{
               RowBox[{"Average", "[", 
                RowBox[{"Path", ",", 
                 RowBox[{"S1", "[", "]"}]}], "]"}], ",", "Last"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bdata", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"LoadCounts", "[", 
           RowBox[{"Path", ",", 
            RowBox[{"C1", "[", "]"}]}], "]"}], "[", 
          RowBox[{"[", "b", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ddata", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"LoadCounts", "[", 
           RowBox[{"Path", ",", 
            RowBox[{"C1", "[", "]"}]}], "]"}], "[", 
          RowBox[{"[", "d", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Bright state fidelity=\>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"MaximalBy", "[", 
            RowBox[{
             RowBox[{"Average", "[", 
              RowBox[{"Path", ",", 
               RowBox[{"S1", "[", "]"}]}], "]"}], ",", "Last"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Dark state fidelity=\>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"MinimalBy", "[", 
            RowBox[{
             RowBox[{"Average", "[", 
              RowBox[{"Path", ",", 
               RowBox[{"S1", "[", "]"}]}], "]"}], ",", "Last"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"Histogram", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"bdata", ",", "ddata"}], "}"}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Black", ",", "Thick", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1.5", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.5", ",", "800"}], "}"}]}], "}"}], "]"}]}], 
               "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.5", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Range", ",", "All"}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<# of photon\>\"", ",", "\"\<# of events\>\""}], 
            "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "Bold"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"graph", ",", "\[IndentingNewLine]", 
         RowBox[{"Histogram", "[", 
          RowBox[{"bdata", ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Range", ",", "All"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<# of photon\>\"", ",", "\"\<# of events\>\""}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Histogram", "[", 
          RowBox[{"ddata", ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Range", ",", "All"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<# of photon\>\"", ",", "\"\<# of events\>\""}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}]}], "]"}]}], "}"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TwoQubitState", "[", 
     RowBox[{"Path_String", ",", 
      RowBox[{"Threshold1_:", "1"}], ",", "Threshold2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "data", ",", "state", ",", "p0", ",", "p1", ",", "p2", ",", "n"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{"LoadCounts", "[", 
         RowBox[{"Path", ",", 
          RowBox[{"C1", "[", "]"}]}], "]"}]}], ";", 
       RowBox[{"n", "=", 
        RowBox[{"1.", "*", 
         RowBox[{"Length", "@", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", "Threshold1"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", ">", "Threshold2"}], ",", "2", ",", "1"}], "]"}],
               ",", "0"}], "]"}], ")"}], "&"}], ",", "data", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p0", "=", 
        RowBox[{"Each", "[", 
         RowBox[{"state", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"#2", ",", "0"}], "]"}], "/", "n"}]}], "}"}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"Each", "[", 
         RowBox[{"state", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"#2", ",", "1"}], "]"}], "/", "n"}]}], "}"}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"Each", "[", 
         RowBox[{"state", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"#2", ",", "2"}], "]"}], "/", "n"}]}], "}"}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p0", ",", "p1", ",", "p2"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<P00\>\"", ",", "\"\<P01+P10\>\"", ",", "\"\<P11\>\""}], 
           "}"}]}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "ExportFile", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportFile", "[", 
    RowBox[{"addr_String", ",", "data_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", 
         RowBox[{"FileNameDrop", "[", 
          RowBox[{"addr", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", 
        RowBox[{"FileNameDrop", "[", 
         RowBox[{"addr", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"Export", "[", 
      RowBox[{"addr", ",", "data", ",", "opts"}], "]"}], ";"}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "AddNoise", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AddNoise", "[", 
    RowBox[{"dat_List", ",", "dist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "noise", "}"}], ",", 
     RowBox[{
      RowBox[{"noise", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"dist", ",", 
         RowBox[{"Length", "@", "dat"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dat", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"dat", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "+", "noise"}]}], "}"}], 
       "\[Transpose]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.805088090077239*^9, 3.805088126213608*^9}, {
   3.8050881752694287`*^9, 3.805088175555664*^9}, {3.805088365678263*^9, 
   3.8050883696506405`*^9}, {3.8050884057820225`*^9, 
   3.8050884066347427`*^9}, {3.805088438413763*^9, 3.8050884419473143`*^9}, {
   3.805088533545375*^9, 3.8050885352398434`*^9}, {3.805088580549682*^9, 
   3.8050885852451267`*^9}, {3.8050886435073295`*^9, 
   3.8050886449335155`*^9}, {3.8050889233559947`*^9, 
   3.8050889244291253`*^9}, {3.8050915219322257`*^9, 
   3.8050915469403524`*^9}, {3.8055220648087406`*^9, 3.8055220661282115`*^9}, 
   3.8056738856290345`*^9, {3.8064575041413293`*^9, 3.806457508238372*^9}, {
   3.8069028947044935`*^9, 3.8069030022079763`*^9}, {3.8069030548661413`*^9, 
   3.80690307883005*^9}, 3.80691681782997*^9, {3.806916850541483*^9, 
   3.8069168556298733`*^9}, {3.80691691066568*^9, 3.8069169173468103`*^9}, {
   3.806995757028916*^9, 3.806995790778651*^9}, {3.8070553046935234`*^9, 
   3.8070553324642425`*^9}, {3.807514919481782*^9, 3.8075149314268274`*^9}, {
   3.8075160017071714`*^9, 3.807516001806904*^9}, {3.807516054924805*^9, 
   3.8075161106347713`*^9}, {3.8076985548245745`*^9, 
   3.8076985555256987`*^9}, {3.8082795595361624`*^9, 3.808279567397133*^9}, {
   3.8098255397064023`*^9, 3.8098255472761745`*^9}, {3.8110484740751925`*^9, 
   3.8110485044629*^9}, {3.811048593352106*^9, 3.811048673056884*^9}, {
   3.8110487309450226`*^9, 3.8110488188608336`*^9}, {3.8110488768526955`*^9, 
   3.8110488775388603`*^9}, {3.8110489168397245`*^9, 
   3.8110489295487256`*^9}, {3.8110490247281055`*^9, 
   3.8110490397379513`*^9}, {3.8110490896464376`*^9, 
   3.8110490920998745`*^9}, {3.811049125513488*^9, 3.8110491531485596`*^9}, {
   3.8110491858530693`*^9, 3.8110492384194455`*^9}, {3.811049301919573*^9, 
   3.8110493627079544`*^9}, {3.81104941990594*^9, 3.811049420172228*^9}, {
   3.8110494544784536`*^9, 3.8110494813735037`*^9}, {3.8110495292683773`*^9, 
   3.8110495451478972`*^9}, {3.8110496177815905`*^9, 3.811049688447548*^9}, {
   3.811049828516839*^9, 3.811049834983539*^9}, {3.8110499229412384`*^9, 
   3.811049924925928*^9}, 3.8110499566799817`*^9, 3.811050023023502*^9, {
   3.813915767418443*^9, 3.8139159120375633`*^9}, {3.813916795164954*^9, 
   3.813916796758691*^9}, {3.813916951154656*^9, 3.813916987269044*^9}, {
   3.8139172631101246`*^9, 3.8139172637065287`*^9}, {3.8139173053700724`*^9, 
   3.813917318933787*^9}, {3.813917354737007*^9, 3.813917369010823*^9}, {
   3.813917495135419*^9, 3.813917497490119*^9}, {3.816054019241191*^9, 
   3.816054061842226*^9}, {3.8209150836820974`*^9, 3.8209150856179204`*^9}, {
   3.8209151223167815`*^9, 3.820915153498396*^9}, {3.8227824061428995`*^9, 
   3.8227824669173765`*^9}, {3.82307480205205*^9, 3.8230748034323597`*^9}, {
   3.823074879919818*^9, 3.8230749247549205`*^9}, {3.823137581340486*^9, 
   3.823137614786046*^9}, {3.823137649378539*^9, 3.823137664773371*^9}, {
   3.823213242205203*^9, 3.8232132568809576`*^9}, {3.8235754439893208`*^9, 
   3.8235754827686176`*^9}, {3.823575516279005*^9, 3.823575692458867*^9}, {
   3.8235757395788593`*^9, 3.8235757633792133`*^9}, {3.8235758136408043`*^9, 
   3.8235758138233166`*^9}},
 CellLabel->
  "In[5480]:=",ExpressionUUID->"4fec53e1-60aa-4fef-80fd-e663c255db14"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dedicated", "Subsection",
 CellChangeTimes->{{3.805087666357027*^9, 
  3.8050876719151645`*^9}},ExpressionUUID->"c2540ca5-fc5c-459b-afd2-\
109930100cb6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SDFScanTimeFit", "[", 
     RowBox[{"data_List", ",", "\[CapitalOmega]SB_", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "2", "Pi"}], "*)"}], ",", "\[Delta]0_", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "2", "Pi"}], "*)"}], ",", 
      RowBox[{"n0", ":", 
       RowBox[{"_", "?", "NumberQ"}], ":", "0.01"}], ",", 
      RowBox[{"heatingrate", ":", 
       RowBox[{"_", "?", "NumberQ"}], ":", 
       RowBox[{"10", "^", 
        RowBox[{"-", "4"}]}]}], ",", 
      RowBox[{"export_Symbol:", "False"}], ",", 
      RowBox[{"plot_Symbol:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Tau]", ",", "nlm", ",", "hr", ",", "n", ",", "\[CapitalOmega]sb", 
        ",", "\[Delta]", ",", "T", ",", "graph"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MaximalBy", "[", 
           RowBox[{"data", ",", "First"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                    "^", "2"}], " ", "hr", " ", "\[Tau]"}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ")"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                    "^", "2"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "\[Tau]"}], 
                    "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"-", "3"}]}], ">=", "hr", ">=", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.95", "\[CapitalOmega]SB"}], "<=", 
               "\[CapitalOmega]sb", "\[LessEqual]", 
               RowBox[{"1.05", "\[CapitalOmega]SB"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"20", ">=", "n", ">=", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.9", "\[Delta]0"}], "<=", "\[Delta]", "\[LessEqual]", 
               RowBox[{"1.1", "\[Delta]0"}]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hr", ",", "heatingrate"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n0"}], "}"}], ",", "\[Delta]", ",", 
            "\[CapitalOmega]sb"}], "}"}], ",", "\[Tau]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<period=\>\"", ",", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"\[Delta]", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}]}],
          ",", "\"\<us\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<initial phonon number=\>\"", ",", 
         RowBox[{"n", "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<heating rate=\>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hr", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
          "*", 
          RowBox[{"10", "^", "3"}]}], ",", "\"\</ms\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<sideband Rabi rate=\>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]sb", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
          "*", 
          RowBox[{"10", "^", "3"}]}], ",", "\"\<kHz\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"nlm", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "T"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], 
              "}"}]}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<t(us)\>\"", ",", "\"\<Spin up population\>\""}], 
              "}"}]}], ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"FrameTicksStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"data", ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"export", ",", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
            RowBox[{"DateString", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
               "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", 
               ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
               "\"\<\\\\\>\""}], "}"}], "]"}], "<>", 
            "\"\<Spin dependent force signal vs time \>\"", "<>", 
            RowBox[{"DateString", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
               "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}],
               "}"}], "]"}], "<>", "\"\<.png\>\""}], ",", "graph", ",", 
           RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"plot", ",", 
         RowBox[{"Print", "[", "graph", "]"}]}], "]"}], ";", 
       RowBox[{"\[Delta]", "/.", 
        RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SDFScanDetuningFit", "[", 
     RowBox[{"data_List", ",", "\[CapitalOmega]SB_", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "2", "Pi"}], "*)"}], ",", "\[Tau]0_", ",", 
      RowBox[{"n0", ":", 
       RowBox[{"_", "?", "NumberQ"}], ":", "0.01"}], ",", 
      RowBox[{"HeatingRate", ":", 
       RowBox[{"_", "?", "NumberQ"}], ":", "0.0001"}], ",", 
      RowBox[{"export_Symbol:", "False"}], ",", 
      RowBox[{"plot_Symbol:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Tau]", ",", "nlm", ",", "hr", ",", "n", ",", "\[CapitalOmega]sb", 
        ",", "\[Delta]", ",", "T", ",", "graph"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{"MaximalBy", "[", 
          RowBox[{"data", ",", "First"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                    "^", "2"}], " ", "hr", " ", "\[Tau]"}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ")"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                    "^", "2"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "\[Tau]"}], 
                    "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"-", "3"}]}], ">=", "hr", ">=", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.95", "\[CapitalOmega]SB"}], "<=", 
               "\[CapitalOmega]sb", "\[LessEqual]", 
               RowBox[{"1.05", "\[CapitalOmega]SB"}]}], ")"}], "&&", 
             RowBox[{"n", ">=", "0"}], "&&", 
             RowBox[{"\[Tau]", ">", "0"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hr", ",", "HeatingRate"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n0"}], "}"}], ",", "\[CapitalOmega]sb", ",", 
            RowBox[{"{", 
             RowBox[{"\[Tau]", ",", "\[Tau]0"}], "}"}]}], "}"}], ",", 
          "\[Delta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<period=\>\"", ",", 
         RowBox[{"\[Tau]", "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
         "\"\<us\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<initial phonon number=\>\"", ",", 
         RowBox[{"n", "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<heating rate=\>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hr", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
          "*", 
          RowBox[{"10", "^", "3"}]}], ",", "\"\</ms\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<sideband Rabi rate=\>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]sb", "/.", 
            RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
          "*", 
          RowBox[{"10", "^", "3"}]}], ",", "\"\<kHz\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"nlm", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "T"}], ",", "T"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], 
              "}"}]}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\[Delta](MHz)\>\"", ",", "\"\<Spin up population\>\""}], 
              "}"}]}], ",", 
            RowBox[{"Axes", "\[Rule]", "False"}], ",", 
            RowBox[{"FrameTicksStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"data", ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"export", ",", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
            RowBox[{"DateString", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
               "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", 
               ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
               "\"\<\\\\\>\""}], "}"}], "]"}], "<>", 
            "\"\<Spin dependent force signal vs time \>\"", "<>", 
            RowBox[{"DateString", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
               "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}],
               "}"}], "]"}], "<>", "\"\<.png\>\""}], ",", "graph", ",", 
           RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"plot", ",", 
         RowBox[{"Print", "[", "graph", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"\[Tau]", "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
         ")"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MSGatePopulationFit", "[", 
     RowBox[{
     "Path_String", ",", "Threshold1_Integer", ",", "Threshold2_Integer", ",",
       "\[CapitalOmega]SB_", ",", "\[Delta]0_", ",", 
      RowBox[{"n0_:", "0.01"}]}], "]"}], ":=", 
    RowBox[{"MSGatePopulationFit", "[", 
     RowBox[{
      RowBox[{"TwoQubitState", "[", 
       RowBox[{"Path", ",", "Threshold1", ",", "Threshold2"}], "]"}], ",", 
      "\[CapitalOmega]SB", ",", "\[Delta]0", ",", "n0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MSGatePopulationFit", "[", 
     RowBox[{
     "Path_String", ",", "par0_", ",", "par1_", ",", "par2_", ",", 
      "\[CapitalOmega]SB_", ",", "\[Delta]0_", ",", 
      RowBox[{"n0_:", "0.01"}]}], "]"}], ":=", 
    RowBox[{"MSGatePopulationFit", "[", 
     RowBox[{
      RowBox[{"TwoQubitState", "[", 
       RowBox[{"Path", ",", "par0", ",", "par1", ",", "par2"}], "]"}], ",", 
      "\[CapitalOmega]SB", ",", "\[Delta]0", ",", "n0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MSGatePopulationFit", "[", 
     RowBox[{"data_List", ",", "\[CapitalOmega]SB_", ",", "\[Delta]0_", ",", 
      RowBox[{"n0_:", "0.01"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "p0", ",", "p1", ",", "p2", ",", "n", ",", "nlm0", ",", "nlm1", ",", 
        "nlm2", ",", "\[CapitalOmega]sb", ",", "\[Delta]", ",", "t", ",", 
        "T"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p0", ",", "p1", ",", "p2"}], "}"}], "=", "data"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{"MaximalBy", "[", 
          RowBox[{"p0", ",", "First"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm0", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"p0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "8"}], 
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"4", " ", 
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                    "^", "2"}]}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "t"}], "]"}]}], 
                    ")"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ")"}]}], ")"}]}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]sb", "^", "2"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "t"}], "-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "t"}], "]"}]}], 
                    ")"}], "/", 
                   RowBox[{"\[Delta]", "^", "2"}]}]}], "]"}]}], "+", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                   "^", "2"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "t"}], "]"}]}], 
                   ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ")"}]}], ")"}]}]}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.9", "\[CapitalOmega]SB"}], "<=", 
               "\[CapitalOmega]sb", "\[LessEqual]", 
               RowBox[{"1.1", "\[CapitalOmega]SB"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"20", ">=", "n", ">=", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.9", "\[Delta]0"}], "<=", "\[Delta]", "\[LessEqual]", 
               RowBox[{"1.1", "\[Delta]0"}]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", "n0"}], "}"}], ",", "\[Delta]", ",", 
            "\[CapitalOmega]sb"}], "}"}], ",", "t"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlm1", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"p1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "4"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                   "^", "2"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "t"}], "]"}]}], 
                   ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ")"}]}], ")"}]}]}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.9", "\[CapitalOmega]SB"}], "<=", 
               "\[CapitalOmega]sb", "\[LessEqual]", 
               RowBox[{"1.1", "\[CapitalOmega]SB"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"20", ">=", "n", ">=", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.9", "\[Delta]0"}], "<=", "\[Delta]", "\[LessEqual]", 
               RowBox[{"1.1", "\[Delta]0"}]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", "n0"}], "}"}], ",", "\[Delta]", ",", 
            "\[CapitalOmega]sb"}], "}"}], ",", "t"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlm2", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"p2", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "8"}], 
             RowBox[{"(", 
              RowBox[{"3", "-", 
               RowBox[{"4", " ", 
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                    "^", "2"}]}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "t"}], "]"}]}], 
                    ")"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ")"}]}], ")"}]}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]sb", "^", "2"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "t"}], "-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "t"}], "]"}]}], 
                    ")"}], "/", 
                   RowBox[{"\[Delta]", "^", "2"}]}]}], "]"}]}], "+", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                   "^", "2"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "t"}], "]"}]}], 
                   ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ")"}]}], ")"}]}]}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.9", "\[CapitalOmega]SB"}], "<=", 
               "\[CapitalOmega]sb", "\[LessEqual]", 
               RowBox[{"1.1", "\[CapitalOmega]SB"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"20", ">=", "n", ">=", "0"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.9", "\[Delta]0"}], "<=", "\[Delta]", "\[LessEqual]", 
               RowBox[{"1.1", "\[Delta]0"}]}], ")"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", "n0"}], "}"}], ",", "\[Delta]", ",", 
            "\[CapitalOmega]sb"}], "}"}], ",", "t"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<period=\>\"", ",", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"\[Delta]", "/.", 
            RowBox[{"nlm0", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
           ")"}]}], ",", "\"\<us\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<initial phonon number=\>\"", ",", 
         RowBox[{"n", "/.", 
          RowBox[{"nlm0", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<sideband Rabi rate=\>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]sb", "/.", 
            RowBox[{"nlm0", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
          "*", 
          RowBox[{"10", "^", "3"}]}], ",", "\"\<kHz\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"nlm0", "[", "x", "]"}], ",", 
             RowBox[{"nlm1", "[", "x", "]"}], ",", 
             RowBox[{"nlm2", "[", "x", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "T"}], "}"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<P00\>\"", ",", "\"\<P01+P10\>\"", ",", "\"\<P11\>\""}], 
             "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p0", ",", "p1", ",", "p2"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"PointSize", "[", "0.01", "]"}]}]}], "]"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "MSGateFitWithSpin00", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MSGateFitWithSpin00", "[", 
    RowBox[{"data_List", ",", "\[CapitalOmega]SB_", ",", "\[Delta]0_", ",", 
     RowBox[{"n0_:", "0.01"}], ",", 
     RowBox[{"plot_:", "True"}], ",", 
     RowBox[{"export_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Tau]", ",", "nlm", ",", "n", ",", "\[CapitalOmega]sb", ",", 
       "\[Delta]", ",", "T", ",", "graph"}], "}"}], ",", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{"MaximalBy", "[", 
         RowBox[{"data", ",", "First"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nlm", "=", 
       RowBox[{"NonlinearModelFit", "[", 
        RowBox[{"data", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "8"}], " ", 
            RowBox[{"(", 
             RowBox[{"3", "+", 
              RowBox[{"4", " ", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], 
                    "^", "2"}]}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "\[Tau]"}], 
                    "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "n"}], "+", "1"}], ")"}]}], ")"}]}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{"\[CapitalOmega]sb", "^", "2"}], " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "\[Tau]"}], "-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "\[Tau]"}], 
                    "]"}]}], ")"}], "/", 
                  RowBox[{"\[Delta]", "^", "2"}]}]}], "]"}]}], "+", 
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[CapitalOmega]sb", "/", "\[Delta]"}], ")"}], "^",
                   "2"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", "Pi", " ", "\[Delta]", " ", "\[Tau]"}], 
                    "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "n"}], "+", "1"}], ")"}]}], ")"}]}]}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.9", "\[CapitalOmega]SB"}], "<=", "\[CapitalOmega]sb",
               "\[LessEqual]", 
              RowBox[{"1.1", "\[CapitalOmega]SB"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"20", ">=", "n", ">=", "0"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.9", "\[Delta]0"}], "<=", "\[Delta]", "\[LessEqual]", 
              RowBox[{"1.1", "\[Delta]0"}]}], ")"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "n0"}], "}"}], ",", "\[Delta]", ",", 
           "\[CapitalOmega]sb"}], "}"}], ",", "\[Tau]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<period=\>\"", ",", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"\[Delta]", "/.", 
           RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}]}], 
        ",", "\"\<us\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<initial phonon number=\>\"", ",", 
        RowBox[{"n", "/.", 
         RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<sideband Rabi rate=\>\"", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]sb", "/.", 
           RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ")"}], 
         "*", 
         RowBox[{"10", "^", "3"}]}], ",", "\"\<kHz\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"nlm", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "T"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<t(us)\>\"", ",", "\"\<Spin up population\>\""}], 
             "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}], ",", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"data", ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"export", ",", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
           RowBox[{"DateString", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
              "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
              "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
             "}"}], "]"}], "<>", 
           "\"\<Spin dependent force signal vs time \>\"", "<>", 
           RowBox[{"DateString", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
              "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
             "}"}], "]"}], "<>", "\"\<.png\>\""}], ",", "graph", ",", 
          RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"plot", ",", 
        RowBox[{"Print", "[", "graph", "]"}]}], "]"}], ";", 
      RowBox[{"\[Delta]", "/.", 
       RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7763153852944083`*^9, 3.7763154109617352`*^9}, {
   3.776378872256059*^9, 3.7763788728664265`*^9}, {3.776498414341691*^9, 
   3.7764984412108026`*^9}, {3.7765540070193615`*^9, 3.776554027933407*^9}, {
   3.7765574639437075`*^9, 3.7765574968875647`*^9}, {3.776557905906227*^9, 
   3.776557908442442*^9}, {3.7765579647079024`*^9, 3.776557971785965*^9}, {
   3.776558028463323*^9, 3.7765581477122707`*^9}, {3.776558187022097*^9, 
   3.77655818746192*^9}, {3.776570671447076*^9, 3.7765706777532043`*^9}, {
   3.776570730400346*^9, 3.776570753223284*^9}, 3.7765709765826807`*^9, {
   3.776571514061926*^9, 3.7765715855596323`*^9}, {3.7765719456123047`*^9, 
   3.776571947724653*^9}, {3.776572040265059*^9, 3.7765720681574326`*^9}, {
   3.7765721438608875`*^9, 3.7765721563504705`*^9}, {3.776572200397621*^9, 
   3.7765722054132023`*^9}, {3.7765852953852863`*^9, 3.776585297775891*^9}, {
   3.7766538158308015`*^9, 3.776653816126012*^9}, {3.776664875670165*^9, 
   3.776664972356722*^9}, {3.7766650070269613`*^9, 3.7766650355837746`*^9}, {
   3.7766651285021687`*^9, 3.7766651342299333`*^9}, {3.7766652747998357`*^9, 
   3.7766652813054295`*^9}, {3.7766653344352803`*^9, 
   3.7766653604675856`*^9}, {3.776673479533696*^9, 3.776673500207828*^9}, {
   3.7766735335047417`*^9, 3.776673755755886*^9}, {3.7766739334644227`*^9, 
   3.7766739427755113`*^9}, {3.776678579583706*^9, 3.7766786656450567`*^9}, {
   3.776678757072441*^9, 3.7766787747120733`*^9}, {3.7766788354635324`*^9, 
   3.77667883824337*^9}, {3.77667890400642*^9, 3.776679041689842*^9}, {
   3.7766792089270997`*^9, 3.7766792234711866`*^9}, {3.7766796588631287`*^9, 
   3.7766796688384395`*^9}, {3.776737549712283*^9, 3.7767375591939144`*^9}, {
   3.776742525790571*^9, 3.7767425729503937`*^9}, {3.776742664478509*^9, 
   3.776742730246545*^9}, {3.776742797301139*^9, 3.776742797928461*^9}, 
   3.7767428570772076`*^9, {3.776808875249836*^9, 3.776808902201726*^9}, {
   3.776853563248475*^9, 3.776853564892078*^9}, 3.776853877273296*^9, {
   3.776853973932682*^9, 3.7768539917300644`*^9}, {3.77685403592881*^9, 
   3.7768541463304296`*^9}, {3.776854204877784*^9, 3.776854240701936*^9}, {
   3.776854292304871*^9, 3.776854442354411*^9}, {3.7768545393538866`*^9, 
   3.7768545578035245`*^9}, {3.7768550233220205`*^9, 3.776855026393802*^9}, {
   3.776855106533387*^9, 3.776855163404228*^9}, {3.7768552008161325`*^9, 
   3.7768552287503934`*^9}, {3.7768552769763637`*^9, 3.7768552979821625`*^9}, 
   3.776855337279023*^9, {3.77699929868612*^9, 3.7769993889479923`*^9}, {
   3.7769994344891453`*^9, 3.77699943901005*^9}, {3.776999489835605*^9, 
   3.776999497306616*^9}, {3.7769995590135174`*^9, 3.7769995876841297`*^9}, {
   3.7769997152099323`*^9, 3.7769997338081713`*^9}, {3.7769997955958576`*^9, 
   3.776999869388894*^9}, {3.776999917956411*^9, 3.7769999583275414`*^9}, {
   3.777000008548176*^9, 3.7770000228299646`*^9}, {3.777178518473421*^9, 
   3.777178528544489*^9}, 3.777178564310841*^9, {3.7771788495241127`*^9, 
   3.77717894022755*^9}, {3.7771805501612015`*^9, 3.777180603323034*^9}, {
   3.777180672489067*^9, 3.777180672705488*^9}, {3.7771903791571097`*^9, 
   3.7771903977344294`*^9}, {3.77719043056962*^9, 3.7771905021651564`*^9}, {
   3.777190537381979*^9, 3.777190572886032*^9}, {3.777190654572584*^9, 
   3.777190657917637*^9}, {3.7771907223044515`*^9, 3.777190784222867*^9}, 
   3.7771909394776783`*^9, 3.77719100947449*^9, {3.777191077132556*^9, 
   3.7771910783891954`*^9}, {3.777191117208384*^9, 3.777191257169095*^9}, {
   3.7771913384148245`*^9, 3.777191341181426*^9}, {3.7771914004359655`*^9, 
   3.777191495271353*^9}, {3.7771921595090218`*^9, 3.777192159962809*^9}, {
   3.7771946655043893`*^9, 3.7771947215146046`*^9}, {3.7771947865835943`*^9, 
   3.777194848451146*^9}, {3.777195900593465*^9, 3.7771959135976896`*^9}, {
   3.7772018685759697`*^9, 3.777201877502099*^9}, {3.777201935941818*^9, 
   3.777201951851272*^9}, {3.77720198518114*^9, 3.777202009016399*^9}, {
   3.7772020714374695`*^9, 3.7772021066562862`*^9}, {3.7772021808897676`*^9, 
   3.7772022277424726`*^9}, {3.7772023794776964`*^9, 
   3.7772025125248966`*^9}, {3.7772025452204604`*^9, 3.777202581797644*^9}, {
   3.7772026132754664`*^9, 3.7772026458214293`*^9}, {3.7772027113831015`*^9, 
   3.7772028643749647`*^9}, {3.7772028978434625`*^9, 
   3.7772029518769636`*^9}, {3.7772032136997857`*^9, 
   3.7772032500455894`*^9}, {3.7772033174323807`*^9, 3.7772033429611106`*^9}, 
   3.7772034970719814`*^9, 3.777241172994464*^9, {3.77724648842017*^9, 
   3.7772465797160225`*^9}, 3.7772466733380833`*^9, {3.777247175283695*^9, 
   3.7772471858274975`*^9}, {3.777281505776205*^9, 3.7772815159639606`*^9}, {
   3.7774173412845755`*^9, 3.7774173577884407`*^9}, {3.777418825327888*^9, 
   3.7774188270971565`*^9}, {3.777437934306897*^9, 3.7774379563309994`*^9}, {
   3.777438485518824*^9, 3.7774384856355124`*^9}, {3.777439196454612*^9, 
   3.77743920445422*^9}, {3.7777050998174706`*^9, 3.777705140356061*^9}, {
   3.7777052547561274`*^9, 3.7777052584821634`*^9}, {3.777707374553282*^9, 
   3.7777073761270723`*^9}, {3.777707784655362*^9, 3.777707792470463*^9}, {
   3.7777078382779627`*^9, 3.7777078639911995`*^9}, {3.7777085285460215`*^9, 
   3.777708572844556*^9}, {3.777709312306058*^9, 3.7777093687969875`*^9}, {
   3.7777097632551126`*^9, 3.7777097873357153`*^9}, {3.7777099221322374`*^9, 
   3.7777099393023205`*^9}, {3.7777099977669716`*^9, 3.777710009749926*^9}, {
   3.7777101490613747`*^9, 3.7777101519057674`*^9}, 3.777712243514305*^9, {
   3.7777122772690363`*^9, 3.7777123174914722`*^9}, {3.7777123615586257`*^9, 
   3.7777123879191313`*^9}, {3.777713613087737*^9, 3.777713619157505*^9}, 
   3.777715039393453*^9, 3.7777150773389783`*^9, {3.777715607670744*^9, 
   3.7777156114177237`*^9}, {3.7777178107615657`*^9, 
   3.7777178198791833`*^9}, {3.777717865755499*^9, 3.7777178964075284`*^9}, {
   3.777793681419482*^9, 3.777793712367176*^9}, {3.77779404357016*^9, 
   3.777794055209036*^9}, {3.7777941033453074`*^9, 3.7777941078606396`*^9}, {
   3.777794189956489*^9, 3.7777942192487974`*^9}, {3.777794284029559*^9, 
   3.7777944025131073`*^9}, {3.7777944471208153`*^9, 3.777794451247779*^9}, {
   3.7777946742565765`*^9, 3.77779467812523*^9}, 3.7778134343154078`*^9, {
   3.777851383641488*^9, 3.7778513946829605`*^9}, {3.7778514395898685`*^9, 
   3.777851457636607*^9}, {3.777851507121273*^9, 3.777851521750152*^9}, {
   3.777851561719265*^9, 3.7778515887828903`*^9}, {3.777853117114765*^9, 
   3.777853133084059*^9}, {3.7778542832632046`*^9, 3.7778543399795313`*^9}, 
   3.77785987370522*^9, {3.7779540259014635`*^9, 3.777954040789649*^9}, {
   3.777954671640602*^9, 3.77795473649716*^9}, {3.777961303031126*^9, 
   3.777961339513564*^9}, {3.777961402558964*^9, 3.777961403340873*^9}, {
   3.7779647969552755`*^9, 3.7779648471889386`*^9}, {3.777964905622673*^9, 
   3.777964939108124*^9}, {3.777964978620459*^9, 3.7779650111135645`*^9}, {
   3.777965203478136*^9, 3.7779652058009243`*^9}, {3.7782181211860466`*^9, 
   3.7782181321756573`*^9}, {3.7782182573568926`*^9, 
   3.7782182620912323`*^9}, {3.7784084205474634`*^9, 3.778408420658167*^9}, {
   3.7784084703582573`*^9, 3.7784084978327837`*^9}, {3.778409017841837*^9, 
   3.778409018710513*^9}, {3.7784618961458673`*^9, 3.778461908538726*^9}, {
   3.778462179081231*^9, 3.7784622099716225`*^9}, {3.7784626255697536`*^9, 
   3.7784626399792194`*^9}, {3.778462742745398*^9, 3.7784627760782585`*^9}, {
   3.7784629830451975`*^9, 3.7784629832885466`*^9}, {3.778463061607104*^9, 
   3.7784630703606944`*^9}, {3.778463310245186*^9, 3.778463368636035*^9}, {
   3.7784634256455784`*^9, 3.7784634287891717`*^9}, {3.778463484501184*^9, 
   3.7784635169264708`*^9}, {3.7784727032481384`*^9, 3.778472729484975*^9}, {
   3.778472997457353*^9, 3.778473012545005*^9}, {3.7787319890494795`*^9, 
   3.778732115317808*^9}, {3.7787321530907936`*^9, 3.778732168728973*^9}, {
   3.778732240348071*^9, 3.778732310970211*^9}, {3.7787323537862396`*^9, 
   3.7787323719726057`*^9}, {3.778732509643319*^9, 3.7787325322069793`*^9}, {
   3.7787326472357435`*^9, 3.778732699892926*^9}, {3.778732736875699*^9, 
   3.7787327771579742`*^9}, {3.778732867983936*^9, 3.7787328991426096`*^9}, {
   3.7787367835338254`*^9, 3.7787368338163576`*^9}, {3.7787512003554063`*^9, 
   3.778751200539914*^9}, {3.7787512530435066`*^9, 3.778751256806443*^9}, 
   3.778753088809078*^9, {3.7787531304397473`*^9, 3.778753165007306*^9}, {
   3.7787531980499415`*^9, 3.7787533011183124`*^9}, {3.778753340501991*^9, 
   3.778753420078185*^9}, {3.778753456365145*^9, 3.778753489271147*^9}, {
   3.7787535714892755`*^9, 3.7787535793831654`*^9}, {3.7787537953585186`*^9, 
   3.7787537961184864`*^9}, {3.7787540474443655`*^9, 3.778754056233859*^9}, {
   3.778842046507412*^9, 3.7788420524086304`*^9}, {3.7795134041846266`*^9, 
   3.779513418493362*^9}, {3.7795134555213404`*^9, 3.77951346343019*^9}, {
   3.779586767081542*^9, 3.77958677211907*^9}, {3.7795868888997707`*^9, 
   3.7795868958880825`*^9}, {3.779586990537966*^9, 3.7795869920967975`*^9}, 
   3.77966542134295*^9, 3.779686750813852*^9, {3.7796868485774093`*^9, 
   3.7796868501821175`*^9}, {3.7796870496616616`*^9, 
   3.7796873001388254`*^9}, {3.7796873331086564`*^9, 
   3.7796873334986134`*^9}, {3.779687365481085*^9, 3.779687368936843*^9}, {
   3.7798578400838623`*^9, 3.779857852790865*^9}, {3.7798580861596704`*^9, 
   3.779858087830202*^9}, {3.779858136789215*^9, 3.7798581758945923`*^9}, {
   3.779858653320281*^9, 3.7798586579349337`*^9}, 3.779858723408764*^9, {
   3.779858787654879*^9, 3.779858807510757*^9}, {3.7798589390019627`*^9, 
   3.7798590099052672`*^9}, {3.779859926931079*^9, 3.7798599776244535`*^9}, 
   3.7798600711651926`*^9, {3.7798605352366304`*^9, 3.779860536931097*^9}, {
   3.7800139276885023`*^9, 3.7800139368908825`*^9}, {3.7801834354284816`*^9, 
   3.7801834375827184`*^9}, {3.7801837148549*^9, 3.780183739943776*^9}, {
   3.780183793436661*^9, 3.780183797045007*^9}, {3.7801839885845594`*^9, 
   3.7801840176886935`*^9}, {3.7801840691220875`*^9, 3.780184127624569*^9}, 
   3.780184508303096*^9, {3.780184780875852*^9, 3.7801847829672556`*^9}, {
   3.780185263594378*^9, 3.7801852887789984`*^9}, {3.780185337050852*^9, 
   3.7801853946278095`*^9}, {3.780185461754218*^9, 3.780185535314414*^9}, {
   3.780185605622311*^9, 3.7801856368477697`*^9}, {3.780185878072394*^9, 
   3.780185881288789*^9}, {3.78021704900165*^9, 3.780217117314226*^9}, {
   3.780217177223153*^9, 3.7802172098797827`*^9}, {3.780307547120505*^9, 
   3.780307575789802*^9}, 3.7803772971917114`*^9, {3.7803776440856256`*^9, 
   3.7803776724946203`*^9}, {3.7803777165308046`*^9, 3.780377762248491*^9}, {
   3.7803778003665094`*^9, 3.7803778848514767`*^9}, {3.7803781457684155`*^9, 
   3.7803781802800827`*^9}, {3.780378214480582*^9, 3.780378214825659*^9}, {
   3.7803783340915728`*^9, 3.7803783506004047`*^9}, {3.7803784550519533`*^9, 
   3.780378512821396*^9}, {3.7803789772957344`*^9, 3.780379033185207*^9}, {
   3.7803790808117867`*^9, 3.7803791094032917`*^9}, {3.7803791488836656`*^9, 
   3.7803792194379034`*^9}, {3.780379262836794*^9, 3.780379332177279*^9}, {
   3.780379588063677*^9, 3.780379608833109*^9}, {3.7803797006384916`*^9, 
   3.78037975011213*^9}, {3.780379785415678*^9, 3.780379896021761*^9}, {
   3.7803799307937317`*^9, 3.7803799344230213`*^9}, 3.7803800393313484`*^9, {
   3.780380075290143*^9, 3.7803801204313717`*^9}, {3.7803802037873597`*^9, 
   3.78038020976038*^9}, {3.780380254048889*^9, 3.7803802602193813`*^9}, {
   3.7803803404956083`*^9, 3.7803803498396096`*^9}, {3.780380403978765*^9, 
   3.7803804226508093`*^9}, 3.780380512264056*^9, {3.780380587243456*^9, 
   3.780380592710828*^9}, {3.7803806520151644`*^9, 3.7803806926644106`*^9}, {
   3.7803807642917776`*^9, 3.780380782322538*^9}, {3.7803910599443564`*^9, 
   3.7803910606295233`*^9}, {3.780391385625025*^9, 3.7803913923530245`*^9}, {
   3.780805507471404*^9, 3.7808055519993477`*^9}, {3.780805617711647*^9, 
   3.7808056393916793`*^9}, {3.7808057666773467`*^9, 3.780805770383437*^9}, {
   3.780805802623235*^9, 3.7808058403543506`*^9}, {3.7808060032029305`*^9, 
   3.7808060313337154`*^9}, 3.7808062858023243`*^9, 3.780806333312293*^9, {
   3.780806471951603*^9, 3.7808065466718187`*^9}, {3.780806617515399*^9, 
   3.7808066259987164`*^9}, {3.7808066643042955`*^9, 
   3.7808066944476995`*^9}, {3.7808067274444733`*^9, 
   3.7808068066397233`*^9}, {3.7808070097197046`*^9, 3.780807037948228*^9}, {
   3.7808071228392487`*^9, 3.7808071603170414`*^9}, {3.7808072669589057`*^9, 
   3.7808072737836576`*^9}, {3.7808073847748923`*^9, 3.780807400848914*^9}, {
   3.7808074327117205`*^9, 3.7808075033588257`*^9}, {3.780807583620225*^9, 
   3.7808075866251907`*^9}, {3.7808881436432877`*^9, 
   3.7808881965996943`*^9}, {3.780889008386162*^9, 3.7808890818218117`*^9}, {
   3.7808893263739357`*^9, 3.780889328532164*^9}, {3.7808893732914877`*^9, 
   3.780889460752637*^9}, {3.7808896566887484`*^9, 3.780889658044124*^9}, 
   3.7808898222361126`*^9, {3.7808900421900053`*^9, 3.7808900816913877`*^9}, {
   3.780890136592594*^9, 3.780890152240755*^9}, {3.7808912486821203`*^9, 
   3.7808912667408347`*^9}, {3.7808984619531994`*^9, 
   3.7808984621626396`*^9}, {3.780898637864852*^9, 3.780898643532697*^9}, {
   3.7808986993534455`*^9, 3.7808987225893173`*^9}, 3.7809081369614305`*^9, {
   3.780908470692111*^9, 3.780908499541973*^9}, {3.781171630241144*^9, 
   3.781171686761962*^9}, {3.7812616496668844`*^9, 3.781261653513595*^9}, {
   3.7812616975607777`*^9, 3.781261732655905*^9}, {3.7812617709215517`*^9, 
   3.781261852897283*^9}, {3.781261897786214*^9, 3.781261963124447*^9}, {
   3.7812620012903605`*^9, 3.781262023380275*^9}, {3.781262338870401*^9, 
   3.7812623610031996`*^9}, {3.781262412522396*^9, 3.7812624245163145`*^9}, {
   3.781262467167232*^9, 3.7812624922631054`*^9}, {3.7813882096817513`*^9, 
   3.781388234905283*^9}, {3.7813883460011244`*^9, 3.781388362884963*^9}, {
   3.7813884231687155`*^9, 3.781388515281333*^9}, {3.781388627000506*^9, 
   3.7813886694100685`*^9}, {3.7813887791734734`*^9, 3.781388821142215*^9}, {
   3.781388949498887*^9, 3.7813889500414352`*^9}, {3.7813894234601336`*^9, 
   3.781389445317669*^9}, {3.781389531035391*^9, 3.7813895767431316`*^9}, {
   3.781389625302246*^9, 3.781389626678564*^9}, {3.781389898824627*^9, 
   3.781389899181672*^9}, {3.7813899429336443`*^9, 3.7813899431650248`*^9}, {
   3.7813899996010704`*^9, 3.7813902056429486`*^9}, {3.7813902400688667`*^9, 
   3.7813902799452047`*^9}, {3.7813903468642097`*^9, 
   3.7813904127888746`*^9}, {3.7813905797991543`*^9, 3.781390580009592*^9}, {
   3.7813907389514537`*^9, 3.781390754629518*^9}, 3.7814323137093983`*^9, {
   3.781432447568187*^9, 3.781432480314597*^9}, {3.7814325370638046`*^9, 
   3.781432553972577*^9}, {3.7814329234787846`*^9, 3.781433015876639*^9}, {
   3.7814330699360404`*^9, 3.781433079846532*^9}, {3.78143318215094*^9, 
   3.7814332974575176`*^9}, {3.7814746651317945`*^9, 
   3.7814746731284046`*^9}, {3.7814747317067194`*^9, 3.781474740391489*^9}, {
   3.781474790245141*^9, 3.781474791860819*^9}, {3.781474852993302*^9, 
   3.78147485661661*^9}, {3.7814789368774805`*^9, 3.7814790151790385`*^9}, {
   3.7815195152178645`*^9, 3.781519536740296*^9}, {3.7815753509638076`*^9, 
   3.781575382734825*^9}, {3.7815754892190013`*^9, 3.781575530411818*^9}, {
   3.7818490621280355`*^9, 3.7818490656625834`*^9}, {3.7818497878872747`*^9, 
   3.7818497933077803`*^9}, {3.781849826804207*^9, 3.7818498302140894`*^9}, {
   3.781850047564869*^9, 3.7818501131728587`*^9}, {3.7819354867682695`*^9, 
   3.7819354870894103`*^9}, {3.782018005485952*^9, 3.782018006480293*^9}, {
   3.782018067567938*^9, 3.7820181277240744`*^9}, {3.7820181838519816`*^9, 
   3.7820181915424166`*^9}, 3.782030301099427*^9, {3.7820303514597583`*^9, 
   3.7820303567246785`*^9}, 3.7820304729389095`*^9, {3.782030504506494*^9, 
   3.782030504644126*^9}, {3.7820305647244644`*^9, 3.782030615069836*^9}, {
   3.7820307407477584`*^9, 3.7820307411905746`*^9}, {3.782031214933955*^9, 
   3.7820312261140585`*^9}, {3.7820994312345915`*^9, 
   3.7820994672113843`*^9}, {3.7820995249479904`*^9, 3.782099526112875*^9}, {
   3.7821139161907015`*^9, 3.7821139664981737`*^9}, {3.7821198562922173`*^9, 
   3.7821199087978115`*^9}, {3.7821199903208103`*^9, 3.782120013167715*^9}, {
   3.782120075601761*^9, 3.7821201152078495`*^9}, {3.7821202599727316`*^9, 
   3.7821202909129934`*^9}, {3.782189261764991*^9, 3.782189262077156*^9}, {
   3.7821893601369333`*^9, 3.782189366537817*^9}, {3.7822645120762815`*^9, 
   3.782264573822166*^9}, {3.7822682271639805`*^9, 3.782268269466857*^9}, {
   3.7822683036833596`*^9, 3.782268405159999*^9}, {3.7822685152396345`*^9, 
   3.7822685333871064`*^9}, {3.782268567456002*^9, 3.782268710871493*^9}, {
   3.782268834501892*^9, 3.7822688752180123`*^9}, {3.7822689105704775`*^9, 
   3.782268912543201*^9}, {3.782268947672261*^9, 3.782269002931492*^9}, {
   3.782269035177264*^9, 3.782269039197513*^9}, {3.7822691357612915`*^9, 
   3.7822691462691917`*^9}, {3.782269275802805*^9, 3.7822693108381157`*^9}, {
   3.782269353924897*^9, 3.782269356762311*^9}, {3.782269636672798*^9, 
   3.7822696542647552`*^9}, {3.7822697067583823`*^9, 3.782269712725425*^9}, {
   3.782269773448047*^9, 3.7822698905130014`*^9}, {3.7822700187809997`*^9, 
   3.782270020997074*^9}, {3.7822705365300283`*^9, 3.782270542520009*^9}, 
   3.782270593495694*^9, {3.7822721845889363`*^9, 3.7822722698289948`*^9}, 
   3.7822724628937197`*^9, {3.782272934053785*^9, 3.782272983234271*^9}, {
   3.782273813874049*^9, 3.7822738683763037`*^9}, {3.78227392607202*^9, 
   3.7822739744656105`*^9}, {3.7822740080109067`*^9, 3.782274023960255*^9}, {
   3.7822745773630285`*^9, 3.782274616427565*^9}, {3.782274844336113*^9, 
   3.7822748447160974`*^9}, {3.782293779695088*^9, 3.7822937871132507`*^9}, 
   3.782358922883029*^9, {3.7823589802576017`*^9, 3.7823590413781595`*^9}, {
   3.7823590818289905`*^9, 3.78235913050007*^9}, {3.7823591871964574`*^9, 
   3.782359279635265*^9}, 3.782359322882618*^9, {3.7823593590698485`*^9, 
   3.7823593739869585`*^9}, {3.7823594398009644`*^9, 
   3.7823594676265554`*^9}, {3.7823595194619417`*^9, 
   3.7823596029437027`*^9}, {3.782359648785118*^9, 3.7823596506790533`*^9}, {
   3.7823598036729307`*^9, 3.78235982011596*^9}, {3.782359881382128*^9, 
   3.782359925222893*^9}, {3.7823599592618685`*^9, 3.7823600288976545`*^9}, {
   3.782360118515009*^9, 3.7823601666303434`*^9}, {3.7823603255094833`*^9, 
   3.7823603547443066`*^9}, 3.7823604220922093`*^9, {3.782360500632185*^9, 
   3.7823606173640327`*^9}, {3.782379873760433*^9, 3.7823798804186287`*^9}, {
   3.7823801163689203`*^9, 3.782380130584905*^9}, {3.782380198221039*^9, 
   3.782380225304614*^9}, {3.7823802570916123`*^9, 3.782380262223888*^9}, {
   3.782380293195068*^9, 3.7823803839553647`*^9}, {3.7823804587044773`*^9, 
   3.782380497910636*^9}, {3.782380570656107*^9, 3.7823805854345875`*^9}, {
   3.7823806164855547`*^9, 3.782380634491404*^9}, 3.782381677080407*^9, {
   3.782381766019573*^9, 3.782381793799288*^9}, {3.7823818563390493`*^9, 
   3.7823819071033*^9}, {3.7823819425285687`*^9, 3.7823819619406586`*^9}, 
   3.782382096817983*^9, {3.7823821650315714`*^9, 3.782382184572318*^9}, {
   3.7823822501310062`*^9, 3.7823822504571342`*^9}, {3.782382335016014*^9, 
   3.7823823355964622`*^9}, {3.7823824181457167`*^9, 
   3.7823824788214626`*^9}, {3.7824714989468403`*^9, 3.782471558602315*^9}, {
   3.782471589052887*^9, 3.7824716030793786`*^9}, {3.782471644718032*^9, 
   3.782471644817765*^9}, {3.782471697755205*^9, 3.7824717080716176`*^9}, {
   3.7824717849639997`*^9, 3.7824717880567293`*^9}, {3.782471938011733*^9, 
   3.7824719748681746`*^9}, {3.7824721110420303`*^9, 3.782472142266533*^9}, {
   3.7824722354722905`*^9, 3.7824722620771456`*^9}, {3.7824723115518456`*^9, 
   3.7824724027918596`*^9}, {3.782472433304266*^9, 3.782472471388425*^9}, {
   3.782472567635051*^9, 3.782472630287511*^9}, {3.78247284052232*^9, 
   3.78247284452761*^9}, {3.7825140890105352`*^9, 3.782514100629465*^9}, {
   3.7825534201858616`*^9, 3.7825534451899977`*^9}, {3.7825535514249134`*^9, 
   3.7825535837594476`*^9}, {3.7825537796306667`*^9, 
   3.7825538393928556`*^9}, {3.7825538722559757`*^9, 3.782553905841166*^9}, {
   3.7825541602827606`*^9, 3.782554204573323*^9}, {3.7825542449872513`*^9, 
   3.782554275844735*^9}, {3.782554400998063*^9, 3.782554489173271*^9}, {
   3.7825546215054007`*^9, 3.7825546566145153`*^9}, {3.782554869814396*^9, 
   3.78255491613852*^9}, {3.7825549676597457`*^9, 3.782554985141*^9}, {
   3.7825550347283964`*^9, 3.7825550415232267`*^9}, {3.782555174812796*^9, 
   3.7825551998219194`*^9}, {3.7825555284611015`*^9, 3.782555530233362*^9}, {
   3.7825555953512297`*^9, 3.782555649585202*^9}, {3.782598368859758*^9, 
   3.782598372059203*^9}, {3.782598547726449*^9, 3.782598635290294*^9}, {
   3.782598667730545*^9, 3.782598677841508*^9}, {3.782598753792406*^9, 
   3.7825989182725687`*^9}, {3.7825989624713755`*^9, 3.782598966265231*^9}, {
   3.7825993184165397`*^9, 3.782599329921773*^9}, {3.782599378909774*^9, 
   3.7825993790424194`*^9}, {3.7825997132646723`*^9, 
   3.7825997428106627`*^9}, {3.782600307968369*^9, 3.78260032393966*^9}, {
   3.7826003807268047`*^9, 3.7826003980833917`*^9}, {3.7826004388094854`*^9, 
   3.7826004417406473`*^9}, {3.7826029154440737`*^9, 3.782602996864349*^9}, {
   3.7826030301383696`*^9, 3.782603041742339*^9}, {3.7826031362775416`*^9, 
   3.782603141132559*^9}, {3.7826037072088084`*^9, 3.7826037123570414`*^9}, {
   3.782605737821727*^9, 3.782605740778819*^9}, {3.7826057717111025`*^9, 
   3.782605809836152*^9}, {3.7826181074285693`*^9, 3.7826181091200457`*^9}, {
   3.7826181416640196`*^9, 3.7826181504724646`*^9}, {3.7827056778111115`*^9, 
   3.7827057002620754`*^9}, {3.782706168007274*^9, 3.7827061822242556`*^9}, {
   3.7831516305443363`*^9, 3.7831516559553847`*^9}, {3.7831604974426975`*^9, 
   3.7831605091264534`*^9}, {3.7833397650940323`*^9, 3.783339780269451*^9}, {
   3.78333981607271*^9, 3.7833398610364723`*^9}, {3.7833399961521573`*^9, 
   3.7833400236595993`*^9}, {3.7834064017623835`*^9, 
   3.7834064183540154`*^9}, {3.783406513638215*^9, 3.7834065171398516`*^9}, {
   3.7834067211951847`*^9, 3.7834067315903873`*^9}, {3.7834084346691675`*^9, 
   3.783408492150456*^9}, {3.7834090220999384`*^9, 3.783409166232438*^9}, {
   3.783409233053443*^9, 3.7834093302764482`*^9}, {3.7834094192958145`*^9, 
   3.7834094712016506`*^9}, {3.7834121027182474`*^9, 
   3.7834121028229675`*^9}, {3.7834121541387434`*^9, 3.783412198650614*^9}, {
   3.7834123333824177`*^9, 3.783412333724101*^9}, {3.783412364613903*^9, 
   3.783412373905274*^9}, {3.7834160035000134`*^9, 3.7834160863211813`*^9}, {
   3.78341627883186*^9, 3.78341628093324*^9}, {3.783416570573597*^9, 
   3.7834165851127176`*^9}, {3.783416677068817*^9, 3.7834166811110077`*^9}, {
   3.7834167245009785`*^9, 3.7834167248400717`*^9}, {3.7834196165584736`*^9, 
   3.7834196168088045`*^9}, {3.7834198846670747`*^9, 3.783419888223564*^9}, {
   3.783420001354041*^9, 3.7834200015076303`*^9}, {3.783421758582719*^9, 
   3.783421758828063*^9}, 3.7834224150341306`*^9, {3.783422451806223*^9, 
   3.783422454119038*^9}, {3.783422496355094*^9, 3.7834225134623475`*^9}, {
   3.7834225644041233`*^9, 3.783422586432218*^9}, {3.7834859244900584`*^9, 
   3.783485927372351*^9}, {3.7834914817148495`*^9, 3.78349148186445*^9}, {
   3.7834916068342667`*^9, 3.7834916141167927`*^9}, {3.7834916444736147`*^9, 
   3.7834916505304184`*^9}, {3.783505337627492*^9, 3.7835053636179905`*^9}, {
   3.7835063164091225`*^9, 3.7835063217269025`*^9}, {3.783506366562008*^9, 
   3.7835063669878693`*^9}, {3.7835064038891916`*^9, 
   3.7835064092438726`*^9}, {3.783507580080925*^9, 3.7835075890349817`*^9}, {
   3.783567752426464*^9, 3.78356776892335*^9}, {3.7838198677227516`*^9, 
   3.783819868135648*^9}, {3.7838199990066833`*^9, 3.7838200004468327`*^9}, {
   3.7838452992914524`*^9, 3.7838453013599186`*^9}, {3.783845520771189*^9, 
   3.7838455209457226`*^9}, {3.7838455513145137`*^9, 
   3.7838456017296977`*^9}, {3.783845741683446*^9, 3.7838457418011312`*^9}, {
   3.7838460446133785`*^9, 3.7838461319647903`*^9}, {3.783846524934945*^9, 
   3.7838465487362976`*^9}, {3.7840944316814485`*^9, 
   3.7840944549312754`*^9}, {3.7840945772432003`*^9, 3.784094613317733*^9}, {
   3.7840947482798295`*^9, 3.7840947800468807`*^9}, {3.7841061330948524`*^9, 
   3.7841061600058904`*^9}, 3.784106310079576*^9, {3.784106370147947*^9, 
   3.784106427973316*^9}, {3.784106602466701*^9, 3.7841066108951626`*^9}, {
   3.7841067205409575`*^9, 3.784106724462471*^9}, {3.784106786580361*^9, 
   3.7841068375390916`*^9}, {3.784106949505681*^9, 3.7841070118599386`*^9}, {
   3.784107091319456*^9, 3.784107097403187*^9}, {3.784107163138403*^9, 
   3.7841071739135895`*^9}, {3.784107244545711*^9, 3.784107247473881*^9}, {
   3.784107394647323*^9, 3.7841075141168485`*^9}, 3.784107571265028*^9, {
   3.784109295486271*^9, 3.7841093051913185`*^9}, {3.7841093450357704`*^9, 
   3.7841094507091875`*^9}, {3.7841094855360565`*^9, 
   3.7841095132290025`*^9}, {3.7841097306696215`*^9, 
   3.7841097315382986`*^9}, {3.7841097658944273`*^9, 3.784109766456922*^9}, {
   3.7841099643517303`*^9, 3.7841099906713486`*^9}, 3.784110052960779*^9, {
   3.7841101041229672`*^9, 3.784110193278554*^9}, 3.7841105037283773`*^9, 
   3.78411053435448*^9, {3.784156750499432*^9, 3.784156766767928*^9}, {
   3.7841579800125785`*^9, 3.7841579882475567`*^9}, {3.784158499455531*^9, 
   3.7841585116229935`*^9}, {3.784169043363319*^9, 3.784169065043344*^9}, {
   3.7841691065782747`*^9, 3.784169182057435*^9}, {3.78416922219211*^9, 
   3.784169278015832*^9}, {3.7841693791533794`*^9, 3.7841694058370256`*^9}, {
   3.784169439570816*^9, 3.7841694786303663`*^9}, 3.7841698318587947`*^9, {
   3.7841699179226513`*^9, 3.7841700234883566`*^9}, {3.7841700664295273`*^9, 
   3.7841700925566607`*^9}, {3.7841701289702864`*^9, 3.784170159936479*^9}, {
   3.784170481181435*^9, 3.784170487953327*^9}, {3.7843292013711452`*^9, 
   3.7843292095512705`*^9}, {3.7843726718828964`*^9, 3.784372681443331*^9}, {
   3.784415621030654*^9, 3.7844156256931844`*^9}, {3.7844157476152844`*^9, 
   3.7844157513143926`*^9}, {3.7844271742190447`*^9, 
   3.7844271781265955`*^9}, {3.784455234188792*^9, 3.7844552379607058`*^9}, {
   3.7845219705251226`*^9, 3.78452198693923*^9}, {3.7846311999160852`*^9, 
   3.784631206265108*^9}, {3.784695822825816*^9, 3.784695826250658*^9}, {
   3.7847065487146115`*^9, 3.784706619369673*^9}, {3.7847066533956833`*^9, 
   3.7847066568693943`*^9}, {3.7847067221907177`*^9, 3.784706754309828*^9}, 
   3.784711827792777*^9, {3.784711875900132*^9, 3.7847119388827105`*^9}, {
   3.784711974354854*^9, 3.7847119772949915`*^9}, {3.7851073445114565`*^9, 
   3.7851073469549227`*^9}, 3.78511929728771*^9, {3.7851196155400033`*^9, 
   3.7851197811790667`*^9}, {3.785119841183607*^9, 3.7851199259210105`*^9}, {
   3.785119989156911*^9, 3.7851199949723587`*^9}, {3.785120043937422*^9, 
   3.785120044499918*^9}, {3.7851201871005874`*^9, 3.7851202044102993`*^9}, {
   3.7851202543896503`*^9, 3.78512028257129*^9}, {3.7851204420468335`*^9, 
   3.7851205588664455`*^9}, {3.785120678639161*^9, 3.7851206788107014`*^9}, {
   3.7851208657158966`*^9, 3.78512087939332*^9}, {3.7851209921049175`*^9, 
   3.7851210271591787`*^9}, {3.7851222867718363`*^9, 
   3.7851222960350657`*^9}, {3.7851223275717325`*^9, 3.785122328583029*^9}, {
   3.785122409352043*^9, 3.78512241286864*^9}, {3.785125039228465*^9, 
   3.785125044422575*^9}, {3.7851255420408897`*^9, 3.785125549582721*^9}, {
   3.7851255810445895`*^9, 3.7851256511600924`*^9}, {3.785125760574506*^9, 
   3.7851258359379764`*^9}, {3.785125939575837*^9, 3.7851259396536293`*^9}, {
   3.785127351947002*^9, 3.7851273569256873`*^9}, {3.785127407458557*^9, 
   3.7851274414177465`*^9}, {3.7851280686195416`*^9, 3.785128083766037*^9}, {
   3.7851282013540897`*^9, 3.7851282198157225`*^9}, {3.7851282810928593`*^9, 
   3.7851283360239673`*^9}, {3.785128781534622*^9, 3.785128812160725*^9}, {
   3.785128882849696*^9, 3.7851288833453703`*^9}, {3.785129524587617*^9, 
   3.785129729731042*^9}, {3.7851305531501284`*^9, 3.785130562522067*^9}, {
   3.7851306511650257`*^9, 3.7851306733975744`*^9}, 3.785130816266526*^9, {
   3.785131008020754*^9, 3.785131056731498*^9}, {3.7851314389783263`*^9, 
   3.785131485839017*^9}, {3.7851315608554134`*^9, 3.785131571105005*^9}, {
   3.785131606571164*^9, 3.7851316319971733`*^9}, {3.7851323773520126`*^9, 
   3.7851324632509584`*^9}, {3.785132652463982*^9, 3.7851326726011353`*^9}, {
   3.785132745962956*^9, 3.78513274611854*^9}, {3.785134208949768*^9, 
   3.785134212889233*^9}, {3.7851342575158978`*^9, 3.785134304584032*^9}, {
   3.785134348998265*^9, 3.785134354901477*^9}, {3.7851972513783035`*^9, 
   3.785197263456006*^9}, {3.78519855873429*^9, 3.7851985751743274`*^9}, {
   3.7851986216560297`*^9, 3.7851986486957226`*^9}, {3.7852021928522587`*^9, 
   3.785202202113495*^9}, {3.7852024675097957`*^9, 3.785202474002434*^9}, {
   3.7852025377130632`*^9, 3.78520254211928*^9}, {3.7852026633052177`*^9, 
   3.7852026704730487`*^9}, {3.7852029965720243`*^9, 3.785203112359396*^9}, {
   3.7852031532809677`*^9, 3.7852031587573233`*^9}, {3.785203257602001*^9, 
   3.7852032589035215`*^9}, {3.7852035576955185`*^9, 
   3.7852036493913136`*^9}, {3.7852038271828794`*^9, 3.785203837203086*^9}, {
   3.7852038891960506`*^9, 3.7852038919756165`*^9}, {3.7852039503884153`*^9, 
   3.785203988714926*^9}, {3.785204027124216*^9, 3.7852040609876595`*^9}, {
   3.7852041193196735`*^9, 3.7852041354465485`*^9}, {3.7852042791163597`*^9, 
   3.7852043353130836`*^9}, {3.7852048347206125`*^9, 3.785204841794696*^9}, {
   3.7852049246980033`*^9, 3.78520504381946*^9}, 3.7852050800625415`*^9, {
   3.7852051135699396`*^9, 3.78520513102227*^9}, 3.7852051633528147`*^9, {
   3.7852052601340113`*^9, 3.785205309189831*^9}, {3.7852053555348997`*^9, 
   3.7852054292906675`*^9}, {3.7852054774249516`*^9, 
   3.7852054854135895`*^9}, {3.7852055182098894`*^9, 3.785205576184857*^9}, 
   3.7852056240977316`*^9, {3.785205820818681*^9, 3.785205896675828*^9}, {
   3.785205965464878*^9, 3.7852059707736826`*^9}, {3.7852071841410046`*^9, 
   3.7852072154373155`*^9}, {3.785207817267954*^9, 3.7852078647110853`*^9}, {
   3.7853004938176565`*^9, 3.7853005274357586`*^9}, {3.785300603991041*^9, 
   3.7853006078447375`*^9}, {3.7853010258738804`*^9, 
   3.7853010561319666`*^9}, {3.785301337768839*^9, 3.785301396976511*^9}, {
   3.785301483228863*^9, 3.7853015290732713`*^9}, {3.7853016766316824`*^9, 
   3.7853016985680227`*^9}, 3.785301939541147*^9, 3.7853020091589804`*^9, {
   3.7853026274835124`*^9, 3.7853026309332876`*^9}, {3.7855741334214687`*^9, 
   3.7855741655355916`*^9}, {3.7855750163962965`*^9, 
   3.7855750678118057`*^9}, {3.785577379074295*^9, 3.785577379377484*^9}, {
   3.785579003227131*^9, 3.785579006929231*^9}, {3.7855790901257553`*^9, 
   3.7855791040445347`*^9}, {3.7855792043882046`*^9, 3.7855792633505325`*^9}, 
   3.785579296778144*^9, {3.7855794779706163`*^9, 3.7855794781980076`*^9}, {
   3.7855795212099886`*^9, 3.7855795220786653`*^9}, {3.785579649976652*^9, 
   3.7855796959816303`*^9}, {3.785579739052454*^9, 3.7855797434536843`*^9}, {
   3.785579998951455*^9, 3.785580026601516*^9}, {3.785580392209839*^9, 
   3.785580414600963*^9}, {3.7855804539437556`*^9, 3.7855804692986946`*^9}, 
   3.785580522075564*^9, {3.785638686319376*^9, 3.78563868699457*^9}, {
   3.785638867602605*^9, 3.785638891780949*^9}, {3.785638929130073*^9, 
   3.78563892998379*^9}, {3.7856417475270834`*^9, 3.785641790584942*^9}, 
   3.785641827392514*^9, {3.785743903911502*^9, 3.7857439138239946`*^9}, {
   3.785744301713735*^9, 3.785744334516019*^9}, {3.7857446336141973`*^9, 
   3.7857446337488375`*^9}, {3.7857448487040243`*^9, 
   3.7857448653505087`*^9}, {3.7859222472788935`*^9, 3.785922255202715*^9}, {
   3.785988741636729*^9, 3.7859887463321795`*^9}, {3.7860082625852127`*^9, 
   3.786008266201547*^9}, {3.7860138102187843`*^9, 3.7860138144534664`*^9}, {
   3.7860143494186387`*^9, 3.7860143521024656`*^9}, {3.7860612826769075`*^9, 
   3.7860612889760714`*^9}, {3.786061563364881*^9, 3.786061566776762*^9}, {
   3.7860625241921787`*^9, 3.786062527369686*^9}, {3.786165471119266*^9, 
   3.786165480068347*^9}, {3.786177977196444*^9, 3.786177997757489*^9}, {
   3.7861788585926933`*^9, 3.7861789196136003`*^9}, {3.786179784901902*^9, 
   3.786179812463238*^9}, {3.7861804791722927`*^9, 3.7861804846406765`*^9}, {
   3.786180659782566*^9, 3.78618066156979*^9}, {3.7861843361685123`*^9, 
   3.7861843381502156`*^9}, {3.786184427197215*^9, 3.786184432675573*^9}, {
   3.786184487157955*^9, 3.7861845046312532`*^9}, {3.7861850139050922`*^9, 
   3.786185058117923*^9}, {3.7861853192818975`*^9, 3.7861853225591383`*^9}, {
   3.786186287646701*^9, 3.7861863099451036`*^9}, {3.786186392831569*^9, 
   3.78618642132641*^9}, {3.786186474976018*^9, 3.786186511079522*^9}, {
   3.786186587396546*^9, 3.786186614828228*^9}, {3.786186785386369*^9, 
   3.7861867875735235`*^9}, {3.786224225058548*^9, 3.786224304930071*^9}, 
   3.7862243597056704`*^9, {3.7862243914069405`*^9, 3.78622440486896*^9}, {
   3.786224552453503*^9, 3.7862245563720303`*^9}, {3.7862246115016823`*^9, 
   3.78622473347069*^9}, {3.7862247795944133`*^9, 3.7862247909959393`*^9}, {
   3.7862249655005326`*^9, 3.786225023968263*^9}, {3.786225506679098*^9, 
   3.786225506981291*^9}, {3.786230899818508*^9, 3.7862309054674106`*^9}, {
   3.7862309438019514`*^9, 3.7862309477873*^9}, {3.7862320390127287`*^9, 
   3.7862320401816053`*^9}, {3.786232612866961*^9, 3.786232816162603*^9}, {
   3.7862328632437673`*^9, 3.786232864366766*^9}, 3.7863176954100103`*^9, {
   3.786317737206299*^9, 3.7863178459715967`*^9}, 3.7863180081152277`*^9, 
   3.786318069707607*^9, {3.786319933473379*^9, 3.7863199414460707`*^9}, {
   3.78632012759155*^9, 3.7863201407214575`*^9}, {3.7863205420936904`*^9, 
   3.7863205491019588`*^9}, {3.786320616304344*^9, 3.7863206546877546`*^9}, {
   3.7863291014011326`*^9, 3.7863291533103924`*^9}, {3.786329242840102*^9, 
   3.7863293268306165`*^9}, {3.786329584875926*^9, 3.786329594015498*^9}, {
   3.786329924065358*^9, 3.7863299276248446`*^9}, {3.7863301148245068`*^9, 
   3.786330162701544*^9}, {3.786330197396812*^9, 3.7863302330086308`*^9}, {
   3.786335826828849*^9, 3.786335931032339*^9}, {3.786335963794775*^9, 
   3.7863359972633204`*^9}, 3.78633605894147*^9, {3.7863363382549353`*^9, 
   3.786336345943386*^9}, {3.786444595601116*^9, 3.786444613528201*^9}, {
   3.7864449475464554`*^9, 3.78644501541107*^9}, {3.786445051395891*^9, 
   3.7864450592199793`*^9}, {3.7864451187139673`*^9, 
   3.7864451207415476`*^9}, {3.786595703119054*^9, 3.786595718266569*^9}, {
   3.786595759775625*^9, 3.7865957928951054`*^9}, {3.786595860783656*^9, 
   3.7865958614778013`*^9}, {3.7865959729985332`*^9, 
   3.7865960534365425`*^9}, {3.786596102147352*^9, 3.7865962715196614`*^9}, 
   3.786596324730442*^9, {3.786596357440018*^9, 3.7865963630719657`*^9}, {
   3.7865964402816033`*^9, 3.7865964446898212`*^9}, 3.7865965850217495`*^9, {
   3.786596641249467*^9, 3.7865967594365835`*^9}, {3.786596980066893*^9, 
   3.7865971625661187`*^9}, 3.786597203267335*^9, {3.7865972416417694`*^9, 
   3.78659724175746*^9}, 3.7865984561836047`*^9, {3.7865997725682397`*^9, 
   3.786599772653013*^9}, {3.78661032624697*^9, 3.7866103373492966`*^9}, {
   3.786611334384473*^9, 3.7866113477377825`*^9}, {3.7866113872122774`*^9, 
   3.7866113873329554`*^9}, {3.7866114608933463`*^9, 
   3.7866114837642183`*^9}, {3.7866118520758142`*^9, 
   3.7866118688958583`*^9}, {3.786661007857752*^9, 3.7866610244653645`*^9}, {
   3.7866614534547844`*^9, 3.786661489876438*^9}, {3.7866615316687374`*^9, 
   3.7866615409618998`*^9}, {3.7866617645483093`*^9, 
   3.7866617646400642`*^9}, {3.786661869516755*^9, 3.786661892089424*^9}, {
   3.786661951905551*^9, 3.7866619528799467`*^9}, {3.7866620091176367`*^9, 
   3.7866620094856534`*^9}, {3.7866627360587063`*^9, 
   3.7866627361724024`*^9}, {3.7866759322821827`*^9, 3.78667594168904*^9}, {
   3.786677384944287*^9, 3.786677395182922*^9}, {3.7866807362471347`*^9, 
   3.7866807821225214`*^9}, {3.7866810167953*^9, 3.7866811206796436`*^9}, {
   3.786681182673949*^9, 3.7866812234479694`*^9}, {3.786681258208065*^9, 
   3.7866812621465387`*^9}, {3.7866814989077363`*^9, 
   3.7866815952572165`*^9}, {3.7866816510441127`*^9, 3.786681675220496*^9}, {
   3.786682042696325*^9, 3.786682056657012*^9}, {3.7866996462577496`*^9, 
   3.786699776990334*^9}, {3.7867005532655463`*^9, 3.786700568346239*^9}, {
   3.7867007273103676`*^9, 3.7867007351434317`*^9}, {3.7867635919658136`*^9, 
   3.7867635972317395`*^9}, {3.786861501388754*^9, 3.7868615137178016`*^9}, {
   3.7868619932553663`*^9, 3.786862017456682*^9}, {3.786960132628612*^9, 
   3.786960155854536*^9}, {3.787284245243659*^9, 3.787284260597622*^9}, {
   3.7872952788883295`*^9, 3.787295310990528*^9}, {3.787567882622756*^9, 
   3.7875679270849185`*^9}, {3.7879966061007347`*^9, 
   3.7879966067140956`*^9}, {3.800597410189348*^9, 3.800597425705826*^9}, {
   3.8005974766714396`*^9, 3.8005975096432066`*^9}, {3.8048370254904704`*^9, 
   3.8048370461701717`*^9}, {3.804837201971548*^9, 3.8048372290820527`*^9}, {
   3.804838704437671*^9, 3.8048387200579014`*^9}, {3.804907478092116*^9, 
   3.8049074938729167`*^9}, {3.8050874708907166`*^9, 3.8050874721333942`*^9}, 
   3.805087655841147*^9, {3.8050877688349943`*^9, 3.805087779862506*^9}, {
   3.805087912808*^9, 3.805087956627824*^9}, 3.8050880419546537`*^9, {
   3.805088136602826*^9, 3.805088137667978*^9}, {3.8050881686740656`*^9, 
   3.8050881888929987`*^9}, {3.8050886565025787`*^9, 3.805088656915475*^9}},
 CellLabel->
  "In[5517]:=",ExpressionUUID->"179a6a3b-3b7f-46af-af4e-c287d4099074"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["QRM-experiment-used",
 FontSlant->"Plain"]], "Subsubsection",
 CellChangeTimes->{{3.805088206627576*^9, 
  3.8050882172062874`*^9}},ExpressionUUID->"1b1fe7cb-ab6e-4016-acf4-\
1e51fc906df9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "QRMSpinPopulation", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QRMSpinPopulation", "[", 
    RowBox[{"data_", ",", "repeats_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Data", ",", "l"}], "}"}], ",", 
     RowBox[{
      RowBox[{"l", "=", 
       RowBox[{"Length", "@", "data"}]}], ";", 
      RowBox[{"Data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Mean", "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "repeats"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "l"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "@", 
             RowBox[{"Data", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"StandardDeviation", "@", 
           RowBox[{"Data", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpinPopulationVariation", "[", 
     RowBox[{"data_List", ",", 
      RowBox[{"sidebandRabi_", "?", "NumberQ"}], ",", 
      RowBox[{"background_", "?", "NumberQ"}], ",", 
      RowBox[{"repeats_Integer:", " ", "500"}], ",", 
      RowBox[{"theoreticaldata__:", "Null"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", ",", "Data", ",", "graph1", ",", "Graph"}], "}"}], ",", 
      RowBox[{
       RowBox[{"l", "=", 
        RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Data", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Mean", "/@", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"ToExpression", "@", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], ",", "repeats"}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "l"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graph1", "=", 
        RowBox[{"ErrorListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Mean", "@", 
                   RowBox[{"Data", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "-", 
                 "background"}]}], "}"}], ",", 
              RowBox[{"ErrorBar", "@", 
               RowBox[{"(", 
                RowBox[{"StandardDeviation", "@", 
                 RowBox[{"Data", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"\"\<the ultimate sideband rabi is \>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"(", 
                RowBox[{"1000", "*", "sidebandRabi"}], ")"}]}], "<>", 
              "\"\<kHz\>\""}], ",", "Top"}], "]"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<t(us)\>\"", ",", "\"\<Spin up population\>\""}], 
            "}"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "12"}], "]"}]}], ",", "opts"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"theoreticaldata", "===", "Null"}], ",", 
         RowBox[{"Graph", "=", "graph1"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "@", 
            RowBox[{"(", 
             RowBox[{"First", "@", 
              RowBox[{"{", "theoreticaldata", "}"}]}], ")"}]}], ",", 
           RowBox[{"Graph", "=", 
            RowBox[{"Show", "[", 
             RowBox[{"graph1", ",", 
              RowBox[{"ListLinePlot", "[", 
               RowBox[{
                RowBox[{"{", "theoreticaldata", "}"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Thickness", "[", "0.004", "]"}], "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}]}], 
           ",", 
           RowBox[{"Graph", "=", 
            RowBox[{"Show", "[", 
             RowBox[{"graph1", ",", 
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"{", "theoreticaldata", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "2000"}], "}"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Thickness", "[", "0.004", "]"}], "}"}]}], ",", 
                RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "]"}]}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<Spin population variation data \>\"", "<>", 
          RowBox[{"ToString", "@", "repeats"}], "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
             "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.csv\>\""}], ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"Data", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ultimate sideband Rabi rate:\>\"", ",", "sidebandRabi"}], 
            "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<Spin population variation \>\"", "<>", 
          RowBox[{"ToString", "@", "repeats"}], "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
             "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.png\>\""}], ",", "Graph", ",", 
         RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}], ";", 
       "Graph"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpinPopulationVariation", "[", 
     RowBox[{"data_List", ",", "background_", ",", 
      RowBox[{"theoreticaldata__:", "Null"}], ",", 
      RowBox[{"symbol", ":", 
       RowBox[{"(", 
        RowBox[{"\"\<95% confidence level\>\"", "|", "\"\<One SD\>\""}], 
        ")"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"graph", ",", "Graph"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"graph", "=", 
        RowBox[{"ErrorListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"(*", 
                RowBox[{"Mean", "@"}], "*)"}], 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Mean", "@", 
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "-", 
                 "background"}]}], "}"}], ",", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"symbol", "\[Equal]", "\"\<One SD\>\""}], ",", 
                RowBox[{"ErrorBar", "[", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"StandardDeviation", "@", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ","}], "*)"}], 
                 RowBox[{"StandardDeviation", "@", 
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{
                "symbol", "\[Equal]", "\"\<95% confidence level\>\""}], ",", 
                RowBox[{"ErrorBar", "[", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"1.96", " ", 
                    RowBox[{
                    RowBox[{"StandardDeviation", "@", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], ","}],
                   "*)"}], 
                 RowBox[{"1.96", " ", 
                  RowBox[{
                   RowBox[{"StandardDeviation", "@", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "/", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"data", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], 
                 "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<P(\[UpArrow])\>\"", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \
\(SB\)]\)/\!\(\*SubsuperscriptBox[\(\[CapitalOmega]\), \(SB\), \(c\)]\)\>\"", 
               ",", "\"\<t(\[Mu]s)\>\""}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], ",", "opts"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "theoreticaldata", "}"}], "===", 
          RowBox[{"{", "Null", "}"}]}], ",", 
         RowBox[{"Graph", "=", "graph"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "@", 
            RowBox[{
             RowBox[{"{", "theoreticaldata", "}"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"Graph", "=", 
            RowBox[{"Show", "[", 
             RowBox[{"graph", ",", 
              RowBox[{"ListLinePlot", "[", 
               RowBox[{
                RowBox[{"{", "theoreticaldata", "}"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Blue", ",", 
                    RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.004", "]"}]}], "]"}], 
                  "}"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
               RowBox[{"(*", 
                RowBox[{",", 
                 RowBox[{"PlotLegends", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<no decoherence\>\"", ",", 
                    "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(d\)]\)=5.5ms\>\""}],
                    "}"}]}]}], "*)"}], "]"}], ",", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}], 
               "]"}]}], "]"}]}], ",", 
           RowBox[{"Graph", "=", 
            RowBox[{"Show", "[", 
             RowBox[{"graph", ",", 
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"{", "theoreticaldata", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "2000"}], "}"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{
                   RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
                   RowBox[{"Thickness", "[", "0.004", "]"}]}], "]"}]}], ",", 
                RowBox[{"PlotRange", "->", "All"}]}], "]"}], ",", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "0.1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}], 
               "]"}]}], "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<Spin population variation \>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.svg\>\""}], ",", "Graph"}], "]"}], ";", 
       "Graph"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QRModelFullCalibrate", "[", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"symbol", "=", "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CtrlSignalValue", "[", 
      RowBox[{
       RowBox[{"sequencer", "@", "\"\<Repeats\>\""}], ",", "200"}], "]"}], 
     ";", 
     RowBox[{"CtrlSignalValue", "[", 
      RowBox[{
       RowBox[{"sequencer", "@", "\"\<Trigger\>\""}], ",", "False"}], "]"}], 
     ";", 
     RowBox[{"CtrlSignalValue", "[", 
      RowBox[{
       RowBox[{"sequencer", "@", "\"\<Count or State\>\""}], ",", "1"}], 
      "]"}], ";", 
     RowBox[{"QRMCalibrate", "=", 
      RowBox[{
      "NotebookOpen", "[", 
       "\"\<E:\\\\member\\\\cml_maverick\\\\QRM full calibrate.nb\>\"", 
       "]"}]}], ";", "\n", 
     RowBox[{"openCloseTaggedCell", "[", 
      RowBox[{
      "QRMCalibrate", ",", "\"\<QRM full calibrate\>\"", ",", "Open"}], "]"}],
      ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cells", "[", 
         RowBox[{"QRMCalibrate", ",", 
          RowBox[{"CellTags", "\[Rule]", "\"\<QRM full calibrate\>\""}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "All", ",", "Cell"}], "]"}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"FrontEndTokenExecute", "[", 
       RowBox[{"QRMCalibrate", ",", "\"\<Evaluate\>\""}], "]"}], ";"}], 
     "*)"}], ")"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"QRMFullCalibrate", "[", 
      RowBox[{"data_List", ",", 
       RowBox[{"symbol_:", "True"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "l", ",", "DataForCarr", ",", "DataForRed", ",", "DataForBlue", ",", 
         "DataForRedPi", ",", "DataForBluePi", ",", "nlm1", ",", "nlm2", ",", 
         "nlm3", ",", "nlm4", ",", "x", ",", "k", ",", "BaseFreq", ",", "a", 
         ",", "b", ",", "a0", ",", "b0"}], "}"}], ",", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{"Length", "@", "data"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DataForCarr", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"l", "+", "1", "-", "i"}], ",", "1"}], "]"}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"l", "+", "1", "-", "i"}], ",", "2"}], "]"}], 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"l", "+", "1", "-", "i"}], ",", "2"}], "]"}], 
                  "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForRed", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"l", "+", "1", "-", "i"}], ",", "1"}], "]"}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"l", "+", "1", "-", "i"}], ",", "2"}], "]"}], "]"}], 
              "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForBlue", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"l", "+", "1", "-", "i"}], ",", "1"}], "]"}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"l", "+", "1", "-", "i"}], ",", "2"}], "]"}], "]"}], 
              "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForRedPi", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"l", "+", "1", "-", "i"}], ",", "1"}], "]"}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"l", "+", "1", "-", "i"}], ",", "3"}], "]"}], "]"}], 
              "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"DataForBluePi", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"l", "+", "1", "-", "i"}], ",", "1"}], "]"}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"l", "+", "1", "-", "i"}], ",", "3"}], "]"}], "]"}], 
              "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nlm1", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"DataForRedPi", "+", "DataForBluePi"}], ")"}], "/", 
            "2"}], ",", 
           RowBox[{"a", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"b", " ", "x"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{"DataForRedPi", ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
             RowBox[{"ListPlot", "[", 
              RowBox[{"DataForBluePi", ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"nlm1", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a0", ",", "b0"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "/.", 
          RowBox[{"nlm1", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nlm2", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{"DataForCarr", ",", 
           RowBox[{"BaseFreq", "+", 
            RowBox[{"k", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Sin", "[", 
                RowBox[{"b", " ", "x"}], "]"}], ")"}], "^", "2"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "k", ",", 
             RowBox[{"{", 
              RowBox[{"BaseFreq", ",", 
               RowBox[{"DataForCarr", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], ",",
            "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{"DataForCarr", ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Orange"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"nlm2", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"nlm3", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{"DataForRed", ",", 
           RowBox[{"BaseFreq", "+", 
            RowBox[{"k", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Sin", "[", 
                RowBox[{"b", " ", "x"}], "]"}], ")"}], "^", "2"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "k", ",", 
             RowBox[{"{", 
              RowBox[{"BaseFreq", ",", 
               RowBox[{"DataForRed", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], ",",
            "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{"DataForRed", ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"nlm3", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"nlm4", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{"DataForBlue", ",", 
           RowBox[{"BaseFreq", "+", 
            RowBox[{"k", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Sin", "[", 
                RowBox[{"b", " ", "x"}], "]"}], ")"}], "^", "2"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "k", ",", 
             RowBox[{"{", 
              RowBox[{"BaseFreq", ",", 
               RowBox[{"DataForBlue", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], ",",
            "x"}], "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{"DataForBlue", ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"nlm4", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"a0", ",", "b0", ",", "nlm2", ",", "nlm3", ",", "nlm4"}], 
         "}"}]}]}], "]"}]}], ";"}], "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"QRMFullCalibrate", "[", 
      RowBox[{"data__List", ",", 
       RowBox[{"symbol_Symbol:", "True"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "l", ",", "L", ",", "DataForRed", ",", "DataForRedF", ",", 
         "DataForBlue", ",", "DataForBlueF", ",", "DataForRedPi", ",", 
         "DataForRedPiF", ",", "DataForBluePi", ",", "DataForBluePiF", ",", 
         "DataForCarrierShift1", ",", "DataForCarrierShift2", ",", 
         "DataForCarrF1", ",", "DataForCarrF2", ",", "nlm1", ",", "nlm2", ",",
          "nlm3", ",", "nlm4", ",", "nlm5", ",", "x", ",", "k", ",", 
         "BaseFreq", ",", "a", ",", "b", ",", "a0", ",", "b0", ",", 
         "DataFortrapfreq", ",", "trapfreqM", ",", "trapfreqSD", ",", 
         "basefreq"}], "}"}], ",", 
       RowBox[{
        RowBox[{"basefreq", "=", "187"}], ";", 
        RowBox[{"l", "=", 
         RowBox[{"Length", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", "data", "}"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], ";", 
        RowBox[{"L", "=", 
         RowBox[{"Length", "@", 
          RowBox[{"{", "data", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DataForRed", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", "data", "}"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "data", "}"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForRedF", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"DataForRed", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"DataForRed", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"(", 
               RowBox[{"DataForRed", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"DataForBlue", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", "data", "}"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "data", "}"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForBlueF", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"DataForBlue", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"DataForBlue", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"(", 
               RowBox[{"DataForBlue", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"DataForRedPi", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", "data", "}"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "data", "}"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForRedPiF", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"DataForRedPi", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"DataForRedPi", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"(", 
               RowBox[{"DataForRedPi", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"DataForBluePi", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", "data", "}"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "data", "}"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForBluePiF", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"DataForBluePi", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"DataForBluePi", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"(", 
               RowBox[{"DataForBluePi", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"DataFortrapfreq", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DataForBlue", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"DataForBlue", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                  RowBox[{
                   RowBox[{"DataForRed", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "/", 
                "2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", 
                RowBox[{"DataForBlue", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "@", "DataForBlue"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForCarrierShift1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", "data", "}"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "data", "}"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForCarrF1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"DataForCarrierShift1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"DataForCarrierShift1", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"(", 
               RowBox[{"DataForCarrierShift1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"DataForCarrierShift2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", "data", "}"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "data", "}"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "data", "}"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}], "-", 
                "basefreq"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DataForCarrF2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"DataForCarrierShift2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"DataForCarrierShift2", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"(", 
               RowBox[{"DataForCarrierShift2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"nlm1", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"DataForRedPiF", "+", "DataForBluePiF"}], ")"}], "/", 
            "2"}], ",", 
           RowBox[{"a", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"b", " ", "x"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"DataForRedPi", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "@", "DataForRedPi"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"DataForBluePi", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "@", "DataForBluePi"}]}], "}"}]}], "]"}],
                ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nlm1", "[", "x", "]"}], "-", "0.001"}], ",", 
                 RowBox[{
                  RowBox[{"nlm1", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
               RowBox[{"Filling", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", "\[Rule]", 
                  RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"nlm1", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"Axes", "->", "False"}], ",", 
             RowBox[{
             "PlotLabel", "\[Rule]", "\"\<Sideband Rabi frequency\>\""}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a0", ",", "b0"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "/.", 
          RowBox[{"nlm1", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nlm2", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{"DataForRedF", ",", 
           RowBox[{"BaseFreq", "+", 
            RowBox[{"k", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Sin", "[", 
                RowBox[{"b", " ", "x"}], "]"}], ")"}], "^", "2"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "k", ",", 
             RowBox[{"{", 
              RowBox[{"BaseFreq", ",", 
               RowBox[{"DataForRedF", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], ",",
            "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"DataForRed", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "@", "DataForRed"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nlm2", "[", "x", "]"}], "-", "0.001"}], ",", 
                 RowBox[{
                  RowBox[{"nlm2", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
               RowBox[{"Filling", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", "\[Rule]", 
                  RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"nlm2", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"Axes", "->", "False"}], ",", 
             RowBox[{
             "PlotLabel", "\[Rule]", "\"\<Red sideband frequency\>\""}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nlm3", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{"DataForBlueF", ",", 
           RowBox[{"BaseFreq", "+", 
            RowBox[{"k", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Sin", "[", 
                RowBox[{"b", " ", "x"}], "]"}], ")"}], "^", "2"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "k", ",", 
             RowBox[{"{", 
              RowBox[{"BaseFreq", ",", 
               RowBox[{"DataForBlueF", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], ",",
            "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"DataForBlue", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "@", "DataForBlue"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nlm3", "[", "x", "]"}], "-", "0.001"}], ",", 
                 RowBox[{
                  RowBox[{"nlm3", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
               RowBox[{"Filling", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", "\[Rule]", 
                  RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"nlm3", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"Axes", "->", "False"}], ",", 
             RowBox[{
             "PlotLabel", "\[Rule]", "\"\<Blue sideband frequency\>\""}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nlm4", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{"DataForCarrF2", ",", 
           RowBox[{"(*", 
            RowBox[{"BaseFreq", "+"}], "*)"}], 
           RowBox[{"k", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Sin", "[", 
               RowBox[{"b", " ", "x"}], "]"}], ")"}], "^", "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "k"}], 
            RowBox[{"(*", 
             RowBox[{",", 
              RowBox[{"{", 
               RowBox[{"BaseFreq", ",", "0"}], "}"}]}], "*)"}], "}"}], ",", 
           "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"DataForCarrierShift2", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "@", "DataForCarrierShift2"}]}], "}"}]}],
                 "]"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Automatic"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nlm4", "[", "x", "]"}], "-", "0.001"}], ",", 
                 RowBox[{
                  RowBox[{"nlm4", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
               RowBox[{"Filling", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", "\[Rule]", 
                  RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"nlm4", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"Axes", "->", "False"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "\"\<Method:direct scan\>\""}]}],
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nlm5", "=", 
         RowBox[{"NonlinearModelFit", "[", 
          RowBox[{"DataForCarrF1", ",", 
           RowBox[{"(*", 
            RowBox[{"BaseFreq", "+"}], "*)"}], 
           RowBox[{"k", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Sin", "[", 
               RowBox[{"b", " ", "x"}], "]"}], ")"}], "^", "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "k"}], 
            RowBox[{"(*", 
             RowBox[{",", 
              RowBox[{"{", 
               RowBox[{"BaseFreq", ",", "0"}], "}"}]}], "*)"}], "}"}], ",", 
           "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"DataForCarrierShift1", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "@", "DataForCarrierShift1"}]}], "}"}]}],
                 "]"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Automatic"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nlm5", "[", "x", "]"}], "-", "0.001"}], ",", 
                 RowBox[{
                  RowBox[{"nlm5", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
               RowBox[{"Filling", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", "\[Rule]", 
                  RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"nlm5", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"Axes", "->", "False"}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "\"\<Method:Ramsey\>\""}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"trapfreqM", "=", 
         RowBox[{"Mean", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DataFortrapfreq", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"trapfreqSD", "=", 
         RowBox[{"StandardDeviation", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DataFortrapfreq", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symbol", ",", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{"DataFortrapfreq", ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Automatic"}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"trapfreqM", "-", "0.001"}], ",", 
                 RowBox[{"trapfreqM", "+", "0.001"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
               RowBox[{"Filling", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"1", "\[Rule]", 
                  RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Plot", "[", 
              RowBox[{"trapfreqM", ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", "0.8"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"Axes", "->", "False"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"trapfreqM", "-", "0.005"}], ",", 
                  RowBox[{"trapfreqM", "+", "0.005"}]}], "}"}]}], "}"}]}], 
             ",", 
             RowBox[{"PlotLabel", "\[Rule]", "\"\<Trap frequency\>\""}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "a0", ",", "b0", ",", "nlm2", ",", "nlm3", ",", "nlm4", ",", "nlm5", 
          ",", "trapfreqM", ",", "trapfreqSD"}], "}"}]}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QRMFullCalibrate", "[", 
     RowBox[{"data__List", ",", 
      RowBox[{"symbol_Symbol:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "l", ",", "L", ",", "DataForRed", ",", "DataForRedF", ",", 
        "DataForBlue", ",", "DataForBlueF", ",", "DataForRedPi", ",", 
        "DataForRedPiF", ",", "DataForBluePi", ",", "DataForBluePiF", ",", 
        "DataForCarrierShift1", ",", "DataForCarrierShift2", ",", 
        "DataForCarrF1", ",", "DataForCarrF2", ",", "nlm1", ",", "nlm2", ",", 
        "nlm3", ",", "nlm4", ",", "nlm5", ",", "x", ",", "k", ",", "a", ",", 
        "b", ",", "BaseFreq", ",", "DataFortrapfreq", ",", "trapfreqM", ",", 
        "trapfreqSD", ",", "basefreq"}], "}"}], ",", 
      RowBox[{
       RowBox[{"basefreq", "=", "187"}], ";", 
       RowBox[{"l", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", "data", "}"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], ";", 
       RowBox[{"L", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"{", "data", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DataForRed", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "data", "}"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", "data", "}"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataForRedF", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"DataForRed", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{"DataForRed", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"(", 
              RowBox[{"DataForRed", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"DataForBlue", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "data", "}"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", "data", "}"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataForBlueF", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"DataForBlue", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{"DataForBlue", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"(", 
              RowBox[{"DataForBlue", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"DataForRedPi", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "data", "}"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", "data", "}"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataForRedPiF", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"DataForRedPi", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{"DataForRedPi", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"(", 
              RowBox[{"DataForRedPi", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"DataForBluePi", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "data", "}"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", "data", "}"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataForBluePiF", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"DataForBluePi", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{"DataForBluePi", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"(", 
              RowBox[{"DataForBluePi", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"DataFortrapfreq", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"DataForBlue", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DataForBlue", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"DataForRed", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "/", 
               "2"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"DataForBlue", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "@", "DataForBlue"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataForCarrierShift1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "data", "}"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", "data", "}"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataForCarrF1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"DataForCarrierShift1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{"DataForCarrierShift1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"(", 
              RowBox[{"DataForCarrierShift1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"DataForCarrierShift2", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "data", "}"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "data", "}"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "data", "}"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}], "-", 
               "basefreq"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "l"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataForCarrF2", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"DataForCarrierShift2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{"DataForCarrierShift2", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"(", 
              RowBox[{"DataForCarrierShift2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}]}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nlm1", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"DataForRedPiF", "+", "DataForBluePiF"}], ")"}], "/", 
           "2"}], ",", 
          RowBox[{"a", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"b", " ", "x"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symbol", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"DataForRedPi", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "@", "DataForRedPi"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"DataForBluePi", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "@", "DataForBluePi"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"nlm1", "[", "x", "]"}], "-", "0.001"}], ",", 
                RowBox[{
                 RowBox[{"nlm1", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
              RowBox[{"Filling", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", "\[Rule]", 
                 RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"nlm1", "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"Axes", "->", "False"}], ",", 
            RowBox[{
            "PlotLabel", "\[Rule]", "\"\<Sideband Rabi frequency\>\""}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm2", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"DataForRedF", ",", 
          RowBox[{"BaseFreq", "+", 
           RowBox[{"k", " ", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"b", " ", "x"}], "]"}], "^", "2"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "b", ",", 
            RowBox[{"{", 
             RowBox[{"BaseFreq", ",", 
              RowBox[{"DataForRedF", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
          "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symbol", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"DataForRed", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "@", "DataForRed"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"nlm2", "[", "x", "]"}], "-", "0.001"}], ",", 
                RowBox[{
                 RowBox[{"nlm2", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
              RowBox[{"Filling", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", "\[Rule]", 
                 RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"nlm2", "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"Axes", "->", "False"}], ",", 
            RowBox[{
            "PlotLabel", "\[Rule]", "\"\<Red sideband frequency\>\""}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm3", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"DataForBlueF", ",", 
          RowBox[{"BaseFreq", "+", 
           RowBox[{"k", " ", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"b", " ", "x"}], "]"}], "^", "2"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "b", ",", 
            RowBox[{"{", 
             RowBox[{"BaseFreq", ",", 
              RowBox[{"DataForBlueF", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
          "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symbol", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"DataForBlue", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "@", "DataForBlue"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"nlm3", "[", "x", "]"}], "-", "0.001"}], ",", 
                RowBox[{
                 RowBox[{"nlm3", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
              RowBox[{"Filling", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", "\[Rule]", 
                 RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"nlm3", "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"Axes", "->", "False"}], ",", 
            RowBox[{
            "PlotLabel", "\[Rule]", "\"\<Blue sideband frequency\>\""}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm4", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"DataForCarrF2", ",", 
          RowBox[{"(*", 
           RowBox[{"BaseFreq", "+"}], "*)"}], 
          RowBox[{"k", " ", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"b", " ", "x"}], "]"}], "^", "2"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "b"}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"{", 
              RowBox[{"BaseFreq", ",", "0"}], "}"}]}], "*)"}], "}"}], ",", 
          "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symbol", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"DataForCarrierShift2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "@", "DataForCarrierShift2"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Automatic"}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"nlm4", "[", "x", "]"}], "-", "0.001"}], ",", 
                RowBox[{
                 RowBox[{"nlm4", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
              RowBox[{"Filling", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", "\[Rule]", 
                 RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"nlm4", "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"Axes", "->", "False"}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", "\"\<Method:direct scan\>\""}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nlm5", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"DataForCarrF1", ",", 
          RowBox[{"(*", 
           RowBox[{"BaseFreq", "+"}], "*)"}], 
          RowBox[{"k", " ", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"b", " ", "x"}], "]"}], "^", "2"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "b"}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"{", 
              RowBox[{"BaseFreq", ",", "0"}], "}"}]}], "*)"}], "}"}], ",", 
          "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symbol", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"DataForCarrierShift1", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "@", "DataForCarrierShift1"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Automatic"}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"nlm5", "[", "x", "]"}], "-", "0.001"}], ",", 
                RowBox[{
                 RowBox[{"nlm5", "[", "x", "]"}], "+", "0.001"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
              RowBox[{"Filling", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", "\[Rule]", 
                 RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"nlm5", "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"Axes", "->", "False"}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", "\"\<Method:Ramsey\>\""}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"trapfreqM", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"DataFortrapfreq", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"trapfreqSD", "=", 
        RowBox[{"StandardDeviation", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"DataFortrapfreq", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symbol", ",", 
         RowBox[{"Print", "@", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{"DataFortrapfreq", ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Automatic"}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"trapfreqM", "-", "0.001"}], ",", 
                RowBox[{"trapfreqM", "+", "0.001"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
              RowBox[{"Filling", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", "\[Rule]", 
                 RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{"trapfreqM", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"Axes", "->", "False"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"trapfreqM", "-", "0.005"}], ",", 
                 RowBox[{"trapfreqM", "+", "0.005"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", "\"\<Trap frequency\>\""}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nlm1", ",", 
         RowBox[{"b", "/.", 
          RowBox[{"nlm1", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
         "nlm2", ",", "nlm3", ",", "nlm4", ",", "nlm5", ",", "trapfreqM", ",",
          "trapfreqSD"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PhononNumberVariationPlot", "[", 
     RowBox[{
     "FileTable_List", ",", "sidebandRabi_List", ",", "repeats_Integer", ",", 
      RowBox[{"theoreticaldata__:", "Null"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "data1", ",", "dataexport", ",", "data2", ",", "data3", ",", "data4", 
        ",", "data5", ",", "graph1", ",", "graph2", ",", "Graph"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"data1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"pn", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"-", "4"}], "]"}], "]"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{"Abs", "/@", 
                RowBox[{
                 RowBox[{"pn", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"FileTable", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "FileTable"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataexport", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FileTable", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"data1", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "FileTable"}]}], "}"}]}], "]"}], ",", 
          "sidebandRabi"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data2", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"repeats", "\[Equal]", "1"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FileTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"Mean", "@", 
                 RowBox[{"data1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "All", ",", "1"}], "]"}], "]"}]}]}], 
               "}"}], ",", 
              RowBox[{"ErrorBar", "[", 
               RowBox[{"data1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "FileTable"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FileTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"Mean", "@", 
                 RowBox[{"data1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "All", ",", "1"}], "]"}], "]"}]}]}], 
               "}"}], ",", 
              RowBox[{"ErrorBar", "@", 
               RowBox[{"(", 
                RowBox[{"(", 
                 RowBox[{"StandardDeviation", "@", 
                  RowBox[{"data1", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "All", ",", "1"}], "]"}], "]"}]}], 
                 ")"}], 
                RowBox[{"(*", 
                 RowBox[{"*", 
                  RowBox[{"1.96", "/", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"data1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "*)"}], 
                ")"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "FileTable"}]}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data3", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"data2", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "data2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data4", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"{", "theoreticaldata", "}"}], ",", 
          RowBox[{"_", "?", "ListQ"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data5", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"{", "theoreticaldata", "}"}], ",", "data4"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"theoreticaldata", "===", "Null"}], ",", 
         RowBox[{"graph1", "=", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"data3", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Blue", ",", 
               RowBox[{"Thickness", "[", "0.004", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.7", "]"}]}], "]"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ",", 
         RowBox[{"graph1", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{"data4", "===", 
                 RowBox[{"{", "}"}]}], ")"}]}], ",", 
              RowBox[{"ListLinePlot", "[", 
               RowBox[{"data4", ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Red", ",", 
                   RowBox[{"Thickness", "[", "0.004", "]"}], ",", 
                   RowBox[{"Opacity", "[", "0.7", "]"}]}], "]"}]}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "]"}], 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{"data5", "===", 
                 RowBox[{"{", "}"}]}], ")"}]}], ",", 
              RowBox[{"Plot", "[", 
               RowBox[{"data5", ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "2000"}], "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                RowBox[{"PlotStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"Blue", ",", 
                   RowBox[{"Thickness", "[", "0.004", "]"}], ",", 
                   RowBox[{"Opacity", "[", "0.7", "]"}]}], "]"}]}]}], "]"}]}],
              "]"}]}], "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"graph2", "=", 
        RowBox[{"ErrorListPlot", "[", 
         RowBox[{"data2", ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Average phonon number\>\""}], 
          ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<t(us)\>\"", ",", 
             "\"\<\!\(\*OverscriptBox[\(n\), \(_\)]\)=\[InvisibleComma]\
\[LeftAngleBracket]\!\(\*SuperscriptBox[\(a\), \(\[Dagger]\)]\)a\
\[RightAngleBracket]\>\""}], "}"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "15"}], "]"}]}], ",", "opts"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Graph", "=", 
        RowBox[{"Show", "@@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"graph2", ",", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"graph1", ",", "Null"}], "]"}]}], "}"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", 
          "\"\<Fitted Average phonon number variation \>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.csv\>\""}], ",", "dataexport"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", 
          "\"\<Fitted Average phonon number variation \>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.svg\>\""}], ",", "Graph"}], 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "*)"}], "]"}], ";",
        "\[IndentingNewLine]", "Graph"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PhononNumberVariationPlot", "[", 
     RowBox[{"data_List", ",", "opts1___Rule", ",", 
      RowBox[{
       RowBox[{"theoreticaldata", ":", "__"}], "/;", 
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"Head", "/@", 
          RowBox[{"{", "theoreticaldata", "}"}]}], ",", "Rule"}], "]"}]}], 
      ",", "opts2___Rule", ",", 
      RowBox[{"export_Symbol:", "False"}], ",", 
      RowBox[{"label_Symbol:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "data1", ",", "data2", ",", "graph1", ",", "graph2", ",", "Graph"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"graph1", "=", 
        RowBox[{"ErrorListPlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2", ",", 
                   RowBox[{"-", "4"}]}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"ErrorBar", "[", 
               RowBox[{"Min", "[", 
                RowBox[{"Abs", "/@", 
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "10"}], "]"}]}], ",", "opts1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"data1", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"{", "theoreticaldata", "}"}], ",", 
          RowBox[{"_", "?", "ListQ"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data2", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"{", "theoreticaldata", "}"}], ",", "data1"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"graph2", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{"data1", "===", 
               RowBox[{"{", "}"}]}], ")"}]}], ",", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{"data1", ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "opts2"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{"data2", "===", 
               RowBox[{"{", "}"}]}], ")"}]}], ",", 
            RowBox[{"Plot", "[", 
             RowBox[{"data2", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "2000"}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "opts2"}], 
             "]"}]}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Graph", "=", 
        RowBox[{"Show", "@@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"If", "[", 
           RowBox[{"label", ",", 
            RowBox[{"{", 
             RowBox[{"graph1", ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"graph2", ",", "Null"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"graph1", ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"graph2", ",", "Null"}], "]"}], ",", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "20"}], "}"}]}], "}"}], "]"}]}], "}"}], 
               "]"}]}], "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"export", ",", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
            RowBox[{"DateString", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
               "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", 
               ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
               "\"\<\\\\\>\""}], "}"}], "]"}], "<>", 
            "\"\<Phonon number variation \>\"", "<>", 
            RowBox[{"DateString", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
              "}"}], "]"}], "<>", "\"\<.svg\>\""}], ",", "Graph"}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "*)"}], "]"}]}], 
        "]"}], ";", "Graph"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"FittedAveragePhononNumberVariation", "[", 
      RowBox[{"Folder_List", ",", "pitime_", ",", 
       RowBox[{"kmax_:", "15"}], ",", 
       RowBox[{"symbol_:", "True"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "AveragePhononNumber", ",", "AveragePhononNumberVariation", ",", 
         "Graph"}], "}"}], ",", 
       RowBox[{
        RowBox[{"AveragePhononNumberVariation", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Folder", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"PhononNumberFittingBlue", "[", 
                 RowBox[{
                  RowBox[{"Average", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Folder", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"S1", "[", "]"}]}], "]"}], ",", "pitime", ",", 
                  "kmax", ",", "symbol"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "@", 
                  RowBox[{"Folder", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "Folder"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AveragePhononNumber", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"AveragePhononNumberVariation", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"Mean", "@", 
                RowBox[{"AveragePhononNumberVariation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"ErrorBar", "[", 
              RowBox[{"StandardDeviation", "@", 
               RowBox[{"AveragePhononNumberVariation", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "AveragePhononNumberVariation"}]}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
           RowBox[{"DateString", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
              "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
              "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
             "}"}], "]"}], "<>", "\"\<Fitted Average phonon number \>\"", "<>", 
           RowBox[{"DateString", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
             "}"}], "]"}], "<>", "\"\<.csv\>\""}], ",", 
          RowBox[{"Prepend", "[", 
           RowBox[{"AveragePhononNumberVariation", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<pre-estimated pi time=\>\"", "<>", 
               RowBox[{"ToString", "[", "pitime", "]"}]}], ",", 
              RowBox[{"\"\<cutoff phonon number=\>\"", "<>", 
               RowBox[{"ToString", "[", "kmax", "]"}]}]}], "}"}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Graph", "=", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"ErrorListPlot", "[", 
            RowBox[{"AveragePhononNumber", ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
           RowBox[{"ListLinePlot", "[", "AveragePhononNumber", "]"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<t(us)\>\"", ",", "\"\<Average phonon number\>\""}], 
             "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
           RowBox[{"DateString", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
              "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
              "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
             "}"}], "]"}], "<>", 
           "\"\<Fitted Average phonon number variation \>\"", "<>", 
           RowBox[{"DateString", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
             "}"}], "]"}], "<>", "\"\<.png\>\""}], ",", "Graph", ",", 
          RowBox[{"ImageResolution", "\[Rule]", "100"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "Graph"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FittedAveragePhononNumberVariation", "[", 
     RowBox[{"Folder_List", ",", "pitime_", ",", 
      RowBox[{"kmax_Integer:", " ", "15"}], ",", 
      RowBox[{"func_:", "PhononBSBFit"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "AveragePhononNumber", ",", "AveragePhononNumberVariation", ",", 
        "Graph", ",", "dat", ",", "pt"}], "}"}], ",", 
      RowBox[{
       RowBox[{"pt", "=", "pitime"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AveragePhononNumberVariation", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Folder", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"dat", "=", 
                RowBox[{
                 RowBox[{"func", "[", 
                  RowBox[{
                   RowBox[{"Average", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Folder", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"S1", "[", "]"}]}], "]"}], ",", "pt", ",", 
                   "kmax"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "3"}]}], "}"}], "]"}], "]"}]}], ";", 
               RowBox[{"pt", "=", 
                RowBox[{"dat", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"dat", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "@", 
                 RowBox[{"Folder", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "Folder"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AveragePhononNumber", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AveragePhononNumberVariation", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Mean", "@", 
               RowBox[{"AveragePhononNumberVariation", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"ErrorBar", "[", 
             RowBox[{"1.96", " ", 
              RowBox[{
               RowBox[{"StandardDeviation", "@", 
                RowBox[{"AveragePhononNumberVariation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"Length", "@", 
                 RowBox[{"AveragePhononNumberVariation", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "AveragePhononNumberVariation"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", "\"\<Fitted Average phonon number \>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.csv\>\""}], ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{"AveragePhononNumberVariation", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<pre-estimated pi time=\>\"", "<>", 
              RowBox[{"ToString", "[", "pitime", "]"}]}], ",", 
             RowBox[{"\"\<cutoff phonon number=\>\"", "<>", 
              RowBox[{"ToString", "[", "kmax", "]"}]}]}], "}"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Graph", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ErrorListPlot", "[", 
           RowBox[{"AveragePhononNumber", ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
          RowBox[{"ListLinePlot", "[", "AveragePhononNumber", "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<t(us)\>\"", ",", "\"\<Average phonon number\>\""}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<D:\\\\Data\\\\\>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Year\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<\\\\\>\"", ",", "\"\<Year\>\"", ",", 
             "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", "\"\<\\\\\>\""}], 
            "}"}], "]"}], "<>", 
          "\"\<Fitted Average phonon number variation \>\"", "<>", 
          RowBox[{"DateString", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Hour\>\"", ",", "\"\<Minute\>\"", ",", "\"\<Second\>\""}], 
            "}"}], "]"}], "<>", "\"\<.png\>\""}], ",", "Graph", ",", 
         RowBox[{"ImageResolution", "\[Rule]", "100"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "Graph"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FittedAveragePhononNumberVariation", "[", 
     RowBox[{"FileTable_List", ",", "kmax_List", ",", "pitime_", ",", 
      RowBox[{"func_:", " ", "PhononBSBFit"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ClearAll", "[", "pn", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NotebookWrite", "[", 
          RowBox[{
           RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
           RowBox[{"Cell", "[", 
            RowBox[{"CellGroupData", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cell", "[", 
                 RowBox[{
                  RowBox[{"\"\<Fit \>\"", "<>", 
                   RowBox[{"ToString", "@", "i"}], "<>", "\"\<,\>\"", "<>", 
                   RowBox[{"ToString", "@", "j"}]}], ",", 
                  "\"\<Subsection\>\""}], "]"}], ",", 
                RowBox[{"Cell", "[", 
                 RowBox[{
                  RowBox[{"BoxData", "[", 
                   RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<pn\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "j"}], ",", "\"\<]\>\""}], "}"}],
                     "]"}], ",", "\"\<=\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToString", "@", "func"}], ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Average\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<FileTable\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<,\>\"", ",", 
                    "\"\<2\>\""}], "}"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
                    "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", "\"\<[\>\"",
                     ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[\>\"", ",", 
                    RowBox[{"ToString", "@", "j"}], ",", "\"\<]\>\""}], "}"}],
                     "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
                    "\"\<,\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<S1\>\"", ",", "\"\<[\>\"", ",", "\"\<1\>\"", ",", 
                    "\"\<]\>\""}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                    "\"\<]\>\""}], "}"}], "]"}], ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "pitime"}], ",", "\"\<,\>\"", 
                    ",", 
                    RowBox[{"ToString", "@", 
                    RowBox[{"kmax", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}], ",", 
                    "\"\<]\>\""}], "}"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
                  "\"\<Input\>\""}], "]"}]}], "}"}], ",", "Open"}], "]"}], 
            "]"}], ",", "All"}], "]"}], ";", 
         RowBox[{"FrontEndTokenExecute", "[", "\"\<Evaluate\>\"", "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "FileTable"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"FileTable", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
     ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FittedAveragePhononNumberVariation", "[", 
    RowBox[{"FileTable_List", ",", "kmax_Integer", ",", "pitime_", ",", 
     RowBox[{"func_:", " ", "PhononBSBFit"}]}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ClearAll", "[", "pn", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookWrite", "[", 
         RowBox[{
          RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
          RowBox[{"Cell", "[", 
           RowBox[{"CellGroupData", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cell", "[", 
                RowBox[{
                 RowBox[{"\"\<Fit\>\"", "<>", 
                  RowBox[{"ToString", "@", "i"}]}], ",", 
                 "\"\<Subsection\>\""}], "]"}], ",", 
               RowBox[{"Cell", "[", 
                RowBox[{
                 RowBox[{"BoxData", "[", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<pn\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<]\>\""}], "}"}],
                     "]"}], ",", "\"\<=\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToString", "@", "func"}], ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Average\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<FileTable\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<,\>\"", ",", 
                    "\"\<2\>\""}], "}"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
                    "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", "\"\<,\>\"",
                     ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<S1\>\"", ",", "\"\<[\>\"", ",", "\"\<]\>\""}], "}"}],
                     "]"}]}], "}"}], "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], 
                    ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "pitime"}], ",", "\"\<,\>\"", 
                    ",", 
                    RowBox[{"ToString", "@", "kmax"}]}], "}"}], "]"}], ",", 
                    "\"\<]\>\""}], "}"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
                 "\"\<Input\>\""}], "]"}]}], "}"}], ",", "Open"}], "]"}], 
           "]"}], ",", "All"}], "]"}], ";", 
        RowBox[{"FrontEndTokenExecute", "[", "\"\<Evaluate\>\"", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "FileTable"}]}], "}"}]}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ClearAll", "@", "SidebandFit"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SidebandFit", "[", 
      RowBox[{"data_List", ",", "kmax_", ",", "pitime_", ",", 
       RowBox[{"func_:", " ", "PhononBSBFit"}]}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ClearAll", "[", 
        RowBox[{"pb", ",", "pr"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NotebookWrite", "[", 
           RowBox[{
            RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
            RowBox[{"Cell", "[", 
             RowBox[{"CellGroupData", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cell", "[", 
                  RowBox[{
                   RowBox[{"\"\<Blue sideband\>\"", "<>", 
                    RowBox[{"ToString", "@", "i"}]}], ",", 
                   "\"\<Subsection\>\""}], "]"}], ",", 
                 RowBox[{"Cell", "[", 
                  RowBox[{
                   RowBox[{"BoxData", "[", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<pb\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<]\>\""}], "}"}],
                     "]"}], ",", "\"\<=\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToString", "@", "func"}], ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Part\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<data\>\"", ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<,\>\"", ",", 
                    "\"\<2\>\""}], "}"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
                    "]"}], ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "pitime"}], ",", "\"\<,\>\"", 
                    ",", 
                    RowBox[{"ToString", "@", "kmax"}]}], "}"}], "]"}], ",", 
                    "\"\<]\>\""}], "}"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
                   "\"\<Input\>\""}], "]"}]}], "}"}], ",", "Open"}], "]"}], 
             "]"}], ",", "All"}], "]"}], ";", 
          RowBox[{"FrontEndTokenExecute", "[", "\"\<Evaluate\>\"", "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NotebookWrite", "[", 
           RowBox[{
            RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
            RowBox[{"Cell", "[", 
             RowBox[{"CellGroupData", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cell", "[", 
                  RowBox[{
                   RowBox[{"\"\<Red sideband\>\"", "<>", 
                    RowBox[{"ToString", "@", "i"}]}], ",", 
                   "\"\<Subsection\>\""}], "]"}], ",", 
                 RowBox[{"Cell", "[", 
                  RowBox[{
                   RowBox[{"BoxData", "[", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<pr\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<]\>\""}], "}"}],
                     "]"}], ",", "\"\<=\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToString", "@", "func"}], ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Part\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<data\>\"", ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<,\>\"", ",", 
                    "\"\<3\>\""}], "}"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
                    "]"}], ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "pitime"}], ",", "\"\<,\>\"", 
                    ",", 
                    RowBox[{"ToString", "@", "kmax"}]}], "}"}], "]"}], ",", 
                    "\"\<]\>\""}], "}"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
                   "\"\<Input\>\""}], "]"}]}], "}"}], ",", "Open"}], "]"}], 
             "]"}], ",", "All"}], "]"}], ";", 
          RowBox[{"FrontEndTokenExecute", "[", "\"\<Evaluate\>\"", "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}]}], ")"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "@", "SidebandFit"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SidebandFit", "[", 
     RowBox[{"data_List", ",", "kmax_", ",", "pitime_", ",", 
      RowBox[{"func_:", " ", "PhononNumberFitting"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ClearAll", "[", "pn", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NotebookWrite", "[", 
          RowBox[{
           RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
           RowBox[{"Cell", "[", 
            RowBox[{"CellGroupData", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cell", "[", 
                 RowBox[{
                  RowBox[{"\"\<Fit\>\"", "<>", 
                   RowBox[{"ToString", "@", "i"}]}], ",", 
                  "\"\<Subsection\>\""}], "]"}], ",", 
                RowBox[{"Cell", "[", 
                 RowBox[{
                  RowBox[{"BoxData", "[", 
                   RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<pn\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<]\>\""}], "}"}],
                     "]"}], ",", "\"\<=\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToString", "@", "func"}], ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Part\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<data\>\"", ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<,\>\"", ",", 
                    "\"\<2\>\""}], "}"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
                    "]"}], ",", "\"\<,\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Part\>\"", ",", "\"\<[\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<data\>\"", ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "i"}], ",", "\"\<,\>\"", ",", 
                    "\"\<3\>\""}], "}"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
                    "]"}], ",", "\"\<,\>\"", ",", 
                    RowBox[{"ToString", "@", "pitime"}], ",", "\"\<,\>\"", 
                    ",", 
                    RowBox[{"ToString", "@", "kmax"}]}], "}"}], "]"}], ",", 
                    "\"\<]\>\""}], "}"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
                  "\"\<Input\>\""}], "]"}]}], "}"}], ",", "Open"}], "]"}], 
            "]"}], ",", "All"}], "]"}], ";", 
         RowBox[{"FrontEndTokenExecute", "[", "\"\<Evaluate\>\"", "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}]}], ")"}]}], ";"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToInterval", "[", "inequality_Inequality", "]"}], ":=", 
   RowBox[{"Interval", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"First", "[", "inequality", "]"}], ",", 
      RowBox[{"Last", "[", "inequality", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QRMWaveString", "[", 
     RowBox[{
      RowBox[{"freqr_", "?", "NumberQ"}], ",", 
      RowBox[{"\[Delta]r_", "?", "NumberQ"}], ",", 
      RowBox[{"freqb_", "?", "NumberQ"}], ",", 
      RowBox[{"\[Delta]b_", "?", "NumberQ"}], ",", "phaser_List", ",", 
      "phaseb_List", ",", "amplitude_Function"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "inequality", ",", "points", ",", "tointerval", ",", "Pr", ",", "Pb", 
        ",", "phaserlist", ",", "phaseblist"}], "}"}], ",", 
      RowBox[{
       RowBox[{"inequality", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"phaser", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "phaser"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"phaseb", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "phaseb"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"First", "[", 
                    RowBox[{"inequality", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                   RowBox[{"Last", "[", 
                    RowBox[{"inequality", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"Length", "@", "inequality"}]}], "}"}]}], "]"}]}], 
              ",", 
              RowBox[{
               RowBox[{"#1", "<", "#2"}], "&"}]}], "]"}], ",", "1"}], "]"}], 
          ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tointerval", "=", 
        RowBox[{"Interval", "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{"points", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pr", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"IntervalMemberQ", "[", 
              RowBox[{
               RowBox[{"ToInterval", "[", 
                RowBox[{"phaser", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", "#"}], 
              "]"}], ",", 
             RowBox[{"phaser", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "phaser"}]}], "}"}]}], "]"}], "&"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Pb", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"IntervalMemberQ", "[", 
              RowBox[{
               RowBox[{"ToInterval", "[", 
                RowBox[{"phaseb", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", "#"}], 
              "]"}], ",", 
             RowBox[{"phaseb", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "phaseb"}]}], "}"}]}], "]"}], "&"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"phaserlist", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"(", 
            RowBox[{"Pr", "/@", "tointerval"}], ")"}]}], ",", "Null"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"phaseblist", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"(", 
            RowBox[{"Pb", "/@", "tointerval"}], ")"}]}], ",", "Null"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", 
              RowBox[{"2", " ", "i"}], "]"}], "]"}], "-", 
            RowBox[{"points", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", " ", "i"}], "-", "1"}], "]"}], "]"}]}], ",", "0", 
           ",", "0", ",", "0", ",", 
           RowBox[{"ToFormulaString", "[", 
            RowBox[{
             RowBox[{"amplitude", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "Pi", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"freqr", "+", "\[Delta]r"}], ")"}], " ", "t"}], 
                   "+", 
                   RowBox[{"phaserlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "+", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "Pi", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"freqb", "+", "\[Delta]b"}], ")"}], " ", "t"}], 
                   "+", 
                   RowBox[{"phaseblist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}]}], 
              ")"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "phaserlist"}]}], "}"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QRMWaveString", "[", 
     RowBox[{
      RowBox[{"carrfreq_", "?", "NumberQ"}], ",", 
      RowBox[{"trapfreq_", "?", "NumberQ"}], ",", "phaser_", ",", "phaseb_", 
      ",", 
      RowBox[{"duration_", "?", "NumberQ"}], ",", 
      RowBox[{"freqshift_", "?", "NumberQ"}], ",", 
      RowBox[{"amplitude_", "?", "NumberQ"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "duration", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"ToFormulaString", "[", 
        RowBox[{"amplitude", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "Pi", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"carrfreq", "-", "trapfreq", "+", "freqshift"}], 
                 ")"}], " ", "t"}], "+", "phaser"}], ")"}]}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "Pi", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"carrfreq", "+", "trapfreq", "+", "freqshift"}], 
                 ")"}], " ", "t"}], "+", "phaseb"}], ")"}]}], "]"}]}], 
          ")"}]}], "]"}]}], "}"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QRMWaveString", "[", 
     RowBox[{"n_Integer", ",", 
      RowBox[{"freqr_", "?", "NumberQ"}], ",", 
      RowBox[{"freqb_", "?", "NumberQ"}], ",", 
      RowBox[{"pulsetime_", "?", "NumberQ"}], ",", 
      RowBox[{"amplitude_", "?", "NumberQ"}], ",", "par_List", ",", 
      RowBox[{"gap_", "?", "NumberQ"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "pulsetime", ",", "0", ",", "0", ",", "0", ",", 
              RowBox[{"ToFormulaString", "[", 
               RowBox[{"amplitude", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", "Pi", " ", "freqr", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"i", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gap", "*", "2"}], "+", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ")"}]}], 
                   "]"}], "+", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", "Pi", " ", "freqb", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"i", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gap", "*", "2"}], "+", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ")"}]}], 
                   "]"}]}], ")"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "gap", ",", "0", ",", "0", ",", "0"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"par", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"par", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "gap", ",", "0", ",", "0", ",", "0"}], "}"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"amplitude", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"2", "Pi", " ", "freqr", 
             RowBox[{"(", 
              RowBox[{"t", "-", 
               RowBox[{"i", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"gap", "*", "2"}], "+", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ")"}]}], 
            "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "Pi", " ", "freqb", 
             RowBox[{"(", 
              RowBox[{"t", "-", 
               RowBox[{"i", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"gap", "*", "2"}], "+", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ")"}]}], 
            "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QRMWaveString", "[", 
     RowBox[{
      RowBox[{"carrfreq_", "?", "NumberQ"}], ",", 
      RowBox[{"trapfreq_", "?", "NumberQ"}], ",", 
      RowBox[{"\[Delta]r_", "?", "NumberQ"}], ",", 
      RowBox[{"\[Delta]b_", "?", "NumberQ"}], ",", "phasec_List", ",", 
      "amplitude_Function"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "inequality", "}"}], ",", 
      RowBox[{
       RowBox[{"inequality", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"phasec", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "phasec"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Last", "[", 
             RowBox[{"inequality", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", 
            RowBox[{"First", "[", 
             RowBox[{"inequality", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", "0", ",", "0", 
           ",", "0", ",", 
           RowBox[{"ToFormulaString", "[", 
            RowBox[{
             RowBox[{"amplitude", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "Pi", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"carrfreq", "-", "trapfreq", "+", "\[Delta]r"}], 
                    ")"}], " ", "t"}], "+", 
                   RowBox[{"phasec", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}], 
               "+", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "Pi", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"carrfreq", "+", "trapfreq", "+", "\[Delta]b"}], 
                    ")"}], " ", "t"}], "+", 
                   RowBox[{"phasec", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
               ")"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "phasec"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QRMWaveString", "[", 
     RowBox[{
      RowBox[{"carrfreq_", "?", "NumberQ"}], ",", 
      RowBox[{"trapfreq_", "?", "NumberQ"}], ",", "phaser_", ",", "phaseb_", 
      ",", "phasec_List", ",", "amplitude_Function"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "inequality", "}"}], ",", 
      RowBox[{
       RowBox[{"inequality", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"phasec", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "phasec"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Last", "[", 
             RowBox[{"inequality", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", 
            RowBox[{"First", "[", 
             RowBox[{"inequality", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", "0", ",", "0", 
           ",", "0", ",", 
           RowBox[{"ToFormulaString", "[", 
            RowBox[{
             RowBox[{"amplitude", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "Pi", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"carrfreq", "-", "trapfreq"}], ")"}], " ", "t"}], 
                   "+", "phaser", "+", 
                   RowBox[{"phasec", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}], 
               "+", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "Pi", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"carrfreq", "+", "trapfreq"}], ")"}], " ", "t"}], 
                   "+", "phaseb", "+", 
                   RowBox[{"phasec", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
               ")"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "phasec"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"QRMWaveString", "[", 
      RowBox[{"n_Integer", ",", 
       RowBox[{"freqr_", "?", "NumberQ"}], ",", 
       RowBox[{"freqb_", "?", "NumberQ"}], ",", 
       RowBox[{"pulsetime_", "?", "NumberQ"}], ",", 
       RowBox[{"amplitude_", "?", "NumberQ"}], ",", "par_List", ",", 
       RowBox[{"gap_", "?", "NumberQ"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"freqr", ",", "0", ",", "amplitude", ",", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "i"}], "/", "6"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gap", "*", "2"}], "+", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", "freqr"}], 
                  "+", 
                  RowBox[{"Ceiling", "[", 
                   RowBox[{
                    RowBox[{"i", "/", "6"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gap", "*", "2"}], "+", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", "freqr"}], 
                   "]"}]}], ")"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"freqb", ",", "0", ",", "amplitude", ",", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "i"}], "/", "6"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gap", "*", "2"}], "+", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", "freqb"}], 
                  "+", 
                  RowBox[{"Ceiling", "[", 
                   RowBox[{
                    RowBox[{"i", "/", "6"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gap", "*", "2"}], "+", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", "freqb"}], 
                   "]"}]}], ")"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0", ",", "pulsetime", ",", "0", ",", "0", ",", "0", ",", 
               RowBox[{"\"\<[\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\< \>\"", "<>", 
                RowBox[{"ToString", "[", " ", 
                 RowBox[{"i", "+", "1"}], "]"}], "<>", "\"\<]\>\""}]}], "}"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "gap", ",", "0", ",", "0", ",", "0"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"par", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"par", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"par", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "gap", ",", "0", ",", "0", ",", "0"}], 
              "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"6", 
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}]}], ",", "6"}], "}"}]}], "]"}], 
         ",", "1"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"amplitude", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", "Pi", " ", "freqr", 
              RowBox[{"(", 
               RowBox[{"t", "-", 
                RowBox[{"i", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"gap", "*", "2"}], "+", 
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ")"}]}], 
             "]"}], "+", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", "Pi", " ", "freqb", 
              RowBox[{"(", 
               RowBox[{"t", "-", 
                RowBox[{"i", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"gap", "*", "2"}], "+", 
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ")"}]}], 
             "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "GeneratePhaseList", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeneratePhaseList", "[", 
    RowBox[{"x_List", ",", "phase_List"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GeneratePhaseList", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "phase"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "x"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeneratePhaseList", "[", 
     RowBox[{
      RowBox[{"x_", "?", "NumberQ"}], ",", "phase_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "pos", "}"}], ",", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"IntervalMemberQ", "[", 
              RowBox[{
               RowBox[{"ToInterval", "[", 
                RowBox[{"phase", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], ",", "x"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "@", "phase"}]}], "}"}]}], "]"}], ",", 
           "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pos", "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"phase", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"phase", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], 
             "\[LessEqual]", "t", "<", "x"}]}], "}"}], "}"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"phase", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"pos", "-", "1"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"phase", "[", 
              RowBox[{"[", 
               RowBox[{"pos", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"phase", "[", 
               RowBox[{"[", 
                RowBox[{"pos", ",", "2", ",", "1"}], "]"}], "]"}], 
              "\[LessEqual]", "t", "<", "x"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "QRMWavePlot", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QRMWavePlot", "[", 
     RowBox[{"wavestring_", ",", "pulsetime_", ",", "gap_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", 
      RowBox[{
       RowBox[{"f", "=", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"wavestring", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"gap", "+", "pulsetime"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "<=", "t", "<", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"gap", "+", "pulsetime"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "+", "pulsetime"}]}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "wavestring"}]}], "}"}]}], "]"}], "]"}]}],
        ";", 
       RowBox[{"Plot", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pulsetime", "+", "gap"}], ")"}], " ", 
            RowBox[{"Length", "@", "wavestring"}]}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "QRMSequence", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"QRMSequence", "[", 
      RowBox[{"n_Integer", ",", "pulsetime_", ",", "coolingtime_", ",", 
       RowBox[{"pumpingtime_:", "3"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "seq", "}"}], ",", 
       RowBox[{
        RowBox[{"seq", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Raman\>\"", "[", 
               RowBox[{"pulsetime", "+", "2"}], "]"}], ",", 
              RowBox[{"\"\<Pumping\>\"", "[", "pumpingtime", "]"}], ",", 
              RowBox[{"\"\<Raman\>\"", "[", 
               RowBox[{"coolingtime", "+", "2"}], "]"}], ",", 
              RowBox[{"\"\<Pumping\>\"", "[", "pumpingtime", "]"}]}], "}"}], 
            ",", "n"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<AWG\>\"", "[", "1", "]"}], "}"}], ",", "seq"}], 
         "]"}]}]}], "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QRMSequence", "[", 
     RowBox[{"n_Integer", ",", "pulsetime_", ",", "coolingtime_", ",", 
      RowBox[{"pumpingtime_:", "3"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "seq", "}"}], ",", 
      RowBox[{
       RowBox[{"seq", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Raman\>\"", "[", "pulsetime", "]"}], ",", 
             RowBox[{"\"\<Zero\>\"", "[", "0.5", "]"}], ",", 
             RowBox[{"\"\<Pumping\>\"", "[", "pumpingtime", "]"}], ",", 
             RowBox[{"\"\<Zero\>\"", "[", "0.5", "]"}], ",", 
             RowBox[{"\"\<Raman4\>\"", "[", "coolingtime", "]"}], ",", 
             RowBox[{"\"\<Zero\>\"", "[", "0.5", "]"}], ",", 
             RowBox[{"\"\<Pumping\>\"", "[", "pumpingtime", "]"}], ",", 
             RowBox[{"\"\<Zero\>\"", "[", "0.5", "]"}]}], "}"}], ",", "n"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<AWG\>\"", "[", "1", "]"}], "}"}], ",", "seq"}], 
        "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "SaturationPointFit", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SaturationPointFit", "[", 
     RowBox[{"Data_List", ",", 
      RowBox[{"\[Gamma]0_:", "10"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nlm", ",", "a", ",", "b", ",", "\[Gamma]", ",", "x", ",", "T", ",", 
        "data"}], "}"}], ",", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Data", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Data", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"ErrorBar", "[", 
             RowBox[{"Data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2", ",", "2"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "Data"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"T", "=", 
        RowBox[{
         RowBox[{"MaximalBy", "[", 
          RowBox[{"Data", ",", "First"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"nlm", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"a", "+", 
           RowBox[{"b", " ", 
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x"}], "/", "\[Gamma]"}], ")"}]}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", 
            RowBox[{"{", 
             RowBox[{"\[Gamma]", ",", "\[Gamma]0"}], "}"}]}], "}"}], ",", 
          "x"}], "]"}]}], ";", 
       RowBox[{"Print", "@", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"nlm", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"T", "+", "20"}]}], "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          RowBox[{"ErrorListPlot", "[", 
           RowBox[{"data", ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nlm", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "\[Gamma]"}], "}"}], "/.", 
          RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], 
        "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "GetProbabilityFromSideband", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetProbabilityFromSideband", "[", 
     RowBox[{"datb_List", ",", "datr_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p0", ",", "p1", ",", "eq", ",", "var"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"p0", "[", "0", "]"}]}], "\[Equal]", 
           RowBox[{"datb", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], "~", "Join", "~", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"p1", "[", "0", "]"}]}], "\[Equal]", 
           RowBox[{"datr", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], "~", "Join", "~", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p1", "[", 
              RowBox[{"i", "-", "2"}], "]"}], "-", 
             RowBox[{"p0", "[", 
              RowBox[{"i", "-", "1"}], "]"}]}], "\[Equal]", 
            RowBox[{"datb", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", 
             RowBox[{"Length", "@", "datb"}]}], "}"}]}], "]"}], "~", "Join", 
         "~", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p1", "[", 
              RowBox[{"i", "-", "1"}], "]"}], "-", 
             RowBox[{"p0", "[", 
              RowBox[{"i", "-", "2"}], "]"}]}], "\[Equal]", 
            RowBox[{"datr", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", 
             RowBox[{"Length", "@", "datr"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"var", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"p0", "[", 
            RowBox[{"i", "-", "1"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "datb"}]}], "}"}]}], "]"}], "~", "Join", 
         "~", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"p1", "[", 
            RowBox[{"i", "-", "1"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "datb"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"var", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{"eq", ",", "var"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"Length", "@", "datb"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "PDOfPDM", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PD", " ", "means", " ", "phonon", " ", "distribution"}], ",", 
    " ", 
    RowBox[{
    "PDM", " ", "means", " ", "pseudo", " ", "denstiy", " ", "matrix"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PDOfPDM", "[", 
    RowBox[{"datb_List", ",", "datr_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "dat", "}"}], ",", 
     RowBox[{
      RowBox[{"dat", "=", 
       RowBox[{"GetProbabilityFromSideband", "[", 
        RowBox[{"datb", ",", "datr"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dat", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"dat", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7763153852944083`*^9, 3.7763154109617352`*^9}, {
   3.776378872256059*^9, 3.7763788728664265`*^9}, {3.776498414341691*^9, 
   3.7764984412108026`*^9}, {3.7765540070193615`*^9, 3.776554027933407*^9}, {
   3.7765574639437075`*^9, 3.7765574968875647`*^9}, {3.776557905906227*^9, 
   3.776557908442442*^9}, {3.7765579647079024`*^9, 3.776557971785965*^9}, {
   3.776558028463323*^9, 3.7765581477122707`*^9}, {3.776558187022097*^9, 
   3.77655818746192*^9}, {3.776570671447076*^9, 3.7765706777532043`*^9}, {
   3.776570730400346*^9, 3.776570753223284*^9}, 3.7765709765826807`*^9, {
   3.776571514061926*^9, 3.7765715855596323`*^9}, {3.7765719456123047`*^9, 
   3.776571947724653*^9}, {3.776572040265059*^9, 3.7765720681574326`*^9}, {
   3.7765721438608875`*^9, 3.7765721563504705`*^9}, {3.776572200397621*^9, 
   3.7765722054132023`*^9}, {3.7765852953852863`*^9, 3.776585297775891*^9}, {
   3.7766538158308015`*^9, 3.776653816126012*^9}, {3.776664875670165*^9, 
   3.776664972356722*^9}, {3.7766650070269613`*^9, 3.7766650355837746`*^9}, {
   3.7766651285021687`*^9, 3.7766651342299333`*^9}, {3.7766652747998357`*^9, 
   3.7766652813054295`*^9}, {3.7766653344352803`*^9, 
   3.7766653604675856`*^9}, {3.776673479533696*^9, 3.776673500207828*^9}, {
   3.7766735335047417`*^9, 3.776673755755886*^9}, {3.7766739334644227`*^9, 
   3.7766739427755113`*^9}, {3.776678579583706*^9, 3.7766786656450567`*^9}, {
   3.776678757072441*^9, 3.7766787747120733`*^9}, {3.7766788354635324`*^9, 
   3.77667883824337*^9}, {3.77667890400642*^9, 3.776679041689842*^9}, {
   3.7766792089270997`*^9, 3.7766792234711866`*^9}, {3.7766796588631287`*^9, 
   3.7766796688384395`*^9}, {3.776737549712283*^9, 3.7767375591939144`*^9}, {
   3.776742525790571*^9, 3.7767425729503937`*^9}, {3.776742664478509*^9, 
   3.776742730246545*^9}, {3.776742797301139*^9, 3.776742797928461*^9}, 
   3.7767428570772076`*^9, {3.776808875249836*^9, 3.776808902201726*^9}, {
   3.776853563248475*^9, 3.776853564892078*^9}, 3.776853877273296*^9, {
   3.776853973932682*^9, 3.7768539917300644`*^9}, {3.77685403592881*^9, 
   3.7768541463304296`*^9}, {3.776854204877784*^9, 3.776854240701936*^9}, {
   3.776854292304871*^9, 3.776854442354411*^9}, {3.7768545393538866`*^9, 
   3.7768545578035245`*^9}, {3.7768550233220205`*^9, 3.776855026393802*^9}, {
   3.776855106533387*^9, 3.776855163404228*^9}, {3.7768552008161325`*^9, 
   3.7768552287503934`*^9}, {3.7768552769763637`*^9, 3.7768552979821625`*^9}, 
   3.776855337279023*^9, {3.77699929868612*^9, 3.7769993889479923`*^9}, {
   3.7769994344891453`*^9, 3.77699943901005*^9}, {3.776999489835605*^9, 
   3.776999497306616*^9}, {3.7769995590135174`*^9, 3.7769995876841297`*^9}, {
   3.7769997152099323`*^9, 3.7769997338081713`*^9}, {3.7769997955958576`*^9, 
   3.776999869388894*^9}, {3.776999917956411*^9, 3.7769999583275414`*^9}, {
   3.777000008548176*^9, 3.7770000228299646`*^9}, {3.777178518473421*^9, 
   3.777178528544489*^9}, 3.777178564310841*^9, {3.7771788495241127`*^9, 
   3.77717894022755*^9}, {3.7771805501612015`*^9, 3.777180603323034*^9}, {
   3.777180672489067*^9, 3.777180672705488*^9}, {3.7771903791571097`*^9, 
   3.7771903977344294`*^9}, {3.77719043056962*^9, 3.7771905021651564`*^9}, {
   3.777190537381979*^9, 3.777190572886032*^9}, {3.777190654572584*^9, 
   3.777190657917637*^9}, {3.7771907223044515`*^9, 3.777190784222867*^9}, 
   3.7771909394776783`*^9, 3.77719100947449*^9, {3.777191077132556*^9, 
   3.7771910783891954`*^9}, {3.777191117208384*^9, 3.777191257169095*^9}, {
   3.7771913384148245`*^9, 3.777191341181426*^9}, {3.7771914004359655`*^9, 
   3.777191495271353*^9}, {3.7771921595090218`*^9, 3.777192159962809*^9}, {
   3.7771946655043893`*^9, 3.7771947215146046`*^9}, {3.7771947865835943`*^9, 
   3.777194848451146*^9}, {3.777195900593465*^9, 3.7771959135976896`*^9}, {
   3.7772018685759697`*^9, 3.777201877502099*^9}, {3.777201935941818*^9, 
   3.777201951851272*^9}, {3.77720198518114*^9, 3.777202009016399*^9}, {
   3.7772020714374695`*^9, 3.7772021066562862`*^9}, {3.7772021808897676`*^9, 
   3.7772022277424726`*^9}, {3.7772023794776964`*^9, 
   3.7772025125248966`*^9}, {3.7772025452204604`*^9, 3.777202581797644*^9}, {
   3.7772026132754664`*^9, 3.7772026458214293`*^9}, {3.7772027113831015`*^9, 
   3.7772028643749647`*^9}, {3.7772028978434625`*^9, 
   3.7772029518769636`*^9}, {3.7772032136997857`*^9, 
   3.7772032500455894`*^9}, {3.7772033174323807`*^9, 3.7772033429611106`*^9}, 
   3.7772034970719814`*^9, 3.777241172994464*^9, {3.77724648842017*^9, 
   3.7772465797160225`*^9}, 3.7772466733380833`*^9, {3.777247175283695*^9, 
   3.7772471858274975`*^9}, {3.777281505776205*^9, 3.7772815159639606`*^9}, {
   3.7774173412845755`*^9, 3.7774173577884407`*^9}, {3.777418825327888*^9, 
   3.7774188270971565`*^9}, {3.777437934306897*^9, 3.7774379563309994`*^9}, {
   3.777438485518824*^9, 3.7774384856355124`*^9}, {3.777439196454612*^9, 
   3.77743920445422*^9}, {3.7777050998174706`*^9, 3.777705140356061*^9}, {
   3.7777052547561274`*^9, 3.7777052584821634`*^9}, {3.777707374553282*^9, 
   3.7777073761270723`*^9}, {3.777707784655362*^9, 3.777707792470463*^9}, {
   3.7777078382779627`*^9, 3.7777078639911995`*^9}, {3.7777085285460215`*^9, 
   3.777708572844556*^9}, {3.777709312306058*^9, 3.7777093687969875`*^9}, {
   3.7777097632551126`*^9, 3.7777097873357153`*^9}, {3.7777099221322374`*^9, 
   3.7777099393023205`*^9}, {3.7777099977669716`*^9, 3.777710009749926*^9}, {
   3.7777101490613747`*^9, 3.7777101519057674`*^9}, 3.777712243514305*^9, {
   3.7777122772690363`*^9, 3.7777123174914722`*^9}, {3.7777123615586257`*^9, 
   3.7777123879191313`*^9}, {3.777713613087737*^9, 3.777713619157505*^9}, 
   3.777715039393453*^9, 3.7777150773389783`*^9, {3.777715607670744*^9, 
   3.7777156114177237`*^9}, {3.7777178107615657`*^9, 
   3.7777178198791833`*^9}, {3.777717865755499*^9, 3.7777178964075284`*^9}, {
   3.777793681419482*^9, 3.777793712367176*^9}, {3.77779404357016*^9, 
   3.777794055209036*^9}, {3.7777941033453074`*^9, 3.7777941078606396`*^9}, {
   3.777794189956489*^9, 3.7777942192487974`*^9}, {3.777794284029559*^9, 
   3.7777944025131073`*^9}, {3.7777944471208153`*^9, 3.777794451247779*^9}, {
   3.7777946742565765`*^9, 3.77779467812523*^9}, 3.7778134343154078`*^9, {
   3.777851383641488*^9, 3.7778513946829605`*^9}, {3.7778514395898685`*^9, 
   3.777851457636607*^9}, {3.777851507121273*^9, 3.777851521750152*^9}, {
   3.777851561719265*^9, 3.7778515887828903`*^9}, {3.777853117114765*^9, 
   3.777853133084059*^9}, {3.7778542832632046`*^9, 3.7778543399795313`*^9}, 
   3.77785987370522*^9, {3.7779540259014635`*^9, 3.777954040789649*^9}, {
   3.777954671640602*^9, 3.77795473649716*^9}, {3.777961303031126*^9, 
   3.777961339513564*^9}, {3.777961402558964*^9, 3.777961403340873*^9}, {
   3.7779647969552755`*^9, 3.7779648471889386`*^9}, {3.777964905622673*^9, 
   3.777964939108124*^9}, {3.777964978620459*^9, 3.7779650111135645`*^9}, {
   3.777965203478136*^9, 3.7779652058009243`*^9}, {3.7782181211860466`*^9, 
   3.7782181321756573`*^9}, {3.7782182573568926`*^9, 
   3.7782182620912323`*^9}, {3.7784084205474634`*^9, 3.778408420658167*^9}, {
   3.7784084703582573`*^9, 3.7784084978327837`*^9}, {3.778409017841837*^9, 
   3.778409018710513*^9}, {3.7784618961458673`*^9, 3.778461908538726*^9}, {
   3.778462179081231*^9, 3.7784622099716225`*^9}, {3.7784626255697536`*^9, 
   3.7784626399792194`*^9}, {3.778462742745398*^9, 3.7784627760782585`*^9}, {
   3.7784629830451975`*^9, 3.7784629832885466`*^9}, {3.778463061607104*^9, 
   3.7784630703606944`*^9}, {3.778463310245186*^9, 3.778463368636035*^9}, {
   3.7784634256455784`*^9, 3.7784634287891717`*^9}, {3.778463484501184*^9, 
   3.7784635169264708`*^9}, {3.7784727032481384`*^9, 3.778472729484975*^9}, {
   3.778472997457353*^9, 3.778473012545005*^9}, {3.7787319890494795`*^9, 
   3.778732115317808*^9}, {3.7787321530907936`*^9, 3.778732168728973*^9}, {
   3.778732240348071*^9, 3.778732310970211*^9}, {3.7787323537862396`*^9, 
   3.7787323719726057`*^9}, {3.778732509643319*^9, 3.7787325322069793`*^9}, {
   3.7787326472357435`*^9, 3.778732699892926*^9}, {3.778732736875699*^9, 
   3.7787327771579742`*^9}, {3.778732867983936*^9, 3.7787328991426096`*^9}, {
   3.7787367835338254`*^9, 3.7787368338163576`*^9}, {3.7787512003554063`*^9, 
   3.778751200539914*^9}, {3.7787512530435066`*^9, 3.778751256806443*^9}, 
   3.778753088809078*^9, {3.7787531304397473`*^9, 3.778753165007306*^9}, {
   3.7787531980499415`*^9, 3.7787533011183124`*^9}, {3.778753340501991*^9, 
   3.778753420078185*^9}, {3.778753456365145*^9, 3.778753489271147*^9}, {
   3.7787535714892755`*^9, 3.7787535793831654`*^9}, {3.7787537953585186`*^9, 
   3.7787537961184864`*^9}, {3.7787540474443655`*^9, 3.778754056233859*^9}, {
   3.778842046507412*^9, 3.7788420524086304`*^9}, {3.7795134041846266`*^9, 
   3.779513418493362*^9}, {3.7795134555213404`*^9, 3.77951346343019*^9}, {
   3.779586767081542*^9, 3.77958677211907*^9}, {3.7795868888997707`*^9, 
   3.7795868958880825`*^9}, {3.779586990537966*^9, 3.7795869920967975`*^9}, 
   3.77966542134295*^9, 3.779686750813852*^9, {3.7796868485774093`*^9, 
   3.7796868501821175`*^9}, {3.7796870496616616`*^9, 
   3.7796873001388254`*^9}, {3.7796873331086564`*^9, 
   3.7796873334986134`*^9}, {3.779687365481085*^9, 3.779687368936843*^9}, {
   3.7798578400838623`*^9, 3.779857852790865*^9}, {3.7798580861596704`*^9, 
   3.779858087830202*^9}, {3.779858136789215*^9, 3.7798581758945923`*^9}, {
   3.779858653320281*^9, 3.7798586579349337`*^9}, 3.779858723408764*^9, {
   3.779858787654879*^9, 3.779858807510757*^9}, {3.7798589390019627`*^9, 
   3.7798590099052672`*^9}, {3.779859926931079*^9, 3.7798599776244535`*^9}, 
   3.7798600711651926`*^9, {3.7798605352366304`*^9, 3.779860536931097*^9}, {
   3.7800139276885023`*^9, 3.7800139368908825`*^9}, {3.7801834354284816`*^9, 
   3.7801834375827184`*^9}, {3.7801837148549*^9, 3.780183739943776*^9}, {
   3.780183793436661*^9, 3.780183797045007*^9}, {3.7801839885845594`*^9, 
   3.7801840176886935`*^9}, {3.7801840691220875`*^9, 3.780184127624569*^9}, 
   3.780184508303096*^9, {3.780184780875852*^9, 3.7801847829672556`*^9}, {
   3.780185263594378*^9, 3.7801852887789984`*^9}, {3.780185337050852*^9, 
   3.7801853946278095`*^9}, {3.780185461754218*^9, 3.780185535314414*^9}, {
   3.780185605622311*^9, 3.7801856368477697`*^9}, {3.780185878072394*^9, 
   3.780185881288789*^9}, {3.78021704900165*^9, 3.780217117314226*^9}, {
   3.780217177223153*^9, 3.7802172098797827`*^9}, {3.780307547120505*^9, 
   3.780307575789802*^9}, 3.7803772971917114`*^9, {3.7803776440856256`*^9, 
   3.7803776724946203`*^9}, {3.7803777165308046`*^9, 3.780377762248491*^9}, {
   3.7803778003665094`*^9, 3.7803778848514767`*^9}, {3.7803781457684155`*^9, 
   3.7803781802800827`*^9}, {3.780378214480582*^9, 3.780378214825659*^9}, {
   3.7803783340915728`*^9, 3.7803783506004047`*^9}, {3.7803784550519533`*^9, 
   3.780378512821396*^9}, {3.7803789772957344`*^9, 3.780379033185207*^9}, {
   3.7803790808117867`*^9, 3.7803791094032917`*^9}, {3.7803791488836656`*^9, 
   3.7803792194379034`*^9}, {3.780379262836794*^9, 3.780379332177279*^9}, {
   3.780379588063677*^9, 3.780379608833109*^9}, {3.7803797006384916`*^9, 
   3.78037975011213*^9}, {3.780379785415678*^9, 3.780379896021761*^9}, {
   3.7803799307937317`*^9, 3.7803799344230213`*^9}, 3.7803800393313484`*^9, {
   3.780380075290143*^9, 3.7803801204313717`*^9}, {3.7803802037873597`*^9, 
   3.78038020976038*^9}, {3.780380254048889*^9, 3.7803802602193813`*^9}, {
   3.7803803404956083`*^9, 3.7803803498396096`*^9}, {3.780380403978765*^9, 
   3.7803804226508093`*^9}, 3.780380512264056*^9, {3.780380587243456*^9, 
   3.780380592710828*^9}, {3.7803806520151644`*^9, 3.7803806926644106`*^9}, {
   3.7803807642917776`*^9, 3.780380782322538*^9}, {3.7803910599443564`*^9, 
   3.7803910606295233`*^9}, {3.780391385625025*^9, 3.7803913923530245`*^9}, {
   3.780805507471404*^9, 3.7808055519993477`*^9}, {3.780805617711647*^9, 
   3.7808056393916793`*^9}, {3.7808057666773467`*^9, 3.780805770383437*^9}, {
   3.780805802623235*^9, 3.7808058403543506`*^9}, {3.7808060032029305`*^9, 
   3.7808060313337154`*^9}, 3.7808062858023243`*^9, 3.780806333312293*^9, {
   3.780806471951603*^9, 3.7808065466718187`*^9}, {3.780806617515399*^9, 
   3.7808066259987164`*^9}, {3.7808066643042955`*^9, 
   3.7808066944476995`*^9}, {3.7808067274444733`*^9, 
   3.7808068066397233`*^9}, {3.7808070097197046`*^9, 3.780807037948228*^9}, {
   3.7808071228392487`*^9, 3.7808071603170414`*^9}, {3.7808072669589057`*^9, 
   3.7808072737836576`*^9}, {3.7808073847748923`*^9, 3.780807400848914*^9}, {
   3.7808074327117205`*^9, 3.7808075033588257`*^9}, {3.780807583620225*^9, 
   3.7808075866251907`*^9}, {3.7808881436432877`*^9, 
   3.7808881965996943`*^9}, {3.780889008386162*^9, 3.7808890818218117`*^9}, {
   3.7808893263739357`*^9, 3.780889328532164*^9}, {3.7808893732914877`*^9, 
   3.780889460752637*^9}, {3.7808896566887484`*^9, 3.780889658044124*^9}, 
   3.7808898222361126`*^9, {3.7808900421900053`*^9, 3.7808900816913877`*^9}, {
   3.780890136592594*^9, 3.780890152240755*^9}, {3.7808912486821203`*^9, 
   3.7808912667408347`*^9}, {3.7808984619531994`*^9, 
   3.7808984621626396`*^9}, {3.780898637864852*^9, 3.780898643532697*^9}, {
   3.7808986993534455`*^9, 3.7808987225893173`*^9}, 3.7809081369614305`*^9, {
   3.780908470692111*^9, 3.780908499541973*^9}, {3.781171630241144*^9, 
   3.781171686761962*^9}, {3.7812616496668844`*^9, 3.781261653513595*^9}, {
   3.7812616975607777`*^9, 3.781261732655905*^9}, {3.7812617709215517`*^9, 
   3.781261852897283*^9}, {3.781261897786214*^9, 3.781261963124447*^9}, {
   3.7812620012903605`*^9, 3.781262023380275*^9}, {3.781262338870401*^9, 
   3.7812623610031996`*^9}, {3.781262412522396*^9, 3.7812624245163145`*^9}, {
   3.781262467167232*^9, 3.7812624922631054`*^9}, {3.7813882096817513`*^9, 
   3.781388234905283*^9}, {3.7813883460011244`*^9, 3.781388362884963*^9}, {
   3.7813884231687155`*^9, 3.781388515281333*^9}, {3.781388627000506*^9, 
   3.7813886694100685`*^9}, {3.7813887791734734`*^9, 3.781388821142215*^9}, {
   3.781388949498887*^9, 3.7813889500414352`*^9}, {3.7813894234601336`*^9, 
   3.781389445317669*^9}, {3.781389531035391*^9, 3.7813895767431316`*^9}, {
   3.781389625302246*^9, 3.781389626678564*^9}, {3.781389898824627*^9, 
   3.781389899181672*^9}, {3.7813899429336443`*^9, 3.7813899431650248`*^9}, {
   3.7813899996010704`*^9, 3.7813902056429486`*^9}, {3.7813902400688667`*^9, 
   3.7813902799452047`*^9}, {3.7813903468642097`*^9, 
   3.7813904127888746`*^9}, {3.7813905797991543`*^9, 3.781390580009592*^9}, {
   3.7813907389514537`*^9, 3.781390754629518*^9}, 3.7814323137093983`*^9, {
   3.781432447568187*^9, 3.781432480314597*^9}, {3.7814325370638046`*^9, 
   3.781432553972577*^9}, {3.7814329234787846`*^9, 3.781433015876639*^9}, {
   3.7814330699360404`*^9, 3.781433079846532*^9}, {3.78143318215094*^9, 
   3.7814332974575176`*^9}, {3.7814746651317945`*^9, 
   3.7814746731284046`*^9}, {3.7814747317067194`*^9, 3.781474740391489*^9}, {
   3.781474790245141*^9, 3.781474791860819*^9}, {3.781474852993302*^9, 
   3.78147485661661*^9}, {3.7814789368774805`*^9, 3.7814790151790385`*^9}, {
   3.7815195152178645`*^9, 3.781519536740296*^9}, {3.7815753509638076`*^9, 
   3.781575382734825*^9}, {3.7815754892190013`*^9, 3.781575530411818*^9}, {
   3.7818490621280355`*^9, 3.7818490656625834`*^9}, {3.7818497878872747`*^9, 
   3.7818497933077803`*^9}, {3.781849826804207*^9, 3.7818498302140894`*^9}, {
   3.781850047564869*^9, 3.7818501131728587`*^9}, {3.7819354867682695`*^9, 
   3.7819354870894103`*^9}, {3.782018005485952*^9, 3.782018006480293*^9}, {
   3.782018067567938*^9, 3.7820181277240744`*^9}, {3.7820181838519816`*^9, 
   3.7820181915424166`*^9}, 3.782030301099427*^9, {3.7820303514597583`*^9, 
   3.7820303567246785`*^9}, 3.7820304729389095`*^9, {3.782030504506494*^9, 
   3.782030504644126*^9}, {3.7820305647244644`*^9, 3.782030615069836*^9}, {
   3.7820307407477584`*^9, 3.7820307411905746`*^9}, {3.782031214933955*^9, 
   3.7820312261140585`*^9}, {3.7820994312345915`*^9, 
   3.7820994672113843`*^9}, {3.7820995249479904`*^9, 3.782099526112875*^9}, {
   3.7821139161907015`*^9, 3.7821139664981737`*^9}, {3.7821198562922173`*^9, 
   3.7821199087978115`*^9}, {3.7821199903208103`*^9, 3.782120013167715*^9}, {
   3.782120075601761*^9, 3.7821201152078495`*^9}, {3.7821202599727316`*^9, 
   3.7821202909129934`*^9}, {3.782189261764991*^9, 3.782189262077156*^9}, {
   3.7821893601369333`*^9, 3.782189366537817*^9}, {3.7822645120762815`*^9, 
   3.782264573822166*^9}, {3.7822682271639805`*^9, 3.782268269466857*^9}, {
   3.7822683036833596`*^9, 3.782268405159999*^9}, {3.7822685152396345`*^9, 
   3.7822685333871064`*^9}, {3.782268567456002*^9, 3.782268710871493*^9}, {
   3.782268834501892*^9, 3.7822688752180123`*^9}, {3.7822689105704775`*^9, 
   3.782268912543201*^9}, {3.782268947672261*^9, 3.782269002931492*^9}, {
   3.782269035177264*^9, 3.782269039197513*^9}, {3.7822691357612915`*^9, 
   3.7822691462691917`*^9}, {3.782269275802805*^9, 3.7822693108381157`*^9}, {
   3.782269353924897*^9, 3.782269356762311*^9}, {3.782269636672798*^9, 
   3.7822696542647552`*^9}, {3.7822697067583823`*^9, 3.782269712725425*^9}, {
   3.782269773448047*^9, 3.7822698905130014`*^9}, {3.7822700187809997`*^9, 
   3.782270020997074*^9}, {3.7822705365300283`*^9, 3.782270542520009*^9}, 
   3.782270593495694*^9, {3.7822721845889363`*^9, 3.7822722698289948`*^9}, 
   3.7822724628937197`*^9, {3.782272934053785*^9, 3.782272983234271*^9}, {
   3.782273813874049*^9, 3.7822738683763037`*^9}, {3.78227392607202*^9, 
   3.7822739744656105`*^9}, {3.7822740080109067`*^9, 3.782274023960255*^9}, {
   3.7822745773630285`*^9, 3.782274616427565*^9}, {3.782274844336113*^9, 
   3.7822748447160974`*^9}, {3.782293779695088*^9, 3.7822937871132507`*^9}, 
   3.782358922883029*^9, {3.7823589802576017`*^9, 3.7823590413781595`*^9}, {
   3.7823590818289905`*^9, 3.78235913050007*^9}, {3.7823591871964574`*^9, 
   3.782359279635265*^9}, 3.782359322882618*^9, {3.7823593590698485`*^9, 
   3.7823593739869585`*^9}, {3.7823594398009644`*^9, 
   3.7823594676265554`*^9}, {3.7823595194619417`*^9, 
   3.7823596029437027`*^9}, {3.782359648785118*^9, 3.7823596506790533`*^9}, {
   3.7823598036729307`*^9, 3.78235982011596*^9}, {3.782359881382128*^9, 
   3.782359925222893*^9}, {3.7823599592618685`*^9, 3.7823600288976545`*^9}, {
   3.782360118515009*^9, 3.7823601666303434`*^9}, {3.7823603255094833`*^9, 
   3.7823603547443066`*^9}, 3.7823604220922093`*^9, {3.782360500632185*^9, 
   3.7823606173640327`*^9}, {3.782379873760433*^9, 3.7823798804186287`*^9}, {
   3.7823801163689203`*^9, 3.782380130584905*^9}, {3.782380198221039*^9, 
   3.782380225304614*^9}, {3.7823802570916123`*^9, 3.782380262223888*^9}, {
   3.782380293195068*^9, 3.7823803839553647`*^9}, {3.7823804587044773`*^9, 
   3.782380497910636*^9}, {3.782380570656107*^9, 3.7823805854345875`*^9}, {
   3.7823806164855547`*^9, 3.782380634491404*^9}, 3.782381677080407*^9, {
   3.782381766019573*^9, 3.782381793799288*^9}, {3.7823818563390493`*^9, 
   3.7823819071033*^9}, {3.7823819425285687`*^9, 3.7823819619406586`*^9}, 
   3.782382096817983*^9, {3.7823821650315714`*^9, 3.782382184572318*^9}, {
   3.7823822501310062`*^9, 3.7823822504571342`*^9}, {3.782382335016014*^9, 
   3.7823823355964622`*^9}, {3.7823824181457167`*^9, 
   3.7823824788214626`*^9}, {3.7824714989468403`*^9, 3.782471558602315*^9}, {
   3.782471589052887*^9, 3.7824716030793786`*^9}, {3.782471644718032*^9, 
   3.782471644817765*^9}, {3.782471697755205*^9, 3.7824717080716176`*^9}, {
   3.7824717849639997`*^9, 3.7824717880567293`*^9}, {3.782471938011733*^9, 
   3.7824719748681746`*^9}, {3.7824721110420303`*^9, 3.782472142266533*^9}, {
   3.7824722354722905`*^9, 3.7824722620771456`*^9}, {3.7824723115518456`*^9, 
   3.7824724027918596`*^9}, {3.782472433304266*^9, 3.782472471388425*^9}, {
   3.782472567635051*^9, 3.782472630287511*^9}, {3.78247284052232*^9, 
   3.78247284452761*^9}, {3.7825140890105352`*^9, 3.782514100629465*^9}, {
   3.7825534201858616`*^9, 3.7825534451899977`*^9}, {3.7825535514249134`*^9, 
   3.7825535837594476`*^9}, {3.7825537796306667`*^9, 
   3.7825538393928556`*^9}, {3.7825538722559757`*^9, 3.782553905841166*^9}, {
   3.7825541602827606`*^9, 3.782554204573323*^9}, {3.7825542449872513`*^9, 
   3.782554275844735*^9}, {3.782554400998063*^9, 3.782554489173271*^9}, {
   3.7825546215054007`*^9, 3.7825546566145153`*^9}, {3.782554869814396*^9, 
   3.78255491613852*^9}, {3.7825549676597457`*^9, 3.782554985141*^9}, {
   3.7825550347283964`*^9, 3.7825550415232267`*^9}, {3.782555174812796*^9, 
   3.7825551998219194`*^9}, {3.7825555284611015`*^9, 3.782555530233362*^9}, {
   3.7825555953512297`*^9, 3.782555649585202*^9}, {3.782598368859758*^9, 
   3.782598372059203*^9}, {3.782598547726449*^9, 3.782598635290294*^9}, {
   3.782598667730545*^9, 3.782598677841508*^9}, {3.782598753792406*^9, 
   3.7825989182725687`*^9}, {3.7825989624713755`*^9, 3.782598966265231*^9}, {
   3.7825993184165397`*^9, 3.782599329921773*^9}, {3.782599378909774*^9, 
   3.7825993790424194`*^9}, {3.7825997132646723`*^9, 
   3.7825997428106627`*^9}, {3.782600307968369*^9, 3.78260032393966*^9}, {
   3.7826003807268047`*^9, 3.7826003980833917`*^9}, {3.7826004388094854`*^9, 
   3.7826004417406473`*^9}, {3.7826029154440737`*^9, 3.782602996864349*^9}, {
   3.7826030301383696`*^9, 3.782603041742339*^9}, {3.7826031362775416`*^9, 
   3.782603141132559*^9}, {3.7826037072088084`*^9, 3.7826037123570414`*^9}, {
   3.782605737821727*^9, 3.782605740778819*^9}, {3.7826057717111025`*^9, 
   3.782605809836152*^9}, {3.7826181074285693`*^9, 3.7826181091200457`*^9}, {
   3.7826181416640196`*^9, 3.7826181504724646`*^9}, {3.7827056778111115`*^9, 
   3.7827057002620754`*^9}, {3.782706168007274*^9, 3.7827061822242556`*^9}, {
   3.7831516305443363`*^9, 3.7831516559553847`*^9}, {3.7831604974426975`*^9, 
   3.7831605091264534`*^9}, {3.7833397650940323`*^9, 3.783339780269451*^9}, {
   3.78333981607271*^9, 3.7833398610364723`*^9}, {3.7833399961521573`*^9, 
   3.7833400236595993`*^9}, {3.7834064017623835`*^9, 
   3.7834064183540154`*^9}, {3.783406513638215*^9, 3.7834065171398516`*^9}, {
   3.7834067211951847`*^9, 3.7834067315903873`*^9}, {3.7834084346691675`*^9, 
   3.783408492150456*^9}, {3.7834090220999384`*^9, 3.783409166232438*^9}, {
   3.783409233053443*^9, 3.7834093302764482`*^9}, {3.7834094192958145`*^9, 
   3.7834094712016506`*^9}, {3.7834121027182474`*^9, 
   3.7834121028229675`*^9}, {3.7834121541387434`*^9, 3.783412198650614*^9}, {
   3.7834123333824177`*^9, 3.783412333724101*^9}, {3.783412364613903*^9, 
   3.783412373905274*^9}, {3.7834160035000134`*^9, 3.7834160863211813`*^9}, {
   3.78341627883186*^9, 3.78341628093324*^9}, {3.783416570573597*^9, 
   3.7834165851127176`*^9}, {3.783416677068817*^9, 3.7834166811110077`*^9}, {
   3.7834167245009785`*^9, 3.7834167248400717`*^9}, {3.7834196165584736`*^9, 
   3.7834196168088045`*^9}, {3.7834198846670747`*^9, 3.783419888223564*^9}, {
   3.783420001354041*^9, 3.7834200015076303`*^9}, {3.783421758582719*^9, 
   3.783421758828063*^9}, 3.7834224150341306`*^9, {3.783422451806223*^9, 
   3.783422454119038*^9}, {3.783422496355094*^9, 3.7834225134623475`*^9}, {
   3.7834225644041233`*^9, 3.783422586432218*^9}, {3.7834859244900584`*^9, 
   3.783485927372351*^9}, {3.7834914817148495`*^9, 3.78349148186445*^9}, {
   3.7834916068342667`*^9, 3.7834916141167927`*^9}, {3.7834916444736147`*^9, 
   3.7834916505304184`*^9}, {3.783505337627492*^9, 3.7835053636179905`*^9}, {
   3.7835063164091225`*^9, 3.7835063217269025`*^9}, {3.783506366562008*^9, 
   3.7835063669878693`*^9}, {3.7835064038891916`*^9, 
   3.7835064092438726`*^9}, {3.783507580080925*^9, 3.7835075890349817`*^9}, {
   3.783567752426464*^9, 3.78356776892335*^9}, {3.7838198677227516`*^9, 
   3.783819868135648*^9}, {3.7838199990066833`*^9, 3.7838200004468327`*^9}, {
   3.7838452992914524`*^9, 3.7838453013599186`*^9}, {3.783845520771189*^9, 
   3.7838455209457226`*^9}, {3.7838455513145137`*^9, 
   3.7838456017296977`*^9}, {3.783845741683446*^9, 3.7838457418011312`*^9}, {
   3.7838460446133785`*^9, 3.7838461319647903`*^9}, {3.783846524934945*^9, 
   3.7838465487362976`*^9}, {3.7840944316814485`*^9, 
   3.7840944549312754`*^9}, {3.7840945772432003`*^9, 3.784094613317733*^9}, {
   3.7840947482798295`*^9, 3.7840947800468807`*^9}, {3.7841061330948524`*^9, 
   3.7841061600058904`*^9}, 3.784106310079576*^9, {3.784106370147947*^9, 
   3.784106427973316*^9}, {3.784106602466701*^9, 3.7841066108951626`*^9}, {
   3.7841067205409575`*^9, 3.784106724462471*^9}, {3.784106786580361*^9, 
   3.7841068375390916`*^9}, {3.784106949505681*^9, 3.7841070118599386`*^9}, {
   3.784107091319456*^9, 3.784107097403187*^9}, {3.784107163138403*^9, 
   3.7841071739135895`*^9}, {3.784107244545711*^9, 3.784107247473881*^9}, {
   3.784107394647323*^9, 3.7841075141168485`*^9}, 3.784107571265028*^9, {
   3.784109295486271*^9, 3.7841093051913185`*^9}, {3.7841093450357704`*^9, 
   3.7841094507091875`*^9}, {3.7841094855360565`*^9, 
   3.7841095132290025`*^9}, {3.7841097306696215`*^9, 
   3.7841097315382986`*^9}, {3.7841097658944273`*^9, 3.784109766456922*^9}, {
   3.7841099643517303`*^9, 3.7841099906713486`*^9}, 3.784110052960779*^9, {
   3.7841101041229672`*^9, 3.784110193278554*^9}, 3.7841105037283773`*^9, 
   3.78411053435448*^9, {3.784156750499432*^9, 3.784156766767928*^9}, {
   3.7841579800125785`*^9, 3.7841579882475567`*^9}, {3.784158499455531*^9, 
   3.7841585116229935`*^9}, {3.784169043363319*^9, 3.784169065043344*^9}, {
   3.7841691065782747`*^9, 3.784169182057435*^9}, {3.78416922219211*^9, 
   3.784169278015832*^9}, {3.7841693791533794`*^9, 3.7841694058370256`*^9}, {
   3.784169439570816*^9, 3.7841694786303663`*^9}, 3.7841698318587947`*^9, {
   3.7841699179226513`*^9, 3.7841700234883566`*^9}, {3.7841700664295273`*^9, 
   3.7841700925566607`*^9}, {3.7841701289702864`*^9, 3.784170159936479*^9}, {
   3.784170481181435*^9, 3.784170487953327*^9}, {3.7843292013711452`*^9, 
   3.7843292095512705`*^9}, {3.7843726718828964`*^9, 3.784372681443331*^9}, {
   3.784415621030654*^9, 3.7844156256931844`*^9}, {3.7844157476152844`*^9, 
   3.7844157513143926`*^9}, {3.7844271742190447`*^9, 
   3.7844271781265955`*^9}, {3.784455234188792*^9, 3.7844552379607058`*^9}, {
   3.7845219705251226`*^9, 3.78452198693923*^9}, {3.7846311999160852`*^9, 
   3.784631206265108*^9}, {3.784695822825816*^9, 3.784695826250658*^9}, {
   3.7847065487146115`*^9, 3.784706619369673*^9}, {3.7847066533956833`*^9, 
   3.7847066568693943`*^9}, {3.7847067221907177`*^9, 3.784706754309828*^9}, 
   3.784711827792777*^9, {3.784711875900132*^9, 3.7847119388827105`*^9}, {
   3.784711974354854*^9, 3.7847119772949915`*^9}, {3.7851073445114565`*^9, 
   3.7851073469549227`*^9}, 3.78511929728771*^9, {3.7851196155400033`*^9, 
   3.7851197811790667`*^9}, {3.785119841183607*^9, 3.7851199259210105`*^9}, {
   3.785119989156911*^9, 3.7851199949723587`*^9}, {3.785120043937422*^9, 
   3.785120044499918*^9}, {3.7851201871005874`*^9, 3.7851202044102993`*^9}, {
   3.7851202543896503`*^9, 3.78512028257129*^9}, {3.7851204420468335`*^9, 
   3.7851205588664455`*^9}, {3.785120678639161*^9, 3.7851206788107014`*^9}, {
   3.7851208657158966`*^9, 3.78512087939332*^9}, {3.7851209921049175`*^9, 
   3.7851210271591787`*^9}, {3.7851222867718363`*^9, 
   3.7851222960350657`*^9}, {3.7851223275717325`*^9, 3.785122328583029*^9}, {
   3.785122409352043*^9, 3.78512241286864*^9}, {3.785125039228465*^9, 
   3.785125044422575*^9}, {3.7851255420408897`*^9, 3.785125549582721*^9}, {
   3.7851255810445895`*^9, 3.7851256511600924`*^9}, {3.785125760574506*^9, 
   3.7851258359379764`*^9}, {3.785125939575837*^9, 3.7851259396536293`*^9}, {
   3.785127351947002*^9, 3.7851273569256873`*^9}, {3.785127407458557*^9, 
   3.7851274414177465`*^9}, {3.7851280686195416`*^9, 3.785128083766037*^9}, {
   3.7851282013540897`*^9, 3.7851282198157225`*^9}, {3.7851282810928593`*^9, 
   3.7851283360239673`*^9}, {3.785128781534622*^9, 3.785128812160725*^9}, {
   3.785128882849696*^9, 3.7851288833453703`*^9}, {3.785129524587617*^9, 
   3.785129729731042*^9}, {3.7851305531501284`*^9, 3.785130562522067*^9}, {
   3.7851306511650257`*^9, 3.7851306733975744`*^9}, 3.785130816266526*^9, {
   3.785131008020754*^9, 3.785131056731498*^9}, {3.7851314389783263`*^9, 
   3.785131485839017*^9}, {3.7851315608554134`*^9, 3.785131571105005*^9}, {
   3.785131606571164*^9, 3.7851316319971733`*^9}, {3.7851323773520126`*^9, 
   3.7851324632509584`*^9}, {3.785132652463982*^9, 3.7851326726011353`*^9}, {
   3.785132745962956*^9, 3.78513274611854*^9}, {3.785134208949768*^9, 
   3.785134212889233*^9}, {3.7851342575158978`*^9, 3.785134304584032*^9}, {
   3.785134348998265*^9, 3.785134354901477*^9}, {3.7851972513783035`*^9, 
   3.785197263456006*^9}, {3.78519855873429*^9, 3.7851985751743274`*^9}, {
   3.7851986216560297`*^9, 3.7851986486957226`*^9}, {3.7852021928522587`*^9, 
   3.785202202113495*^9}, {3.7852024675097957`*^9, 3.785202474002434*^9}, {
   3.7852025377130632`*^9, 3.78520254211928*^9}, {3.7852026633052177`*^9, 
   3.7852026704730487`*^9}, {3.7852029965720243`*^9, 3.785203112359396*^9}, {
   3.7852031532809677`*^9, 3.7852031587573233`*^9}, {3.785203257602001*^9, 
   3.7852032589035215`*^9}, {3.7852035576955185`*^9, 
   3.7852036493913136`*^9}, {3.7852038271828794`*^9, 3.785203837203086*^9}, {
   3.7852038891960506`*^9, 3.7852038919756165`*^9}, {3.7852039503884153`*^9, 
   3.785203988714926*^9}, {3.785204027124216*^9, 3.7852040609876595`*^9}, {
   3.7852041193196735`*^9, 3.7852041354465485`*^9}, {3.7852042791163597`*^9, 
   3.7852043353130836`*^9}, {3.7852048347206125`*^9, 3.785204841794696*^9}, {
   3.7852049246980033`*^9, 3.78520504381946*^9}, 3.7852050800625415`*^9, {
   3.7852051135699396`*^9, 3.78520513102227*^9}, 3.7852051633528147`*^9, {
   3.7852052601340113`*^9, 3.785205309189831*^9}, {3.7852053555348997`*^9, 
   3.7852054292906675`*^9}, {3.7852054774249516`*^9, 
   3.7852054854135895`*^9}, {3.7852055182098894`*^9, 3.785205576184857*^9}, 
   3.7852056240977316`*^9, {3.785205820818681*^9, 3.785205896675828*^9}, {
   3.785205965464878*^9, 3.7852059707736826`*^9}, {3.7852071841410046`*^9, 
   3.7852072154373155`*^9}, {3.785207817267954*^9, 3.7852078647110853`*^9}, {
   3.7853004938176565`*^9, 3.7853005274357586`*^9}, {3.785300603991041*^9, 
   3.7853006078447375`*^9}, {3.7853010258738804`*^9, 
   3.7853010561319666`*^9}, {3.785301337768839*^9, 3.785301396976511*^9}, {
   3.785301483228863*^9, 3.7853015290732713`*^9}, {3.7853016766316824`*^9, 
   3.7853016985680227`*^9}, 3.785301939541147*^9, 3.7853020091589804`*^9, {
   3.7853026274835124`*^9, 3.7853026309332876`*^9}, {3.7855741334214687`*^9, 
   3.7855741655355916`*^9}, {3.7855750163962965`*^9, 
   3.7855750678118057`*^9}, {3.785577379074295*^9, 3.785577379377484*^9}, {
   3.785579003227131*^9, 3.785579006929231*^9}, {3.7855790901257553`*^9, 
   3.7855791040445347`*^9}, {3.7855792043882046`*^9, 3.7855792633505325`*^9}, 
   3.785579296778144*^9, {3.7855794779706163`*^9, 3.7855794781980076`*^9}, {
   3.7855795212099886`*^9, 3.7855795220786653`*^9}, {3.785579649976652*^9, 
   3.7855796959816303`*^9}, {3.785579739052454*^9, 3.7855797434536843`*^9}, {
   3.785579998951455*^9, 3.785580026601516*^9}, {3.785580392209839*^9, 
   3.785580414600963*^9}, {3.7855804539437556`*^9, 3.7855804692986946`*^9}, 
   3.785580522075564*^9, {3.785638686319376*^9, 3.78563868699457*^9}, {
   3.785638867602605*^9, 3.785638891780949*^9}, {3.785638929130073*^9, 
   3.78563892998379*^9}, {3.7856417475270834`*^9, 3.785641790584942*^9}, 
   3.785641827392514*^9, {3.785743903911502*^9, 3.7857439138239946`*^9}, {
   3.785744301713735*^9, 3.785744334516019*^9}, {3.7857446336141973`*^9, 
   3.7857446337488375`*^9}, {3.7857448487040243`*^9, 
   3.7857448653505087`*^9}, {3.7859222472788935`*^9, 3.785922255202715*^9}, {
   3.785988741636729*^9, 3.7859887463321795`*^9}, {3.7860082625852127`*^9, 
   3.786008266201547*^9}, {3.7860138102187843`*^9, 3.7860138144534664`*^9}, {
   3.7860143494186387`*^9, 3.7860143521024656`*^9}, {3.7860612826769075`*^9, 
   3.7860612889760714`*^9}, {3.786061563364881*^9, 3.786061566776762*^9}, {
   3.7860625241921787`*^9, 3.786062527369686*^9}, {3.786165471119266*^9, 
   3.786165480068347*^9}, {3.786177977196444*^9, 3.786177997757489*^9}, {
   3.7861788585926933`*^9, 3.7861789196136003`*^9}, {3.786179784901902*^9, 
   3.786179812463238*^9}, {3.7861804791722927`*^9, 3.7861804846406765`*^9}, {
   3.786180659782566*^9, 3.78618066156979*^9}, {3.7861843361685123`*^9, 
   3.7861843381502156`*^9}, {3.786184427197215*^9, 3.786184432675573*^9}, {
   3.786184487157955*^9, 3.7861845046312532`*^9}, {3.7861850139050922`*^9, 
   3.786185058117923*^9}, {3.7861853192818975`*^9, 3.7861853225591383`*^9}, {
   3.786186287646701*^9, 3.7861863099451036`*^9}, {3.786186392831569*^9, 
   3.78618642132641*^9}, {3.786186474976018*^9, 3.786186511079522*^9}, {
   3.786186587396546*^9, 3.786186614828228*^9}, {3.786186785386369*^9, 
   3.7861867875735235`*^9}, {3.786224225058548*^9, 3.786224304930071*^9}, 
   3.7862243597056704`*^9, {3.7862243914069405`*^9, 3.78622440486896*^9}, {
   3.786224552453503*^9, 3.7862245563720303`*^9}, {3.7862246115016823`*^9, 
   3.78622473347069*^9}, {3.7862247795944133`*^9, 3.7862247909959393`*^9}, {
   3.7862249655005326`*^9, 3.786225023968263*^9}, {3.786225506679098*^9, 
   3.786225506981291*^9}, {3.786230899818508*^9, 3.7862309054674106`*^9}, {
   3.7862309438019514`*^9, 3.7862309477873*^9}, {3.7862320390127287`*^9, 
   3.7862320401816053`*^9}, {3.786232612866961*^9, 3.786232816162603*^9}, {
   3.7862328632437673`*^9, 3.786232864366766*^9}, 3.7863176954100103`*^9, {
   3.786317737206299*^9, 3.7863178459715967`*^9}, 3.7863180081152277`*^9, 
   3.786318069707607*^9, {3.786319933473379*^9, 3.7863199414460707`*^9}, {
   3.78632012759155*^9, 3.7863201407214575`*^9}, {3.7863205420936904`*^9, 
   3.7863205491019588`*^9}, {3.786320616304344*^9, 3.7863206546877546`*^9}, {
   3.7863291014011326`*^9, 3.7863291533103924`*^9}, {3.786329242840102*^9, 
   3.7863293268306165`*^9}, {3.786329584875926*^9, 3.786329594015498*^9}, {
   3.786329924065358*^9, 3.7863299276248446`*^9}, {3.7863301148245068`*^9, 
   3.786330162701544*^9}, {3.786330197396812*^9, 3.7863302330086308`*^9}, {
   3.786335826828849*^9, 3.786335931032339*^9}, {3.786335963794775*^9, 
   3.7863359972633204`*^9}, 3.78633605894147*^9, {3.7863363382549353`*^9, 
   3.786336345943386*^9}, {3.786444595601116*^9, 3.786444613528201*^9}, {
   3.7864449475464554`*^9, 3.78644501541107*^9}, {3.786445051395891*^9, 
   3.7864450592199793`*^9}, {3.7864451187139673`*^9, 
   3.7864451207415476`*^9}, {3.786595703119054*^9, 3.786595718266569*^9}, {
   3.786595759775625*^9, 3.7865957928951054`*^9}, {3.786595860783656*^9, 
   3.7865958614778013`*^9}, {3.7865959729985332`*^9, 
   3.7865960534365425`*^9}, {3.786596102147352*^9, 3.7865962715196614`*^9}, 
   3.786596324730442*^9, {3.786596357440018*^9, 3.7865963630719657`*^9}, {
   3.7865964402816033`*^9, 3.7865964446898212`*^9}, 3.7865965850217495`*^9, {
   3.786596641249467*^9, 3.7865967594365835`*^9}, {3.786596980066893*^9, 
   3.7865971625661187`*^9}, 3.786597203267335*^9, {3.7865972416417694`*^9, 
   3.78659724175746*^9}, 3.7865984561836047`*^9, {3.7865997725682397`*^9, 
   3.786599772653013*^9}, {3.78661032624697*^9, 3.7866103373492966`*^9}, {
   3.786611334384473*^9, 3.7866113477377825`*^9}, {3.7866113872122774`*^9, 
   3.7866113873329554`*^9}, {3.7866114608933463`*^9, 
   3.7866114837642183`*^9}, {3.7866118520758142`*^9, 
   3.7866118688958583`*^9}, {3.786661007857752*^9, 3.7866610244653645`*^9}, {
   3.7866614534547844`*^9, 3.786661489876438*^9}, {3.7866615316687374`*^9, 
   3.7866615409618998`*^9}, {3.7866617645483093`*^9, 
   3.7866617646400642`*^9}, {3.786661869516755*^9, 3.786661892089424*^9}, {
   3.786661951905551*^9, 3.7866619528799467`*^9}, {3.7866620091176367`*^9, 
   3.7866620094856534`*^9}, {3.7866627360587063`*^9, 
   3.7866627361724024`*^9}, {3.7866759322821827`*^9, 3.78667594168904*^9}, {
   3.786677384944287*^9, 3.786677395182922*^9}, {3.7866807362471347`*^9, 
   3.7866807821225214`*^9}, {3.7866810167953*^9, 3.7866811206796436`*^9}, {
   3.786681182673949*^9, 3.7866812234479694`*^9}, {3.786681258208065*^9, 
   3.7866812621465387`*^9}, {3.7866814989077363`*^9, 
   3.7866815952572165`*^9}, {3.7866816510441127`*^9, 3.786681675220496*^9}, {
   3.786682042696325*^9, 3.786682056657012*^9}, {3.7866996462577496`*^9, 
   3.786699776990334*^9}, {3.7867005532655463`*^9, 3.786700568346239*^9}, {
   3.7867007273103676`*^9, 3.7867007351434317`*^9}, {3.7867635919658136`*^9, 
   3.7867635972317395`*^9}, {3.786861501388754*^9, 3.7868615137178016`*^9}, {
   3.7868619932553663`*^9, 3.786862017456682*^9}, {3.786960132628612*^9, 
   3.786960155854536*^9}, {3.787284245243659*^9, 3.787284260597622*^9}, {
   3.7872952788883295`*^9, 3.787295310990528*^9}, {3.787567882622756*^9, 
   3.7875679270849185`*^9}, {3.7879966061007347`*^9, 
   3.7879966067140956`*^9}, {3.800597410189348*^9, 3.800597425705826*^9}, {
   3.8005974766714396`*^9, 3.8005975096432066`*^9}, {3.8048370254904704`*^9, 
   3.8048370461701717`*^9}, {3.804837201971548*^9, 3.8048372290820527`*^9}, {
   3.804838704437671*^9, 3.8048387200579014`*^9}, {3.804907478092116*^9, 
   3.8049074938729167`*^9}, {3.8050874708907166`*^9, 3.8050874721333942`*^9}, 
   3.805087655841147*^9, {3.8050877688349943`*^9, 3.805087779862506*^9}, {
   3.805087912808*^9, 3.805087956627824*^9}, 3.8050880419546537`*^9, {
   3.805088136602826*^9, 3.805088137667978*^9}, {3.8050881686740656`*^9, 
   3.805088194868021*^9}, {3.8050883512807627`*^9, 3.8050883530989017`*^9}, {
   3.8050883976776943`*^9, 3.805088422758626*^9}, 3.8050885213310375`*^9, {
   3.8050885618806047`*^9, 3.8050885646043224`*^9}, {3.8050886670713177`*^9, 
   3.805088680512376*^9}, {3.805189326472845*^9, 3.8051893289203005`*^9}, {
   3.8051893598017216`*^9, 3.8051893953875628`*^9}, {3.8051894652467546`*^9, 
   3.8051894656486783`*^9}, {3.8051895777279716`*^9, 3.805189628210978*^9}, {
   3.8051897110473366`*^9, 3.805189728414895*^9}, 3.805189759707217*^9, {
   3.805190082960986*^9, 3.805190084340299*^9}, {3.8051902049761057`*^9, 
   3.8051902267129803`*^9}, {3.8051902673941956`*^9, 3.805190277248844*^9}, {
   3.8051905326795034`*^9, 3.805190577591405*^9}, {3.805190621917873*^9, 
   3.8051906346538157`*^9}, {3.805190935682101*^9, 3.8051909361598225`*^9}, {
   3.8052459893939323`*^9, 3.8052459958396955`*^9}, {3.805246133059841*^9, 
   3.8052461496065936`*^9}, 3.805246192675424*^9, {3.805246330088971*^9, 
   3.805246381678482*^9}, {3.8052464409699316`*^9, 3.805246479957676*^9}, {
   3.80524679053039*^9, 3.80524680741823*^9}, {3.8052468645025826`*^9, 
   3.8052469260917635`*^9}, {3.8052469704710894`*^9, 
   3.8052469948808165`*^9}, {3.8052470470632772`*^9, 3.805247127323654*^9}, {
   3.805249058487568*^9, 3.805249071594519*^9}, {3.80525862792284*^9, 
   3.8052586826375294`*^9}, {3.8052702186985064`*^9, 
   3.8052702193158555`*^9}, {3.805425538504809*^9, 3.805425538959592*^9}, {
   3.8059430960858088`*^9, 3.8059431245436974`*^9}, {3.8059433689719667`*^9, 
   3.8059433717874374`*^9}, {3.8059436153300743`*^9, 3.805943637248453*^9}, {
   3.8059437234838147`*^9, 3.8059437363713465`*^9}, {3.805944306134498*^9, 
   3.8059444221711545`*^9}, {3.8059444779938555`*^9, 
   3.8059445829152403`*^9}, {3.805944614057948*^9, 3.8059446186726065`*^9}, {
   3.805944767618246*^9, 3.805944800514265*^9}, {3.805944868841522*^9, 
   3.80594487747942*^9}, {3.8059449255967283`*^9, 3.805944926072456*^9}, {
   3.8059450496888404`*^9, 3.8059450877021728`*^9}, {3.805945120323925*^9, 
   3.8059451248757505`*^9}, {3.805963442556514*^9, 3.805963528836755*^9}, 
   3.8059636632113667`*^9, {3.8059637811489387`*^9, 3.805963790336366*^9}, {
   3.805964061451697*^9, 3.8059640667325735`*^9}, {3.8062112326425805`*^9, 
   3.8062112665050154`*^9}, 3.8062113014405794`*^9, 3.806211338788692*^9, {
   3.806211424702914*^9, 3.806211458567343*^9}, 3.8062118174263926`*^9, {
   3.806212386581184*^9, 3.806212401912181*^9}, {3.806457482949008*^9, 
   3.806457488689655*^9}, {3.8065587422699018`*^9, 3.8065587981574297`*^9}, {
   3.806559873193921*^9, 3.8065598778035936`*^9}, {3.8065599828056593`*^9, 
   3.8065599950768394`*^9}, {3.806561578463416*^9, 3.8065615979034433`*^9}, {
   3.806561706851062*^9, 3.806561719846306*^9}, {3.8067097518586073`*^9, 
   3.80670975284098*^9}, {3.806709812798623*^9, 3.806709817890006*^9}, {
   3.806709910784559*^9, 3.8067099165700855`*^9}, {3.8067100178472204`*^9, 
   3.8067100211763163`*^9}, {3.8077556297921104`*^9, 3.807755812359711*^9}, {
   3.807755886085484*^9, 3.8077558960747595`*^9}, {3.8077559909669065`*^9, 
   3.807755992551668*^9}, {3.8079310670399113`*^9, 3.807931069805513*^9}, {
   3.8121620074023304`*^9, 3.8121620093331647`*^9}, 3.81345970287914*^9, 
   3.8134597478298893`*^9, {3.813459786620119*^9, 3.813459789731795*^9}, {
   3.813460452914672*^9, 3.813460462583805*^9}, {3.813464705658369*^9, 
   3.8134647382232533`*^9}, {3.8134648011100206`*^9, 3.813464805908184*^9}, {
   3.8134648694129496`*^9, 3.813464872667244*^9}, {3.8134649159226794`*^9, 
   3.8134649578036413`*^9}, {3.8134649886950026`*^9, 
   3.8134650039860954`*^9}, {3.8207205016508465`*^9, 3.820720511132491*^9}, {
   3.824000821813737*^9, 3.824000821979292*^9}},
 CellLabel->
  "In[5573]:=",ExpressionUUID->"0c374017-817d-4a1c-a017-adba2b317455"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["phonon number fitting by blue",
 FontSlant->"Plain"]], "Subsubsection",
 CellChangeTimes->{{3.776315521507967*^9, 3.7763155342708197`*^9}, {
  3.7775056698746724`*^9, 
  3.7775056713946075`*^9}},ExpressionUUID->"c8f1241d-67ca-4e9e-b35d-\
99f41e367b04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{
   "\[Alpha]V", ",", "\[Alpha]Cur", ",", "\[Eta]fitting", ",", "Repeattimes", 
    ",", "PhononNumberFittingBlue", ",", "errorBar"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]V", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Cur", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]fitting", "=", "0.08"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Repeattimes", "=", "200"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"errorBar", "[", 
     RowBox[{"type_:", " ", "\"\<Rectangle\>\""}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0_", ",", " ", "x1_"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"y0_", ",", " ", "y1_"}], "}"}]}], "}"}], ",", " ", "value_", 
     ",", " ", "\n", "    ", "meta_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "error", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"error", " ", "=", " ", 
       RowBox[{"Flatten", "[", "meta", "]"}]}], ";", "\n", "    ", 
      RowBox[{"error", " ", "=", " ", "\n", "     ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"error", " ", "===", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "0", ",", " ", "\n", "      ", 
         RowBox[{"Last", "[", "error", "]"}]}], "]"}]}], ";", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ChartElementData", "[", "type", "]"}], "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x0", ",", " ", "x1"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"y0", ",", " ", "y1"}], "}"}]}], "}"}], ",", " ", "\n", 
          "      ", "value", ",", " ", "meta"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Black", ",", " ", "\n", "      ", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x0", " ", "+", " ", "x1"}], ")"}], "/", "2"}], 
                 ",", " ", 
                 RowBox[{"y1", " ", "-", " ", "error"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x0", " ", "+", " ", "x1"}], ")"}], "/", "2"}], 
                 ",", " ", "\n", "          ", 
                 RowBox[{"y1", " ", "+", " ", "error"}]}], "}"}]}], "}"}], 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "/", "3"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "x0"}], " ", "+", " ", "x1"}], ")"}]}], 
                 ",", " ", "\n", "          ", 
                 RowBox[{"y1", " ", "+", " ", "error"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "/", "3"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"x0", " ", "+", " ", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", " ", "\n", 
                 "          ", 
                 RowBox[{"y1", " ", "+", " ", "error"}]}], "}"}]}], "}"}], 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "/", "3"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "x0"}], " ", "+", " ", "x1"}], ")"}]}], 
                 ",", " ", "\n", "          ", 
                 RowBox[{"y1", " ", "-", " ", "error"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "/", "3"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"x0", " ", "+", " ", 
                    RowBox[{"2", " ", "x1"}]}], ")"}]}], ",", " ", 
                 RowBox[{"y1", " ", "-", " ", "error"}]}], "}"}]}], "}"}]}], 
            "}"}], "]"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhononNumberFittingBlue", "[", 
    RowBox[{"blue_List", ",", "b\[Pi]fitting_", ",", 
     RowBox[{"kmax_Integer:", "15"}], ",", 
     RowBox[{"symbol_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"red", ",", 
       RowBox[{"(*", 
        RowBox[{"blue", ","}], "*)"}], "nred", ",", "nblue", ",", "Ared", ",",
        "Ablue", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", 
       "level", ",", "Pk", ",", "p", ",", "Zero", ",", "zero", ",", "Origin", 
       ",", "Pred", ",", "Pblue", ",", "\[Chi]red", ",", "\[Chi]blue", ",", 
       "na", ",", "V", ",", "Cur", ",", "\[Chi]", ",", "result", ",", 
       "distribution1", ",", "distribution2", ",", "\[Alpha]", ",", "nbar", 
       ",", "fittingred", ",", "fittingblue", ",", "Fred", ",", "Fblue", ",", 
       "dev", ",", "param", ",", "parabolic", ",", "RMS", ",", "rms", ",", 
       "fittingpara", ",", "findpoint", ",", "bestfitting", ",", "bestvalue", 
       ",", "unc", ",", "devlength", ",", "devnumber", ",", "Deviation", ",", 
       "Param", ",", "Parabolic", ",", "pkbestfitting", ",", "pkbestvalue", 
       ",", "DataDeviation", ",", "DataPk", ",", "\[Sigma]\[Chi]", ",", 
       "Uncertain", ",", "interval", ",", "finalfitting", ",", "ddev", ",", 
       "normalization", ",", "i", ",", "j", ",", "n", ",", "x", ",", "t", ",",
        "newdistribution", ",", "a", ",", "b", ",", "c", ",", "prob", ",", 
       "averagephononnumber", ",", "phononnumberfluctuation"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"blue", "=", 
        RowBox[{"Average", "[", 
         RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"nblue", "=", 
        RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ablue", "=", "0.95"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalOmega]b", "=", 
        RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"level", "=", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Pk", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"p", ",", 
          RowBox[{"kmax", "+", "5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Zero", "=", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{"zero", ",", 
           RowBox[{"kmax", "+", "5"}]}], "]"}], "*", "0"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Origin", "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Most", "[", 
               RowBox[{"Most", "[", "Zero", "]"}], "]"}], ",", 
              "\[CapitalOmega]b"}], "]"}], ",", "Ablue"}], "]"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Origin", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Drop", "[", 
               RowBox[{"Zero", ",", 
                RowBox[{"-", "3"}]}], "]"}], ",", "\[CapitalOmega]b"}], "]"}],
             ",", "Ablue"}], "]"}], ",", "Ablue"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pblue", "[", 
         RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"kmax", "+", "5"}], "]"}], "]"}], "-", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "4"}], "]"}], "]"}], " ", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"p", "[", 
                   RowBox[{"[", 
                    RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], "*", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"i", "+", "1"}], ")"}], "0.7"], "*", " ", "t"}]], 
               " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{"i", "+", "1"}]]], 
                 RowBox[{"LaguerreL", "[", 
                  RowBox[{"i", ",", "1", ",", 
                   SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"kmax", "+", "3"}], "]"}], "]"}], " ", "t"}], 
                "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]", "[", "Pk_List", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"i", "=", "1"}], "nblue"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Pblue", "[", 
               RowBox[{"Pk", ",", 
                RowBox[{"blue", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
              RowBox[{"blue", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], ")"}],
          "/", 
         RowBox[{"(", "nblue", ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"na", "=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         RowBox[{"i", " ", 
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"i", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"i", "-", "na"}], ")"}]}], ")"}], "2"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Cur", "=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], 
          RowBox[{"kmax", "-", "1"}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", "i", "]"}], "+", 
            RowBox[{"p", "[", 
             RowBox[{"i", "+", "2"}], "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"p", "[", 
              RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], "2"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"FindArgMin", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", "nblue", ")"}], "*", 
              RowBox[{"\[Chi]", "[", "Pk", "]"}]}], "+", 
             RowBox[{"\[Alpha]V", "*", "V"}], "+", 
             RowBox[{"\[Alpha]Cur", "*", "Cur"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"i", "=", "1"}], 
                RowBox[{"kmax", "+", "1"}]], 
               RowBox[{"p", "[", "i", "]"}]}], "<=", "1"}], "&&", 
             RowBox[{"Apply", "[", 
              RowBox[{"And", ",", 
               RowBox[{"Thread", "[", 
                RowBox[{"Pk", "\[GreaterEqual]", "Zero"}], "]"}]}], "]"}], "&&", 
             RowBox[{"Apply", "[", 
              RowBox[{"And", ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"Take", "[", 
                  RowBox[{"Pk", ",", 
                   RowBox[{"kmax", "+", "1"}]}], "]"}], "\[LessEqual]", 
                 RowBox[{"Table", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
              "]"}], "&&", 
             RowBox[{"(", 
              RowBox[{"0.9", "<=", 
               RowBox[{"p", "[", 
                RowBox[{"kmax", "+", "4"}], "]"}], "\[LessEqual]", "1"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"0.9", "<=", 
               RowBox[{"p", "[", 
                RowBox[{"kmax", "+", "5"}], "]"}], "\[LessEqual]", "1"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.95", "\[CapitalOmega]b"}], "<=", 
               RowBox[{"p", "[", 
                RowBox[{"kmax", "+", "3"}], "]"}], "\[LessEqual]", " ", 
               RowBox[{"1.05", "*", "\[CapitalOmega]b"}]}], ")"}]}]}], "}"}], 
          ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"Pk", ",", "Origin"}], "}"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"devlength", "=", "0.0005"}], ";", "\[IndentingNewLine]", 
       RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Deviation", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"dev", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"kmax", "+", "1"}], ",", 
            RowBox[{
             RowBox[{"2", "devnumber"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"kmax", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{
             RowBox[{"2", " ", "devnumber"}], "+", "1"}]}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"Deviation", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "devnumber", "-", "1"}], ")"}], 
                "devlength"}], "devnumber"], 
              RowBox[{"result", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "+", 
             RowBox[{"result", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Param", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Array", "[", 
           RowBox[{"param", ",", 
            RowBox[{"kmax", "+", "1"}]}], "]"}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Parabolic", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"parabolic", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", 
          RowBox[{"kmax", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RMS", "=", 
              RowBox[{"Array", "[", 
               RowBox[{"rms", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"2", "devnumber"}], "+", "1"}], ",", "2"}], 
                 "}"}]}], "]"}]}], ",", 
             RowBox[{"fittingpara", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"Param", ",", 
                  RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], 
             ",", 
             RowBox[{"findpoint", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"result", ",", 
                  RowBox[{"kmax", "+", "1"}]}], "]"}], ",", "i"}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "\[LessEqual]", 
                RowBox[{
                 RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"RMS", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", 
                  RowBox[{"Deviation", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"RMS", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
                  RowBox[{"FindMinValue", "[", 
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", 
                    RowBox[{"i", "\[Rule]", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"fittingpara", ",", "findpoint"}], "}"}], "]"}]}],
                    "]"}]}]}], "}"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"Parabolic", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"Fit", "[", 
               RowBox[{"RMS", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "x", ",", 
                  SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ",", 
             RowBox[{"Clear", "[", 
              RowBox[{"RMS", ",", "fittingpara", ",", "findpoint"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"Parabolic", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pkbestfitting", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"bestfitting", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pkbestvalue", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"bestvalue", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", 
          RowBox[{"kmax", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"pkbestfitting", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"FindArgMin", "[", 
                RowBox[{
                 RowBox[{"Parabolic", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"pkbestvalue", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"FindMinValue", "[", 
               RowBox[{
                RowBox[{"Parabolic", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"pkbestfitting", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
             RowBox[{
              RowBox[{"pkbestvalue", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "}"}]}], "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"kmax", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pkbestfitting", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", "0"}], 
            ",", 
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pkbestfitting", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"normalization", "=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         RowBox[{"pkbestfitting", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"DataDeviation", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"ddev", ",", 
          RowBox[{"Length", "[", "blue", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataPk", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"pkbestfitting", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "=", "1"}], ";", 
          RowBox[{"j", "=", "1"}]}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{
          RowBox[{"ddev", "[", 
           RowBox[{"n", "++"}], "]"}], "=", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{"DataPk", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]\[Chi]", "=", 
        RowBox[{"1.96", "*", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"DataDeviation", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], 
            "]"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
            SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Uncertain", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"unc", ",", 
          RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", 
          RowBox[{"kmax", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"interval", "=", 
              RowBox[{"x", "/.", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{"Parabolic", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
                 RowBox[{
                  RowBox[{"pkbestvalue", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", "\[Sigma]\[Chi]"}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Uncertain", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"interval", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"pkbestfitting", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"interval", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"pkbestfitting", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"finalfitting", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DataPk", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], 
           "\[Rule]", " ", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fittingblue", "=", 
        RowBox[{"Pblue", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"pkbestfitting", ",", 
            RowBox[{"Take", "[", 
             RowBox[{"result", ",", 
              RowBox[{"-", "4"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Fblue", "=", 
        RowBox[{"Plot", "[", 
         RowBox[{"fittingblue", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"blue", "[", 
             RowBox[{"[", 
              RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}],
           ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<t(us)\>\"", ",", "\"\<Spin up population\>\""}], 
            "}"}]}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"averagephononnumber", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DataPk", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "*", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"phononnumberfluctuation", "=", 
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "*", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", 
        RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], "*)"}], ";", 
      RowBox[{"(*", 
       RowBox[{"distribution", "+", 
        RowBox[{"error", " ", "bar"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Distribution \>\"", ",", " ", 
          RowBox[{
           RowBox[{"finalfitting", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Error Bar \>\"", ",", " ", 
          RowBox[{
           RowBox[{"finalfitting", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", 
          ",", 
          RowBox[{"result", "[", 
           RowBox[{"[", 
            RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"symbol", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Pi]b\), \(0, 1\)]\) = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"\[Pi]", "/", 
            RowBox[{"result", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], "]"}], "<>", 
          "\"\<, Average phonon number: \>\"", "<>", 
          RowBox[{"ToString", "@", "averagephononnumber"}], "<>", 
          "\"\<\[PlusMinus]\>\"", "<>", 
          RowBox[{"ToString", "@", "phononnumberfluctuation"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<WFA = \>\"", ",", 
          RowBox[{
           FractionBox["2", "\[Pi]"], 
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"i", "-", "1"}]], 
               RowBox[{
                RowBox[{
                 StyleBox["finalfitting",
                  FontWeight->"Plain"], 
                 StyleBox["[",
                  FontWeight->"Bold"], 
                 StyleBox[
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}],
                  FontWeight->"Bold"], 
                 StyleBox["]",
                  FontWeight->"Bold"]}], "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"finalfitting", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
             "]"}], "]"}]}], ",", "\"\< \[PlusMinus] \>\"", ",", 
          RowBox[{
           FractionBox["2", "\[Pi]"], 
           SuperscriptBox[
            RowBox[{"Total", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{
                 RowBox[{"finalfitting", 
                  StyleBox["[",
                   FontWeight->"Bold"], 
                  StyleBox[
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}],
                   FontWeight->"Bold"], 
                  StyleBox["]",
                   FontWeight->"Bold"]}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "2"], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"finalfitting", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}], 
            FractionBox["1", "2"]]}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"symbol", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"symbol", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"BarChart", "[", 
          RowBox[{"finalfitting", ",", 
           RowBox[{"ChartElementFunction", "\[Rule]", 
            RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", 
                  "1"}], "}"}], ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", 
                "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"prob", "=", 
         RowBox[{"BarChart", "[", 
          RowBox[{"finalfitting", ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"ChartElementFunction", "\[Rule]", 
              RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ","}], 
            "*)"}], 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", 
                  "1"}], "}"}], ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", 
                "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
         "\"\<F:\\\\Experiments\\\\Phonon Shift_Wigner \
Function\\\\Paper\\\\Figures\\\\SuperPos01Add3Prob.jpg\>\"", ",", "prob", ",", 
          RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"symbol", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Show", "[", 
          RowBox[{"Fblue", ",", 
           RowBox[{"ListPlot", "[", 
            RowBox[{"blue", ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
               "}"}]}]}], "]"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"List", "@@", "#"}], "&"}], "/@", "finalfitting"}], ",", 
        RowBox[{"Param", "\[LeftDoubleBracket]", 
         RowBox[{"kmax", "+", "5"}], "\[RightDoubleBracket]"}], ",", 
        "averagephononnumber", ",", "phononnumberfluctuation", ",", 
        RowBox[{"\[Pi]", "/", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}]}], "}"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7765547445441008`*^9, {3.776854774742101*^9, 3.776854782013646*^9}, 
   3.7768548418355913`*^9, 3.7769172775058517`*^9, 3.7769173688684096`*^9, {
   3.776917418270234*^9, 3.7769174189603887`*^9}, {3.7769182864198155`*^9, 
   3.7769183391617036`*^9}, {3.7769183706414795`*^9, 
   3.7769184297672873`*^9}, {3.776918489116497*^9, 3.776918594284119*^9}, 
   3.776918644259409*^9, {3.7773722490094523`*^9, 3.777372262160284*^9}, 
   3.7773723704187746`*^9, {3.7773724380748463`*^9, 3.7773724440428867`*^9}, {
   3.7773725694594917`*^9, 3.777372569592138*^9}, {3.777372617443172*^9, 
   3.77737261767954*^9}, {3.777372801076094*^9, 3.777372853151831*^9}, {
   3.7773732849747114`*^9, 3.777373301239216*^9}, {3.7773736761555996`*^9, 
   3.777373678470409*^9}, {3.7773738928201857`*^9, 3.777373903340054*^9}, {
   3.7774189300488396`*^9, 3.777418932679804*^9}, {3.7774286275872965`*^9, 
   3.777428649171575*^9}, {3.777431430311141*^9, 3.7774314487558155`*^9}, {
   3.7774315108866634`*^9, 3.777431515069476*^9}, {3.7774387338696747`*^9, 
   3.7774387468160543`*^9}, {3.7774387983392673`*^9, 3.777438817200827*^9}, {
   3.7774388641791954`*^9, 3.7774388648513975`*^9}, {3.777442154864598*^9, 
   3.7774421992927856`*^9}, {3.7774423922248397`*^9, 3.77744244084781*^9}, {
   3.7774427586027145`*^9, 3.7774428023977547`*^9}, {3.7774431154937105`*^9, 
   3.7774431223982477`*^9}, {3.7774433170238543`*^9, 
   3.7774433204606633`*^9}, {3.7774433784905972`*^9, 
   3.7774433959110107`*^9}, {3.7774435240368366`*^9, 3.777443569963546*^9}, {
   3.777506186313735*^9, 3.777506195725565*^9}, {3.7775062268234015`*^9, 
   3.7775062498907146`*^9}, 3.777631896333584*^9, 3.7869307607251015`*^9, 
   3.7869308937920475`*^9, {3.8059481454391665`*^9, 3.80594814583012*^9}, {
   3.8059530580053654`*^9, 3.8059530874386454`*^9}, {3.8059558912721148`*^9, 
   3.805955891451634*^9}, {3.8059603598233733`*^9, 3.8059603647571774`*^9}, {
   3.805960473493359*^9, 3.8059604736589165`*^9}, {3.805961100266038*^9, 
   3.8059611115438747`*^9}, {3.805961199566456*^9, 3.805961210634853*^9}, {
   3.821051820455868*^9, 3.821051821092165*^9}},
 CellLabel->
  "In[5556]:=",ExpressionUUID->"0c257bf7-0420-46a1-8631-70cdcae4faf2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Phonon number fitting by red and Blue",
 FontSlant->"Plain"]], "Subsubsection",
 CellChangeTimes->{{3.7775056559504423`*^9, 3.777505662016221*^9}, {
  3.7776305215490875`*^9, 
  3.777630523317359*^9}},ExpressionUUID->"54d357f4-f4e4-497a-89fe-\
a587e0f37e41"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Alpha]V", ",", " ", "\[Alpha]Cur", ",", "PhononNumberFitting"}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Alpha]V", " ", "=", " ", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]Cur", " ", "=", " ", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PhononNumberFitting", "[", 
     RowBox[{"blue_List", ",", 
      RowBox[{"b\[Pi]fitting_", "?", "NumberQ"}], ",", "red_List", ",", 
      RowBox[{"r\[Pi]fitting_", "?", "NumberQ"}], ",", 
      RowBox[{"kmax_Integer:", " ", "15"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\n", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nred", ",", " ", "nblue", ",", " ", "Ared", ",", " ", "Ablue", ",", 
        " ", "Bred", ",", " ", "\n", "   ", "Bblue", ",", " ", 
        "\[CapitalOmega]r", ",", " ", "\[CapitalOmega]b", ",", " ", "level", 
        ",", " ", "Pk", ",", " ", "p", ",", " ", "Zero", ",", " ", "\n", 
        "   ", "zero", ",", " ", "Origin", ",", " ", "Pred", ",", " ", 
        "Pblue", ",", " ", "\[Chi]red", ",", " ", "\[Chi]blue", ",", " ", 
        "na", ",", " ", "V", ",", " ", "\n", "   ", "Cur", ",", " ", "\[Chi]",
         ",", " ", "result", ",", " ", "distribution", ",", " ", "\[Alpha]", 
        ",", " ", "nbar", ",", " ", "fittingred", ",", " ", "\n", "   ", 
        "fittingblue", ",", " ", "Fred", ",", " ", "Fblue", ",", " ", "dev", 
        ",", " ", "param", ",", " ", "parabolic", ",", " ", "RMS", ",", " ", 
        "rms", ",", " ", "\n", "   ", "fittingpara", ",", " ", "findpoint", 
        ",", " ", "bestfitting", ",", " ", "bestvalue", ",", " ", "unc", ",", 
        " ", "devlength", ",", " ", "\n", "   ", "devnumber", ",", " ", 
        "Deviation", ",", " ", "Param", ",", " ", "Parabolic", ",", " ", 
        "pkbestfitting", ",", " ", "pkbestvalue", ",", "\n", "    ", 
        "DataDeviation", ",", " ", "DataPk", ",", " ", "\[Sigma]\[Chi]", ",", 
        " ", "Uncertain", ",", " ", "interval", ",", " ", "\n", "   ", 
        "finalfitting", ",", " ", "ddev", ",", " ", "normalization", ",", " ",
         "i", ",", " ", "j", ",", " ", "n", ",", " ", "x", ",", " ", "t", ",",
         " ", "nik", ",", " ", "K"}], "}"}], ",", "\n", "\n", "  ", 
      RowBox[{
       RowBox[{"nred", " ", "=", " ", 
        RowBox[{"Length", "[", "red", "]"}]}], ";", " ", 
       RowBox[{"nblue", " ", "=", " ", 
        RowBox[{"Length", "[", "blue", "]"}]}], ";", "\n", "  ", 
       RowBox[{"Ared", " ", "=", " ", "0.95"}], ";", " ", 
       RowBox[{"Ablue", " ", "=", " ", "0.95"}], ";", "\n", "  ", 
       RowBox[{"Bred", " ", "=", " ", "0.95"}], ";", " ", 
       RowBox[{"Bblue", " ", "=", " ", "0.95"}], ";", "\n", "  ", 
       RowBox[{"\[CapitalOmega]b", " ", "=", " ", 
        RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], ";", " ", 
       RowBox[{"\[CapitalOmega]r", " ", "=", " ", 
        RowBox[{"\[Pi]", "/", "\n", "    ", "r\[Pi]fitting"}]}], ";", "\n", 
       "  ", 
       RowBox[{"level", " ", "=", " ", 
        RowBox[{"10", "^", 
         RowBox[{"-", "3"}]}]}], ";", "\n", "  ", "\n", "  ", 
       RowBox[{"Pk", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{"p", ",", " ", 
          RowBox[{"kmax", " ", "+", " ", "9"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"Zero", " ", "=", " ", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{"zero", ",", " ", 
           RowBox[{"kmax", " ", "+", " ", "9"}]}], "]"}], "*", "0"}]}], ";", 
       "\n", "  ", 
       RowBox[{"Origin", " ", "=", " ", "\n", "   ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Append", "[", "\n", "     ", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Append", "[", "\n", "       ", 
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Append", " ", "[", "\n", "         ", 
                   RowBox[{
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", "\n", "           ", 
                    RowBox[{"Most", "[", 
                    RowBox[{"Most", "[", "\n", "             ", 
                    RowBox[{"Most", "[", 
                    RowBox[{
                    "Most", "[", "\n", "               ", "Zero", "]"}], 
                    "]"}], "]"}], "]"}], "]"}], "]"}], ",", " ", 
                    "\[CapitalOmega]r"}], "]"}], ",", " ", 
                  "\[CapitalOmega]b"}], "]"}], ",", " ", "\n", "       ", 
                "Ared"}], "]"}], ",", " ", "Ablue"}], "]"}], ",", " ", 
            "Bred"}], "]"}], ",", " ", "Bblue"}], "]"}]}], ";", "\n", "  ", 
       "\n", "  ", 
       RowBox[{
        RowBox[{"Pred", "[", 
         RowBox[{"p_List", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "kmax"], 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"kmax", "+", "8"}], "]"}], "]"}], "-", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "6"}], "]"}], "]"}], " ", 
               SuperscriptBox["E", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"p", "[", 
                   RowBox[{"[", 
                    RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], "t"}]], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 FractionBox["1", 
                  SqrtBox["i"]], 
                 RowBox[{"LaguerreL", "[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "1", ",", 
                   SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"kmax", "+", "4"}], "]"}], "]"}], " ", "t"}], 
                "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\n", "  ", 
       RowBox[{
        RowBox[{"Pblue", "[", 
         RowBox[{"p_List", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"kmax", "+", "9"}], "]"}], "]"}], "-", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "7"}], "]"}], "]"}], " ", 
               SuperscriptBox["E", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"p", "[", 
                   RowBox[{"[", 
                    RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], "t"}]], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 FractionBox["1", 
                  SqrtBox[
                   RowBox[{"i", "+", "1"}]]], 
                 RowBox[{"LaguerreL", "[", 
                  RowBox[{"i", ",", "1", ",", 
                   SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"kmax", "+", "5"}], "]"}], "]"}], " ", "t"}], 
                "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\n", "  ", 
       RowBox[{
        RowBox[{"\[Chi]", "[", "Pk_List", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], "nred"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Pred", "[", 
                RowBox[{"Pk", ",", 
                 RowBox[{"red", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], " ", 
           "+", " ", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], "nblue"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Pblue", "[", 
                RowBox[{"Pk", ",", 
                 RowBox[{"blue", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"nred", " ", "+", " ", "nblue"}], ")"}]}]}], ";", "\n", 
       "  ", 
       RowBox[{"na", " ", "=", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         RowBox[{"i", " ", 
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "1"}], "]"}]}]}]}], ";", "\n", "  ", 
       RowBox[{"V", " ", "=", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"i", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"i", "-", "na"}], ")"}]}], ")"}], "2"]}]}], ";", "\n", 
       "  ", 
       RowBox[{"Cur", " ", "=", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], 
          RowBox[{"kmax", "-", "1"}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", "i", "]"}], "+", 
            RowBox[{"p", "[", 
             RowBox[{"i", "+", "2"}], "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"p", "[", 
              RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], "2"]}]}], ";", "\n", 
       "  ", 
       RowBox[{"result", " ", "=", " ", "\n", "   ", 
        RowBox[{"FindArgMin", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nred", " ", "+", " ", "nblue"}], ")"}], "*", 
              RowBox[{"\[Chi]", "[", "Pk", "]"}]}], " ", "+", " ", 
             RowBox[{"\[Alpha]V", "*", "V"}], " ", "+", " ", 
             RowBox[{"\[Alpha]Cur", "*", "Cur"}]}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"i", "=", "1"}], 
                RowBox[{"kmax", "+", "1"}]], 
               RowBox[{"p", "[", "i", "]"}]}], "<=", "1"}], " ", "&&", " ", 
             RowBox[{"Apply", "[", 
              RowBox[{"And", ",", " ", 
               RowBox[{"Thread", "[", 
                RowBox[{"Pk", " ", ">=", " ", "Zero"}], "]"}]}], "]"}], " ", "&&",
              " ", "\n", "      ", 
             RowBox[{"Apply", "[", 
              RowBox[{"And", ",", " ", "\n", "       ", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"Take", "[", 
                  RowBox[{"Pk", ",", " ", 
                   RowBox[{"kmax", " ", "+", " ", "1"}]}], "]"}], " ", "<=", 
                 " ", 
                 RowBox[{"Table", "[", 
                  RowBox[{"1", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", " ", "1", ",", " ", 
                    RowBox[{"kmax", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], 
                "]"}]}], "]"}], " ", "&&", " ", "\n", "      ", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"kmax", " ", "+", " ", "6"}], "]"}], " ", "<=", " ", 
              "1"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"kmax", " ", "+", " ", "7"}], "]"}], " ", "<=", " ", 
              "1"}], " ", "&&", " ", "\n", "      ", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"kmax", " ", "+", " ", "4"}], "]"}], " ", "<=", " ", 
              RowBox[{"1.1", "*", "\[CapitalOmega]r"}]}], " ", "&&", " ", 
             "\n", "      ", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"kmax", " ", "+", " ", "4"}], "]"}], " ", ">=", " ", 
              RowBox[{"0.9", " ", "\[CapitalOmega]r"}]}], " ", "&&", " ", 
             "\n", "      ", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"kmax", " ", "+", " ", "5"}], "]"}], " ", "<=", " ", 
              RowBox[{"1.1", "*", "\[CapitalOmega]b"}]}], " ", "&&", " ", 
             "\n", "      ", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"kmax", " ", "+", " ", "5"}], "]"}], " ", ">=", " ", 
              RowBox[{"0.9", " ", "\[CapitalOmega]b"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"kmax", " ", "+", " ", "8"}], "]"}], " ", ">=", " ", 
              "0"}], " ", "&&", " ", "\n", "      ", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"kmax", " ", "+", " ", "9"}], "]"}], " ", ">=", " ", 
              "0"}]}]}], "}"}], ",", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"Pk", ",", " ", "Origin"}], "}"}], "]"}]}], "]"}]}], ";", 
       "\n", "  ", "\n", "  ", 
       RowBox[{"devlength", " ", "=", " ", "0.01"}], ";", "\n", "  ", 
       RowBox[{"devnumber", " ", "=", " ", "2"}], ";", "\n", "  ", 
       RowBox[{"Deviation", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{"dev", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"kmax", " ", "+", " ", "1"}], ",", " ", 
            RowBox[{
             RowBox[{"2", " ", "devnumber"}], " ", "+", " ", "1"}]}], "}"}]}],
          "]"}]}], ";", "\n", "  ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "   ", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
           RowBox[{"j", " ", "<=", " ", 
            RowBox[{
             RowBox[{"2", " ", "devnumber"}], " ", "+", " ", "1"}]}], ",", 
           " ", 
           RowBox[{"j", "++"}], ",", " ", "\n", "    ", 
           RowBox[{
            RowBox[{"Deviation", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "\n", "      ", "j"}], "]"}], "]"}], " ",
             "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                  "j", " ", "-", " ", "devnumber", " ", "-", " ", "1"}], 
                  ")"}], " ", "devlength"}], ")"}], "/", "devnumber"}], " ", 
              RowBox[{"result", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", "\n", 
             "      ", 
             RowBox[{"result", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", "\n",
        "  ", 
       RowBox[{"Param", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Array", "[", 
           RowBox[{"param", ",", " ", 
            RowBox[{"kmax", " ", "+", " ", "1"}]}], "]"}], ",", " ", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", " ", 
            RowBox[{"-", "8"}]}], "]"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"Parabolic", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{"parabolic", ",", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", ">=", " ", "level"}], ",", 
           "\n", "    ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RMS", " ", "=", " ", 
              RowBox[{"Array", "[", 
               RowBox[{"rms", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"2", " ", "devnumber"}], " ", "+", " ", "1"}], ",",
                   " ", "2"}], "}"}]}], "]"}]}], ",", " ", "\n", "     ", 
             RowBox[{"fittingpara", " ", "=", " ", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"Param", ",", " ", 
                  RowBox[{"kmax", " ", "+", " ", "1"}]}], "]"}], ",", " ", 
                "i"}], "]"}]}], ",", " ", "\n", "     ", 
             RowBox[{"findpoint", " ", "=", " ", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"result", ",", " ", 
                  RowBox[{"kmax", " ", "+", " ", "1"}]}], "]"}], ",", " ", 
                "i"}], "]"}]}], ",", "\n", "     ", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
               RowBox[{"j", " ", "<=", " ", 
                RowBox[{
                 RowBox[{"2", " ", "devnumber"}], " ", "+", " ", "1"}]}], ",",
                " ", 
               RowBox[{"j", "++"}], ",", "\n", "      ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"RMS", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
                  RowBox[{"Deviation", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ",", "\n", 
                 "       ", 
                 RowBox[{
                  RowBox[{"RMS", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", " ", "2"}], "]"}], "]"}], " ", "=", " ",
                   "\n", "        ", 
                  RowBox[{"FindMinValue", "[", 
                   RowBox[{
                    RowBox[{"\[Chi]", "[", "\n", "          ", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", " ", 
                    RowBox[{"i", " ", "->", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}]}], "]"}], 
                    "]"}], ",", " ", "\n", "         ", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"fittingpara", ",", " ", "findpoint"}], "}"}], 
                    "]"}]}], "]"}]}]}], "}"}]}], "]"}], ",", " ", "\n", 
             "     ", 
             RowBox[{
              RowBox[{"Parabolic", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"Fit", "[", 
               RowBox[{"RMS", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "x", ",", " ", 
                  RowBox[{"x", "^", "2"}]}], "}"}], ",", " ", "x"}], "]"}]}], 
             ",", " ", "\n", "     ", 
             RowBox[{"Clear", "[", 
              RowBox[{"RMS", ",", " ", "fittingpara", ",", " ", "findpoint"}],
               "]"}]}], "}"}], ",", " ", 
           RowBox[{
            RowBox[{"Parabolic", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "0"}]}], "]"}]}], 
        "]"}], ";", "\n", "  ", 
       RowBox[{"pkbestfitting", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{"bestfitting", ",", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"pkbestvalue", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{"bestvalue", ",", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "   ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", ">=", " ", "\n", "     ", 
            "level"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"pkbestfitting", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
              RowBox[{
               RowBox[{"FindArgMin", "[", 
                RowBox[{
                 RowBox[{"Parabolic", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", " ", "x"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", "\n", "     ", 
             RowBox[{
              RowBox[{"pkbestvalue", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "\n", "      ", 
              RowBox[{"FindMinValue", "[", 
               RowBox[{
                RowBox[{"Parabolic", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", " ", "x"}], "]"}]}]}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"pkbestfitting", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "0"}], ",", " ",
              "\n", "     ", 
             RowBox[{
              RowBox[{"pkbestvalue", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "0"}]}], 
            "}"}]}], "]"}]}], "]"}], ";", "\n", "  ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", "\n", "   ", 
         RowBox[{
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "\n", "    ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pkbestfitting", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", ">=", " ", "0"}], ",", " ", 
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", "0"}], "]"}]}]}], 
        "]"}], ";", "\n", "  ", 
       RowBox[{"pkbestfitting", " ", "=", " ", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"normalization", " ", "=", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         RowBox[{"pkbestfitting", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";", "\n", "  ", "\n", 
       "  ", 
       RowBox[{"DataDeviation", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{"ddev", ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", "blue", "]"}], " ", "+", " ", 
           RowBox[{"Length", "[", "red", "]"}]}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"DataPk", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"pkbestfitting", ",", " ", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", " ", 
            RowBox[{"-", "8"}]}], "]"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", " ", "=", " ", "1"}], ";", " ", 
          RowBox[{"j", " ", "=", " ", "1"}]}], ",", " ", 
         RowBox[{"j", " ", "<=", " ", "nred"}], ",", " ", 
         RowBox[{"j", "++"}], ",", " ", "\n", "   ", 
         RowBox[{
          RowBox[{"ddev", "[", 
           RowBox[{"n", "++"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pred", "[", 
              RowBox[{"DataPk", ",", " ", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", 
             "-", " ", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", " ", "2"}], "]"}], "]"}]}], ")"}], "^", 
           "2"}]}]}], "]"}], ";", "\n", "  ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"j", " ", "<=", " ", "nblue"}], ",", " ", 
         RowBox[{"j", "++"}], ",", " ", "\n", "   ", 
         RowBox[{
          RowBox[{"ddev", "[", 
           RowBox[{"n", "++"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{"DataPk", ",", " ", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", 
             "-", " ", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", " ", "2"}], "]"}], "]"}]}], ")"}], "^", 
           "2"}]}]}], "]"}], ";", "\n", "  ", 
       RowBox[{"\[Sigma]\[Chi]", " ", "=", " ", "\n", "   ", 
        RowBox[{"1.96", "*", 
         RowBox[{
          RowBox[{"Sqrt", "[", "\n", "      ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"DataDeviation", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", 
                RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "^", 
              "2"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "1", ",", " ", "\n", "        ", 
               RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], 
            "]"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
            RowBox[{"Sqrt", "[", "\n", "       ", "Repeattimes", "]"}]}], 
           ")"}]}]}]}], ";", "\n", "  ", 
       RowBox[{"Uncertain", " ", "=", " ", 
        RowBox[{"Array", "[", 
         RowBox[{"unc", ",", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"kmax", " ", "+", " ", "1"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", ">=", " ", "level"}], ",", 
           "\n", "    ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"interval", " ", "=", " ", "\n", "      ", 
              RowBox[{"x", " ", "/.", " ", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{"Parabolic", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "==", " ", 
                 RowBox[{
                  RowBox[{"pkbestvalue", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], " ", "+", " ", 
                  "\[Sigma]\[Chi]"}]}], "]"}]}]}], ",", "\n", "     ", 
             RowBox[{
              RowBox[{"Uncertain", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "\n", "      ", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"interval", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
                  RowBox[{"pkbestfitting", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", "\n", 
                "       ", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"interval", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
                  RowBox[{"pkbestfitting", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
            "}"}], ",", " ", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "0"}]}], "]"}]}], 
        "]"}], ";", "\n", "  ", 
       RowBox[{"finalfitting", " ", "=", " ", "\n", "   ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DataPk", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], " ", "->",
            " ", "\n", "     ", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"kmax", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "  ", "\n", "  ", 
       RowBox[{"fittingred", " ", "=", " ", "\n", "   ", 
        RowBox[{"Pred", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"pkbestfitting", "/", "normalization"}], ",", " ", 
            RowBox[{"Take", "[", 
             RowBox[{"result", ",", " ", 
              RowBox[{"-", "8"}]}], "]"}]}], "]"}], ",", " ", "t"}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"fittingblue", " ", "=", " ", "\n", "   ", 
        RowBox[{"Pblue", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"pkbestfitting", "/", "normalization"}], ",", " ", 
            RowBox[{"Take", "[", 
             RowBox[{"result", ",", " ", 
              RowBox[{"-", "8"}]}], "]"}]}], "]"}], ",", " ", "t"}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"Fred", " ", "=", " ", 
        RowBox[{"Plot", "[", 
         RowBox[{"fittingred", ",", " ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "0", ",", " ", 
            RowBox[{"red", "[", 
             RowBox[{"[", 
              RowBox[{"nred", ",", " ", "1"}], "]"}], "]"}]}], "}"}], ",", 
          " ", "\n", "    ", 
          RowBox[{"PlotStyle", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", " ", "Red"}], 
            "}"}]}], ",", " ", 
          RowBox[{"LabelStyle", " ", "->", " ", "Bold"}], ",", " ", "\n", 
          "    ", 
          RowBox[{"PlotRange", " ", "->", " ", "All"}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
          RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", "\n", "    ", 
          RowBox[{"FrameTicksStyle", " ", "->", " ", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", " ", "15"}], "]"}]}]}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"Fblue", " ", "=", " ", "\n", "   ", 
        RowBox[{"Plot", "[", 
         RowBox[{"fittingblue", ",", " ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "0", ",", " ", 
            RowBox[{"blue", "[", 
             RowBox[{"[", 
              RowBox[{"nblue", ",", " ", "1"}], "]"}], "]"}]}], "}"}], ",", 
          " ", "\n", "    ", 
          RowBox[{"PlotStyle", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", " ", "Blue"}], 
            "}"}]}], ",", " ", 
          RowBox[{"LabelStyle", " ", "->", " ", "Bold"}], ",", " ", "\n", 
          "    ", 
          RowBox[{"PlotRange", " ", "->", " ", "All"}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
          RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", "\n", "    ", 
          RowBox[{"FrameTicksStyle", " ", "->", " ", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", " ", "15"}], "]"}]}]}], "]"}]}], ";", "\n", 
       "  ", "\n", "  ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{"distribution", "+", 
         RowBox[{"error", " ", "bar"}]}], "*)"}], "\n", "  ", 
       RowBox[{"Print", "[", 
        RowBox[{"(*", 
         RowBox[{"\"\<Distribution \>\"", ","}], "*)"}], 
        RowBox[{
         RowBox[{"finalfitting", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], " ", "//", " ", 
         "MatrixForm"}], "]"}], ";", "\n", "  ", 
       RowBox[{"Print", "[", 
        RowBox[{"(*", 
         RowBox[{"\"\<Error Bar \>\"", ","}], "*)"}], " ", 
        RowBox[{
         RowBox[{"finalfitting", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], " ", "//", " ", 
         "MatrixForm"}], "]"}], ";", "\n", "  ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\\), \\(0, 1\\)]\\) = \>\
\"", ",", " ", "\n", "   ", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"kmax", " ", "+", " ", "5"}], "]"}], "]"}]}], "]"}], ";", 
       "\n", "  ", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\\), \\(1, \
\\(-1\\)\\)]\\) = \>\"", ",", "\n", "    ", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"kmax", " ", "+", " ", "4"}], "]"}], "]"}]}], "]"}], ";", 
       "\n", "  ", 
       RowBox[{"Print", "[", 
        RowBox[{"BarChart", "[", 
         RowBox[{"finalfitting", ",", " ", "\n", "    ", 
          RowBox[{"ChartElementFunction", " ", "->", " ", 
           RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", "    ", 
          RowBox[{"FrameTicks", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", " ", "0.2", ",", " ", "0.4", ",", " ", "0.6", ",", 
                 " ", "0.8", ",", " ", "1"}], "}"}], ",", " ", "\n", 
               "       ", "None"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", " ", 
                   RowBox[{"i", " ", "-", " ", "1"}]}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", " ", "1", ",", " ", 
                   RowBox[{"kmax", " ", "+", " ", "1"}]}], "}"}]}], "]"}], 
               ",", " ", "None"}], "}"}]}], "}"}]}], ",", " ", "\n", "    ", 
          RowBox[{"FrameTicksStyle", " ", "->", " ", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", " ", "15"}], "]"}]}], ",", " ", 
          RowBox[{"LabelStyle", " ", "->", " ", "Bold"}], ",", " ", "\n", 
          "    ", 
          RowBox[{"ImageSize", " ", "->", " ", "Medium"}]}], "]"}], "]"}], 
       ";", "\n", "  ", 
       RowBox[{"Print", "[", 
        RowBox[{"List", "[", "\n", "    ", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"Fred", ",", " ", 
            RowBox[{"ListPlot", "[", 
             RowBox[{"red", ",", " ", 
              RowBox[{"PlotStyle", " ", "->", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.01", "]"}], ",", " ", "Black"}],
                 "}"}]}]}], "]"}], ",", " ", "\n", "     ", 
            RowBox[{"ImageSize", " ", "->", " ", "Medium"}]}], "]"}], ",", 
          " ", "\n", "    ", 
          RowBox[{"Show", "[", 
           RowBox[{"Fblue", ",", " ", 
            RowBox[{"ListPlot", "[", 
             RowBox[{"blue", ",", " ", 
              RowBox[{"PlotStyle", " ", "->", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "0.01", "]"}], ",", " ", "Black"}],
                 "}"}]}]}], "]"}], ",", "\n", "      ", 
            RowBox[{"ImageSize", " ", "->", " ", "Medium"}]}], "]"}]}], "]"}],
         "]"}], ";"}]}], "\n", "  ", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhononNumberFitting", "[", 
    RowBox[{"blue_List", ",", "red_List", ",", 
     RowBox[{"\[Pi]fitting_", "?", "NumberQ"}], ",", 
     RowBox[{"kmax_Integer:", " ", "15"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nred", ",", " ", "nblue", ",", " ", "level", ",", "init", ",", " ", 
       "Pk", ",", " ", "p", ",", " ", "Pred", ",", " ", "Pblue", ",", " ", 
       "\[Chi]red", ",", " ", "\[Chi]blue", ",", " ", "\[Chi]", ",", " ", 
       "result", ",", " ", "fittingred", ",", " ", "\n", "   ", "fittingblue",
        ",", " ", "Fred", ",", " ", "Fblue", ",", " ", "dev", ",", " ", 
       "param", ",", " ", "parabolic", ",", " ", "RMS", ",", " ", "rms", ",", 
       " ", "\n", "   ", "fittingpara", ",", " ", "findpoint", ",", " ", 
       "bestfitting", ",", " ", "bestvalue", ",", " ", "unc", ",", " ", 
       "devlength", ",", " ", "\n", "   ", "devnumber", ",", " ", "Deviation",
        ",", " ", "Param", ",", " ", "Parabolic", ",", " ", "pkbestfitting", 
       ",", " ", "pkbestvalue", ",", "\n", "    ", "DataDeviation", ",", " ", 
       "DataPk", ",", " ", "\[Sigma]\[Chi]", ",", " ", "Uncertain", ",", " ", 
       "interval", ",", " ", "\n", "   ", "finalfitting", ",", " ", "ddev", 
       ",", " ", "normalization", ",", " ", "i", ",", " ", "j", ",", " ", "n",
        ",", "x", ",", " ", "t", ",", "fig1", ",", "fig2", ",", "fig3", ",", 
       "fig4"}], "}"}], ",", "\[IndentingNewLine]", "\n", "  ", 
     RowBox[{
      RowBox[{"nred", " ", "=", " ", 
       RowBox[{"Length", "[", "red", "]"}]}], ";", " ", 
      RowBox[{"nblue", " ", "=", " ", 
       RowBox[{"Length", "[", "blue", "]"}]}], ";", "\n", "  ", 
      RowBox[{"level", " ", "=", " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "3"}]}]}], ";", "\n", "  ", 
      RowBox[{"init", "=", 
       RowBox[{"{", "0", "}"}]}], ";", "\n", " ", 
      RowBox[{"Pk", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"p", ",", " ", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"kmax", "+", "1"}], ")"}]}], " ", "+", " ", "2"}]}], 
        "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{
       RowBox[{"Pblue", "[", 
        RowBox[{"p_List", ",", " ", "t_"}], "]"}], " ", ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"p", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], 
          RowBox[{"kmax", "-", "1"}]], 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "2"}], "]"}], "]"}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "2", "+", "kmax"}], "]"}], "]"}]}], ")"}], 
            " ", 
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"2", "kmax"}], "+", "3"}], "]"}], "]"}]}], " ", 
              "t"}]], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["1", 
               SqrtBox[
                RowBox[{"i", "+", "1"}]]], 
              RowBox[{"LaguerreL", "[", 
               RowBox[{"i", ",", "1", ",", 
                SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", "\[Pi]", 
              " ", 
              RowBox[{"t", "/", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"2", "kmax"}], "+", "4"}], "]"}], "]"}]}]}], 
             "]"}]}], ")"}]}]}]}]}], ";", "\n", "  ", 
      RowBox[{
       RowBox[{"Pred", "[", 
        RowBox[{"p_List", ",", " ", "t_"}], "]"}], " ", ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"[", 
             RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], ")"}]}], "+", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], 
          RowBox[{"kmax", "-", "1"}]], 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "3", "+", "kmax"}], "]"}], "]"}]}], ")"}], 
            " ", 
            SuperscriptBox["E", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"2", "kmax"}], "+", "3"}], "]"}], "]"}]}], " ", 
              "t"}]], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["1", 
               SqrtBox[
                RowBox[{"i", "+", "1"}]]], 
              RowBox[{"LaguerreL", "[", 
               RowBox[{"i", ",", "1", ",", 
                SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", "\[Pi]", 
              " ", 
              RowBox[{"t", "/", 
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"2", "kmax"}], "+", "4"}], "]"}], "]"}]}]}], 
             "]"}]}], ")"}]}]}]}]}], ";", "\n", "  ", 
      RowBox[{
       RowBox[{"\[Chi]", "[", "p_List", "]"}], " ", ":=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "nred"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pred", "[", 
              RowBox[{"p", ",", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], " ", 
         "+", " ", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "1"}], "nblue"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pblue", "[", 
              RowBox[{"p", ",", 
               RowBox[{"blue", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        ")"}]}], ";", "\n", "\n", "  ", 
      RowBox[{"result", " ", "=", " ", "\n", "   ", 
       RowBox[{"FindArgMin", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Chi]", "[", "Pk", "]"}], ",", 
           RowBox[{
            RowBox[{"0.9", "<=", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"i", "=", "1"}], 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"kmax", "+", "1"}], ")"}]}]], 
              RowBox[{"p", "[", "i", "]"}]}], "<=", "1"}], " ", "&&", " ", 
            RowBox[{"(", 
             RowBox[{"And", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"0", "\[LessEqual]", 
                 RowBox[{"p", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"2", "*", 
                   RowBox[{"(", 
                    RowBox[{"kmax", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], 
             ")"}], " ", "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{
                RowBox[{"2", "kmax"}], "+", "3"}], "]"}], "\[GreaterEqual]", 
              "0"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.9", " ", "\[Pi]fitting"}], "\[LessEqual]", 
              RowBox[{"p", "[", 
               RowBox[{
                RowBox[{"2", "kmax"}], "+", "4"}], "]"}], "\[LessEqual]", 
              RowBox[{"1.1", " ", "\[Pi]fitting"}]}], ")"}]}]}], "}"}], ",", 
         " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "[", "i", "]"}], ",", 
               RowBox[{
                RowBox[{"PadRight", "[", 
                 RowBox[{"init", ",", 
                  RowBox[{"2", "*", 
                   RowBox[{"(", 
                    RowBox[{"kmax", "+", "1"}], ")"}]}]}], "]"}], 
                "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"2", "*", 
                RowBox[{"(", 
                 RowBox[{"kmax", "+", "1"}], ")"}]}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{
                 RowBox[{"2", "kmax"}], "+", "3"}], "]"}], ",", "0"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{
                 RowBox[{"2", "kmax"}], "+", "4"}], "]"}], ",", 
               "\[Pi]fitting"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\n", "  ", "\n", "  ", 
      RowBox[{"devlength", " ", "=", " ", "0.01"}], ";", "\n", "  ", 
      RowBox[{"devnumber", " ", "=", " ", "2"}], ";", "\n", "  ", 
      RowBox[{"Deviation", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"dev", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}], ",", " ", 
           RowBox[{
            RowBox[{"2", " ", "devnumber"}], " ", "+", " ", "1"}]}], "}"}]}], 
        "]"}]}], ";", "\n", "  ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "<=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", "\n", "   ", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
          RowBox[{"j", " ", "<=", " ", 
           RowBox[{
            RowBox[{"2", " ", "devnumber"}], " ", "+", " ", "1"}]}], ",", " ", 
          RowBox[{"j", "++"}], ",", " ", "\n", "    ", 
          RowBox[{
           RowBox[{"Deviation", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "\n", "      ", "j"}], "]"}], "]"}], " ", 
           "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                 "j", " ", "-", " ", "devnumber", " ", "-", " ", "1"}], ")"}],
                 " ", "devlength"}], ")"}], "/", "devnumber"}], " ", 
             RowBox[{"result", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", "\n", "      ", 
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", "\n", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"Param", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{"param", ",", 
           RowBox[{"2", "*", 
            RowBox[{"(", " ", 
             RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], "]"}], ",", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"result", ",", " ", 
           RowBox[{"-", "2"}]}], "]"}]}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"Parabolic", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"parabolic", ",", " ", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], "]"}]}], ";", 
      "\n", "  ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "<=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"result", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", ">=", " ", "level"}], ",", 
          "\n", "    ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RMS", " ", "=", " ", 
             RowBox[{"Array", "[", 
              RowBox[{"rms", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"2", " ", "devnumber"}], " ", "+", " ", "1"}], ",", 
                 " ", "2"}], "}"}]}], "]"}]}], ",", " ", "\n", "     ", 
            RowBox[{"fittingpara", " ", "=", " ", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"Param", ",", " ", 
                 RowBox[{"2", "*", 
                  RowBox[{"(", 
                   RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], "]"}], 
               ",", " ", "i"}], "]"}]}], ",", " ", "\n", "     ", 
            RowBox[{"findpoint", " ", "=", " ", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"result", ",", " ", 
                 RowBox[{"2", "*", 
                  RowBox[{"(", 
                   RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], "]"}], 
               ",", " ", "i"}], "]"}]}], ",", "\n", "     ", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
              RowBox[{"j", " ", "<=", " ", 
               RowBox[{
                RowBox[{"2", " ", "devnumber"}], " ", "+", " ", "1"}]}], ",", 
              " ", 
              RowBox[{"j", "++"}], ",", "\n", "      ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"RMS", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
                 RowBox[{"Deviation", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ",", "\n", 
                "       ", 
                RowBox[{
                 RowBox[{"RMS", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", " ", "2"}], "]"}], "]"}], " ", "=", " ", 
                 "\n", "        ", 
                 RowBox[{"FindMinValue", "[", 
                  RowBox[{
                   RowBox[{"\[Chi]", "[", "\n", "          ", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", " ", 
                    RowBox[{"i", " ", "->", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}]}], "]"}], 
                    "]"}], ",", " ", "\n", "         ", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"fittingpara", ",", " ", "findpoint"}], "}"}], 
                    "]"}]}], "]"}]}]}], "}"}]}], "]"}], ",", " ", "\n", 
            "     ", 
            RowBox[{
             RowBox[{"Parabolic", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
             RowBox[{"Fit", "[", 
              RowBox[{"RMS", ",", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "x", ",", " ", 
                 RowBox[{"x", "^", "2"}]}], "}"}], ",", " ", "x"}], "]"}]}], 
            ",", " ", "\n", "     ", 
            RowBox[{"Clear", "[", 
             RowBox[{"RMS", ",", " ", "fittingpara", ",", " ", "findpoint"}], 
             "]"}]}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"Parabolic", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "0"}]}], "]"}]}], 
       "]"}], ";", "\n", "\[IndentingNewLine]", "  ", 
      RowBox[{"pkbestfitting", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"bestfitting", ",", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], "]"}]}], ";", 
      "\n", "  ", 
      RowBox[{"pkbestvalue", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"bestvalue", ",", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], "]"}]}], ";", 
      "\n", "  ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "<=", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", "\n", "   ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"result", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", ">=", " ", "\n", "     ", 
           "level"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pkbestfitting", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"FindArgMin", "[", 
               RowBox[{
                RowBox[{"Parabolic", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", " ", "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", "\n", "     ", 
            RowBox[{
             RowBox[{"pkbestvalue", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "\n", "      ", 
             RowBox[{"FindMinValue", "[", 
              RowBox[{
               RowBox[{"Parabolic", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "x"}], "]"}]}]}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pkbestfitting", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "0"}], ",", " ", 
            "\n", "     ", 
            RowBox[{
             RowBox[{"pkbestvalue", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "0"}]}], "}"}]}],
          "]"}]}], "]"}], ";", "\n", "  ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "<=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", "\n", "   ", 
        RowBox[{
         RowBox[{"pkbestfitting", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "\n", "    ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", ">=", " ", "0"}], ",", " ", 
           RowBox[{"pkbestfitting", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "0"}], "]"}]}]}], "]"}],
       ";", "\n", "  ", 
      RowBox[{"pkbestfitting", " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"result", ",", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]}], "]"}]}], ";", 
      "\n", "  ", 
      RowBox[{"normalization", " ", "=", " ", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "1"}], 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", " ", "+", " ", "1"}], ")"}]}]], 
        RowBox[{"pkbestfitting", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"DataDeviation", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"ddev", ",", " ", 
         RowBox[{"nblue", " ", "+", " ", "nred"}]}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"DataPk", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"pkbestfitting", ",", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"result", ",", " ", 
           RowBox[{"-", "2"}]}], "]"}]}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", " ", "=", " ", "1"}], ";", " ", 
         RowBox[{"j", " ", "=", " ", "1"}]}], ",", " ", 
        RowBox[{"j", " ", "<=", " ", "nred"}], ",", " ", 
        RowBox[{"j", "++"}], ",", " ", "\n", "   ", 
        RowBox[{
         RowBox[{"ddev", "[", 
          RowBox[{"n", "++"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pred", "[", 
             RowBox[{"DataPk", ",", " ", 
              RowBox[{"red", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "-",
             " ", 
            RowBox[{"red", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", " ", "2"}], "]"}], "]"}]}], ")"}], "^", 
          "2"}]}]}], "]"}], ";", "\n", "  ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"j", " ", "<=", " ", "nblue"}], ",", " ", 
        RowBox[{"j", "++"}], ",", " ", "\n", "   ", 
        RowBox[{
         RowBox[{"ddev", "[", 
          RowBox[{"n", "++"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pblue", "[", 
             RowBox[{"DataPk", ",", " ", 
              RowBox[{"blue", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", " ", "1"}], "]"}], "]"}]}], "]"}], " ", "-",
             " ", 
            RowBox[{"blue", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", " ", "2"}], "]"}], "]"}]}], ")"}], "^", 
          "2"}]}]}], "]"}], ";", "\n", "  ", 
      RowBox[{"\[Sigma]\[Chi]", " ", "=", " ", "\n", "   ", 
       RowBox[{"1.96", "*", 
        RowBox[{
         RowBox[{"Sqrt", "[", "\n", "      ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"DataDeviation", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "^", 
             "2"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "1", ",", " ", "\n", "        ", 
              RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}],
           "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
           RowBox[{"Sqrt", "[", "\n", "       ", "Repeattimes", "]"}]}], 
          ")"}]}]}]}], ";", "\n", "\[IndentingNewLine]", "  ", 
      RowBox[{"Uncertain", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{"unc", ",", " ", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", "+", "1"}], ")"}]}]}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "<=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"kmax", "+", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pkbestfitting", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", ">=", " ", "level"}], ",", 
          "\n", "    ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"interval", " ", "=", " ", "\n", "      ", 
             RowBox[{"x", " ", "/.", " ", 
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{"Parabolic", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "==", " ", 
                RowBox[{
                 RowBox[{"pkbestvalue", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "+", " ", 
                 "\[Sigma]\[Chi]"}]}], "]"}]}]}], ",", "\n", "     ", 
            RowBox[{
             RowBox[{"Uncertain", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "\n", "      ", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"interval", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
                 RowBox[{"pkbestfitting", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", "\n", 
               "       ", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"interval", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
                 RowBox[{"pkbestfitting", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "}"}],
           ",", " ", 
          RowBox[{
           RowBox[{"Uncertain", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "0"}]}], "]"}]}], 
       "]"}], ";", "\n", "  ", 
      RowBox[{"finalfitting", " ", "=", " ", "\n", "   ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"DataPk", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], " ", "->",
           " ", "\n", "     ", 
          RowBox[{
           RowBox[{"Uncertain", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"kmax", "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\n", "  ", 
      RowBox[{"fittingred", " ", "=", " ", "\n", "   ", 
       RowBox[{"Pred", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"pkbestfitting", "/", "normalization"}], ",", " ", 
           RowBox[{"Take", "[", 
            RowBox[{"result", ",", " ", 
             RowBox[{"-", "2"}]}], "]"}]}], "]"}], ",", " ", "t"}], "]"}]}], 
      ";", "\n", "  ", 
      RowBox[{"fittingblue", " ", "=", " ", "\n", "   ", 
       RowBox[{"Pblue", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"pkbestfitting", "/", "normalization"}], ",", " ", 
           RowBox[{"Take", "[", 
            RowBox[{"result", ",", " ", 
             RowBox[{"-", "2"}]}], "]"}]}], "]"}], ",", " ", "t"}], "]"}]}], 
      ";", "\n", "  ", 
      RowBox[{"Fred", " ", "=", " ", 
       RowBox[{"Plot", "[", 
        RowBox[{"fittingred", ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "0", ",", " ", 
           RowBox[{"red", "[", 
            RowBox[{"[", 
             RowBox[{"nred", ",", " ", "1"}], "]"}], "]"}]}], "}"}], ",", " ",
          "\n", "    ", 
         RowBox[{"PlotStyle", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.002", "]"}], ",", " ", "Red"}], 
           "}"}]}], ",", " ", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Bold", ",", "Black", ",", 
            RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", " ", "\n", 
         "    ", 
         RowBox[{"PlotRange", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", " ", 
         RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
         RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", "\n", "    ", 
         RowBox[{"FrameTicksStyle", " ", "->", " ", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", " ", "14"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<t (\[Mu]s)\>\"", ",", "\"\<P(\[UpArrow])\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"Fblue", " ", "=", " ", "\n", "   ", 
       RowBox[{"Plot", "[", 
        RowBox[{"fittingblue", ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "0", ",", " ", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"nblue", ",", " ", "1"}], "]"}], "]"}]}], "}"}], ",", 
         " ", "\n", "    ", 
         RowBox[{"PlotStyle", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.002", "]"}], ",", " ", "Blue"}], 
           "}"}]}], ",", " ", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Bold", ",", "Black", ",", 
            RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", " ", "\n", 
         "    ", 
         RowBox[{"PlotRange", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", " ", 
         RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
         RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", "\n", "    ", 
         RowBox[{"FrameTicksStyle", " ", "->", " ", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", " ", "14"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<t (\[Mu]s)\>\"", ",", "\"\<P(\[UpArrow])\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\[Pi]time=\>\"", ",", " ", "\n", "   ", 
        RowBox[{"result", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"kmax", "+", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\n", " ", 
      RowBox[{"fig1", "=", " ", 
       RowBox[{"BarChart", "[", 
        RowBox[{
         RowBox[{"finalfitting", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"kmax", "+", "1"}]}], "]"}], "]"}], ",", " ", "\n", 
         "    ", 
         RowBox[{"ChartElementFunction", " ", "->", " ", 
          RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", " ", 
         RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", "    ", 
         RowBox[{"FrameTicks", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "0", ",", " ", "0.2", ",", " ", "0.4", ",", " ", "0.6", ",", 
                " ", "0.8", ",", " ", "1"}], "}"}], ",", " ", "\n", "       ",
               "None"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"i", " ", "-", " ", "1"}]}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", "1", ",", " ", 
                  RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", " ", 
              "None"}], "}"}]}], "}"}]}], ",", " ", "\n", "    ", 
         RowBox[{"FrameTicksStyle", " ", "->", " ", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", " ", "14"}], "]"}]}], ",", " ", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Bold", ",", "Black", ",", 
            RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", " ", "\n", 
         "    ", 
         RowBox[{"ImageSize", " ", "->", " ", "Medium"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<k\>\"", ",", "\"\<\!\(\*SubscriptBox[\(p0\), \(k\)]\)\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"fig2", "=", 
       RowBox[{"BarChart", "[", 
        RowBox[{
         RowBox[{"finalfitting", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"kmax", "+", "2"}], ";;", 
            RowBox[{
             RowBox[{"2", "kmax"}], "+", "2"}]}], "]"}], "]"}], ",", " ", 
         "\n", "    ", 
         RowBox[{"ChartElementFunction", " ", "->", " ", 
          RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", " ", 
         RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", "    ", 
         RowBox[{"FrameTicks", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "0", ",", " ", "0.2", ",", " ", "0.4", ",", " ", "0.6", ",", 
                " ", "0.8", ",", " ", "1"}], "}"}], ",", " ", "\n", "       ",
               "None"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"i", " ", "-", " ", "1"}]}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", "1", ",", " ", 
                  RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", " ", 
              "None"}], "}"}]}], "}"}]}], ",", " ", "\n", "    ", 
         RowBox[{"FrameTicksStyle", " ", "->", " ", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", " ", "14"}], "]"}]}], ",", " ", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Bold", ",", "Black", ",", 
            RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", " ", "\n", 
         "    ", 
         RowBox[{"ImageSize", " ", "->", " ", "Medium"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<k\>\"", ",", "\"\<\!\(\*SubscriptBox[\(p1\), \(k\)]\)\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "\n", "  ", 
      RowBox[{"fig3", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"Fred", ",", " ", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"red", ",", " ", 
           RowBox[{"PlotStyle", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.01", "]"}], ",", " ", "Black"}], 
             "}"}]}]}], "]"}], ",", " ", "\n", "     ", 
         RowBox[{"ImageSize", " ", "->", " ", "Medium"}]}], "]"}]}], ";", " ",
       "\[IndentingNewLine]", "\n", "   ", 
      RowBox[{"fig4", "=", " ", 
       RowBox[{"Show", "[", 
        RowBox[{"Fblue", ",", " ", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"blue", ",", " ", 
           RowBox[{"PlotStyle", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.01", "]"}], ",", " ", "Black"}], 
             "}"}]}]}], "]"}], ",", "\n", "      ", 
         RowBox[{"ImageSize", " ", "->", " ", "Medium"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "@", 
       RowBox[{"Grid", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"fig1", ",", "fig2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"fig3", ",", "fig4"}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"finalfitting", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], ",", 
           RowBox[{"finalfitting", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}]}], "\n", "  ", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.777505687206746*^9, 3.7775056872177167`*^9}, {
   3.7775057533822474`*^9, 3.777505824491085*^9}, {3.7775059544996886`*^9, 
   3.777505960236348*^9}, {3.7775060085503316`*^9, 3.7775060337130404`*^9}, 
   3.786930890306364*^9, {3.8059478484764013`*^9, 3.8059479287307587`*^9}, {
   3.80594826725736*^9, 3.8059483186010394`*^9}, {3.805948370740591*^9, 
   3.805948406538848*^9}, {3.8059484854029236`*^9, 3.805948498820039*^9}, {
   3.8059485658976383`*^9, 3.805948693740718*^9}, {3.8059487467210207`*^9, 
   3.8059487564101067`*^9}, {3.8059487947356043`*^9, 
   3.8059488564415693`*^9}, {3.8059489265470705`*^9, 3.805948960250929*^9}, {
   3.8059489945930796`*^9, 3.805949000541171*^9}, {3.8059490372948723`*^9, 
   3.8059490893386793`*^9}, {3.805949153522019*^9, 3.805949187615834*^9}, 
   3.8059492796038103`*^9, {3.805949319411343*^9, 3.8059493937265854`*^9}, 
   3.805949433773479*^9, {3.805949466868964*^9, 3.805949497006361*^9}, {
   3.8059495734140053`*^9, 3.8059495998552876`*^9}, {3.8059496484413433`*^9, 
   3.805949669113056*^9}, {3.8059497107865996`*^9, 3.8059497140628366`*^9}, {
   3.8059497525329475`*^9, 3.8059497556496115`*^9}, {3.8059498544792886`*^9, 
   3.8059500207924795`*^9}, {3.8059500516070642`*^9, 
   3.8059501299644957`*^9}, {3.8059501813919516`*^9, 
   3.8059502300867167`*^9}, {3.805950377997125*^9, 3.805950389736727*^9}, {
   3.805950446367267*^9, 3.805950598658958*^9}, {3.80595069767414*^9, 
   3.8059508079801235`*^9}, {3.805950868813423*^9, 3.8059508874695263`*^9}, {
   3.805950963584954*^9, 3.805950968823941*^9}, {3.8059510129070396`*^9, 
   3.805951019394689*^9}, {3.805951227480158*^9, 3.8059512565105157`*^9}, {
   3.8059520314718604`*^9, 3.805952107729904*^9}, 3.805952142324381*^9, {
   3.805952182401194*^9, 3.8059522442128773`*^9}, {3.8059523447669425`*^9, 
   3.8059523448397474`*^9}, {3.8059530706565294`*^9, 
   3.8059530924761724`*^9}, {3.8059533779789906`*^9, 
   3.8059534147805624`*^9}, {3.8059535107179756`*^9, 3.8059535601946483`*^9}, 
   3.80595360939506*^9, 3.8059536400341153`*^9, {3.8059538595699606`*^9, 
   3.805953952922287*^9}, {3.8059540210231495`*^9, 3.8059540448783484`*^9}, {
   3.805954103108609*^9, 3.8059541956989737`*^9}, {3.8059542726022935`*^9, 
   3.805954304041209*^9}, {3.8059543393378077`*^9, 3.8059543451382933`*^9}, {
   3.8059543797557087`*^9, 3.805954384881998*^9}, {3.805954500182623*^9, 
   3.8059545290125165`*^9}, {3.805954566050458*^9, 3.8059547260754666`*^9}, {
   3.8059548305410695`*^9, 3.8059548619909563`*^9}, {3.8059552056478357`*^9, 
   3.8059552315086703`*^9}, {3.805955278545869*^9, 3.805955286999259*^9}, {
   3.8059553382322354`*^9, 3.8059553456244645`*^9}, {3.805955465975582*^9, 
   3.8059556580518684`*^9}, 3.805955743731715*^9, {3.805955784552539*^9, 
   3.8059557877878857`*^9}, {3.8059591867627573`*^9, 3.805959193769019*^9}, {
   3.8059595574702897`*^9, 3.8059595589174194`*^9}, {3.8059598419813566`*^9, 
   3.8059598423852763`*^9}, {3.8059609677005877`*^9, 
   3.8059609876811485`*^9}, {3.805961129978572*^9, 3.805961195540224*^9}, {
   3.805961297928384*^9, 3.805961338457986*^9}, {3.8059614531921268`*^9, 
   3.8059614947150717`*^9}, {3.8059615391302824`*^9, 
   3.8059616191612377`*^9}, {3.8059616826085463`*^9, 3.8059617911283064`*^9}, 
   3.8059618742130938`*^9, {3.8059619108161974`*^9, 3.805962036679572*^9}, {
   3.805962068197277*^9, 3.8059621717573028`*^9}, {3.805962226973626*^9, 
   3.8059622620079255`*^9}, {3.8059623127911043`*^9, 3.805962328077221*^9}, {
   3.8059626662697153`*^9, 3.805962686325076*^9}, {3.8059627670132737`*^9, 
   3.8059627697808723`*^9}, {3.8059628828335094`*^9, 3.805962919361813*^9}, {
   3.8059645115479016`*^9, 3.805964559211424*^9}, {3.8059646096465335`*^9, 
   3.8059646360758476`*^9}, 3.8064017090144615`*^9, {3.806401855859723*^9, 
   3.8064018712774878`*^9}, {3.8064019022037754`*^9, 3.8064019386183844`*^9}, 
   3.8064019939374332`*^9},
 CellLabel->
  "In[5563]:=",ExpressionUUID->"2e884141-df80-4c15-bad6-6e8c765c1d6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Phonon number fitting by red",
 FontSlant->"Plain"]], "Subsubsection",
 CellChangeTimes->{{3.7776305284276924`*^9, 
  3.77763055261501*^9}},ExpressionUUID->"375390a8-7841-40e3-8f4c-\
dccfb6c7d89f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PhononNumberFittingRed", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]V", " ", "=", " ", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Alpha]Cur", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhononNumberFittingRed", "[", 
    RowBox[{"red_List", ",", "r\[Pi]fitting_", ",", 
     RowBox[{"kmax_Integer:", "15"}], ",", 
     RowBox[{"symbol_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nred", ",", "Ared", ",", "\[CapitalOmega]r", ",", "level", ",", "Pk", 
       ",", "p", ",", "Zero", ",", "zero", ",", "Origin", ",", "Pred", ",", 
       "\[Chi]red", ",", "na", ",", "V", ",", "Cur", ",", "\[Chi]", ",", 
       "result", ",", "distribution1", ",", "distribution2", ",", "\[Alpha]", 
       ",", "nbar", ",", "fittingred", ",", "fittingblue", ",", "Fred", ",", 
       "Fblue", ",", "dev", ",", "param", ",", "parabolic", ",", "RMS", ",", 
       "rms", ",", "fittingpara", ",", "findpoint", ",", "bestfitting", ",", 
       "bestvalue", ",", "unc", ",", "devlength", ",", "devnumber", ",", 
       "Deviation", ",", "Param", ",", "Parabolic", ",", "pkbestfitting", ",",
        "pkbestvalue", ",", "DataDeviation", ",", "DataPk", ",", 
       "\[Sigma]\[Chi]", ",", "Uncertain", ",", "interval", ",", 
       "finalfitting", ",", "ddev", ",", "normalization", ",", "i", ",", "j", 
       ",", "n", ",", "x", ",", "t", ",", "newdistribution", ",", "a", ",", 
       "b", ",", "c", ",", "prob", ",", "averagephononnumber", ",", 
       "phononnumberfluctuation"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"blue", "=", 
        RowBox[{"Average", "[", 
         RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"nred", "=", 
        RowBox[{"Length", "[", "red", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ared", "=", "0.95"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalOmega]r", "=", 
        RowBox[{"\[Pi]", "/", "r\[Pi]fitting"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"level", "=", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Pk", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"p", ",", 
          RowBox[{"kmax", "+", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Zero", "=", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{"zero", ",", 
           RowBox[{"kmax", "+", "4"}]}], "]"}], "*", "0"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Origin", "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Most", "[", 
               RowBox[{"Most", "[", "Zero", "]"}], "]"}], ",", 
              "\[CapitalOmega]b"}], "]"}], ",", "Ablue"}], "]"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Origin", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Drop", "[", 
               RowBox[{"Zero", ",", 
                RowBox[{"-", "3"}]}], "]"}], ",", "\[CapitalOmega]r"}], "]"}],
             ",", "Ared"}], "]"}], ",", "Ared"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pred", "[", 
         RowBox[{"p_List", ",", "t_"}], "]"}], ":=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "kmax"], 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", 
                RowBox[{"kmax", "+", "4"}], "]"}], "]"}], "-", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", 
                 RowBox[{"kmax", "+", "3"}], "]"}], "]"}], " ", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"p", "[", 
                   RowBox[{"[", 
                    RowBox[{"kmax", "+", "1"}], "]"}], "]"}]}], "*", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"i", "+", "1"}], ")"}], "0.7"], "*", " ", "t"}]], 
               " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 FractionBox["1", 
                  SqrtBox["i"]], 
                 RowBox[{"LaguerreL", "[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "1", ",", 
                   SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
                 RowBox[{"p", "[", 
                  RowBox[{"[", 
                   RowBox[{"kmax", "+", "2"}], "]"}], "]"}], " ", "t"}], 
                "]"}]}]}], ")"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]", "[", "Pk_List", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"i", "=", "1"}], "nred"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Pred", "[", 
               RowBox[{"Pk", ",", 
                RowBox[{"red", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
              RowBox[{"red", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}], ")"}],
          "/", 
         RowBox[{"(", "nred", ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"na", "=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         RowBox[{"i", " ", 
          RowBox[{"p", "[", 
           RowBox[{"i", "+", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], "kmax"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"i", "+", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"i", "-", "na"}], ")"}]}], ")"}], "2"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Cur", "=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], 
          RowBox[{"kmax", "-", "1"}]], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", "i", "]"}], "+", 
            RowBox[{"p", "[", 
             RowBox[{"i", "+", "2"}], "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"p", "[", 
              RowBox[{"i", "+", "1"}], "]"}]}]}], ")"}], "2"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"FindArgMin", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", "nred", ")"}], "*", 
              RowBox[{"\[Chi]", "[", "Pk", "]"}]}], "+", 
             RowBox[{"\[Alpha]V", "*", "V"}], "+", 
             RowBox[{"\[Alpha]Cur", "*", "Cur"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"i", "=", "1"}], "kmax"], 
               RowBox[{"p", "[", "i", "]"}]}], "<=", "1"}], "&&", 
             RowBox[{"Apply", "[", 
              RowBox[{"And", ",", 
               RowBox[{"Thread", "[", 
                RowBox[{"Pk", "\[GreaterEqual]", "Zero"}], "]"}]}], "]"}], "&&", 
             RowBox[{"(", 
              RowBox[{"0.9", "<=", 
               RowBox[{"p", "[", 
                RowBox[{"kmax", "+", "3"}], "]"}], "\[LessEqual]", "1"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"0.9", "<=", 
               RowBox[{"p", "[", 
                RowBox[{"kmax", "+", "4"}], "]"}], "\[LessEqual]", "1"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.95", "\[CapitalOmega]r"}], "<=", 
               RowBox[{"p", "[", 
                RowBox[{"kmax", "+", "2"}], "]"}], "\[LessEqual]", " ", 
               RowBox[{"1.05", "*", "\[CapitalOmega]r"}]}], ")"}]}]}], "}"}], 
          ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"Pk", ",", "Origin"}], "}"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"devlength", "=", "0.0005"}], ";", "\[IndentingNewLine]", 
       RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Deviation", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"dev", ",", 
          RowBox[{"{", 
           RowBox[{"kmax", ",", 
            RowBox[{
             RowBox[{"2", "devnumber"}], "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "kmax"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{
             RowBox[{"2", " ", "devnumber"}], "+", "1"}]}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"Deviation", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "devnumber", "-", "1"}], ")"}], 
                "devlength"}], "devnumber"], 
              RowBox[{"result", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "+", 
             RowBox[{"result", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Param", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Array", "[", 
           RowBox[{"param", ",", "kmax"}], "]"}], ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Parabolic", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"parabolic", ",", "kmax"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "kmax"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RMS", "=", 
              RowBox[{"Array", "[", 
               RowBox[{"rms", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"2", "devnumber"}], "+", "1"}], ",", "2"}], 
                 "}"}]}], "]"}]}], ",", 
             RowBox[{"fittingpara", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"Param", ",", "kmax"}], "]"}], ",", "i"}], "]"}]}], 
             ",", 
             RowBox[{"findpoint", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"result", ",", "kmax"}], "]"}], ",", "i"}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "\[LessEqual]", 
                RowBox[{
                 RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"RMS", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "=", 
                  RowBox[{"Deviation", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"RMS", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
                  RowBox[{"FindMinValue", "[", 
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"Param", ",", 
                    RowBox[{"i", "\[Rule]", " ", 
                    RowBox[{"Deviation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"fittingpara", ",", "findpoint"}], "}"}], "]"}]}],
                    "]"}]}]}], "}"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"Parabolic", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"Fit", "[", 
               RowBox[{"RMS", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "x", ",", 
                  SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ",", 
             RowBox[{"Clear", "[", 
              RowBox[{"RMS", ",", "fittingpara", ",", "findpoint"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"Parabolic", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pkbestfitting", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"bestfitting", ",", "kmax"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pkbestvalue", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"bestvalue", ",", "kmax"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "kmax"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"result", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"pkbestfitting", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"FindArgMin", "[", 
                RowBox[{
                 RowBox[{"Parabolic", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"pkbestvalue", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"FindMinValue", "[", 
               RowBox[{
                RowBox[{"Parabolic", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "x"}], "]"}]}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"pkbestfitting", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "0"}], ",", 
             RowBox[{
              RowBox[{"pkbestvalue", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "}"}]}], "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "kmax"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"pkbestfitting", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pkbestfitting", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", "0"}], 
            ",", 
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pkbestfitting", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"result", ",", "kmax"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"normalization", "=", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "kmax"], 
         RowBox[{"pkbestfitting", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"DataDeviation", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"ddev", ",", 
          RowBox[{"Length", "[", "red", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataPk", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"pkbestfitting", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"result", ",", 
            RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "=", "1"}], ";", 
          RowBox[{"j", "=", "1"}]}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", "nred"}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{
          RowBox[{"ddev", "[", 
           RowBox[{"n", "++"}], "]"}], "=", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pred", "[", 
              RowBox[{"DataPk", ",", 
               RowBox[{"red", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"red", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]\[Chi]", "=", 
        RowBox[{"1.96", "*", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"DataDeviation", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], 
            "]"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
            SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Uncertain", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"unc", ",", "kmax"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "kmax"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pkbestfitting", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "level"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"interval", "=", 
              RowBox[{"x", "/.", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{"Parabolic", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
                 RowBox[{
                  RowBox[{"pkbestvalue", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", "\[Sigma]\[Chi]"}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Uncertain", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"interval", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"pkbestfitting", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"interval", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"pkbestfitting", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"finalfitting", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DataPk", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], 
           "\[Rule]", " ", 
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fittingred", "=", 
        RowBox[{"Pred", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"pkbestfitting", ",", 
            RowBox[{"Take", "[", 
             RowBox[{"result", ",", 
              RowBox[{"-", "4"}]}], "]"}]}], "]"}], ",", "t"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Fred", "=", 
        RowBox[{"Plot", "[", 
         RowBox[{"fittingred", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"red", "[", 
             RowBox[{"[", 
              RowBox[{"nred", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Red"}], "}"}]}], 
          ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Red Sideband\>\""}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<t(us)\>\"", ",", "\"\<Spin up population\>\""}], 
            "}"}]}], ",", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"averagephononnumber", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DataPk", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "*", 
           "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "kmax"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"phononnumberfluctuation", "=", 
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Uncertain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", "normalization"}], "*", 
           "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "kmax"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", 
        RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}], "*)"}], ";", 
      RowBox[{"(*", 
       RowBox[{"distribution", "+", 
        RowBox[{"error", " ", "bar"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Distribution \>\"", ",", " ", 
          RowBox[{
           RowBox[{"finalfitting", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Error Bar \>\"", ",", " ", 
          RowBox[{
           RowBox[{"finalfitting", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "MatrixForm"}]}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", 
          ",", 
          RowBox[{"result", "[", 
           RowBox[{"[", 
            RowBox[{"kmax", "+", "3"}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"symbol", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Pi]r\), \(0, 1\)]\) = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"\[Pi]", "/", 
            RowBox[{"result", "[", 
             RowBox[{"[", 
              RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}], "]"}], "<>", 
          "\"\<, Average phonon number: \>\"", "<>", 
          RowBox[{"ToString", "@", "averagephononnumber"}], "<>", 
          "\"\<\[PlusMinus]\>\"", "<>", 
          RowBox[{"ToString", "@", "phononnumberfluctuation"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<WFA = \>\"", ",", 
          RowBox[{
           FractionBox["2", "\[Pi]"], 
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                RowBox[{"i", "-", "1"}]], 
               RowBox[{
                RowBox[{
                 StyleBox["finalfitting",
                  FontWeight->"Plain"], 
                 StyleBox["[",
                  FontWeight->"Bold"], 
                 StyleBox[
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}],
                  FontWeight->"Bold"], 
                 StyleBox["]",
                  FontWeight->"Bold"]}], "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"finalfitting", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
             "]"}], "]"}]}], ",", "\"\< \[PlusMinus] \>\"", ",", 
          RowBox[{
           FractionBox["2", "\[Pi]"], 
           SuperscriptBox[
            RowBox[{"Total", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{
                 RowBox[{"finalfitting", 
                  StyleBox["[",
                   FontWeight->"Bold"], 
                  StyleBox[
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}],
                   FontWeight->"Bold"], 
                  StyleBox["]",
                   FontWeight->"Bold"]}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "2"], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"finalfitting", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}], 
            FractionBox["1", "2"]]}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"symbol", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"finalfitting", "//", "MatrixForm"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"symbol", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"BarChart", "[", 
          RowBox[{"finalfitting", ",", 
           RowBox[{"ChartElementFunction", "\[Rule]", 
            RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", 
                  "1"}], "}"}], ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", "i"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "kmax"}], "}"}]}], "]"}], ",", 
                "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"prob", "=", 
         RowBox[{"BarChart", "[", 
          RowBox[{"finalfitting", ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"ChartElementFunction", "\[Rule]", 
              RowBox[{"errorBar", "[", "\"\<Rectangle\>\"", "]"}]}], ","}], 
            "*)"}], 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameTicks", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", 
                  "1"}], "}"}], ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", 
                "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"FrameTicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
         "\"\<F:\\\\Experiments\\\\Phonon Shift_Wigner \
Function\\\\Paper\\\\Figures\\\\SuperPos01Add3Prob.jpg\>\"", ",", "prob", ",", 
          RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"symbol", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Show", "[", 
          RowBox[{"Fred", ",", 
           RowBox[{"ListPlot", "[", 
            RowBox[{"red", ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
               "}"}]}]}], "]"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"List", "@@", "#"}], "&"}], "/@", "finalfitting"}], ",", 
        RowBox[{"Param", "\[LeftDoubleBracket]", 
         RowBox[{"kmax", "+", "4"}], "\[RightDoubleBracket]"}], ",", 
        "averagephononnumber", ",", "phononnumberfluctuation", ",", 
        RowBox[{"\[Pi]", "/", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"kmax", "+", "2"}], "]"}], "]"}]}]}], "}"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7776305879016447`*^9, 3.7776306768757067`*^9}, {
   3.777630716257391*^9, 3.777630729426174*^9}, {3.7776307675282803`*^9, 
   3.7776309148662634`*^9}, 3.7776309461954813`*^9, {3.777630978841178*^9, 
   3.7776309941273003`*^9}, {3.7776310430275292`*^9, 3.777631048880876*^9}, {
   3.7776310853393764`*^9, 3.7776311664095755`*^9}, {3.777631229514817*^9, 
   3.777631246049599*^9}, {3.777631371829234*^9, 3.7776313719648714`*^9}, {
   3.7776315099029913`*^9, 3.7776317321277094`*^9}, {3.7776317705928445`*^9, 
   3.7776318424157734`*^9}, 3.7776318828685923`*^9, {3.777631918401569*^9, 
   3.7776319680507956`*^9}, {3.777632023889469*^9, 3.7776320246903267`*^9}, {
   3.777632062827341*^9, 3.7776320666331615`*^9}, 3.786930883931403*^9, {
   3.8059531072716017`*^9, 3.8059531083178034`*^9}, {3.805961226463519*^9, 
   3.8059612265971613`*^9}},
 CellLabel->
  "In[5568]:=",ExpressionUUID->"6b31017e-af95-457b-903d-19e49e03ce39"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Coherent state fit by blue",
 FontSlant->"Plain"]], "Subsubsection",
 CellChangeTimes->{{3.786930663592712*^9, 
  3.7869306686063123`*^9}},ExpressionUUID->"9a97093d-ed16-4325-9f8b-\
5209fd107f1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoherentStateFittingBlue", "[", 
   RowBox[{
   "blue_List", ",", "b\[Pi]fitting_", ",", "\[Alpha]startpoint_", ",", 
    RowBox[{"kmax_Integer:", "15"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"red", ",", 
      RowBox[{"(*", 
       RowBox[{"blue", ","}], "*)"}], "nred", ",", "nblue", ",", "Pred", ",", 
      "Pblue", ",", "\[Chi]", ",", "result", ",", "distribution", ",", 
      "fittingred", ",", "fittingblue", ",", "Fred", ",", "Fblue", ",", 
      "\[Alpha]", ",", "Ar", ",", "Ab", ",", "Bb", ",", "\[Lambda]r", ",", 
      "\[Lambda]b", ",", "\[CapitalOmega]r", ",", "\[CapitalOmega]b", ",", 
      "pk", ",", "i", ",", "t", ",", "devlength", ",", "devnumber", ",", 
      "Deviation", ",", "dev", ",", "RMS", ",", "rms", ",", "Parabolic", ",", 
      "pkbestfitting", ",", "pkbestvalue", ",", "x", ",", "DataDeviation", 
      ",", "ddev", ",", "DataPk", ",", "normalization", ",", "n", ",", "j", 
      ",", "\[Sigma]\[Chi]", ",", "interval", ",", "Uncertain"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"blue", "=", 
       RowBox[{"Average", "[", 
        RowBox[{"bluename", ",", "S1"}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nblue", "=", 
      RowBox[{"Length", "[", "blue", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pblue", "[", 
       RowBox[{
       "\[Alpha]_", ",", "Ablue_", ",", "Bblue_", ",", "\[Lambda]blue_", ",", 
        "\[CapitalOmega]blue_", ",", "t_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "kmax"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              SuperscriptBox["\[Alpha]", "2"], ")"}], "i"], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              SuperscriptBox["\[Alpha]", "2"]}]]}], 
           RowBox[{
            RowBox[{"(", "i", ")"}], "!"}]], "*", 
          RowBox[{"(", 
           RowBox[{"Bblue", "-", 
            RowBox[{"Ablue", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Lambda]blue"}], " ", "t"}]], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox["1", 
                SqrtBox[
                 RowBox[{"i", "+", "1"}]]], " ", 
               RowBox[{"LaguerreL", "[", 
                RowBox[{"i", ",", "1", ",", 
                 SuperscriptBox["\[Eta]fitting", "2"]}], "]"}], " ", 
               "\[CapitalOmega]blue", " ", "t"}], "]"}]}]}], ")"}]}], 
         ")"}]}]}]}], ";", "\n", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{
       "\[Alpha]_", ",", "Ab_", ",", "Bb_", ",", "\[Lambda]b_", ",", 
        "\[CapitalOmega]b_"}], "]"}], ":=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"j", "=", "1"}], "nblue"], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{
            "\[Alpha]", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
             "\[CapitalOmega]b", ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"], "/", 
        "nblue"}]}]}], ";", "\n", 
     RowBox[{"result", "=", 
      RowBox[{"FindArgMin", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nblue", "*", 
           RowBox[{"\[Chi]", "[", 
            RowBox[{
            "\[Alpha]", ",", "Ab", ",", "Bb", ",", "\[Lambda]b", ",", 
             "\[CapitalOmega]b"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"\[Alpha]", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"\[Lambda]b", "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"\[CapitalOmega]b", "\[GreaterEqual]", 
              RowBox[{"0.95", 
               RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}]}], "&&", 
             RowBox[{"\[CapitalOmega]b", "\[LessEqual]", " ", 
              RowBox[{"1.05", 
               RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}]}], "&&"}], "*)"}], 
           RowBox[{"Ab", "\[GreaterEqual]", " ", "0"}], "&&", 
           RowBox[{"Ab", "\[LessEqual]", " ", "1"}], "&&", 
           RowBox[{"Bb", "\[GreaterEqual]", "0"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "\[Alpha]startpoint"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ab", ",", "0.9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Bb", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]b", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]b", ",", 
          RowBox[{"\[Pi]", "/", "b\[Pi]fitting"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"devlength", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"devnumber", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Deviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"dev", ",", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"Deviation", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "devnumber", "-", "1"}], ")"}], " ", 
            "devlength", " "}], "devnumber"], "*", 
          RowBox[{"result", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{"result", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RMS", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"rms", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "devnumber"}], "+", "1"}], ",", "2"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"2", "*", "devnumber"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
          RowBox[{"Deviation", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RMS", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"FindMinValue", "[", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{
              RowBox[{"Deviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Ab", ",", "Bb", ",", 
              "\[Lambda]b", ",", "\[CapitalOmega]b"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ab", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Bb", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]b", ",", 
              RowBox[{"result", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Parabolic", "=", 
      RowBox[{"Fit", "[", 
       RowBox[{"RMS", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x", ",", 
          SuperscriptBox["x", "2"]}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pkbestfitting", "=", 
      RowBox[{
       RowBox[{"FindArgMin", "[", 
        RowBox[{"Parabolic", ",", "x"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pkbestvalue", "=", 
      RowBox[{"FindMinValue", "[", 
       RowBox[{"Parabolic", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"DataDeviation", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"ddev", ",", 
        RowBox[{"Length", "[", "blue", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"j", "=", "1"}]}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", "nblue"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{
        RowBox[{"ddev", "[", 
         RowBox[{"n", "++"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Pblue", "[", 
            RowBox[{
             RowBox[{"result", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"result", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"blue", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"blue", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]\[Chi]", "=", 
      RowBox[{"1.96", "*", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DataDeviation", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", "DataDeviation", "]"}]}], ")"}], "2"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "DataDeviation", "]"}]}], "}"}]}], "]"}], 
         "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "DataDeviation", "]"}], "*", 
          SqrtBox["Repeattimes"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interval", "=", 
      RowBox[{"x", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{"Parabolic", "\[Equal]", 
         RowBox[{"pkbestvalue", "+", "\[Sigma]\[Chi]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Uncertain", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "pkbestfitting"}], "]"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"interval", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "pkbestfitting"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"distribution", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"pk", ",", 
        RowBox[{"kmax", "+", "1"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"kmax", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"distribution", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"result", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}], "2"], ")"}], 
           RowBox[{"i", "-", "1"}]], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"result", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}], "2"]}]]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "!"}]]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fittingblue", "=", 
      RowBox[{"Pblue", "[", 
       RowBox[{"pkbestfitting", ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Fblue", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"fittingblue", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"blue", "[", 
           RowBox[{"[", 
            RowBox[{"nblue", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Blue Sideband\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0, 1\)]\) = \>\"", ",", 
         RowBox[{"result", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Pi]b\), \(0, 1\)]\) = \>\"", ",", 
       RowBox[{"\[Pi]", "/", 
        RowBox[{"result", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Alpha] = \>\"", ",", 
       RowBox[{"result", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \[PlusMinus] \>\"", ",", 
       "Uncertain"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "distribution", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"BarChart", "[", 
       RowBox[{"distribution", ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(p\), \(k\)]\)\>\""}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0.2", ",", "0.4", ",", "0.6", ",", "0.8", ",", "1"}],
               "}"}], ",", "None"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"kmax", "+", "1"}]}], "}"}]}], "]"}], ",", "None"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "15"}], "]"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "Bold"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Show", "[", 
       RowBox[{"Fblue", ",", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"blue", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Black"}], 
            "}"}]}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "result", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       "Uncertain"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7869306845327444`*^9, {3.7869307409868565`*^9, 3.78693074268432*^9}, {
   3.786930874787842*^9, 3.786930876206051*^9}, 3.786931016097599*^9},
 CellLabel->
  "In[5572]:=",ExpressionUUID->"3b8f502b-9868-4efa-be84-4d0700604f5f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1160, 831},
WindowMargins->{{110, Automatic}, {Automatic, 41}},
Magnification:>0.8 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (2018\:5e743\:670828\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"SlideShow"}, "Garnet.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 170, 3, 99, "Section",ExpressionUUID->"c11c87c0-a425-4993-a937-084d58749241"],
Cell[753, 27, 38709, 529, 216, "Input",ExpressionUUID->"935a2aae-60e6-4112-80ce-5b8e50ab5612",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[39487, 560, 161, 3, 76, "Subsection",ExpressionUUID->"79eb9fab-3952-4233-9564-6ae0c30f7cf8"],
Cell[39651, 565, 131265, 3288, 10043, "Input",ExpressionUUID->"4fec53e1-60aa-4fef-80fd-e663c255db14",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[170953, 3858, 159, 3, 76, "Subsection",ExpressionUUID->"c2540ca5-fc5c-459b-afd2-109930100cb6"],
Cell[171115, 3863, 71060, 1324, 2016, "Input",ExpressionUUID->"179a6a3b-3b7f-46af-af4e-c287d4099074",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[242200, 5191, 213, 4, 59, "Subsubsection",ExpressionUUID->"1b1fe7cb-ab6e-4016-acf4-1e51fc906df9"],
Cell[242416, 5197, 210735, 4768, 11059, "Input",ExpressionUUID->"0c374017-817d-4a1c-a017-adba2b317455",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[453188, 9970, 276, 5, 59, "Subsubsection",ExpressionUUID->"c8f1241d-67ca-4e9e-b35d-99f41e367b04"],
Cell[453467, 9977, 41705, 1021, 3307, "Input",ExpressionUUID->"0c257bf7-0420-46a1-8631-70cdcae4faf2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[495209, 11003, 282, 5, 1, "Subsubsection",ExpressionUUID->"54d357f4-f4e4-497a-89fe-a587e0f37e41"],
Cell[495494, 11010, 77452, 1822, 330, "Input",ExpressionUUID->"2e884141-df80-4c15-bad6-6e8c765c1d6a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[572983, 12837, 221, 4, 1, "Subsubsection",ExpressionUUID->"375390a8-7841-40e3-8f4c-dccfb6c7d89f"],
Cell[573207, 12843, 34596, 855, 128, "Input",ExpressionUUID->"6b31017e-af95-457b-903d-19e49e03ce39",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[607840, 13703, 220, 4, 1, "Subsubsection",ExpressionUUID->"9a97093d-ed16-4325-9f8b-5209fd107f1c"],
Cell[608063, 13709, 17584, 451, 63, "Input",ExpressionUUID->"3b8f502b-9868-4efa-be84-4d0700604f5f",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

